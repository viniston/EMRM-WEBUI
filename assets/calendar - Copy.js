!function(t,e){"use strict";"object"==typeof module&&module.exports?module.exports=e():"function"==typeof define&&define.amd?define([],e):t.templates=e()}("object"==typeof window?window:this,function(){"use strict";function t(t,i){var o=n({},r.locals);return e(t)(n(o,i))}function e(t){return o[t]}function i(t){return t?String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;"):""}function n(t,e){e=e||{};for(var i in e)t[i]=e[i];return t}var o={};o["availability/add_timeblock"]=o["availability/add_timeblock.ejs"]=function(t){var e="";return e+='<div class="js-time-range"></div>\n<p class="text--small time-block-popover-text">Any overlaps will be merged.</p>\n<footer>\n  <button class="btn btn-guru btn--small js-add-button">Add</button>\n  <button class="btn btn--small js-cancel-button">Cancel</button>\n</footer>\n',e.trim()},o["availability/copy_availability"]=o["availability/copy_availability.ejs"]=function(t){var e="";return e+='<h3>Copy to these days</h3>\n<div class="js-day-selection"></div>\n<footer>\n  <button class="btn btn-guru js-copy">Copy</button>\n  <button class="btn js-cancel">Cancel</button>\n</footer>\n',e.trim()},o["availability/date_range"]=o["availability/date_range.ejs"]=function(t){var e="";return e+='<span class="js-multiple-days-every">Every </span><strong class="js-day-name"></strong> <span class="js-multiple-days-from">from </span><span class="js-date-range"></span>\n',e.trim()},o["availability/day"]=o["availability/day.ejs"]=function(t){var e="";return e+="<div class='js-custom-availability-day-tab' data-id='",e+=i(this.cid),e+="'>\n  <h3>",e+=i(this.day.getName()),e+="</h3>\n  <p>",e+=i(this.hours),e+="</p>\n</div>\n\n<div class='js-custom-availability-day-body'>\n  <div class='js-custom-availability-helper-text'>\n    <p>Every ",e+=i(this.day.getName()),e+=" from ",e+=i(this.day.getFormattedDate()),e+="\n      <p class='js-availability-varies-text'>\n        Availability varies within this date range.\n        To change that, you can specify times below to apply to every ",e+=i(this.day.getName()),e+=" within the date range.\n        If you make no changes, it will remain varied on ",e+=i(this.day.getName()),e+="\n      </p>\n    </p>\n  </div>\n\n  <div class='js-day-details' />\n\n  <div class='js-availability-overview custom-availability-overview'>\n    <span class='custom-availability-overview-heading'>\n      Availability -\n    </span>\n    <b>\n      ",e+=i(this.hours),e+="\n    </b>\n    <span class='custom-availability-overtime-overview'>\n      (including\n      <b>\n        ",e+=i(this.overtime),e+="\n        overtime\n      </b>\n      )\n    </span>\n  </div>\n</div>\n",e.trim()},o["availability/day_detail"]=o["availability/day_detail.ejs"]=function(t){var e="";return e+='<p class="js-date-range-component"></p>\n<p class="js-variance-text"></p>\n<span class="js-time-blocks"></span>\n<div class="js-availability-text"></div>\n',e.trim()},o["availability/onboard"]=o["availability/onboard.ejs"]=function(t){var e="";return e+='<div class="onboard-overlay">\n  <h4 class="h1 bold">Exceptions to normal availability</h4>\n  <p>Use this form to specify exceptions to a resource\'s normal availability.</p>\n  <p>\n    You should specify a resource\'s &quot;regular&quot; availability in the\n    resources section instead - under &quot;Normal Availability&quot;.\n  </p>\n  <footer>\n    <button class="btn btn-guru js-close">Got it</button>\n  </footer>\n</div>\n',e.trim()},o["availability/popover_menu"]=o["availability/popover_menu.ejs"]=function(t){var e="";return e+='<div class="availability-tabs__menu dropdown">\n  <a class="dropdown-toggle">\n    <i class="rg-ion-chevron-down"></i>\n  </a>\n  <ul class="dropdown-menu">\n    <li class="js-reset-availability">\n      <a>Reset To Normal Availability</a>\n    </li>\n    <li class="js-copy-availability">\n      <a>Copy To Other Days &hellip;</a>\n    </li>\n  </ul>\n</div>\n',e.trim()},o["calendar/color_control"]=o["calendar/color_control.ejs"]=function(t){var e="";return e+='<a id="color-by-trigger" class="dropdown-toggle" data-toggle="dropdown" href="#">\n  <span id="active-coloring">Color by Something</span>\n</a>\n<ul class="dropdown-menu no-ellipsis is-left-aligned" id="color-by-options">\n  <li><a href="#" id="color-by-project">Color by Project</a></li>\n  <li><a href="#" id="color-by-client">Color by Client</a></li>\n  <li><a href="#" id="color-by-booker">Color by Booker</a></li>\n</ul>\n',e.trim()},o["calendar/controls"]=o["calendar/controls.ejs"]=function(t){var e="";return e+='<nav class="calendar">\n  <ul class=\'right-menu is-padded\'>\n    <li>\n      <div data-toggle="tooltip" data-placement="bottom" class=\'header-btn zoom-toggle js-zoom-toggle\'>\n        <div class="zoom-control">\n        </div>\n      </div>\n    </li>\n    <li>\n      <div data-toggle="tooltip" data-placement="bottom" class="js-toggle-availability header-btn has-icon btn-availability"></div>\n    </li>\n    <li id="color-control">\n    </li>\n    <li>\n      <div id="quick-search" class="header-btn">\n      </div>\n    </li>\n    <li class="dropdown is-header-dropdown has-chevron filters">\n      <a class="dropdown-toggle" data-toggle="dropdown" href="#">Filters</a>\n      <div class="dropdown-menu" id="filter-bar"></div>\n    </li>\n  </ul>\n</nav>\n\n',e.trim()},o["calendar/date_control"]=o["calendar/date_control.ejs"]=function(t){var e="";return e+='<li>\n  <a href="#" class="current js-current">Today</a>\n</li>\n<li class="load-more previous">\n  <a href="#" class="previous js-previous"></a>\n</li>\n<li class="load-more next">\n  <a href="#" class="next js-next"></a>\n</li>\n\n<li class=\'months-dropdown dropdown is-header-dropdown\'>\n  <a class="dropdown-toggle header-btn has-icon btn-calendar" data-toggle="dropdown" href="#">\n  </a>\n  <div class="dropdown-menu is-centered">\n    <div class=\'year-scroller\'>\n      <a class=\'js-scroll-year previous\'></a>\n      <span class=\'js-scroll-year current\'>',e+=i(this.activeYear),e+='</span>\n      <a class=\'js-scroll-year next\'></a>\n\n    </div>\n    <ul class="months">\n      <li data-month="1"><a href="#">Jan</a></li>\n      <li data-month="2"><a href="#">Feb</a></li>\n      <li data-month="3"><a href="#">Mar</a></li>\n      <li data-month="4"><a href="#">Apr</a></li>\n      <li data-month="5"><a href="#">May</a></li>\n      <li data-month="6"><a href="#">Jun</a></li>\n      <li data-month="7"><a href="#">Jul</a></li>\n      <li data-month="8"><a href="#">Aug</a></li>\n      <li data-month="9"><a href="#">Sep</a></li>\n      <li data-month="10"><a href="#">Oct</a></li>\n      <li data-month="11"><a href="#">Nov</a></li>\n      <li data-month="12"><a href="#">Dec</a></li>\n    </ul>\n  </div>\n</li>\n\n<li class=\'years-dropdown dropdown has-chevron is-header-dropdown\'>\n  <a id="jump-to-year-trigger" class="dropdown-toggle" data-toggle="dropdown" href="#">\n    <span id="active-year"></span>\n  </a>\n  <ul class="dropdown-menu is-centered" id="jump-to-year-options">\n    ',this.years.forEach(function(t){e+='\n    <li data-year="',e+=i(t),e+='"><a href="#">',e+=i(t),e+="</a></li>\n    "}),e+='\n  </ul>\n</li>\n\n<li class=\'months-listing\'>\n  <ul class="months">\n    <li data-month="1"><a href="#">Jan</a></li>\n    <li data-month="2"><a href="#">Feb</a></li>\n    <li data-month="3"><a href="#">Mar</a></li>\n    <li data-month="4"><a href="#">Apr</a></li>\n    <li data-month="5"><a href="#">May</a></li>\n    <li data-month="6"><a href="#">Jun</a></li>\n    <li data-month="7"><a href="#">Jul</a></li>\n    <li data-month="8"><a href="#">Aug</a></li>\n    <li data-month="9"><a href="#">Sep</a></li>\n    <li data-month="10"><a href="#">Oct</a></li>\n    <li data-month="11"><a href="#">Nov</a></li>\n    <li data-month="12"><a href="#">Dec</a></li>\n  </ul>\n</li>\n\n<div class="large-controls">\n  <div class="previous-timeperiods" style="display: none;">&nbsp;</div>\n  <div class="next-timeperiods" style="display: none;">&nbsp;</div>\n  <div class="previous-resources" style="display: none;">&nbsp;</div>\n  <div class="next-resources" style="display: none;">&nbsp;</div>\n</div>\n',e.trim()},o["calendar/filter_panel"]=o["calendar/filter_panel.ejs"]=function(t){var e="";return e+='<div class="filter-container">\n  <div class="filter__save">\n    <span class="filter__save-link">Save filters</span>\n    <span data-toggle="tooltip" data-placement="left" class="filter__info-tooltip" data-original-title="Save your favourite filter sets for quick access later."></span>\n    <div class="filter__save-dialog">\n      <input type="text" name="name" class="filter__save-name" />\n      <button type="button" class="btn btn-guru btn-small">Save</button>\n      <button type="button" class="btn btn-small">Cancel</button>\n    </div>\n  </div>\n  <div class="filter-categories"></div>\n</div>\n',e.trim()},o["calendar/header"]=o["calendar/header.ejs"]=function(t){var e="";return e+='<div class="blank-space"></div>\n<div id="time-periods"></nav>\n',e.trim()},o["calendar/layout"]=o["calendar/layout.ejs"]=function(t){var e="";return e+='<header></header>\n<aside></aside>\n<section class="red"></section>\n',e.trim()},o["calendar/light_spinner"]=o["calendar/light_spinner.ejs"]=function(t){var e="";return e+='<div class="spinner-wrap">\n  <div class="sprite-spinner">\n    <img src="/assets/calendar/spinner_light.png" alt=""/>\n  </div>\n</div>\n',e.trim()},o["calendar/unit"]=o["calendar/unit.ejs"]=function(t){var e="";return e+='<span class="name"></span>\n<span class="date"></span>\n',e.trim()},o["calendar/unit_grouping"]=o["calendar/unit_grouping.ejs"]=function(t){var e="";return e+='<h2 class="date-period"></h2>\n<h2 class="week-period"> </h2>\n\n<div class="units"></div>\n',e.trim()},o["dialogs/allowance_breakdown"]=o["dialogs/allowance_breakdown.ejs"]=function(t){var e="";return e+="<p>\n  <span class='automated-calculation-heading'>Automated calculation</span>\n</p>\n",e.trim()},o["dialogs/booking_clash_management"]=o["dialogs/booking_clash_management.ejs"]=function(t){var e="";return e+='<div class="booking-clash">\n  <main>\n    <img src="/assets/smallicon/icon--alert.svg">\n    <h1 class="text--warning">Booking Clash</h1>\n    <p class=\'js-booking-clash-text\'>\n      <span class="js-booking-count"></span> within the date range no longer <span class="js-fit-text"></span> the new schedule. What do you want to do with the bookings?\n    </p>\n  </main>\n  <footer>\n    <button class="btn btn-guru js-add-waiting">Move To Waiting List</button>\n    <button class="btn btn-guru js-delete-bookings">Delete</button>\n    <button class="btn cancel js-cancel">Cancel</button>\n  </footer>\n</div>\n',e.trim()},o["dialogs/booking_details_body"]=o["dialogs/booking_details_body.ejs"]=function(t){var e="";return e+='<div class="availability-changed alert alert-block" style="display: none;">\n  <h4 class="text--warning">Availability Changed</h4>\n  <p>This resource\'s availability has changed since this booking was made. Editing it may change the amount of time booked.</p>\n</div>\n<dl>\n  <dt id="booking-resources-field">Resource</dt>\n  <dd id="booking-resources" class="booking-resources"></dd>\n  <div class="js-actions-container"/>\n  <dt id="booking-target-field">Project/Client</dt>\n  <dd id="booking-target">project name</dd>\n  <dt>Total</dt>\n  <dd class="hours"><span id="confirmed-hours">2h confirmed</span> <span id="waiting-list-hours" class="red-marker">+ 10m on waiting list</span></dd>\n  <dt id="details-field">Details</dt>\n  <dd id="details" class="booking-details">details</dd>\n  <dt>Booker</dt>\n  <dd id=\'booker-avatar\'>\n    <img class="js-booker-img"/>\n    <div class="js-booker-name booker-name"></div>\n  </dd>\n</dl>\n',e.trim()},o["dialogs/booking_details_header"]=o["dialogs/booking_details_header.ejs"]=function(t){var e="";return e+='<div class="popover__header">\n  <i class="rg-ion-android-time"></i>\n  Booking\n</div>\n<div>\n  <time id="booking-duration">11.30am - 12.30pm <span>every day</span></time>\n</div>\n\n<time id="booking-date">1 - 2 Apr 2013 <span>(GMT +0) UTC</span></time>\n',e.trim()},o["dialogs/booking_details_single_actions"]=o["dialogs/booking_details_single_actions.ejs"]=function(t){var e="";return e+='<ul>\n  <li class="downtime-btn-group">\n    <a title="Edit" class="btn--blank" id="edit-booking"><i class="rg-ion-edit"></i></a>\n  </li>\n  <li class="downtime-btn-group">\n    <a title="Delete" class="btn--blank" id="delete-booking"><i class="rg-ion-ios-trash"></i></a>\n  </li>\n</ul>\n',e.trim()},o["dialogs/booking_series_details_actions"]=o["dialogs/booking_series_details_actions.ejs"]=function(t){var e="";return e+='<li class="downtime-btn-group">\n  <a title="Edit" class="btn--blank dropdown-toggle edit-dropdown" data-toggle="dropdown" href="#"><i class="rg-ion-edit"></i><span class="rg-ion-chevron-down"></span></a>\n  <ul class="dropdown-menu">\n    <li><a id="edit-single-booking">Edit (date) only</a></li>\n    <li class="divider"></li>\n    <li><a id="edit-series">Edit entire booking</a></li>\n  </ul>\n</li>\n\n<li class="downtime-btn-group"><a title="Split" id="split-series" class="btn--blank" href="#"><i class="rg-ion-scissors"></i></a></li>\n\n<li class="downtime-btn-group">\n  <a title="Delete" class="btn--blank dropdown-toggle delete-dropdown" data-toggle="dropdown" href="#"><i class="rg-ion-ios-trash"></i><span class="rg-ion-chevron-down"></span></a>\n  <ul class="dropdown-menu">\n    <li><a id="delete-single-booking">Delete (date) only</a></li>\n    <li class="divider"></li>\n    <li><a id="delete-series">Delete entire booking</a></li>\n  </ul>\n</li>\n',e.trim()},o["dialogs/custom_availability"]=o["dialogs/custom_availability.ejs"]=function(t){var e="";return e+='<div class="availability-title">\n  <h1 class="availability-title__heading">\n    Availability\n  </h1>\n  <div class="js-avatar availability-title__resource">\n    <span class="js-resource-avatar"></span>\n    <div class="availability-title__resource-name">',e+=i(this.resource.getName()),e+='</div>\n  </div>\n  <h2 class="availability-title__date">\n    ',e+=i(this.dateRange.toString()),e+='\n    <span class="js-timezone availability-title__timezone">',e+=i(this.resource.getTimeZone().toString()),e+='</span>\n  </h2>\n</div>\n<div class="availability-tabs">\n</div>\n',e.trim()},o["dialogs/custom_availability_form"]=o["dialogs/custom_availability_form.ejs"]=function(t){var e="";return e+='<div class="availability-title">\n  <div class="availability-title__daterange availability-input-dates js-daterange">\n    <span class="dash">From</span>\n  </div>\n  <span data-toggle="tooltip" data-html="true" data-placement="left" class="filter__availability-form" data-original-title="Use this form to specify exceptions to a resource\'s normal availability. If you want to change when a resource normally works, it\'s much better to change \'normal availability\' in the resources section instead.<br><br>Only availability that falls within the selected date range is editable. Please note that availability can be affected by any time off/downtime bookings added to the schedule."></span>\n</div>\n',e.trim()},o["dialogs/dialog"]=o["dialogs/dialog.ejs"]=function(t){var e="";return e+="<header></header>\n<main></main>\n<footer></footer>\n",e.trim()},o["dialogs/downtime_details_actions"]=o["dialogs/downtime_details_actions.ejs"]=function(t){var e="";return e+='<li class="downtime-btn-group">\n  <a title="Edit" class="btn--blank" id=\'edit-downtime\'><i class="rg-ion-edit"></i></a>\n</li>\n<li class="downtime-btn-group js-split-button"><a title="Split" id="split-downtime" class="btn--blank"><i class="rg-ion-scissors"></i></a></li>\n<li class="downtime-btn-group js-delete-button"></li>\n',e.trim()},o["dialogs/downtime_details_actions_delete_series"]=o["dialogs/downtime_details_actions_delete_series.ejs"]=function(t){var e="";return e+='<a title="Delete" class="btn--blank dropdown-toggle delete-dropdown" data-toggle="dropdown" href="#"><i class="rg-ion-ios-trash"></i><span class="rg-ion-chevron-down js-delete-menu"></span></a>\n<ul class="dropdown-menu js-delete-menu">\n  <li><a id="delete-duration">Delete (date) only</a></li>\n  <li class="divider"></li>\n  <li><a id="delete-downtime">Delete entire event</a></li>\n</ul>\n',e.trim()},o["dialogs/downtime_details_actions_delete_single"]=o["dialogs/downtime_details_actions_delete_single.ejs"]=function(t){var e="";return e+='<a title="Delete" class="btn--blank delete-dropdown" id="delete-downtime" href=\'#\'><i class="rg-ion-ios-trash"></i></a>\n',e.trim()},o["dialogs/downtime_details_body"]=o["dialogs/downtime_details_body.ejs"]=function(t){var e="";return e+='<main>\n  <dl>\n    <dt id="booking-resources-field">Resources</dt>\n    <dd id="booking-resources" class="booking-resources"></dd>\n    <div class="js-actions-container"/>\n    <dt id="booking-target-field">Type</dt>\n    <dd id="booking-target">type name</dd>\n    <dt>Time</dt>\n    <dd class="hours"><span id="confirmed-hours">2h confirmed</span></dd>\n    <dt id="details-field">Details</dt>\n    <dd id="details">details</dd>\n    <dt>Booker</dt>\n    <dd id=\'booker-avatar\'>\n      <img class="js-booker-img"/>\n      <div class="js-booker-name booker-name"></div>\n    </dd>\n  </dl>\n</main>\n',e.trim()},o["dialogs/downtime_details_header"]=o["dialogs/downtime_details_header.ejs"]=function(t){var e="";return e+='<div class="popover__header" id="popover-header">\n  Time Off\n</div>\n<div>\n  <time id="downtime-duration">11.30am - 12.30pm</time>\n</div>\n<time class="downtime-details-date">1 Jan 2015</time>\n',e.trim()},o["dialogs/edit_booking_header"]=o["dialogs/edit_booking_header.ejs"]=function(t){var e="";return e+='<header>\n  <div class="popover__header" id "popover-header">\n    <i class="rg-ion-android-time"></i>\n    Edit Booking\n  </div>\n</header>\n',e.trim()},o["dialogs/error_list"]=o["dialogs/error_list.ejs"]=function(t){var e="";return e+='<div class="booking-clash">\n  <main>\n    <img src="/assets/smallicon/icon--alert.svg">\n    <h1 class="text--warning">The following issues prevented us from completing your request:</h1>\n    <div class="alert alert-error js-alert-error">\n    </div>\n  </main>\n  <footer>\n    <button class="btn btn-guru add-waiting js-ok">OK</button>\n  </footer>\n</div>\n',e.trim()},o["dialogs/new_booking"]=o["dialogs/new_booking.ejs"]=function(t){var e="";return e+='<div>\n  <main>\n    <form class="booking-form">\n      <dl>\n        <dt class="resource-instance-name required">Resource</dt>\n        <dd class="resource-instance-value"></dd>\n        <dt class="required">From</dt>\n        <dd class="booking-date required js-booking-date"></dd>\n        <dt class="booking-time-field required">Hours</dt>\n        <dd class="booking-time">\n        </dd>\n        <dt>Project/Client</dt>\n        <dd class="project-client">\n        </dd>\n        <dt>Details</dt>\n        <dd>\n          <textarea id="booking-details"></textarea>\n        </dd>\n        <dt class="required">Booker</dt>\n        <dd class="booker">\n        </dd>\n      </dl>\n    </form>\n  </main>\n  <footer>\n    <button class="btn btn-guru" id="add-booking">Add Booking</button>\n    <button class="btn" id="cancel">Cancel</button>\n  </footer>\n</div>\n',e.trim()},o["dialogs/new_booking_downtime_popover"]=o["dialogs/new_booking_downtime_popover.ejs"]=function(t){var e="";return e+='<div class="f-dropdown copy-availability-dropdown" data-dropdown-content aria-hidden="true" aria-autoclose="false" tabindex="-1">\n  <span class="shadow-arrow" style="margin-top: 20px"></span>\n  <div class="dropdown-content">\n    <div class="downtime__tabs ',e+=i(window.rgFeatures.TimeOff?"with-time-off":""),e+='">\n      <ul class="tabs" data-tab>\n        <li class="tab-title booking-tab">\n          <span id=\'new-booking\'><i class="rg-ion-android-time"></i>New Booking</span>\n        </li>\n        ',window.rgFeatures.TimeOff&&(e+='\n          <li class="tab-title downtime-tab">\n            <span id=\'new-downtime\'><i class="rg-icon--vacation"></i><span class="js-time-off-text">New Time Off</span></span>\n          </li>\n        '),e+='\n      </ul>\n\n      <div class="tabs-content downtime__content">\n        <div class="content active" id="panel2">\n          <div class="new-booking-time-off">\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n',e.trim()},o["dialogs/new_client"]=o["dialogs/new_client.ejs"]=function(t){var e="";return e+='<header>\n    <div>\n        <h3>New Client</h3>\n    </div>\n</header>\n<main>\n    <form>\n        <dl>\n            <dt class="required">Name</dt>\n            <dd>\n                <input class="client-name" type="text" placeholder="Enter a name for the new client"><span class="help-inline hide"></span>\n            </dd>\n            <dt>Color</dt>\n        </dl>\n    </form>\n</main>\n<footer>\n    <button class="btn btn-guru add-client js-add-client">Add Client</button>\n    <button class="btn cancel">Cancel</button>\n</footer>\n',e.trim()},o["dialogs/new_downtime"]=o["dialogs/new_downtime.ejs"]=function(t){var e="";return e+='<main>\n  <form class="time-off__form">\n    <dl>\n      <dt class="resource-field required">Resource</dt>\n      <dd class="js-resource-selector downtime-resource"></dd>\n      <div class="downtime-date"></div>\n      <dt>Type</dt>\n      <dd class="downtime-type required" id="downtime-type-options"></dd>\n      <dt class=\'js-timezone-heading required\'></dt>\n      <dd class="js-timezone-selector"></dd>\n      <dt>Details</dt>\n      <dd class="downtime-details optional">\n        <textarea id="downtime-details-value"></textarea>\n      </dd>\n      <dt class="required">Booker</dt>\n      <dd class="booker js-booker"></dd>\n    </dl>\n  </form>\n</main>\n<footer>\n  <button class="btn btn-guru" id="add-downtime">Add Time Off</button>\n  <button class="btn" id="cancel">Cancel</button>\n</footer>\n',e.trim()},o["dialogs/new_downtime_header"]=o["dialogs/new_downtime_header.ejs"]=function(t){var e="";return e+="<header>\n  <div class='popover__header'>\n    <h4>\n      <i class=\"js-downtime-icon rg-icon--vacation\"></i><span class='js-time-off-header-text'> New Time Off </span>\n    </h4>\n  </div>\n</header>\n",e.trim()},o["dialogs/new_project"]=o["dialogs/new_project.ejs"]=function(t){var e="";return e+='<header>\n  <div>\n    <h3>New Project</h3>\n  </div>\n</header>\n<main>\n  <form>\n    <dl>\n      <dt class="required">Project</dt>\n      <dd><input type="text" class="project-name" placeholder="Enter a name for the new project"><span class="help-inline hide"></span></dd>\n      <dt>Client</dt>\n      <dd class="client-select-field">\n      </dd>\n      <dt>\n        Color\n      </dt>\n    </dl>\n  </form>\n</main>\n<footer>\n  <button class="btn btn-guru add-project js-add-project">Add Project</button>\n  <button class="btn cancel">Cancel</button>\n</footer>\n',e.trim()},o["dialogs/popover"]=o["dialogs/popover.ejs"]=function(t){var e="";return e+='<div class="f-dropdown copy-availability-dropdown ',e+=i(this.cssClass),e+='" data-dropdown-content aria-hidden="true" aria-autoclose="false" tabindex="-1">\n  <span class="shadow-arrow"></span>\n  <div class="dropdown-content">\n  </div>\n</div>\n',e.trim()},o["dialogs/removed_availability_dates"]=o["dialogs/removed_availability_dates.ejs"]=function(t){var e="";return e+='<div class="booking-clash">\n  <main>\n    <h1 class="text--warning js-warning-title"></h1>\n\n    <div class="js-booking-non-working-dates-details"></div>\n  </main>\n  <footer>\n    <button class="btn btn-guru js-ok">OK</button>\n  </footer>\n</div>\n',e.trim()},o["dialogs/split_booking"]=o["dialogs/split_booking.ejs"]=function(t){var e="";return e+='<header>\n  <div>\n    <h3>Split this booking series into two blocks?</h3>\n  </div>\n</header>\n<main><div></div><div class="split block1">Mon 15 Apr - Tue 16 Apr</div>\n  <div class="split indicator">&nbsp;</div>\n  <div class="split block2">Wed 17 Apr - Fri 19 Apr</div>\n</main>\n<footer>\n  <button id="split-booking" class="btn btn-guru" type="button">Split Booking</button>\n  <button id="cancel" class="btn">Cancel</button>\n</footer>\n',e.trim()},o["dialogs/split_downtime"]=o["dialogs/split_downtime.ejs"]=function(t){var e="";return e+='<header>\n  <div>\n    <h3 class="js-title-downtime-type">Split this series of events into two blocks?</h3>\n  </div>\n</header>\n<main><div></div><div class="split block1">Mon 15 Apr - Tue 16 Apr</div>\n  <div class="split indicator">&nbsp;</div>\n  <div class="split block2">Wed 17 Apr - Fri 19 Apr</div>\n</main>\n<footer>\n  <button id="split-downtime" class="btn btn-guru" type="button">Split <span class="js-button-downtime-type">Time Off</span></button>\n  <button id="cancel" class="btn">Cancel</button>\n</footer>\n',e.trim()},o["dialogs/waiting_list_confirmation"]=o["dialogs/waiting_list_confirmation.ejs"]=function(t){var e="";return e+='<div class="booking-clash">\n  <main>\n    <img src="/assets/smallicon/icon--alert.svg">\n    <h1 class="text--warning">Booking Clash</h1>\n    <div class="js-booking-clash-details"></div>\n  </main>\n  <footer>\n    <button class="btn btn-guru add-waiting">Add To Waiting List</button>\n    <button class="btn cancel">Cancel</button>\n  </footer>\n</div>\n',e.trim()},o["downtimes/resource_selector"]=o["downtimes/resource_selector.ejs"]=function(t){var e="";return e+='<div class="filter__options-control">\n  <select class="chzn-select filter-option" multiple></select>\n</div>\n<span class="help-inline error" visibility="hidden">Please select at least one resource.</span>\n',e.trim()},o["downtimes/vacation_allowance"]=o["downtimes/vacation_allowance.ejs"]=function(t){var e="";return e+="<dt>Vacation allowance</dt>\n",e.trim()},o["downtimes/vacation_allowance_year"]=o["downtimes/vacation_allowance_year.ejs"]=function(t){var e="";return e+='<dd>\n  <p class="is-bold">Jan to Dec ',e+=i(this.model.get("year")),e+=' allowance</p>\n  <p>Deduct\n    <span><input type="text" data-attribute-year="',e+=i(this.model.get("year")),e+='" class="input--small" value="',e+=i(this.model.get("numberOfUsedDays")),e+='"></input></span>\n    days from remaining allowance of\n    <span>',e+=i(this.model.get("remainingAllowance")),e+='</span> days\n  </p>\n  <span class="js-tooltip filter__info-tooltip"></span>\n</dd>\n',e.trim()},o["filters/category"]=o["filters/category.ejs"]=function(t){var e="";return e+='<h3 class="filter__category--name"></h3>\n<div class="filter__category--selected-options">\n  <span><strong>Perm/Freelance (any):</strong> Permanent</span>\n  <span><strong>Skills (all):</strong> HTML5 &nbsp;|&nbsp; Ruby on Rails</span>\n</div>\n<div class="filter__category__filters"></div>\n<a href="#" class="filter__clear">Clear</a>\n',e.trim()},o["filters/category_options"]=o["filters/category_options.ejs"]=function(t){var e="";return e+='<span class="shadow-arrow"></span>\n<div>\n  <h3>Projects</h3>\n  <span class="select-all-filters">\n    <a class="filter__options--all">All</a>\n  </span>\n  <span class="reset-select-all-filters" style="display: none">\n    <a class="filter__options--all">Clear</a> (all selected)\n  </span>\n  <div class="filter__options"></div>\n  ',this.tooltip&&(e+='\n    <span data-toggle="tooltip" data-placement="left" class="filter__info-tooltip" data-original-title="Filters are automatically generated from any custom fields you have in Settings &gt; Resources &gt; Custom Fields."></span>\n  '),e+="\n</div>\n",e.trim()},o["filters/match_type"]=o["filters/match_type.ejs"]=function(t){var e="";return e+='<select class="match-type-select">\n  <option value="any">match any</option>\n  <option value="all">match all</option>\n</select>\n',e.trim()},o["filters/option_group"]=o["filters/option_group.ejs"]=function(t){var e="";return e+='<div class="filter__options-control">\n  <select class="chzn-select filter-option" multiple></select>\n</div>\n<div class="filter__match-type-control">\n  <div class="match-type"></div>\n</div>\n',e.trim()},o["filters/quick_search_menu"]=o["filters/quick_search_menu.ejs"]=function(t){var e="";return e+='<div class="js-menu-cog time-off-resource__menu">\n  <a class="dropdown-toggle">\n    <i class="rg-ion-gear-a"> </i>\n  </a>\n  <ul class="dropdown-menu js-menu-options" style="position: relative;">\n    <li>\n      <a class="js-currently-filtered">Currently filtered</a>\n    </li>\n    <li>\n      <a class="js-all-people">All people</a>\n    </li>\n    <li>\n      <a class="js-all-resources">All resources</a>\n    </li>\n    <li>\n      <a class="js-clear-resources">Clear</a>\n    </li>\n  </ul>\n</div>\n',e.trim()},o["filters/save_filter_form"]=o["filters/save_filter_form.ejs"]=function(t){var e="";return e+='  <input type="text" name="name" class="filter__save-name" />\n  <div class="filter__save-form--actions">\n    <button type="button" class="btn btn-guru btn--small save">Save</button>\n    <button type="button" class="btn btn--small cancel">Cancel</button>\n  </div>\n',e.trim()},o["filters/saved_filter"]=o["filters/saved_filter.ejs"]=function(t){var e="";return e+='<div class="filter__saved-filter-name"></div>\n<input type="text" class="filter__saved-filter-input" style="display: none" placeholder="Type the new name">\n<span class="filter__saved-filter-actions">\n  <span class="save-rename-filter" style="display: none">Save</span>\n  <span class="rename-filter">Rename</span>\n  <span class="delete-filter">Delete</span>\n</span>\n',e.trim()},o["filters/saved_filter_panel"]=o["filters/saved_filter_panel.ejs"]=function(t){var e="";return e+='<div class="filter__save-header">\n  <span data-toggle="tooltip" data-placement="left" data-original-title="Please select some filters first." class="filter__save-link">Save filters</span>\n  <span data-toggle="tooltip" data-placement="left" class="filter__info-tooltip" data-original-title="Save your favourite filter sets for quick access later."></span>\n</div>\n<div class="filter__save-form">\n</div>\n<h3>Saved filters</h3>\n<div class="filter__saved-filter-list">\n</div>\n',e.trim()},o["filters/selected_options_summary"]=o["filters/selected_options_summary.ejs"]=function(t){var e="";return this.collection.forEach(function(t){e+="\n  <span>\n    <strong>",e+=i(t.name),e+=" (",e+=i(t.matchType),e+="):</strong>\n    ",e=[e,t.selectedOptions].join(""),e+="\n  </span>\n"}),e+="\n",e.trim()},o["filters/selected_options_summary_all"]=o["filters/selected_options_summary_all.ejs"]=function(t){var e="";return e+="<span><strong>All</strong></span>\n",e.trim()},o["resource/card"]=o["resource/card.ejs"]=function(t){var e="";return e+='<img src="" />\n<h3>Resource Name</h3>\n<h4>Resource Tag line</h4>\n<p class="timezone"></p>\n',e.trim()},o["selectors/color_picker"]=o["selectors/color_picker.ejs"]=function(t){var e="";return e+='<dd class="controls">\n    <select class="color optional color-picker-select js-select" id="client_color" name="client[color]">\n        <option value=""></option>\n    </select>\n    <div class="btn-group color-picker">\n        <a href="#" class="btn dropdown-toggle" data-toggle="dropdown">\n            <span class="selected-color"></span>\n            <span class="caret"></span>\n        </a>\n        <ul class="dropdown-menu color-palette js-displayed-colors"></ul>\n    </div>\n</dd>\n',e.trim()},o["selectors/date_range"]=o["selectors/date_range.ejs"]=function(t){var e="";return e+='<span>\n  <input type="text" id="booking-start-date" class="js-date-range-input" autocomplete="off">\n</span>\n<span class="dash">to</span>\n<span>\n  <input type="text" id="booking-end-date" class="js-date-range-input" autocomplete="off">\n</span>\n<div class="help-inline error">Please select a start and end date.</div>\n',e.trim()},o["selectors/date_time_range"]=o["selectors/date_time_range.ejs"]=function(t){var e="";return e+='<dt class="required">From</dt>\n<dd>\n  <span>\n    <input type="text" id="booking-start-date" class="js-date-range-input" autocomplete="off">\n    <input type="text" id="booking-start-time" class="js-time-range-input" autocomplete="off">\n  </span>\n</dd>\n<dt class="required">To</dt>\n<dd>\n  <span>\n    <input type="text" id="booking-end-date" class="js-date-range-input" autocomplete="off">\n    <input type="text" id="booking-end-time" class="js-time-range-input" autocomplete="off">\n  </span>\n  <div class="help-inline error">Validation message</div>\n</dd>\n',
e.trim()},o["selectors/duration"]=o["selectors/duration.ejs"]=function(t){var e="";return e+='<span class="input-append"><input id="booking-hour-time" type="text" autocomplete="off"><span class="add-on">h</span></span><span class="input-append"><input id="booking-minute-time" type="text" autocomplete="off"><span class="add-on">m</span></span><span class="alt-toggle">or <a href="#" class="book-duration-type-toggle">Book specific time</a></span>\n<span class="help-inline error"></span>\n',e.trim()},o["selectors/resource"]=o["selectors/resource.ejs"]=function(t){var e="";return e+='<div class="current">\n  <span class="resource-name">Resource Name</span>\n  <span class="alt-toggle"><a href="#">change...</a></span>\n</div>\n<div class="selector" style="display: none;">\n  <select class="chzn-select"></select>\n</div>\n',e.trim()},o["selectors/time_range"]=o["selectors/time_range.ejs"]=function(t){var e="";return e+='<span>\n  <input type="text" id="booking-start-time" class="js-time-range-input" autocomplete="off">\n</span>\n<span class="dash">to</span>\n<span>\n  <input type="text" id="booking-end-time" class="js-time-range-input" autocomplete="off">\n</span>\n<span class="alt-toggle">or <a href="#" class="book-duration-type-toggle">Book hours per day</a></span>\n<div>\n  <span class="help-inline error">Please select a valid start and end time.</span>\n</div>\n',e.trim()};var r={locals:{},get:e,render:t};return r}),templates.find=function(t){return function(e){return templates.get(t).call(e)}},function(t){"use strict";if("function"==typeof bootstrap)bootstrap("promise",t);else if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=t}else{if("undefined"==typeof self)throw new Error("This environment was not anticiapted by Q. Please file a bug.");self.Q=t()}}(function(){"use strict";function t(t){return function(){return H.apply(t,arguments)}}function e(t){return t===Object(t)}function i(t){return"[object StopIteration]"===tt(t)||t instanceof U}function n(t,e){if(j&&e.stack&&"object"==typeof t&&null!==t&&t.stack&&t.stack.indexOf(et)===-1){for(var i=[],n=e;n;n=n.source)n.stack&&i.unshift(n.stack);i.unshift(t.stack);var r=i.join("\n"+et+"\n");t.stack=o(r)}}function o(t){for(var e=t.split("\n"),i=[],n=0;n<e.length;++n){var o=e[n];a(o)||r(o)||!o||i.push(o)}return i.join("\n")}function r(t){return t.indexOf("(module.js:")!==-1||t.indexOf("(node.js:")!==-1}function s(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var i=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(i)return[i[1],Number(i[2])];var n=/.*@(.+):(\d+)$/.exec(t);return n?[n[1],Number(n[2])]:void 0}function a(t){var e=s(t);if(!e)return!1;var i=e[0],n=e[1];return i===N&&n>=L&&n<=rt}function l(){if(j)try{throw new Error}catch(n){var t=n.stack.split("\n"),e=t[0].indexOf("@")>0?t[1]:t[2],i=s(e);if(!i)return;return N=i[0],i[1]}}function c(t,e,i){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e+" is deprecated, use "+i+" instead.",new Error("").stack),t.apply(t,arguments)}}function u(t){return t instanceof f?t:y(t)?x(t):T(t)}function h(){function t(t){e=t,r.source=t,q(i,function(e,i){u.nextTick(function(){t.promiseDispatch.apply(t,i)})},void 0),i=void 0,n=void 0}var e,i=[],n=[],o=X(h.prototype),r=X(f.prototype);if(r.promiseDispatch=function(t,o,r){var s=Y(arguments);i?(i.push(s),"when"===o&&r[1]&&n.push(r[1])):u.nextTick(function(){e.promiseDispatch.apply(e,s)})},r.valueOf=function(){if(i)return r;var t=m(e);return v(t)&&(e=t),t},r.inspect=function(){return e?e.inspect():{state:"pending"}},u.longStackSupport&&j)try{throw new Error}catch(t){r.stack=t.stack.substring(t.stack.indexOf("\n")+1)}return o.promise=r,o.resolve=function(i){e||t(u(i))},o.fulfill=function(i){e||t(T(i))},o.reject=function(i){e||t(R(i))},o.notify=function(t){e||q(n,function(e,i){u.nextTick(function(){i(t)})},void 0)},o}function d(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var e=h();try{t(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}return e.promise}function p(t){return d(function(e,i){for(var n=0,o=t.length;n<o;n++)u(t[n]).then(e,i)})}function f(t,e,i){void 0===e&&(e=function(t){return R(new Error("Promise does not support operation: "+t))}),void 0===i&&(i=function(){return{state:"unknown"}});var n=X(f.prototype);if(n.promiseDispatch=function(i,o,r){var s;try{s=t[o]?t[o].apply(n,r):e.call(n,o,r)}catch(t){s=R(t)}i&&i(s)},n.inspect=i,i){var o=i();"rejected"===o.state&&(n.exception=o.reason),n.valueOf=function(){var t=i();return"pending"===t.state||"rejected"===t.state?n:t.value}}return n}function g(t,e,i,n){return u(t).then(e,i,n)}function m(t){if(v(t)){var e=t.inspect();if("fulfilled"===e.state)return e.value}return t}function v(t){return t instanceof f}function y(t){return e(t)&&"function"==typeof t.then}function _(t){return v(t)&&"pending"===t.inspect().state}function w(t){return!v(t)||"fulfilled"===t.inspect().state}function b(t){return v(t)&&"rejected"===t.inspect().state}function k(){it.length=0,nt.length=0,ot||(ot=!0)}function D(t,e){ot&&(nt.push(t),e&&"undefined"!=typeof e.stack?it.push(e.stack):it.push("(no stack) "+e))}function C(t){if(ot){var e=Z(nt,t);e!==-1&&(nt.splice(e,1),it.splice(e,1))}}function R(t){var e=f({when:function(e){return e&&C(this),e?e(t):this}},function(){return this},function(){return{state:"rejected",reason:t}});return D(e,t),e}function T(t){return f({when:function(){return t},get:function(e){return t[e]},set:function(e,i){t[e]=i},delete:function(e){delete t[e]},post:function(e,i){return null===e||void 0===e?t.apply(void 0,i):t[e].apply(t,i)},apply:function(e,i){return t.apply(e,i)},keys:function(){return J(t)}},void 0,function(){return{state:"fulfilled",value:t}})}function x(t){var e=h();return u.nextTick(function(){try{t.then(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}}),e.promise}function S(t){return f({isDef:function(){}},function(e,i){return F(t,e,i)},function(){return u(t).inspect()})}function P(t,e,i){return u(t).spread(e,i)}function G(t){return function(){function e(t,e){var s;if("undefined"==typeof StopIteration){try{s=n[t](e)}catch(t){return R(t)}return s.done?u(s.value):g(s.value,o,r)}try{s=n[t](e)}catch(t){return i(t)?u(t.value):R(t)}return g(s,o,r)}var n=t.apply(this,arguments),o=e.bind(e,"next"),r=e.bind(e,"throw");return o()}}function A(t){u.done(u.async(t)())}function M(t){throw new U(t)}function O(t){return function(){return P([this,E(arguments)],function(e,i){return t.apply(e,i)})}}function F(t,e,i){return u(t).dispatch(e,i)}function E(t){return g(t,function(t){var e=0,i=h();return q(t,function(n,o,r){var s;v(o)&&"fulfilled"===(s=o.inspect()).state?t[r]=s.value:(++e,g(o,function(n){t[r]=n,0===--e&&i.resolve(t)},i.reject,function(t){i.notify({index:r,value:t})}))},void 0),0===e&&i.resolve(t),i.promise})}function V(t){return g(t,function(t){return t=Q(t,u),g(E(Q(t,function(t){return g(t,z,z)})),function(){return t})})}function B(t){return u(t).allSettled()}function $(t,e){return u(t).then(void 0,void 0,e)}function I(t,e){return u(t).nodeify(e)}var j=!1;try{throw new Error}catch(t){j=!!t.stack}var N,U,L=l(),z=function(){},W=function(){function t(){for(;e.next;){e=e.next;var i=e.task;e.task=void 0;var o=e.domain;o&&(e.domain=void 0,o.enter());try{i()}catch(e){if(r)throw o&&o.exit(),setTimeout(t,0),o&&o.enter(),e;setTimeout(function(){throw e},0)}o&&o.exit()}n=!1}var e={task:void 0,next:null},i=e,n=!1,o=void 0,r=!1;if(W=function(t){i=i.next={task:t,domain:r&&process.domain,next:null},n||(n=!0,o())},"undefined"!=typeof process&&process.nextTick)r=!0,o=function(){process.nextTick(t)};else if("function"==typeof setImmediate)o="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var s=new MessageChannel;s.port1.onmessage=function(){o=a,s.port1.onmessage=t,t()};var a=function(){s.port2.postMessage(0)};o=function(){setTimeout(t,0),a()}}else o=function(){setTimeout(t,0)};return W}(),H=Function.call,Y=t(Array.prototype.slice),q=t(Array.prototype.reduce||function(t,e){var i=0,n=this.length;if(1===arguments.length)for(;;){if(i in this){e=this[i++];break}if(++i>=n)throw new TypeError}for(;i<n;i++)i in this&&(e=t(e,this[i],i));return e}),Z=t(Array.prototype.indexOf||function(t){for(var e=0;e<this.length;e++)if(this[e]===t)return e;return-1}),Q=t(Array.prototype.map||function(t,e){var i=this,n=[];return q(i,function(o,r,s){n.push(t.call(e,r,s,i))},void 0),n}),X=Object.create||function(t){function e(){}return e.prototype=t,new e},K=t(Object.prototype.hasOwnProperty),J=Object.keys||function(t){var e=[];for(var i in t)K(t,i)&&e.push(i);return e},tt=t(Object.prototype.toString);U="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var et="From previous event:";u.resolve=u,u.nextTick=W,u.longStackSupport=!1,"object"==typeof process&&process&&process.env&&process.env.Q_DEBUG&&(u.longStackSupport=!0),u.defer=h,h.prototype.makeNodeResolver=function(){var t=this;return function(e,i){e?t.reject(e):arguments.length>2?t.resolve(Y(arguments,1)):t.resolve(i)}},u.Promise=d,u.promise=d,d.race=p,d.all=E,d.reject=R,d.resolve=u,u.passByCopy=function(t){return t},f.prototype.passByCopy=function(){return this},u.join=function(t,e){return u(t).join(e)},f.prototype.join=function(t){return u([this,t]).spread(function(t,e){if(t===e)return t;throw new Error("Can't join: not the same: "+t+" "+e)})},u.race=p,f.prototype.race=function(){return this.then(u.race)},u.makePromise=f,f.prototype.toString=function(){return"[object Promise]"},f.prototype.then=function(t,e,i){function o(e){try{return"function"==typeof t?t(e):e}catch(t){return R(t)}}function r(t){if("function"==typeof e){n(t,a);try{return e(t)}catch(t){return R(t)}}return R(t)}function s(t){return"function"==typeof i?i(t):t}var a=this,l=h(),c=!1;return u.nextTick(function(){a.promiseDispatch(function(t){c||(c=!0,l.resolve(o(t)))},"when",[function(t){c||(c=!0,l.resolve(r(t)))}])}),a.promiseDispatch(void 0,"when",[void 0,function(t){var e,i=!1;try{e=s(t)}catch(t){if(i=!0,!u.onerror)throw t;u.onerror(t)}i||l.notify(e)}]),l.promise},u.tap=function(t,e){return u(t).tap(e)},f.prototype.tap=function(t){return t=u(t),this.then(function(e){return t.fcall(e).thenResolve(e)})},u.when=g,f.prototype.thenResolve=function(t){return this.then(function(){return t})},u.thenResolve=function(t,e){return u(t).thenResolve(e)},f.prototype.thenReject=function(t){return this.then(function(){throw t})},u.thenReject=function(t,e){return u(t).thenReject(e)},u.nearer=m,u.isPromise=v,u.isPromiseAlike=y,u.isPending=_,f.prototype.isPending=function(){return"pending"===this.inspect().state},u.isFulfilled=w,f.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},u.isRejected=b,f.prototype.isRejected=function(){return"rejected"===this.inspect().state};var it=[],nt=[],ot=!0;u.resetUnhandledRejections=k,u.getUnhandledReasons=function(){return it.slice()},u.stopUnhandledRejectionTracking=function(){k(),ot=!1},k(),u.reject=R,u.fulfill=T,u.master=S,u.spread=P,f.prototype.spread=function(t,e){return this.all().then(function(e){return t.apply(void 0,e)},e)},u.async=G,u.spawn=A,u.return=M,u.promised=O,u.dispatch=F,f.prototype.dispatch=function(t,e){var i=this,n=h();return u.nextTick(function(){i.promiseDispatch(n.resolve,t,e)}),n.promise},u.get=function(t,e){return u(t).dispatch("get",[e])},f.prototype.get=function(t){return this.dispatch("get",[t])},u.set=function(t,e,i){return u(t).dispatch("set",[e,i])},f.prototype.set=function(t,e){return this.dispatch("set",[t,e])},u.del=u.delete=function(t,e){return u(t).dispatch("delete",[e])},f.prototype.del=f.prototype.delete=function(t){return this.dispatch("delete",[t])},u.mapply=u.post=function(t,e,i){return u(t).dispatch("post",[e,i])},f.prototype.mapply=f.prototype.post=function(t,e){return this.dispatch("post",[t,e])},u.send=u.mcall=u.invoke=function(t,e){return u(t).dispatch("post",[e,Y(arguments,2)])},f.prototype.send=f.prototype.mcall=f.prototype.invoke=function(t){return this.dispatch("post",[t,Y(arguments,1)])},u.fapply=function(t,e){return u(t).dispatch("apply",[void 0,e])},f.prototype.fapply=function(t){return this.dispatch("apply",[void 0,t])},u.try=u.fcall=function(t){return u(t).dispatch("apply",[void 0,Y(arguments,1)])},f.prototype.fcall=function(){return this.dispatch("apply",[void 0,Y(arguments)])},u.fbind=function(t){var e=u(t),i=Y(arguments,1);return function(){return e.dispatch("apply",[this,i.concat(Y(arguments))])}},f.prototype.fbind=function(){var t=this,e=Y(arguments);return function(){return t.dispatch("apply",[this,e.concat(Y(arguments))])}},u.keys=function(t){return u(t).dispatch("keys",[])},f.prototype.keys=function(){return this.dispatch("keys",[])},u.all=E,f.prototype.all=function(){return E(this)},u.allResolved=c(V,"allResolved","allSettled"),f.prototype.allResolved=function(){return V(this)},u.allSettled=B,f.prototype.allSettled=function(){return this.then(function(t){return E(Q(t,function(t){function e(){return t.inspect()}return t=u(t),t.then(e,e)}))})},u.fail=u.catch=function(t,e){return u(t).then(void 0,e)},f.prototype.fail=f.prototype.catch=function(t){return this.then(void 0,t)},u.progress=$,f.prototype.progress=function(t){return this.then(void 0,void 0,t)},u.fin=u.finally=function(t,e){return u(t).finally(e)},f.prototype.fin=f.prototype.finally=function(t){return t=u(t),this.then(function(e){return t.fcall().then(function(){return e})},function(e){return t.fcall().then(function(){throw e})})},u.done=function(t,e,i,n){return u(t).done(e,i,n)},f.prototype.done=function(t,e,i){var o=function(t){u.nextTick(function(){if(n(t,r),!u.onerror)throw t;u.onerror(t)})},r=t||e||i?this.then(t,e,i):this;"object"==typeof process&&process&&process.domain&&(o=process.domain.bind(o)),r.then(void 0,o)},u.timeout=function(t,e,i){return u(t).timeout(e,i)},f.prototype.timeout=function(t,e){var i=h(),n=setTimeout(function(){e&&"string"!=typeof e||(e=new Error(e||"Timed out after "+t+" ms"),e.code="ETIMEDOUT"),i.reject(e)},t);return this.then(function(t){clearTimeout(n),i.resolve(t)},function(t){clearTimeout(n),i.reject(t)},i.notify),i.promise},u.delay=function(t,e){return void 0===e&&(e=t,t=void 0),u(t).delay(e)},f.prototype.delay=function(t){return this.then(function(e){var i=h();return setTimeout(function(){i.resolve(e)},t),i.promise})},u.nfapply=function(t,e){return u(t).nfapply(e)},f.prototype.nfapply=function(t){var e=h(),i=Y(t);return i.push(e.makeNodeResolver()),this.fapply(i).fail(e.reject),e.promise},u.nfcall=function(t){var e=Y(arguments,1);return u(t).nfapply(e)},f.prototype.nfcall=function(){var t=Y(arguments),e=h();return t.push(e.makeNodeResolver()),this.fapply(t).fail(e.reject),e.promise},u.nfbind=u.denodeify=function(t){var e=Y(arguments,1);return function(){var i=e.concat(Y(arguments)),n=h();return i.push(n.makeNodeResolver()),u(t).fapply(i).fail(n.reject),n.promise}},f.prototype.nfbind=f.prototype.denodeify=function(){var t=Y(arguments);return t.unshift(this),u.denodeify.apply(void 0,t)},u.nbind=function(t,e){var i=Y(arguments,2);return function(){function n(){return t.apply(e,arguments)}var o=i.concat(Y(arguments)),r=h();return o.push(r.makeNodeResolver()),u(n).fapply(o).fail(r.reject),r.promise}},f.prototype.nbind=function(){var t=Y(arguments,0);return t.unshift(this),u.nbind.apply(void 0,t)},u.nmapply=u.npost=function(t,e,i){return u(t).npost(e,i)},f.prototype.nmapply=f.prototype.npost=function(t,e){var i=Y(e||[]),n=h();return i.push(n.makeNodeResolver()),this.dispatch("post",[t,i]).fail(n.reject),n.promise},u.nsend=u.nmcall=u.ninvoke=function(t,e){var i=Y(arguments,2),n=h();return i.push(n.makeNodeResolver()),u(t).dispatch("post",[e,i]).fail(n.reject),n.promise},f.prototype.nsend=f.prototype.nmcall=f.prototype.ninvoke=function(t){var e=Y(arguments,1),i=h();return e.push(i.makeNodeResolver()),this.dispatch("post",[t,e]).fail(i.reject),i.promise},u.nodeify=I,f.prototype.nodeify=function(t){return t?void this.then(function(e){u.nextTick(function(){t(null,e)})},function(e){u.nextTick(function(){t(e)})}):this};var rt=l();return u}),function(t,e){function i(t){var e=t.length,i=lt.type(t);return!lt.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===i||"function"!==i&&(0===e||"number"==typeof e&&e>0&&e-1 in t)))}function n(t){var e=Dt[t]={};return lt.each(t.match(ut)||[],function(t,i){e[i]=!0}),e}function o(t,i,n,o){if(lt.acceptData(t)){var r,s,a=lt.expando,l="string"==typeof i,c=t.nodeType,u=c?lt.cache:t,h=c?t[a]:t[a]&&a;if(h&&u[h]&&(o||u[h].data)||!l||n!==e)return h||(c?t[a]=h=J.pop()||lt.guid++:h=a),u[h]||(u[h]={},c||(u[h].toJSON=lt.noop)),("object"==typeof i||"function"==typeof i)&&(o?u[h]=lt.extend(u[h],i):u[h].data=lt.extend(u[h].data,i)),r=u[h],o||(r.data||(r.data={}),r=r.data),n!==e&&(r[lt.camelCase(i)]=n),l?(s=r[i],null==s&&(s=r[lt.camelCase(i)])):s=r,s}}function r(t,e,i){if(lt.acceptData(t)){var n,o,r,s=t.nodeType,l=s?lt.cache:t,c=s?t[lt.expando]:lt.expando;if(l[c]){if(e&&(r=i?l[c]:l[c].data)){lt.isArray(e)?e=e.concat(lt.map(e,lt.camelCase)):e in r?e=[e]:(e=lt.camelCase(e),e=e in r?[e]:e.split(" "));for(n=0,o=e.length;o>n;n++)delete r[e[n]];if(!(i?a:lt.isEmptyObject)(r))return}(i||(delete l[c].data,a(l[c])))&&(s?lt.cleanData([t],!0):lt.support.deleteExpando||l!=l.window?delete l[c]:l[c]=null)}}}function s(t,i,n){if(n===e&&1===t.nodeType){var o="data-"+i.replace(Rt,"-$1").toLowerCase();if(n=t.getAttribute(o),"string"==typeof n){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:Ct.test(n)?lt.parseJSON(n):n)}catch(t){}lt.data(t,i,n)}else n=e}return n}function a(t){var e;for(e in t)if(("data"!==e||!lt.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function l(){return!0}function c(){return!1}function u(t,e){do t=t[e];while(t&&1!==t.nodeType);return t}function h(t,e,i){if(e=e||0,lt.isFunction(e))return lt.grep(t,function(t,n){var o=!!e.call(t,n,t);return o===i});if(e.nodeType)return lt.grep(t,function(t){return t===e===i});if("string"==typeof e){var n=lt.grep(t,function(t){return 1===t.nodeType});if(Lt.test(e))return lt.filter(e,n,!i);e=lt.filter(e,n)}return lt.grep(t,function(t){return lt.inArray(t,e)>=0===i})}function d(t){var e=Ht.split("|"),i=t.createDocumentFragment();if(i.createElement)for(;e.length;)i.createElement(e.pop());return i}function p(t,e){return t.getElementsByTagName(e)[0]||t.appendChild(t.ownerDocument.createElement(e))}function f(t){var e=t.getAttributeNode("type");return t.type=(e&&e.specified)+"/"+t.type,t}function g(t){var e=oe.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function m(t,e){for(var i,n=0;null!=(i=t[n]);n++)lt._data(i,"globalEval",!e||lt._data(e[n],"globalEval"))}function v(t,e){if(1===e.nodeType&&lt.hasData(t)){var i,n,o,r=lt._data(t),s=lt._data(e,r),a=r.events;if(a){delete s.handle,s.events={};for(i in a)for(n=0,o=a[i].length;o>n;n++)lt.event.add(e,i,a[i][n])}s.data&&(s.data=lt.extend({},s.data))}}function y(t,e){var i,n,o;if(1===e.nodeType){if(i=e.nodeName.toLowerCase(),!lt.support.noCloneEvent&&e[lt.expando]){o=lt._data(e);for(n in o.events)lt.removeEvent(e,n,o.handle);e.removeAttribute(lt.expando)}"script"===i&&e.text!==t.text?(f(e).text=t.text,g(e)):"object"===i?(e.parentNode&&(e.outerHTML=t.outerHTML),lt.support.html5Clone&&t.innerHTML&&!lt.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===i&&ee.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===i?e.defaultSelected=e.selected=t.defaultSelected:("input"===i||"textarea"===i)&&(e.defaultValue=t.defaultValue)}}function _(t,i){var n,o,r=0,s=typeof t.getElementsByTagName!==Y?t.getElementsByTagName(i||"*"):typeof t.querySelectorAll!==Y?t.querySelectorAll(i||"*"):e;if(!s)for(s=[],n=t.childNodes||t;null!=(o=n[r]);r++)!i||lt.nodeName(o,i)?s.push(o):lt.merge(s,_(o,i));return i===e||i&&lt.nodeName(t,i)?lt.merge([t],s):s}function w(t){ee.test(t.type)&&(t.defaultChecked=t.checked)}function b(t,e){if(e in t)return e;for(var i=e.charAt(0).toUpperCase()+e.slice(1),n=e,o=Ce.length;o--;)if(e=Ce[o]+i,e in t)return e;return n}function k(t,e){return t=e||t,"none"===lt.css(t,"display")||!lt.contains(t.ownerDocument,t)}function D(t,e){for(var i,n,o,r=[],s=0,a=t.length;a>s;s++)n=t[s],n.style&&(r[s]=lt._data(n,"olddisplay"),i=n.style.display,e?(r[s]||"none"!==i||(n.style.display=""),""===n.style.display&&k(n)&&(r[s]=lt._data(n,"olddisplay",x(n.nodeName)))):r[s]||(o=k(n),(i&&"none"!==i||!o)&&lt._data(n,"olddisplay",o?i:lt.css(n,"display"))));for(s=0;a>s;s++)n=t[s],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?r[s]||"":"none"));return t}function C(t,e,i){var n=ve.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function R(t,e,i,n,o){for(var r=i===(n?"border":"content")?4:"width"===e?1:0,s=0;4>r;r+=2)"margin"===i&&(s+=lt.css(t,i+De[r],!0,o)),n?("content"===i&&(s-=lt.css(t,"padding"+De[r],!0,o)),"margin"!==i&&(s-=lt.css(t,"border"+De[r]+"Width",!0,o))):(s+=lt.css(t,"padding"+De[r],!0,o),"padding"!==i&&(s+=lt.css(t,"border"+De[r]+"Width",!0,o)));return s}function T(t,e,i){var n=!0,o="width"===e?t.offsetWidth:t.offsetHeight,r=ue(t),s=lt.support.boxSizing&&"border-box"===lt.css(t,"boxSizing",!1,r);if(0>=o||null==o){if(o=he(t,e,r),(0>o||null==o)&&(o=t.style[e]),ye.test(o))return o;n=s&&(lt.support.boxSizingReliable||o===t.style[e]),o=parseFloat(o)||0}return o+R(t,e,i||(s?"border":"content"),n,r)+"px"}function x(t){var e=q,i=we[t];return i||(i=S(t,e),"none"!==i&&i||(ce=(ce||lt("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(e.documentElement),e=(ce[0].contentWindow||ce[0].contentDocument).document,e.write("<!doctype html><html><body>"),e.close(),i=S(t,e),ce.detach()),we[t]=i),i}function S(t,e){var i=lt(e.createElement(t)).appendTo(e.body),n=lt.css(i[0],"display");return i.remove(),n}function P(t,e,i,n){var o;if(lt.isArray(e))lt.each(e,function(e,o){i||Te.test(t)?n(t,o):P(t+"["+("object"==typeof o?e:"")+"]",o,i,n)});else if(i||"object"!==lt.type(e))n(t,e);else for(o in e)P(t+"["+o+"]",e[o],i,n)}function G(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,o=0,r=e.toLowerCase().match(ut)||[];if(lt.isFunction(i))for(;n=r[o++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function A(t,i,n,o){function r(l){var c;return s[l]=!0,lt.each(t[l]||[],function(t,l){var u=l(i,n,o);return"string"!=typeof u||a||s[u]?a?!(c=u):e:(i.dataTypes.unshift(u),r(u),!1)}),c}var s={},a=t===Le;return r(i.dataTypes[0])||!s["*"]&&r("*")}function M(t,i){var n,o,r=lt.ajaxSettings.flatOptions||{};for(o in i)i[o]!==e&&((r[o]?t:n||(n={}))[o]=i[o]);return n&&lt.extend(!0,t,n),t}function O(t,i,n){var o,r,s,a,l=t.contents,c=t.dataTypes,u=t.responseFields;for(a in u)a in n&&(i[u[a]]=n[a]);for(;"*"===c[0];)c.shift(),r===e&&(r=t.mimeType||i.getResponseHeader("Content-Type"));if(r)for(a in l)if(l[a]&&l[a].test(r)){c.unshift(a);break}if(c[0]in n)s=c[0];else{for(a in n){if(!c[0]||t.converters[a+" "+c[0]]){s=a;break}o||(o=a)}s=s||o}return s?(s!==c[0]&&c.unshift(s),n[s]):e}function F(t,e){var i,n,o,r,s={},a=0,l=t.dataTypes.slice(),c=l[0];if(t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l[1])for(o in t.converters)s[o.toLowerCase()]=t.converters[o];for(;n=l[++a];)if("*"!==n){if("*"!==c&&c!==n){if(o=s[c+" "+n]||s["* "+n],!o)for(i in s)if(r=i.split(" "),r[1]===n&&(o=s[c+" "+r[0]]||s["* "+r[0]])){o===!0?o=s[i]:s[i]!==!0&&(n=r[0],l.splice(a--,0,n));break}if(o!==!0)if(o&&t.throws)e=o(e);else try{e=o(e)}catch(t){return{state:"parsererror",error:o?t:"No conversion from "+c+" to "+n}}}c=n}return{state:"success",data:e}}function E(){try{return new t.XMLHttpRequest}catch(t){}}function V(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function B(){return setTimeout(function(){Xe=e}),Xe=lt.now()}function $(t,e){lt.each(e,function(e,i){for(var n=(ni[e]||[]).concat(ni["*"]),o=0,r=n.length;r>o;o++)if(n[o].call(t,e,i))return})}function I(t,e,i){var n,o,r=0,s=ii.length,a=lt.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var e=Xe||B(),i=Math.max(0,c.startTime+c.duration-e),n=i/c.duration||0,r=1-n,s=0,l=c.tweens.length;l>s;s++)c.tweens[s].run(r);return a.notifyWith(t,[c,r,i]),1>r&&l?i:(a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:lt.extend({},e),opts:lt.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:Xe||B(),duration:i.duration,tweens:[],createTween:function(e,i){var n=lt.Tween(t,c.opts,e,i,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var i=0,n=e?c.tweens.length:0;if(o)return this;for(o=!0;n>i;i++)c.tweens[i].run(1);return e?a.resolveWith(t,[c,e]):a.rejectWith(t,[c,e]),this}}),u=c.props;for(j(u,c.opts.specialEasing);s>r;r++)if(n=ii[r].call(c,t,u,c.opts))return n;return $(c,u),lt.isFunction(c.opts.start)&&c.opts.start.call(t,c),lt.fx.timer(lt.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function j(t,e){var i,n,o,r,s;for(o in t)if(n=lt.camelCase(o),r=e[n],i=t[o],lt.isArray(i)&&(r=i[1],i=t[o]=i[0]),o!==n&&(t[n]=i,delete t[o]),s=lt.cssHooks[n],s&&"expand"in s){i=s.expand(i),delete t[n];for(o in i)o in t||(t[o]=i[o],e[o]=r)}else e[n]=r}function N(t,e,i){var n,o,r,s,a,l,c,u,h,d=this,p=t.style,f={},g=[],m=t.nodeType&&k(t);i.queue||(u=lt._queueHooks(t,"fx"),null==u.unqueued&&(u.unqueued=0,h=u.empty.fire,u.empty.fire=function(){u.unqueued||h()}),u.unqueued++,d.always(function(){d.always(function(){u.unqueued--,lt.queue(t,"fx").length||u.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===lt.css(t,"display")&&"none"===lt.css(t,"float")&&(lt.support.inlineBlockNeedsLayout&&"inline"!==x(t.nodeName)?p.zoom=1:p.display="inline-block")),i.overflow&&(p.overflow="hidden",lt.support.shrinkWrapBlocks||d.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(o in e)if(s=e[o],Je.exec(s)){if(delete e[o],l=l||"toggle"===s,s===(m?"hide":"show"))continue;g.push(o)}if(r=g.length){a=lt._data(t,"fxshow")||lt._data(t,"fxshow",{}),"hidden"in a&&(m=a.hidden),l&&(a.hidden=!m),m?lt(t).show():d.done(function(){lt(t).hide()}),d.done(function(){var e;lt._removeData(t,"fxshow");for(e in f)lt.style(t,e,f[e])});for(o=0;r>o;o++)n=g[o],c=d.createTween(n,m?a[n]:0),f[n]=a[n]||lt.style(t,n),n in a||(a[n]=c.start,m&&(c.end=c.start,c.start="width"===n||"height"===n?1:0))}}function U(t,e,i,n,o){return new U.prototype.init(t,e,i,n,o)}function L(t,e){var i,n={height:t},o=0;for(e=e?1:0;4>o;o+=2-e)i=De[o],n["margin"+i]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function z(t){return lt.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}var W,H,Y=typeof e,q=t.document,Z=t.location,Q=t.jQuery,X=t.$,K={},J=[],tt="1.9.1",et=J.concat,it=J.push,nt=J.slice,ot=J.indexOf,rt=K.toString,st=K.hasOwnProperty,at=tt.trim,lt=function(t,e){return new lt.fn.init(t,e,H)},ct=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ut=/\S+/g,ht=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,dt=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,pt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ft=/^[\],:{}\s]*$/,gt=/(?:^|:|,)(?:\s*\[)+/g,mt=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,vt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,yt=/^-ms-/,_t=/-([\da-z])/gi,wt=function(t,e){return e.toUpperCase()},bt=function(t){(q.addEventListener||"load"===t.type||"complete"===q.readyState)&&(kt(),lt.ready())},kt=function(){q.addEventListener?(q.removeEventListener("DOMContentLoaded",bt,!1),t.removeEventListener("load",bt,!1)):(q.detachEvent("onreadystatechange",bt),t.detachEvent("onload",bt))};lt.fn=lt.prototype={jquery:tt,constructor:lt,init:function(t,i,n){var o,r;if(!t)return this;if("string"==typeof t){if(o="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:dt.exec(t),!o||!o[1]&&i)return!i||i.jquery?(i||n).find(t):this.constructor(i).find(t);if(o[1]){if(i=i instanceof lt?i[0]:i,lt.merge(this,lt.parseHTML(o[1],i&&i.nodeType?i.ownerDocument||i:q,!0)),pt.test(o[1])&&lt.isPlainObject(i))for(o in i)lt.isFunction(this[o])?this[o](i[o]):this.attr(o,i[o]);return this}if(r=q.getElementById(o[2]),r&&r.parentNode){if(r.id!==o[2])return n.find(t);this.length=1,this[0]=r}return this.context=q,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):lt.isFunction(t)?n.ready(t):(t.selector!==e&&(this.selector=t.selector,this.context=t.context),lt.makeArray(t,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return nt.call(this)},get:function(t){return null==t?this.toArray():0>t?this[this.length+t]:this[t]},pushStack:function(t){var e=lt.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return lt.each(this,t,e)},ready:function(t){return lt.ready.promise().done(t),this},slice:function(){return this.pushStack(nt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},map:function(t){return this.pushStack(lt.map(this,function(e,i){return t.call(e,i,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:it,sort:[].sort,splice:[].splice},lt.fn.init.prototype=lt.fn,lt.extend=lt.fn.extend=function(){var t,i,n,o,r,s,a=arguments[0]||{},l=1,c=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[1]||{},l=2),"object"==typeof a||lt.isFunction(a)||(a={}),c===l&&(a=this,--l);c>l;l++)if(null!=(r=arguments[l]))for(o in r)t=a[o],n=r[o],a!==n&&(u&&n&&(lt.isPlainObject(n)||(i=lt.isArray(n)))?(i?(i=!1,s=t&&lt.isArray(t)?t:[]):s=t&&lt.isPlainObject(t)?t:{},a[o]=lt.extend(u,s,n)):n!==e&&(a[o]=n));return a},lt.extend({noConflict:function(e){return t.$===lt&&(t.$=X),e&&t.jQuery===lt&&(t.jQuery=Q),lt},isReady:!1,readyWait:1,holdReady:function(t){t?lt.readyWait++:lt.ready(!0)},ready:function(t){if(t===!0?!--lt.readyWait:!lt.isReady){if(!q.body)return setTimeout(lt.ready);lt.isReady=!0,t!==!0&&--lt.readyWait>0||(W.resolveWith(q,[lt]),lt.fn.trigger&&lt(q).trigger("ready").off("ready"))}},isFunction:function(t){return"function"===lt.type(t)},isArray:Array.isArray||function(t){return"array"===lt.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?K[rt.call(t)]||"object":typeof t},isPlainObject:function(t){if(!t||"object"!==lt.type(t)||t.nodeType||lt.isWindow(t))return!1;try{if(t.constructor&&!st.call(t,"constructor")&&!st.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var i;for(i in t);return i===e||st.call(t,i)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},error:function(t){throw Error(t)},parseHTML:function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||q;var n=pt.exec(t),o=!i&&[];return n?[e.createElement(n[1])]:(n=lt.buildFragment([t],e,o),o&&lt(o).remove(),lt.merge([],n.childNodes))},parseJSON:function(i){return t.JSON&&t.JSON.parse?t.JSON.parse(i):null===i?i:"string"==typeof i&&(i=lt.trim(i),i&&ft.test(i.replace(mt,"@").replace(vt,"]").replace(gt,"")))?Function("return "+i)():(lt.error("Invalid JSON: "+i),e)},parseXML:function(i){var n,o;if(!i||"string"!=typeof i)return null;try{t.DOMParser?(o=new DOMParser,n=o.parseFromString(i,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(i))}catch(t){n=e}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||lt.error("Invalid XML: "+i),n},noop:function(){},globalEval:function(e){e&&lt.trim(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(yt,"ms-").replace(_t,wt)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},
each:function(t,e,n){var o,r=0,s=t.length,a=i(t);if(n){if(a)for(;s>r&&(o=e.apply(t[r],n),o!==!1);r++);else for(r in t)if(o=e.apply(t[r],n),o===!1)break}else if(a)for(;s>r&&(o=e.call(t[r],r,t[r]),o!==!1);r++);else for(r in t)if(o=e.call(t[r],r,t[r]),o===!1)break;return t},trim:at&&!at.call("\ufeff")?function(t){return null==t?"":at.call(t)}:function(t){return null==t?"":(t+"").replace(ht,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(i(Object(t))?lt.merge(n,"string"==typeof t?[t]:t):it.call(n,t)),n},inArray:function(t,e,i){var n;if(e){if(ot)return ot.call(e,t,i);for(n=e.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in e&&e[i]===t)return i}return-1},merge:function(t,i){var n=i.length,o=t.length,r=0;if("number"==typeof n)for(;n>r;r++)t[o++]=i[r];else for(;i[r]!==e;)t[o++]=i[r++];return t.length=o,t},grep:function(t,e,i){var n,o=[],r=0,s=t.length;for(i=!!i;s>r;r++)n=!!e(t[r],r),i!==n&&o.push(t[r]);return o},map:function(t,e,n){var o,r=0,s=t.length,a=i(t),l=[];if(a)for(;s>r;r++)o=e(t[r],r,n),null!=o&&(l[l.length]=o);else for(r in t)o=e(t[r],r,n),null!=o&&(l[l.length]=o);return et.apply([],l)},guid:1,proxy:function(t,i){var n,o,r;return"string"==typeof i&&(r=t[i],i=t,t=r),lt.isFunction(t)?(n=nt.call(arguments,2),o=function(){return t.apply(i||this,n.concat(nt.call(arguments)))},o.guid=t.guid=t.guid||lt.guid++,o):e},access:function(t,i,n,o,r,s,a){var l=0,c=t.length,u=null==n;if("object"===lt.type(n)){r=!0;for(l in n)lt.access(t,i,l,n[l],!0,s,a)}else if(o!==e&&(r=!0,lt.isFunction(o)||(a=!0),u&&(a?(i.call(t,o),i=null):(u=i,i=function(t,e,i){return u.call(lt(t),i)})),i))for(;c>l;l++)i(t[l],n,a?o:o.call(t[l],l,i(t[l],n)));return r?t:u?i.call(t):c?i(t[0],n):s},now:function(){return(new Date).getTime()}}),lt.ready.promise=function(e){if(!W)if(W=lt.Deferred(),"complete"===q.readyState)setTimeout(lt.ready);else if(q.addEventListener)q.addEventListener("DOMContentLoaded",bt,!1),t.addEventListener("load",bt,!1);else{q.attachEvent("onreadystatechange",bt),t.attachEvent("onload",bt);var i=!1;try{i=null==t.frameElement&&q.documentElement}catch(t){}i&&i.doScroll&&function t(){if(!lt.isReady){try{i.doScroll("left")}catch(e){return setTimeout(t,50)}kt(),lt.ready()}}()}return W.promise(e)},lt.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){K["[object "+e+"]"]=e.toLowerCase()}),H=lt(q);var Dt={};lt.Callbacks=function(t){t="string"==typeof t?Dt[t]||n(t):lt.extend({},t);var i,o,r,s,a,l,c=[],u=!t.once&&[],h=function(e){for(o=t.memory&&e,r=!0,a=l||0,l=0,s=c.length,i=!0;c&&s>a;a++)if(c[a].apply(e[0],e[1])===!1&&t.stopOnFalse){o=!1;break}i=!1,c&&(u?u.length&&h(u.shift()):o?c=[]:d.disable())},d={add:function(){if(c){var e=c.length;!function e(i){lt.each(i,function(i,n){var o=lt.type(n);"function"===o?t.unique&&d.has(n)||c.push(n):n&&n.length&&"string"!==o&&e(n)})}(arguments),i?s=c.length:o&&(l=e,h(o))}return this},remove:function(){return c&&lt.each(arguments,function(t,e){for(var n;(n=lt.inArray(e,c,n))>-1;)c.splice(n,1),i&&(s>=n&&s--,a>=n&&a--)}),this},has:function(t){return t?lt.inArray(t,c)>-1:!(!c||!c.length)},empty:function(){return c=[],this},disable:function(){return c=u=o=e,this},disabled:function(){return!c},lock:function(){return u=e,o||d.disable(),this},locked:function(){return!u},fireWith:function(t,e){return e=e||[],e=[t,e.slice?e.slice():e],!c||r&&!u||(i?u.push(e):h(e)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!r}};return d},lt.extend({Deferred:function(t){var e=[["resolve","done",lt.Callbacks("once memory"),"resolved"],["reject","fail",lt.Callbacks("once memory"),"rejected"],["notify","progress",lt.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var t=arguments;return lt.Deferred(function(i){lt.each(e,function(e,r){var s=r[0],a=lt.isFunction(t[e])&&t[e];o[r[1]](function(){var t=a&&a.apply(this,arguments);t&&lt.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[s+"With"](this===n?i.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?lt.extend(t,n):n}},o={};return n.pipe=n.then,lt.each(e,function(t,r){var s=r[2],a=r[3];n[r[1]]=s.add,a&&s.add(function(){i=a},e[1^t][2].disable,e[2][2].lock),o[r[0]]=function(){return o[r[0]+"With"](this===o?n:this,arguments),this},o[r[0]+"With"]=s.fireWith}),n.promise(o),t&&t.call(o,o),o},when:function(t){var e,i,n,o=0,r=nt.call(arguments),s=r.length,a=1!==s||t&&lt.isFunction(t.promise)?s:0,l=1===a?t:lt.Deferred(),c=function(t,i,n){return function(o){i[t]=this,n[t]=arguments.length>1?nt.call(arguments):o,n===e?l.notifyWith(i,n):--a||l.resolveWith(i,n)}};if(s>1)for(e=Array(s),i=Array(s),n=Array(s);s>o;o++)r[o]&&lt.isFunction(r[o].promise)?r[o].promise().done(c(o,n,r)).fail(l.reject).progress(c(o,i,e)):--a;return a||l.resolveWith(n,r),l.promise()}}),lt.support=function(){var e,i,n,o,r,s,a,l,c,u,h=q.createElement("div");if(h.setAttribute("className","t"),h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=h.getElementsByTagName("*"),n=h.getElementsByTagName("a")[0],!i||!n||!i.length)return{};r=q.createElement("select"),a=r.appendChild(q.createElement("option")),o=h.getElementsByTagName("input")[0],n.style.cssText="top:1px;float:left;opacity:.5",e={getSetAttribute:"t"!==h.className,leadingWhitespace:3===h.firstChild.nodeType,tbody:!h.getElementsByTagName("tbody").length,htmlSerialize:!!h.getElementsByTagName("link").length,style:/top/.test(n.getAttribute("style")),hrefNormalized:"/a"===n.getAttribute("href"),opacity:/^0.5/.test(n.style.opacity),cssFloat:!!n.style.cssFloat,checkOn:!!o.value,optSelected:a.selected,enctype:!!q.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==q.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===q.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},o.checked=!0,e.noCloneChecked=o.cloneNode(!0).checked,r.disabled=!0,e.optDisabled=!a.disabled;try{delete h.test}catch(t){e.deleteExpando=!1}o=q.createElement("input"),o.setAttribute("value",""),e.input=""===o.getAttribute("value"),o.value="t",o.setAttribute("type","radio"),e.radioValue="t"===o.value,o.setAttribute("checked","t"),o.setAttribute("name","t"),s=q.createDocumentFragment(),s.appendChild(o),e.appendChecked=o.checked,e.checkClone=s.cloneNode(!0).cloneNode(!0).lastChild.checked,h.attachEvent&&(h.attachEvent("onclick",function(){e.noCloneEvent=!1}),h.cloneNode(!0).click());for(u in{submit:!0,change:!0,focusin:!0})h.setAttribute(l="on"+u,"t"),e[u+"Bubbles"]=l in t||h.attributes[l].expando===!1;return h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",e.clearCloneStyle="content-box"===h.style.backgroundClip,lt(function(){var i,n,o,r="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",s=q.getElementsByTagName("body")[0];s&&(i=q.createElement("div"),i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",s.appendChild(i).appendChild(h),h.innerHTML="<table><tr><td></td><td>t</td></tr></table>",o=h.getElementsByTagName("td"),o[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===o[0].offsetHeight,o[0].style.display="",o[1].style.display="none",e.reliableHiddenOffsets=c&&0===o[0].offsetHeight,h.innerHTML="",h.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",e.boxSizing=4===h.offsetWidth,e.doesNotIncludeMarginInBodyOffset=1!==s.offsetTop,t.getComputedStyle&&(e.pixelPosition="1%"!==(t.getComputedStyle(h,null)||{}).top,e.boxSizingReliable="4px"===(t.getComputedStyle(h,null)||{width:"4px"}).width,n=h.appendChild(q.createElement("div")),n.style.cssText=h.style.cssText=r,n.style.marginRight=n.style.width="0",h.style.width="1px",e.reliableMarginRight=!parseFloat((t.getComputedStyle(n,null)||{}).marginRight)),typeof h.style.zoom!==Y&&(h.innerHTML="",h.style.cssText=r+"width:1px;padding:1px;display:inline;zoom:1",e.inlineBlockNeedsLayout=3===h.offsetWidth,h.style.display="block",h.innerHTML="<div></div>",h.firstChild.style.width="5px",e.shrinkWrapBlocks=3!==h.offsetWidth,e.inlineBlockNeedsLayout&&(s.style.zoom=1)),s.removeChild(i),i=h=o=n=null)}),i=r=s=a=n=o=null,e}();var Ct=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Rt=/([A-Z])/g;lt.extend({cache:{},expando:"jQuery"+(tt+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(t){return t=t.nodeType?lt.cache[t[lt.expando]]:t[lt.expando],!!t&&!a(t)},data:function(t,e,i){return o(t,e,i)},removeData:function(t,e){return r(t,e)},_data:function(t,e,i){return o(t,e,i,!0)},_removeData:function(t,e){return r(t,e,!0)},acceptData:function(t){if(t.nodeType&&1!==t.nodeType&&9!==t.nodeType)return!1;var e=t.nodeName&&lt.noData[t.nodeName.toLowerCase()];return!e||e!==!0&&t.getAttribute("classid")===e}}),lt.fn.extend({data:function(t,i){var n,o,r=this[0],a=0,l=null;if(t===e){if(this.length&&(l=lt.data(r),1===r.nodeType&&!lt._data(r,"parsedAttrs"))){for(n=r.attributes;n.length>a;a++)o=n[a].name,o.indexOf("data-")||(o=lt.camelCase(o.slice(5)),s(r,o,l[o]));lt._data(r,"parsedAttrs",!0)}return l}return"object"==typeof t?this.each(function(){lt.data(this,t)}):lt.access(this,function(i){return i===e?r?s(r,t,lt.data(r,t)):null:(this.each(function(){lt.data(this,t,i)}),e)},null,i,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){lt.removeData(this,t)})}}),lt.extend({queue:function(t,i,n){var o;return t?(i=(i||"fx")+"queue",o=lt._data(t,i),n&&(!o||lt.isArray(n)?o=lt._data(t,i,lt.makeArray(n)):o.push(n)),o||[]):e},dequeue:function(t,e){e=e||"fx";var i=lt.queue(t,e),n=i.length,o=i.shift(),r=lt._queueHooks(t,e),s=function(){lt.dequeue(t,e)};"inprogress"===o&&(o=i.shift(),n--),r.cur=o,o&&("fx"===e&&i.unshift("inprogress"),delete r.stop,o.call(t,s,r)),!n&&r&&r.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return lt._data(t,i)||lt._data(t,i,{empty:lt.Callbacks("once memory").add(function(){lt._removeData(t,e+"queue"),lt._removeData(t,i)})})}}),lt.fn.extend({queue:function(t,i){var n=2;return"string"!=typeof t&&(i=t,t="fx",n--),n>arguments.length?lt.queue(this[0],t):i===e?this:this.each(function(){var e=lt.queue(this,t,i);lt._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&lt.dequeue(this,t)})},dequeue:function(t){return this.each(function(){lt.dequeue(this,t)})},delay:function(t,e){return t=lt.fx?lt.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,i){var n,o=1,r=lt.Deferred(),s=this,a=this.length,l=function(){--o||r.resolveWith(s,[s])};for("string"!=typeof t&&(i=t,t=e),t=t||"fx";a--;)n=lt._data(s[a],t+"queueHooks"),n&&n.empty&&(o++,n.empty.add(l));return l(),r.promise(i)}});var Tt,xt,St=/[\t\r\n]/g,Pt=/\r/g,Gt=/^(?:input|select|textarea|button|object)$/i,At=/^(?:a|area)$/i,Mt=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,Ot=/^(?:checked|selected)$/i,Ft=lt.support.getSetAttribute,Et=lt.support.input;lt.fn.extend({attr:function(t,e){return lt.access(this,lt.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){lt.removeAttr(this,t)})},prop:function(t,e){return lt.access(this,lt.prop,t,e,arguments.length>1)},removeProp:function(t){return t=lt.propFix[t]||t,this.each(function(){try{this[t]=e,delete this[t]}catch(t){}})},addClass:function(t){var e,i,n,o,r,s=0,a=this.length,l="string"==typeof t&&t;if(lt.isFunction(t))return this.each(function(e){lt(this).addClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(ut)||[];a>s;s++)if(i=this[s],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(St," "):" ")){for(r=0;o=e[r++];)0>n.indexOf(" "+o+" ")&&(n+=o+" ");i.className=lt.trim(n)}return this},removeClass:function(t){var e,i,n,o,r,s=0,a=this.length,l=0===arguments.length||"string"==typeof t&&t;if(lt.isFunction(t))return this.each(function(e){lt(this).removeClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(ut)||[];a>s;s++)if(i=this[s],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(St," "):"")){for(r=0;o=e[r++];)for(;n.indexOf(" "+o+" ")>=0;)n=n.replace(" "+o+" "," ");i.className=t?lt.trim(n):""}return this},toggleClass:function(t,e){var i=typeof t,n="boolean"==typeof e;return lt.isFunction(t)?this.each(function(i){lt(this).toggleClass(t.call(this,i,this.className,e),e)}):this.each(function(){if("string"===i)for(var o,r=0,s=lt(this),a=e,l=t.match(ut)||[];o=l[r++];)a=n?a:!s.hasClass(o),s[a?"addClass":"removeClass"](o);else(i===Y||"boolean"===i)&&(this.className&&lt._data(this,"__className__",this.className),this.className=this.className||t===!1?"":lt._data(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(St," ").indexOf(e)>=0)return!0;return!1},val:function(t){var i,n,o,r=this[0];return arguments.length?(o=lt.isFunction(t),this.each(function(i){var r,s=lt(this);1===this.nodeType&&(r=o?t.call(this,i,s.val()):t,null==r?r="":"number"==typeof r?r+="":lt.isArray(r)&&(r=lt.map(r,function(t){return null==t?"":t+""})),n=lt.valHooks[this.type]||lt.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,r,"value")!==e||(this.value=r))})):r?(n=lt.valHooks[r.type]||lt.valHooks[r.nodeName.toLowerCase()],n&&"get"in n&&(i=n.get(r,"value"))!==e?i:(i=r.value,"string"==typeof i?i.replace(Pt,""):null==i?"":i)):void 0}}),lt.extend({valHooks:{option:{get:function(t){var e=t.attributes.value;return!e||e.specified?t.value:t.text}},select:{get:function(t){for(var e,i,n=t.options,o=t.selectedIndex,r="select-one"===t.type||0>o,s=r?null:[],a=r?o+1:n.length,l=0>o?a:r?o:0;a>l;l++)if(i=n[l],!(!i.selected&&l!==o||(lt.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&lt.nodeName(i.parentNode,"optgroup"))){if(e=lt(i).val(),r)return e;s.push(e)}return s},set:function(t,e){var i=lt.makeArray(e);return lt(t).find("option").each(function(){this.selected=lt.inArray(lt(this).val(),i)>=0}),i.length||(t.selectedIndex=-1),i}}},attr:function(t,i,n){var o,r,s,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return typeof t.getAttribute===Y?lt.prop(t,i,n):(r=1!==a||!lt.isXMLDoc(t),r&&(i=i.toLowerCase(),o=lt.attrHooks[i]||(Mt.test(i)?xt:Tt)),n===e?o&&r&&"get"in o&&null!==(s=o.get(t,i))?s:(typeof t.getAttribute!==Y&&(s=t.getAttribute(i)),null==s?e:s):null!==n?o&&r&&"set"in o&&(s=o.set(t,n,i))!==e?s:(t.setAttribute(i,n+""),n):(lt.removeAttr(t,i),e))},removeAttr:function(t,e){var i,n,o=0,r=e&&e.match(ut);if(r&&1===t.nodeType)for(;i=r[o++];)n=lt.propFix[i]||i,Mt.test(i)?!Ft&&Ot.test(i)?t[lt.camelCase("default-"+i)]=t[n]=!1:t[n]=!1:lt.attr(t,i,""),t.removeAttribute(Ft?i:n)},attrHooks:{type:{set:function(t,e){if(!lt.support.radioValue&&"radio"===e&&lt.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(t,i,n){var o,r,s,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return s=1!==a||!lt.isXMLDoc(t),s&&(i=lt.propFix[i]||i,r=lt.propHooks[i]),n!==e?r&&"set"in r&&(o=r.set(t,n,i))!==e?o:t[i]=n:r&&"get"in r&&null!==(o=r.get(t,i))?o:t[i]},propHooks:{tabIndex:{get:function(t){var i=t.getAttributeNode("tabindex");return i&&i.specified?parseInt(i.value,10):Gt.test(t.nodeName)||At.test(t.nodeName)&&t.href?0:e}}}}),xt={get:function(t,i){var n=lt.prop(t,i),o="boolean"==typeof n&&t.getAttribute(i),r="boolean"==typeof n?Et&&Ft?null!=o:Ot.test(i)?t[lt.camelCase("default-"+i)]:!!o:t.getAttributeNode(i);return r&&r.value!==!1?i.toLowerCase():e},set:function(t,e,i){return e===!1?lt.removeAttr(t,i):Et&&Ft||!Ot.test(i)?t.setAttribute(!Ft&&lt.propFix[i]||i,i):t[lt.camelCase("default-"+i)]=t[i]=!0,i}},Et&&Ft||(lt.attrHooks.value={get:function(t,i){var n=t.getAttributeNode(i);return lt.nodeName(t,"input")?t.defaultValue:n&&n.specified?n.value:e},set:function(t,i,n){return lt.nodeName(t,"input")?(t.defaultValue=i,e):Tt&&Tt.set(t,i,n)}}),Ft||(Tt=lt.valHooks.button={get:function(t,i){var n=t.getAttributeNode(i);return n&&("id"===i||"name"===i||"coords"===i?""!==n.value:n.specified)?n.value:e},set:function(t,i,n){var o=t.getAttributeNode(n);return o||t.setAttributeNode(o=t.ownerDocument.createAttribute(n)),o.value=i+="","value"===n||i===t.getAttribute(n)?i:e}},lt.attrHooks.contenteditable={get:Tt.get,set:function(t,e,i){Tt.set(t,""!==e&&e,i)}},lt.each(["width","height"],function(t,i){lt.attrHooks[i]=lt.extend(lt.attrHooks[i],{set:function(t,n){return""===n?(t.setAttribute(i,"auto"),n):e}})})),lt.support.hrefNormalized||(lt.each(["href","src","width","height"],function(t,i){lt.attrHooks[i]=lt.extend(lt.attrHooks[i],{get:function(t){var n=t.getAttribute(i,2);return null==n?e:n}})}),lt.each(["href","src"],function(t,e){lt.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}})),lt.support.style||(lt.attrHooks.style={get:function(t){return t.style.cssText||e},set:function(t,e){return t.style.cssText=e+""}}),lt.support.optSelected||(lt.propHooks.selected=lt.extend(lt.propHooks.selected,{get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}})),lt.support.enctype||(lt.propFix.enctype="encoding"),lt.support.checkOn||lt.each(["radio","checkbox"],function(){lt.valHooks[this]={get:function(t){return null===t.getAttribute("value")?"on":t.value}}}),lt.each(["radio","checkbox"],function(){lt.valHooks[this]=lt.extend(lt.valHooks[this],{set:function(t,i){return lt.isArray(i)?t.checked=lt.inArray(lt(t).val(),i)>=0:e}})});var Vt=/^(?:input|select|textarea)$/i,Bt=/^key/,$t=/^(?:mouse|contextmenu)|click/,It=/^(?:focusinfocus|focusoutblur)$/,jt=/^([^.]*)(?:\.(.+)|)$/;lt.event={global:{},add:function(t,i,n,o,r){var s,a,l,c,u,h,d,p,f,g,m,v=lt._data(t);if(v){for(n.handler&&(c=n,n=c.handler,r=c.selector),n.guid||(n.guid=lt.guid++),(a=v.events)||(a=v.events={}),(h=v.handle)||(h=v.handle=function(t){return typeof lt===Y||t&&lt.event.triggered===t.type?e:lt.event.dispatch.apply(h.elem,arguments)},h.elem=t),i=(i||"").match(ut)||[""],l=i.length;l--;)s=jt.exec(i[l])||[],f=m=s[1],g=(s[2]||"").split(".").sort(),u=lt.event.special[f]||{},f=(r?u.delegateType:u.bindType)||f,u=lt.event.special[f]||{},d=lt.extend({type:f,origType:m,data:o,handler:n,guid:n.guid,selector:r,needsContext:r&&lt.expr.match.needsContext.test(r),namespace:g.join(".")},c),(p=a[f])||(p=a[f]=[],p.delegateCount=0,u.setup&&u.setup.call(t,o,g,h)!==!1||(t.addEventListener?t.addEventListener(f,h,!1):t.attachEvent&&t.attachEvent("on"+f,h))),u.add&&(u.add.call(t,d),d.handler.guid||(d.handler.guid=n.guid)),r?p.splice(p.delegateCount++,0,d):p.push(d),lt.event.global[f]=!0;t=null}},remove:function(t,e,i,n,o){var r,s,a,l,c,u,h,d,p,f,g,m=lt.hasData(t)&&lt._data(t);if(m&&(u=m.events)){for(e=(e||"").match(ut)||[""],c=e.length;c--;)if(a=jt.exec(e[c])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p){for(h=lt.event.special[p]||{},p=(n?h.delegateType:h.bindType)||p,d=u[p]||[],a=a[2]&&RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=r=d.length;r--;)s=d[r],!o&&g!==s.origType||i&&i.guid!==s.guid||a&&!a.test(s.namespace)||n&&n!==s.selector&&("**"!==n||!s.selector)||(d.splice(r,1),s.selector&&d.delegateCount--,h.remove&&h.remove.call(t,s));l&&!d.length&&(h.teardown&&h.teardown.call(t,f,m.handle)!==!1||lt.removeEvent(t,p,m.handle),delete u[p])}else for(p in u)lt.event.remove(t,p+e[c],i,n,!0);lt.isEmptyObject(u)&&(delete m.handle,lt._removeData(t,"events"))}},trigger:function(i,n,o,r){var s,a,l,c,u,h,d,p=[o||q],f=st.call(i,"type")?i.type:i,g=st.call(i,"namespace")?i.namespace.split("."):[];if(l=h=o=o||q,3!==o.nodeType&&8!==o.nodeType&&!It.test(f+lt.event.triggered)&&(f.indexOf(".")>=0&&(g=f.split("."),f=g.shift(),g.sort()),a=0>f.indexOf(":")&&"on"+f,i=i[lt.expando]?i:new lt.Event(f,"object"==typeof i&&i),i.isTrigger=!0,i.namespace=g.join("."),i.namespace_re=i.namespace?RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=e,i.target||(i.target=o),n=null==n?[i]:lt.makeArray(n,[i]),u=lt.event.special[f]||{},r||!u.trigger||u.trigger.apply(o,n)!==!1)){if(!r&&!u.noBubble&&!lt.isWindow(o)){for(c=u.delegateType||f,It.test(c+f)||(l=l.parentNode);l;l=l.parentNode)p.push(l),h=l;h===(o.ownerDocument||q)&&p.push(h.defaultView||h.parentWindow||t)}for(d=0;(l=p[d++])&&!i.isPropagationStopped();)i.type=d>1?c:u.bindType||f,s=(lt._data(l,"events")||{})[i.type]&&lt._data(l,"handle"),s&&s.apply(l,n),s=a&&l[a],s&&lt.acceptData(l)&&s.apply&&s.apply(l,n)===!1&&i.preventDefault();if(i.type=f,!(r||i.isDefaultPrevented()||u._default&&u._default.apply(o.ownerDocument,n)!==!1||"click"===f&&lt.nodeName(o,"a")||!lt.acceptData(o)||!a||!o[f]||lt.isWindow(o))){h=o[a],h&&(o[a]=null),lt.event.triggered=f;try{o[f]()}catch(t){}lt.event.triggered=e,h&&(o[a]=h)}return i.result}},dispatch:function(t){t=lt.event.fix(t);var i,n,o,r,s,a=[],l=nt.call(arguments),c=(lt._data(this,"events")||{})[t.type]||[],u=lt.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!u.preDispatch||u.preDispatch.call(this,t)!==!1){for(a=lt.event.handlers.call(this,t,c),i=0;(r=a[i++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,s=0;(o=r.handlers[s++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(o.namespace))&&(t.handleObj=o,t.data=o.data,n=((lt.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,l),n!==e&&(t.result=n)===!1&&(t.preventDefault(),t.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,t),t.result}},handlers:function(t,i){var n,o,r,s,a=[],l=i.delegateCount,c=t.target;if(l&&c.nodeType&&(!t.button||"click"!==t.type))for(;c!=this;c=c.parentNode||this)if(1===c.nodeType&&(c.disabled!==!0||"click"!==t.type)){for(r=[],s=0;l>s;s++)o=i[s],n=o.selector+" ",r[n]===e&&(r[n]=o.needsContext?lt(n,this).index(c)>=0:lt.find(n,this,null,[c]).length),r[n]&&r.push(o);r.length&&a.push({elem:c,handlers:r})}return i.length>l&&a.push({elem:this,handlers:i.slice(l)}),a},fix:function(t){if(t[lt.expando])return t;var e,i,n,o=t.type,r=t,s=this.fixHooks[o];for(s||(this.fixHooks[o]=s=$t.test(o)?this.mouseHooks:Bt.test(o)?this.keyHooks:{}),n=s.props?this.props.concat(s.props):this.props,t=new lt.Event(r),e=n.length;e--;)i=n[e],t[i]=r[i];return t.target||(t.target=r.srcElement||q),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,s.filter?s.filter(t,r):t},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,i){var n,o,r,s=i.button,a=i.fromElement;return null==t.pageX&&null!=i.clientX&&(o=t.target.ownerDocument||q,r=o.documentElement,n=o.body,t.pageX=i.clientX+(r&&r.scrollLeft||n&&n.scrollLeft||0)-(r&&r.clientLeft||n&&n.clientLeft||0),t.pageY=i.clientY+(r&&r.scrollTop||n&&n.scrollTop||0)-(r&&r.clientTop||n&&n.clientTop||0)),!t.relatedTarget&&a&&(t.relatedTarget=a===t.target?i.toElement:a),t.which||s===e||(t.which=1&s?1:2&s?3:4&s?2:0),t}},special:{load:{noBubble:!0},click:{trigger:function(){return lt.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):e}},focus:{trigger:function(){if(this!==q.activeElement&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){return this===q.activeElement&&this.blur?(this.blur(),!1):e},delegateType:"focusout"},beforeunload:{postDispatch:function(t){t.result!==e&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var o=lt.extend(new lt.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?lt.event.trigger(o,null,e):lt.event.dispatch.call(e,o),o.isDefaultPrevented()&&i.preventDefault()}},lt.removeEvent=q.removeEventListener?function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)}:function(t,e,i){var n="on"+e;t.detachEvent&&(typeof t[n]===Y&&(t[n]=null),t.detachEvent(n,i))},lt.Event=function(t,i){return this instanceof lt.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.returnValue===!1||t.getPreventDefault&&t.getPreventDefault()?l:c):this.type=t,i&&lt.extend(this,i),this.timeStamp=t&&t.timeStamp||lt.now(),this[lt.expando]=!0,e):new lt.Event(t,i)},lt.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=l,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=l,t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},lt.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){lt.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,o=t.relatedTarget,r=t.handleObj;return(!o||o!==n&&!lt.contains(n,o))&&(t.type=r.origType,i=r.handler.apply(this,arguments),t.type=e),i}}}),lt.support.submitBubbles||(lt.event.special.submit={setup:function(){return!lt.nodeName(this,"form")&&(lt.event.add(this,"click._submit keypress._submit",function(t){var i=t.target,n=lt.nodeName(i,"input")||lt.nodeName(i,"button")?i.form:e;n&&!lt._data(n,"submitBubbles")&&(lt.event.add(n,"submit._submit",function(t){t._submit_bubble=!0}),lt._data(n,"submitBubbles",!0))}),e)},postDispatch:function(t){t._submit_bubble&&(delete t._submit_bubble,this.parentNode&&!t.isTrigger&&lt.event.simulate("submit",this.parentNode,t,!0))},teardown:function(){return!lt.nodeName(this,"form")&&(lt.event.remove(this,"._submit"),e)}}),lt.support.changeBubbles||(lt.event.special.change={setup:function(){return Vt.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(lt.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),lt.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1),lt.event.simulate("change",this,t,!0)})),!1):(lt.event.add(this,"beforeactivate._change",function(t){var e=t.target;Vt.test(e.nodeName)&&!lt._data(e,"changeBubbles")&&(lt.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||lt.event.simulate("change",this.parentNode,t,!0)}),lt._data(e,"changeBubbles",!0))}),e)},handle:function(t){var i=t.target;return this!==i||t.isSimulated||t.isTrigger||"radio"!==i.type&&"checkbox"!==i.type?t.handleObj.handler.apply(this,arguments):e},teardown:function(){return lt.event.remove(this,"._change"),!Vt.test(this.nodeName)}}),lt.support.focusinBubbles||lt.each({focus:"focusin",blur:"focusout"},function(t,e){var i=0,n=function(t){lt.event.simulate(e,t.target,lt.event.fix(t),!0)};lt.event.special[e]={setup:function(){0===i++&&q.addEventListener(t,n,!0)},teardown:function(){0===--i&&q.removeEventListener(t,n,!0)}}}),lt.fn.extend({on:function(t,i,n,o,r){var s,a;if("object"==typeof t){"string"!=typeof i&&(n=n||i,i=e);for(s in t)this.on(s,i,n,t[s],r);return this}if(null==n&&null==o?(o=i,n=i=e):null==o&&("string"==typeof i?(o=n,n=e):(o=n,n=i,i=e)),o===!1)o=c;else if(!o)return this;return 1===r&&(a=o,o=function(t){return lt().off(t),a.apply(this,arguments)},o.guid=a.guid||(a.guid=lt.guid++)),this.each(function(){lt.event.add(this,t,o,n,i)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,i,n){var o,r;if(t&&t.preventDefault&&t.handleObj)return o=t.handleObj,lt(t.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler),this;if("object"==typeof t){for(r in t)this.off(r,i,t[r]);return this}return(i===!1||"function"==typeof i)&&(n=i,i=e),n===!1&&(n=c),this.each(function(){lt.event.remove(this,t,n,i)})},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},trigger:function(t,e){return this.each(function(){lt.event.trigger(t,e,this)})},triggerHandler:function(t,i){var n=this[0];return n?lt.event.trigger(t,i,n,!0):e}}),function(t,e){function i(t){return ft.test(t+"")}function n(){var t,e=[];return t=function(i,n){return e.push(i+=" ")>C.cacheLength&&delete t[e.shift()],t[i]=n}}function o(t){return t[I]=!0,t}function r(t){var e=A.createElement("div");try{return t(e)}catch(t){return!1}finally{e=null}}function s(t,e,i,n){var o,r,s,a,l,c,u,p,f,g;if((e?e.ownerDocument||e:j)!==A&&G(e),e=e||A,i=i||[],!t||"string"!=typeof t)return i;if(1!==(a=e.nodeType)&&9!==a)return[];if(!O&&!n){if(o=gt.exec(t))if(s=o[1]){if(9===a){if(r=e.getElementById(s),!r||!r.parentNode)return i;if(r.id===s)return i.push(r),i}else if(e.ownerDocument&&(r=e.ownerDocument.getElementById(s))&&B(e,r)&&r.id===s)return i.push(r),i}else{if(o[2])return X.apply(i,K.call(e.getElementsByTagName(t),0)),i;if((s=o[3])&&N.getByClassName&&e.getElementsByClassName)return X.apply(i,K.call(e.getElementsByClassName(s),0)),i}if(N.qsa&&!F.test(t)){if(u=!0,p=I,f=e,g=9===a&&t,1===a&&"object"!==e.nodeName.toLowerCase()){for(c=h(t),(u=e.getAttribute("id"))?p=u.replace(yt,"\\$&"):e.setAttribute("id",p),p="[id='"+p+"'] ",l=c.length;l--;)c[l]=p+d(c[l]);f=pt.test(t)&&e.parentNode||e,g=c.join(",")}if(g)try{return X.apply(i,K.call(f.querySelectorAll(g),0)),i}catch(t){}finally{u||e.removeAttribute("id")}}}return w(t.replace(st,"$1"),e,i,n)}function a(t,e){var i=e&&t,n=i&&(~e.sourceIndex||q)-(~t.sourceIndex||q);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function l(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function c(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function u(t){return o(function(e){return e=+e,o(function(i,n){for(var o,r=t([],i.length,e),s=r.length;s--;)i[o=r[s]]&&(i[o]=!(n[o]=i[o]))})})}function h(t,e){var i,n,o,r,a,l,c,u=W[t+" "];if(u)return e?0:u.slice(0);for(a=t,l=[],c=C.preFilter;a;){(!i||(n=at.exec(a)))&&(n&&(a=a.slice(n[0].length)||a),l.push(o=[])),i=!1,(n=ct.exec(a))&&(i=n.shift(),o.push({value:i,type:n[0].replace(st," ")}),a=a.slice(i.length));for(r in C.filter)!(n=dt[r].exec(a))||c[r]&&!(n=c[r](n))||(i=n.shift(),o.push({value:i,type:r,matches:n}),a=a.slice(i.length));if(!i)break}return e?a.length:a?s.error(t):W(t,l).slice(0)}function d(t){for(var e=0,i=t.length,n="";i>e;e++)n+=t[e].value;return n}function p(t,e,i){var n=e.dir,o=i&&"parentNode"===n,r=L++;return e.first?function(e,i,r){for(;e=e[n];)if(1===e.nodeType||o)return t(e,i,r)}:function(e,i,s){var a,l,c,u=U+" "+r;if(s){for(;e=e[n];)if((1===e.nodeType||o)&&t(e,i,s))return!0}else for(;e=e[n];)if(1===e.nodeType||o)if(c=e[I]||(e[I]={}),(l=c[n])&&l[0]===u){if((a=l[1])===!0||a===D)return a===!0}else if(l=c[n]=[u],l[1]=t(e,i,s)||D,l[1]===!0)return!0}}function f(t){return t.length>1?function(e,i,n){for(var o=t.length;o--;)if(!t[o](e,i,n))return!1;return!0}:t[0]}function g(t,e,i,n,o){for(var r,s=[],a=0,l=t.length,c=null!=e;l>a;a++)(r=t[a])&&(!i||i(r,n,o))&&(s.push(r),c&&e.push(a));return s}function m(t,e,i,n,r,s){return n&&!n[I]&&(n=m(n)),r&&!r[I]&&(r=m(r,s)),o(function(o,s,a,l){var c,u,h,d=[],p=[],f=s.length,m=o||_(e||"*",a.nodeType?[a]:a,[]),v=!t||!o&&e?m:g(m,d,t,a,l),y=i?r||(o?t:f||n)?[]:s:v;
if(i&&i(v,y,a,l),n)for(c=g(y,p),n(c,[],a,l),u=c.length;u--;)(h=c[u])&&(y[p[u]]=!(v[p[u]]=h));if(o){if(r||t){if(r){for(c=[],u=y.length;u--;)(h=y[u])&&c.push(v[u]=h);r(null,y=[],c,l)}for(u=y.length;u--;)(h=y[u])&&(c=r?J.call(o,h):d[u])>-1&&(o[c]=!(s[c]=h))}}else y=g(y===s?y.splice(f,y.length):y),r?r(null,s,y,l):X.apply(s,y)})}function v(t){for(var e,i,n,o=t.length,r=C.relative[t[0].type],s=r||C.relative[" "],a=r?1:0,l=p(function(t){return t===e},s,!0),c=p(function(t){return J.call(e,t)>-1},s,!0),u=[function(t,i,n){return!r&&(n||i!==P)||((e=i).nodeType?l(t,i,n):c(t,i,n))}];o>a;a++)if(i=C.relative[t[a].type])u=[p(f(u),i)];else{if(i=C.filter[t[a].type].apply(null,t[a].matches),i[I]){for(n=++a;o>n&&!C.relative[t[n].type];n++);return m(a>1&&f(u),a>1&&d(t.slice(0,a-1)).replace(st,"$1"),i,n>a&&v(t.slice(a,n)),o>n&&v(t=t.slice(n)),o>n&&d(t))}u.push(i)}return f(u)}function y(t,e){var i=0,n=e.length>0,r=t.length>0,a=function(o,a,l,c,u){var h,d,p,f=[],m=0,v="0",y=o&&[],_=null!=u,w=P,b=o||r&&C.find.TAG("*",u&&a.parentNode||a),k=U+=null==w?1:Math.random()||.1;for(_&&(P=a!==A&&a,D=i);null!=(h=b[v]);v++){if(r&&h){for(d=0;p=t[d++];)if(p(h,a,l)){c.push(h);break}_&&(U=k,D=++i)}n&&((h=!p&&h)&&m--,o&&y.push(h))}if(m+=v,n&&v!==m){for(d=0;p=e[d++];)p(y,f,a,l);if(o){if(m>0)for(;v--;)y[v]||f[v]||(f[v]=Q.call(c));f=g(f)}X.apply(c,f),_&&!o&&f.length>0&&m+e.length>1&&s.uniqueSort(c)}return _&&(U=k,P=w),y};return n?o(a):a}function _(t,e,i){for(var n=0,o=e.length;o>n;n++)s(t,e[n],i);return i}function w(t,e,i,n){var o,r,s,a,l,c=h(t);if(!n&&1===c.length){if(r=c[0]=c[0].slice(0),r.length>2&&"ID"===(s=r[0]).type&&9===e.nodeType&&!O&&C.relative[r[1].type]){if(e=C.find.ID(s.matches[0].replace(wt,bt),e)[0],!e)return i;t=t.slice(r.shift().value.length)}for(o=dt.needsContext.test(t)?0:r.length;o--&&(s=r[o],!C.relative[a=s.type]);)if((l=C.find[a])&&(n=l(s.matches[0].replace(wt,bt),pt.test(r[0].type)&&e.parentNode||e))){if(r.splice(o,1),t=n.length&&d(r),!t)return X.apply(i,K.call(n,0)),i;break}}return x(t,c)(n,e,O,i,pt.test(t)),i}function b(){}var k,D,C,R,T,x,S,P,G,A,M,O,F,E,V,B,$,I="sizzle"+-new Date,j=t.document,N={},U=0,L=0,z=n(),W=n(),H=n(),Y=typeof e,q=1<<31,Z=[],Q=Z.pop,X=Z.push,K=Z.slice,J=Z.indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(this[e]===t)return e;return-1},tt="[\\x20\\t\\r\\n\\f]",et="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",it=et.replace("w","w#"),nt="([*^$|!~]?=)",ot="\\["+tt+"*("+et+")"+tt+"*(?:"+nt+tt+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+it+")|)|)"+tt+"*\\]",rt=":("+et+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ot.replace(3,8)+")*)|.*)\\)|)",st=RegExp("^"+tt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+tt+"+$","g"),at=RegExp("^"+tt+"*,"+tt+"*"),ct=RegExp("^"+tt+"*([\\x20\\t\\r\\n\\f>+~])"+tt+"*"),ut=RegExp(rt),ht=RegExp("^"+it+"$"),dt={ID:RegExp("^#("+et+")"),CLASS:RegExp("^\\.("+et+")"),NAME:RegExp("^\\[name=['\"]?("+et+")['\"]?\\]"),TAG:RegExp("^("+et.replace("w","w*")+")"),ATTR:RegExp("^"+ot),PSEUDO:RegExp("^"+rt),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+tt+"*(even|odd|(([+-]|)(\\d*)n|)"+tt+"*(?:([+-]|)"+tt+"*(\\d+)|))"+tt+"*\\)|)","i"),needsContext:RegExp("^"+tt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+tt+"*((?:-\\d)?\\d*)"+tt+"*\\)|)(?=[^-]|$)","i")},pt=/[\x20\t\r\n\f]*[+~]/,ft=/^[^{]+\{\s*\[native code/,gt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,mt=/^(?:input|select|textarea|button)$/i,vt=/^h\d$/i,yt=/'|\\/g,_t=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,wt=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,bt=function(t,e){var i="0x"+e-65536;return i!==i?e:0>i?String.fromCharCode(i+65536):String.fromCharCode(55296|i>>10,56320|1023&i)};try{K.call(j.documentElement.childNodes,0)[0].nodeType}catch(t){K=function(t){for(var e,i=[];e=this[t++];)i.push(e);return i}}T=s.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},G=s.setDocument=function(t){var n=t?t.ownerDocument||t:j;return n!==A&&9===n.nodeType&&n.documentElement?(A=n,M=n.documentElement,O=T(n),N.tagNameNoComments=r(function(t){return t.appendChild(n.createComment("")),!t.getElementsByTagName("*").length}),N.attributes=r(function(t){t.innerHTML="<select></select>";var e=typeof t.lastChild.getAttribute("multiple");return"boolean"!==e&&"string"!==e}),N.getByClassName=r(function(t){return t.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!(!t.getElementsByClassName||!t.getElementsByClassName("e").length)&&(t.lastChild.className="e",2===t.getElementsByClassName("e").length)}),N.getByName=r(function(t){t.id=I+0,t.innerHTML="<a name='"+I+"'></a><div name='"+I+"'></div>",M.insertBefore(t,M.firstChild);var e=n.getElementsByName&&n.getElementsByName(I).length===2+n.getElementsByName(I+0).length;return N.getIdNotName=!n.getElementById(I),M.removeChild(t),e}),C.attrHandle=r(function(t){return t.innerHTML="<a href='#'></a>",t.firstChild&&typeof t.firstChild.getAttribute!==Y&&"#"===t.firstChild.getAttribute("href")})?{}:{href:function(t){return t.getAttribute("href",2)},type:function(t){return t.getAttribute("type")}},N.getIdNotName?(C.find.ID=function(t,e){if(typeof e.getElementById!==Y&&!O){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},C.filter.ID=function(t){var e=t.replace(wt,bt);return function(t){return t.getAttribute("id")===e}}):(C.find.ID=function(t,i){if(typeof i.getElementById!==Y&&!O){var n=i.getElementById(t);return n?n.id===t||typeof n.getAttributeNode!==Y&&n.getAttributeNode("id").value===t?[n]:e:[]}},C.filter.ID=function(t){var e=t.replace(wt,bt);return function(t){var i=typeof t.getAttributeNode!==Y&&t.getAttributeNode("id");return i&&i.value===e}}),C.find.TAG=N.tagNameNoComments?function(t,i){return typeof i.getElementsByTagName!==Y?i.getElementsByTagName(t):e}:function(t,e){var i,n=[],o=0,r=e.getElementsByTagName(t);if("*"===t){for(;i=r[o++];)1===i.nodeType&&n.push(i);return n}return r},C.find.NAME=N.getByName&&function(t,i){return typeof i.getElementsByName!==Y?i.getElementsByName(name):e},C.find.CLASS=N.getByClassName&&function(t,i){return typeof i.getElementsByClassName===Y||O?e:i.getElementsByClassName(t)},E=[],F=[":focus"],(N.qsa=i(n.querySelectorAll))&&(r(function(t){t.innerHTML="<select><option selected=''></option></select>",t.querySelectorAll("[selected]").length||F.push("\\["+tt+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),t.querySelectorAll(":checked").length||F.push(":checked")}),r(function(t){t.innerHTML="<input type='hidden' i=''/>",t.querySelectorAll("[i^='']").length&&F.push("[*^$]="+tt+"*(?:\"\"|'')"),t.querySelectorAll(":enabled").length||F.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),F.push(",.*:")})),(N.matchesSelector=i(V=M.matchesSelector||M.mozMatchesSelector||M.webkitMatchesSelector||M.oMatchesSelector||M.msMatchesSelector))&&r(function(t){N.disconnectedMatch=V.call(t,"div"),V.call(t,"[s!='']:x"),E.push("!=",rt)}),F=RegExp(F.join("|")),E=RegExp(E.join("|")),B=i(M.contains)||M.compareDocumentPosition?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},$=M.compareDocumentPosition?function(t,e){var i;return t===e?(S=!0,0):(i=e.compareDocumentPosition&&t.compareDocumentPosition&&t.compareDocumentPosition(e))?1&i||t.parentNode&&11===t.parentNode.nodeType?t===n||B(j,t)?-1:e===n||B(j,e)?1:0:4&i?-1:1:t.compareDocumentPosition?-1:1}:function(t,e){var i,o=0,r=t.parentNode,s=e.parentNode,l=[t],c=[e];if(t===e)return S=!0,0;if(!r||!s)return t===n?-1:e===n?1:r?-1:s?1:0;if(r===s)return a(t,e);for(i=t;i=i.parentNode;)l.unshift(i);for(i=e;i=i.parentNode;)c.unshift(i);for(;l[o]===c[o];)o++;return o?a(l[o],c[o]):l[o]===j?-1:c[o]===j?1:0},S=!1,[0,0].sort($),N.detectDuplicates=S,A):A},s.matches=function(t,e){return s(t,null,null,e)},s.matchesSelector=function(t,e){if((t.ownerDocument||t)!==A&&G(t),e=e.replace(_t,"='$1']"),!(!N.matchesSelector||O||E&&E.test(e)||F.test(e)))try{var i=V.call(t,e);if(i||N.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){}return s(e,A,null,[t]).length>0},s.contains=function(t,e){return(t.ownerDocument||t)!==A&&G(t),B(t,e)},s.attr=function(t,e){var i;return(t.ownerDocument||t)!==A&&G(t),O||(e=e.toLowerCase()),(i=C.attrHandle[e])?i(t):O||N.attributes?t.getAttribute(e):((i=t.getAttributeNode(e))||t.getAttribute(e))&&t[e]===!0?e:i&&i.specified?i.value:null},s.error=function(t){throw Error("Syntax error, unrecognized expression: "+t)},s.uniqueSort=function(t){var e,i=[],n=1,o=0;if(S=!N.detectDuplicates,t.sort($),S){for(;e=t[n];n++)e===t[n-1]&&(o=i.push(n));for(;o--;)t.splice(i[o],1)}return t},R=s.getText=function(t){var e,i="",n=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=R(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[n];n++)i+=R(e);return i},C=s.selectors={cacheLength:50,createPseudo:o,match:dt,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(wt,bt),t[3]=(t[4]||t[5]||"").replace(wt,bt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||s.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&s.error(t[0]),t},PSEUDO:function(t){var e,i=!t[5]&&t[2];return dt.CHILD.test(t[0])?null:(t[4]?t[2]=t[4]:i&&ut.test(i)&&(e=h(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){return"*"===t?function(){return!0}:(t=t.replace(wt,bt).toLowerCase(),function(e){return e.nodeName&&e.nodeName.toLowerCase()===t})},CLASS:function(t){var e=z[t+" "];return e||(e=RegExp("(^|"+tt+")"+t+"("+tt+"|$)"))&&z(t,function(t){return e.test(t.className||typeof t.getAttribute!==Y&&t.getAttribute("class")||"")})},ATTR:function(t,e,i){return function(n){var o=s.attr(n,t);return null==o?"!="===e:!e||(o+="","="===e?o===i:"!="===e?o!==i:"^="===e?i&&0===o.indexOf(i):"*="===e?i&&o.indexOf(i)>-1:"$="===e?i&&o.slice(-i.length)===i:"~="===e?(" "+o+" ").indexOf(i)>-1:"|="===e&&(o===i||o.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,i,n,o){var r="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===o?function(t){return!!t.parentNode}:function(e,i,l){var c,u,h,d,p,f,g=r!==s?"nextSibling":"previousSibling",m=e.parentNode,v=a&&e.nodeName.toLowerCase(),y=!l&&!a;if(m){if(r){for(;g;){for(h=e;h=h[g];)if(a?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;f=g="only"===t&&!f&&"nextSibling"}return!0}if(f=[s?m.firstChild:m.lastChild],s&&y){for(u=m[I]||(m[I]={}),c=u[t]||[],p=c[0]===U&&c[1],d=c[0]===U&&c[2],h=p&&m.childNodes[p];h=++p&&h&&h[g]||(d=p=0)||f.pop();)if(1===h.nodeType&&++d&&h===e){u[t]=[U,p,d];break}}else if(y&&(c=(e[I]||(e[I]={}))[t])&&c[0]===U)d=c[1];else for(;(h=++p&&h&&h[g]||(d=p=0)||f.pop())&&((a?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++d||(y&&((h[I]||(h[I]={}))[t]=[U,d]),h!==e)););return d-=o,d===n||0===d%n&&d/n>=0}}},PSEUDO:function(t,e){var i,n=C.pseudos[t]||C.setFilters[t.toLowerCase()]||s.error("unsupported pseudo: "+t);return n[I]?n(e):n.length>1?(i=[t,t,"",e],C.setFilters.hasOwnProperty(t.toLowerCase())?o(function(t,i){for(var o,r=n(t,e),s=r.length;s--;)o=J.call(t,r[s]),t[o]=!(i[o]=r[s])}):function(t){return n(t,0,i)}):n}},pseudos:{not:o(function(t){var e=[],i=[],n=x(t.replace(st,"$1"));return n[I]?o(function(t,e,i,o){for(var r,s=n(t,null,o,[]),a=t.length;a--;)(r=s[a])&&(t[a]=!(e[a]=r))}):function(t,o,r){return e[0]=t,n(e,null,r,i),!i.pop()}}),has:o(function(t){return function(e){return s(t,e).length>0}}),contains:o(function(t){return function(e){return(e.textContent||e.innerText||R(e)).indexOf(t)>-1}}),lang:o(function(t){return ht.test(t||"")||s.error("unsupported lang: "+t),t=t.replace(wt,bt).toLowerCase(),function(e){var i;do if(i=O?e.getAttribute("xml:lang")||e.getAttribute("lang"):e.lang)return i=i.toLowerCase(),i===t||0===i.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===M},focus:function(t){return t===A.activeElement&&(!A.hasFocus||A.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeName>"@"||3===t.nodeType||4===t.nodeType)return!1;return!0},parent:function(t){return!C.pseudos.empty(t)},header:function(t){return vt.test(t.nodeName)},input:function(t){return mt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||e.toLowerCase()===t.type)},first:u(function(){return[0]}),last:u(function(t,e){return[e-1]}),eq:u(function(t,e,i){return[0>i?i+e:i]}),even:u(function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t}),odd:u(function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t}),lt:u(function(t,e,i){for(var n=0>i?i+e:i;--n>=0;)t.push(n);return t}),gt:u(function(t,e,i){for(var n=0>i?i+e:i;e>++n;)t.push(n);return t})}};for(k in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[k]=l(k);for(k in{submit:!0,reset:!0})C.pseudos[k]=c(k);x=s.compile=function(t,e){var i,n=[],o=[],r=H[t+" "];if(!r){for(e||(e=h(t)),i=e.length;i--;)r=v(e[i]),r[I]?n.push(r):o.push(r);r=H(t,y(o,n))}return r},C.pseudos.nth=C.pseudos.eq,C.filters=b.prototype=C.pseudos,C.setFilters=new b,G(),s.attr=lt.attr,lt.find=s,lt.expr=s.selectors,lt.expr[":"]=lt.expr.pseudos,lt.unique=s.uniqueSort,lt.text=s.getText,lt.isXMLDoc=s.isXML,lt.contains=s.contains}(t);var Nt=/Until$/,Ut=/^(?:parents|prev(?:Until|All))/,Lt=/^.[^:#\[\.,]*$/,zt=lt.expr.match.needsContext,Wt={children:!0,contents:!0,next:!0,prev:!0};lt.fn.extend({find:function(t){var e,i,n,o=this.length;if("string"!=typeof t)return n=this,this.pushStack(lt(t).filter(function(){for(e=0;o>e;e++)if(lt.contains(n[e],this))return!0}));for(i=[],e=0;o>e;e++)lt.find(t,this[e],i);return i=this.pushStack(o>1?lt.unique(i):i),i.selector=(this.selector?this.selector+" ":"")+t,i},has:function(t){var e,i=lt(t,this),n=i.length;return this.filter(function(){for(e=0;n>e;e++)if(lt.contains(this,i[e]))return!0})},not:function(t){return this.pushStack(h(this,t,!1))},filter:function(t){return this.pushStack(h(this,t,!0))},is:function(t){return!!t&&("string"==typeof t?zt.test(t)?lt(t,this.context).index(this[0])>=0:lt.filter(t,this).length>0:this.filter(t).length>0)},closest:function(t,e){for(var i,n=0,o=this.length,r=[],s=zt.test(t)||"string"!=typeof t?lt(t,e||this.context):0;o>n;n++)for(i=this[n];i&&i.ownerDocument&&i!==e&&11!==i.nodeType;){if(s?s.index(i)>-1:lt.find.matchesSelector(i,t)){r.push(i);break}i=i.parentNode}return this.pushStack(r.length>1?lt.unique(r):r)},index:function(t){return t?"string"==typeof t?lt.inArray(this[0],lt(t)):lt.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){var i="string"==typeof t?lt(t,e):lt.makeArray(t&&t.nodeType?[t]:t),n=lt.merge(this.get(),i);return this.pushStack(lt.unique(n))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),lt.fn.andSelf=lt.fn.addBack,lt.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return lt.dir(t,"parentNode")},parentsUntil:function(t,e,i){return lt.dir(t,"parentNode",i)},next:function(t){return u(t,"nextSibling")},prev:function(t){return u(t,"previousSibling")},nextAll:function(t){return lt.dir(t,"nextSibling")},prevAll:function(t){return lt.dir(t,"previousSibling")},nextUntil:function(t,e,i){return lt.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return lt.dir(t,"previousSibling",i)},siblings:function(t){return lt.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return lt.sibling(t.firstChild)},contents:function(t){return lt.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:lt.merge([],t.childNodes)}},function(t,e){lt.fn[t]=function(i,n){var o=lt.map(this,e,i);return Nt.test(t)||(n=i),n&&"string"==typeof n&&(o=lt.filter(n,o)),o=this.length>1&&!Wt[t]?lt.unique(o):o,this.length>1&&Ut.test(t)&&(o=o.reverse()),this.pushStack(o)}}),lt.extend({filter:function(t,e,i){return i&&(t=":not("+t+")"),1===e.length?lt.find.matchesSelector(e[0],t)?[e[0]]:[]:lt.find.matches(t,e)},dir:function(t,i,n){for(var o=[],r=t[i];r&&9!==r.nodeType&&(n===e||1!==r.nodeType||!lt(r).is(n));)1===r.nodeType&&o.push(r),r=r[i];return o},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}});var Ht="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Yt=/ jQuery\d+="(?:null|\d+)"/g,qt=RegExp("<(?:"+Ht+")[\\s/>]","i"),Zt=/^\s+/,Qt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Xt=/<([\w:]+)/,Kt=/<tbody/i,Jt=/<|&#?\w+;/,te=/<(?:script|style|link)/i,ee=/^(?:checkbox|radio)$/i,ie=/checked\s*(?:[^=]|=\s*.checked.)/i,ne=/^$|\/(?:java|ecma)script/i,oe=/^true\/(.*)/,re=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,se={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:lt.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},ae=d(q),le=ae.appendChild(q.createElement("div"));se.optgroup=se.option,se.tbody=se.tfoot=se.colgroup=se.caption=se.thead,se.th=se.td,lt.fn.extend({text:function(t){return lt.access(this,function(t){return t===e?lt.text(this):this.empty().append((this[0]&&this[0].ownerDocument||q).createTextNode(t))},null,t,arguments.length)},wrapAll:function(t){if(lt.isFunction(t))return this.each(function(e){lt(this).wrapAll(t.call(this,e))});if(this[0]){var e=lt(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return lt.isFunction(t)?this.each(function(e){lt(this).wrapInner(t.call(this,e))}):this.each(function(){var e=lt(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=lt.isFunction(t);return this.each(function(i){lt(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){lt.nodeName(this,"body")||lt(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(t){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(t)})},prepend:function(){return this.domManip(arguments,!0,function(t){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(t,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,!1,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,n=0;null!=(i=this[n]);n++)(!t||lt.filter(t,[i]).length>0)&&(e||1!==i.nodeType||lt.cleanData(_(i)),i.parentNode&&(e&&lt.contains(i.ownerDocument,i)&&m(_(i,"script")),i.parentNode.removeChild(i)));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&lt.cleanData(_(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&lt.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return lt.clone(this,t,e)})},html:function(t){return lt.access(this,function(t){var i=this[0]||{},n=0,o=this.length;if(t===e)return 1===i.nodeType?i.innerHTML.replace(Yt,""):e;if(!("string"!=typeof t||te.test(t)||!lt.support.htmlSerialize&&qt.test(t)||!lt.support.leadingWhitespace&&Zt.test(t)||se[(Xt.exec(t)||["",""])[1].toLowerCase()])){t=t.replace(Qt,"<$1></$2>");try{for(;o>n;n++)i=this[n]||{},1===i.nodeType&&(lt.cleanData(_(i,!1)),i.innerHTML=t);i=0}catch(t){}}i&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(t){var e=lt.isFunction(t);return e||"string"==typeof t||(t=lt(t).not(this).detach()),this.domManip([t],!0,function(t){var e=this.nextSibling,i=this.parentNode;i&&(lt(this).remove(),i.insertBefore(t,e))})},detach:function(t){return this.remove(t,!0)},domManip:function(t,i,n){t=et.apply([],t);var o,r,s,a,l,c,u=0,h=this.length,d=this,m=h-1,v=t[0],y=lt.isFunction(v);if(y||!(1>=h||"string"!=typeof v||lt.support.checkClone)&&ie.test(v))return this.each(function(o){var r=d.eq(o);y&&(t[0]=v.call(this,o,i?r.html():e)),r.domManip(t,i,n)});if(h&&(c=lt.buildFragment(t,this[0].ownerDocument,!1,this),o=c.firstChild,1===c.childNodes.length&&(c=o),o)){for(i=i&&lt.nodeName(o,"tr"),a=lt.map(_(c,"script"),f),s=a.length;h>u;u++)r=c,u!==m&&(r=lt.clone(r,!0,!0),s&&lt.merge(a,_(r,"script"))),n.call(i&&lt.nodeName(this[u],"table")?p(this[u],"tbody"):this[u],r,u);if(s)for(l=a[a.length-1].ownerDocument,lt.map(a,g),u=0;s>u;u++)r=a[u],ne.test(r.type||"")&&!lt._data(r,"globalEval")&&lt.contains(l,r)&&(r.src?lt.ajax({url:r.src,type:"GET",dataType:"script",async:!1,global:!1,throws:!0}):lt.globalEval((r.text||r.textContent||r.innerHTML||"").replace(re,"")));c=o=null}return this}}),lt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){lt.fn[t]=function(t){for(var i,n=0,o=[],r=lt(t),s=r.length-1;s>=n;n++)i=n===s?this:this.clone(!0),lt(r[n])[e](i),it.apply(o,i.get());return this.pushStack(o)}}),lt.extend({clone:function(t,e,i){var n,o,r,s,a,l=lt.contains(t.ownerDocument,t);if(lt.support.html5Clone||lt.isXMLDoc(t)||!qt.test("<"+t.nodeName+">")?r=t.cloneNode(!0):(le.innerHTML=t.outerHTML,le.removeChild(r=le.firstChild)),!(lt.support.noCloneEvent&&lt.support.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||lt.isXMLDoc(t)))for(n=_(r),a=_(t),s=0;null!=(o=a[s]);++s)n[s]&&y(o,n[s]);if(e)if(i)for(a=a||_(t),n=n||_(r),s=0;null!=(o=a[s]);s++)v(o,n[s]);else v(t,r);return n=_(r,"script"),n.length>0&&m(n,!l&&_(t,"script")),n=a=o=null,r},buildFragment:function(t,e,i,n){for(var o,r,s,a,l,c,u,h=t.length,p=d(e),f=[],g=0;h>g;g++)if(r=t[g],r||0===r)if("object"===lt.type(r))lt.merge(f,r.nodeType?[r]:r);else if(Jt.test(r)){for(a=a||p.appendChild(e.createElement("div")),l=(Xt.exec(r)||["",""])[1].toLowerCase(),u=se[l]||se._default,a.innerHTML=u[1]+r.replace(Qt,"<$1></$2>")+u[2],o=u[0];o--;)a=a.lastChild;if(!lt.support.leadingWhitespace&&Zt.test(r)&&f.push(e.createTextNode(Zt.exec(r)[0])),!lt.support.tbody)for(r="table"!==l||Kt.test(r)?"<table>"!==u[1]||Kt.test(r)?0:a:a.firstChild,o=r&&r.childNodes.length;o--;)lt.nodeName(c=r.childNodes[o],"tbody")&&!c.childNodes.length&&r.removeChild(c);for(lt.merge(f,a.childNodes),a.textContent="";a.firstChild;)a.removeChild(a.firstChild);a=p.lastChild}else f.push(e.createTextNode(r));for(a&&p.removeChild(a),lt.support.appendChecked||lt.grep(_(f,"input"),w),g=0;r=f[g++];)if((!n||-1===lt.inArray(r,n))&&(s=lt.contains(r.ownerDocument,r),a=_(p.appendChild(r),"script"),s&&m(a),i))for(o=0;r=a[o++];)ne.test(r.type||"")&&i.push(r);return a=null,p},cleanData:function(t,e){for(var i,n,o,r,s=0,a=lt.expando,l=lt.cache,c=lt.support.deleteExpando,u=lt.event.special;null!=(i=t[s]);s++)if((e||lt.acceptData(i))&&(o=i[a],r=o&&l[o])){if(r.events)for(n in r.events)u[n]?lt.event.remove(i,n):lt.removeEvent(i,n,r.handle);l[o]&&(delete l[o],c?delete i[a]:typeof i.removeAttribute!==Y?i.removeAttribute(a):i[a]=null,J.push(o))}}});var ce,ue,he,de=/alpha\([^)]*\)/i,pe=/opacity\s*=\s*([^)]*)/,fe=/^(top|right|bottom|left)$/,ge=/^(none|table(?!-c[ea]).+)/,me=/^margin/,ve=RegExp("^("+ct+")(.*)$","i"),ye=RegExp("^("+ct+")(?!px)[a-z%]+$","i"),_e=RegExp("^([+-])=("+ct+")","i"),we={BODY:"block"},be={position:"absolute",visibility:"hidden",display:"block"},ke={letterSpacing:0,fontWeight:400},De=["Top","Right","Bottom","Left"],Ce=["Webkit","O","Moz","ms"];lt.fn.extend({css:function(t,i){return lt.access(this,function(t,i,n){var o,r,s={},a=0;if(lt.isArray(i)){for(r=ue(t),o=i.length;o>a;a++)s[i[a]]=lt.css(t,i[a],!1,r);return s}return n!==e?lt.style(t,i,n):lt.css(t,i)},t,i,arguments.length>1)},show:function(){return D(this,!0)},hide:function(){return D(this)},toggle:function(t){var e="boolean"==typeof t;return this.each(function(){(e?t:k(this))?lt(this).show():lt(this).hide()})}}),lt.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=he(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:lt.support.cssFloat?"cssFloat":"styleFloat"},style:function(t,i,n,o){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,s,a,l=lt.camelCase(i),c=t.style;if(i=lt.cssProps[l]||(lt.cssProps[l]=b(c,l)),a=lt.cssHooks[i]||lt.cssHooks[l],n===e)return a&&"get"in a&&(r=a.get(t,!1,o))!==e?r:c[i];if(s=typeof n,"string"===s&&(r=_e.exec(n))&&(n=(r[1]+1)*r[2]+parseFloat(lt.css(t,i)),s="number"),!(null==n||"number"===s&&isNaN(n)||("number"!==s||lt.cssNumber[l]||(n+="px"),lt.support.clearCloneStyle||""!==n||0!==i.indexOf("background")||(c[i]="inherit"),a&&"set"in a&&(n=a.set(t,n,o))===e)))try{c[i]=n}catch(t){}}},css:function(t,i,n,o){var r,s,a,l=lt.camelCase(i);return i=lt.cssProps[l]||(lt.cssProps[l]=b(t.style,l)),a=lt.cssHooks[i]||lt.cssHooks[l],a&&"get"in a&&(s=a.get(t,!0,n)),s===e&&(s=he(t,i,o)),"normal"===s&&i in ke&&(s=ke[i]),""===n||n?(r=parseFloat(s),n===!0||lt.isNumeric(r)?r||0:s):s},swap:function(t,e,i,n){var o,r,s={};for(r in e)s[r]=t.style[r],t.style[r]=e[r];o=i.apply(t,n||[]);for(r in e)t.style[r]=s[r];return o}}),t.getComputedStyle?(ue=function(e){return t.getComputedStyle(e,null)},he=function(t,i,n){var o,r,s,a=n||ue(t),l=a?a.getPropertyValue(i)||a[i]:e,c=t.style;return a&&(""!==l||lt.contains(t.ownerDocument,t)||(l=lt.style(t,i)),ye.test(l)&&me.test(i)&&(o=c.width,r=c.minWidth,s=c.maxWidth,c.minWidth=c.maxWidth=c.width=l,l=a.width,c.width=o,c.minWidth=r,c.maxWidth=s)),l}):q.documentElement.currentStyle&&(ue=function(t){return t.currentStyle},he=function(t,i,n){var o,r,s,a=n||ue(t),l=a?a[i]:e,c=t.style;return null==l&&c&&c[i]&&(l=c[i]),ye.test(l)&&!fe.test(i)&&(o=c.left,r=t.runtimeStyle,s=r&&r.left,s&&(r.left=t.currentStyle.left),c.left="fontSize"===i?"1em":l,l=c.pixelLeft+"px",c.left=o,s&&(r.left=s)),""===l?"auto":l}),lt.each(["height","width"],function(t,i){lt.cssHooks[i]={get:function(t,n,o){return n?0===t.offsetWidth&&ge.test(lt.css(t,"display"))?lt.swap(t,be,function(){return T(t,i,o)}):T(t,i,o):e},set:function(t,e,n){var o=n&&ue(t);return C(t,e,n?R(t,i,n,lt.support.boxSizing&&"border-box"===lt.css(t,"boxSizing",!1,o),o):0)}}}),lt.support.opacity||(lt.cssHooks.opacity={get:function(t,e){return pe.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var i=t.style,n=t.currentStyle,o=lt.isNumeric(e)?"alpha(opacity="+100*e+")":"",r=n&&n.filter||i.filter||"";i.zoom=1,(e>=1||""===e)&&""===lt.trim(r.replace(de,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===e||n&&!n.filter)||(i.filter=de.test(r)?r.replace(de,o):r+" "+o)}}),lt(function(){lt.support.reliableMarginRight||(lt.cssHooks.marginRight={get:function(t,i){return i?lt.swap(t,{display:"inline-block"},he,[t,"marginRight"]):e}}),!lt.support.pixelPosition&&lt.fn.position&&lt.each(["top","left"],function(t,i){lt.cssHooks[i]={get:function(t,n){return n?(n=he(t,i),ye.test(n)?lt(t).position()[i]+"px":n):e}}})}),lt.expr&&lt.expr.filters&&(lt.expr.filters.hidden=function(t){return 0>=t.offsetWidth&&0>=t.offsetHeight||!lt.support.reliableHiddenOffsets&&"none"===(t.style&&t.style.display||lt.css(t,"display"))},lt.expr.filters.visible=function(t){return!lt.expr.filters.hidden(t)}),lt.each({margin:"",padding:"",border:"Width"},function(t,e){lt.cssHooks[t+e]={expand:function(i){for(var n=0,o={},r="string"==typeof i?i.split(" "):[i];4>n;n++)o[t+De[n]+e]=r[n]||r[n-2]||r[0];return o}},me.test(t)||(lt.cssHooks[t+e].set=C)});var Re=/%20/g,Te=/\[\]$/,xe=/\r?\n/g,Se=/^(?:submit|button|image|reset|file)$/i,Pe=/^(?:input|select|textarea|keygen)/i;lt.fn.extend({serialize:function(){return lt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=lt.prop(this,"elements");return t?lt.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!lt(this).is(":disabled")&&Pe.test(this.nodeName)&&!Se.test(t)&&(this.checked||!ee.test(t))}).map(function(t,e){var i=lt(this).val();return null==i?null:lt.isArray(i)?lt.map(i,function(t){return{name:e.name,value:t.replace(xe,"\r\n")}}):{name:e.name,value:i.replace(xe,"\r\n")}}).get()}}),lt.param=function(t,i){var n,o=[],r=function(t,e){e=lt.isFunction(e)?e():null==e?"":e,o[o.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(i===e&&(i=lt.ajaxSettings&&lt.ajaxSettings.traditional),lt.isArray(t)||t.jquery&&!lt.isPlainObject(t))lt.each(t,function(){r(this.name,this.value)});else for(n in t)P(n,t[n],i,r);return o.join("&").replace(Re,"+")},lt.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){lt.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),lt.fn.hover=function(t,e){return this.mouseenter(t).mouseleave(e||t)};var Ge,Ae,Me=lt.now(),Oe=/\?/,Fe=/#.*$/,Ee=/([?&])_=[^&]*/,Ve=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Be=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,$e=/^(?:GET|HEAD)$/,Ie=/^\/\//,je=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Ne=lt.fn.load,Ue={},Le={},ze="*/".concat("*");try{Ae=Z.href}catch(t){Ae=q.createElement("a"),Ae.href="",Ae=Ae.href}Ge=je.exec(Ae.toLowerCase())||[],lt.fn.load=function(t,i,n){if("string"!=typeof t&&Ne)return Ne.apply(this,arguments);var o,r,s,a=this,l=t.indexOf(" ");return l>=0&&(o=t.slice(l,t.length),t=t.slice(0,l)),lt.isFunction(i)?(n=i,i=e):i&&"object"==typeof i&&(s="POST"),a.length>0&&lt.ajax({url:t,type:s,dataType:"html",data:i}).done(function(t){r=arguments,a.html(o?lt("<div>").append(lt.parseHTML(t)).find(o):t)}).complete(n&&function(t,e){a.each(n,r||[t.responseText,e,t])}),this},lt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){lt.fn[e]=function(t){return this.on(e,t)}}),lt.each(["get","post"],function(t,i){lt[i]=function(t,n,o,r){return lt.isFunction(n)&&(r=r||o,o=n,n=e),lt.ajax({url:t,type:i,dataType:r,data:n,success:o})}}),lt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ae,type:"GET",isLocal:Be.test(Ge[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ze,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":t.String,"text html":!0,"text json":lt.parseJSON,"text xml":lt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?M(M(t,lt.ajaxSettings),e):M(lt.ajaxSettings,t)},ajaxPrefilter:G(Ue),ajaxTransport:G(Le),ajax:function(t,i){function n(t,i,n,o){var r,h,y,_,b,D=i;2!==w&&(w=2,l&&clearTimeout(l),
u=e,a=o||"",k.readyState=t>0?4:0,n&&(_=O(d,k,n)),t>=200&&300>t||304===t?(d.ifModified&&(b=k.getResponseHeader("Last-Modified"),b&&(lt.lastModified[s]=b),b=k.getResponseHeader("etag"),b&&(lt.etag[s]=b)),204===t?(r=!0,D="nocontent"):304===t?(r=!0,D="notmodified"):(r=F(d,_),D=r.state,h=r.data,y=r.error,r=!y)):(y=D,(t||!D)&&(D="error",0>t&&(t=0))),k.status=t,k.statusText=(i||D)+"",r?g.resolveWith(p,[h,D,k]):g.rejectWith(p,[k,D,y]),k.statusCode(v),v=e,c&&f.trigger(r?"ajaxSuccess":"ajaxError",[k,d,r?h:y]),m.fireWith(p,[k,D]),c&&(f.trigger("ajaxComplete",[k,d]),--lt.active||lt.event.trigger("ajaxStop")))}"object"==typeof t&&(i=t,t=e),i=i||{};var o,r,s,a,l,c,u,h,d=lt.ajaxSetup({},i),p=d.context||d,f=d.context&&(p.nodeType||p.jquery)?lt(p):lt.event,g=lt.Deferred(),m=lt.Callbacks("once memory"),v=d.statusCode||{},y={},_={},w=0,b="canceled",k={readyState:0,getResponseHeader:function(t){var e;if(2===w){if(!h)for(h={};e=Ve.exec(a);)h[e[1].toLowerCase()]=e[2];e=h[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===w?a:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return w||(t=_[i]=_[i]||t,y[t]=e),this},overrideMimeType:function(t){return w||(d.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>w)for(e in t)v[e]=[v[e],t[e]];else k.always(t[k.status]);return this},abort:function(t){var e=t||b;return u&&u.abort(e),n(0,e),this}};if(g.promise(k).complete=m.add,k.success=k.done,k.error=k.fail,d.url=((t||d.url||Ae)+"").replace(Fe,"").replace(Ie,Ge[1]+"//"),d.type=i.method||i.type||d.method||d.type,d.dataTypes=lt.trim(d.dataType||"*").toLowerCase().match(ut)||[""],null==d.crossDomain&&(o=je.exec(d.url.toLowerCase()),d.crossDomain=!(!o||o[1]===Ge[1]&&o[2]===Ge[2]&&(o[3]||("http:"===o[1]?80:443))==(Ge[3]||("http:"===Ge[1]?80:443)))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=lt.param(d.data,d.traditional)),A(Ue,d,i,k),2===w)return k;c=d.global,c&&0===lt.active++&&lt.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!$e.test(d.type),s=d.url,d.hasContent||(d.data&&(s=d.url+=(Oe.test(s)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=Ee.test(s)?s.replace(Ee,"$1_="+Me++):s+(Oe.test(s)?"&":"?")+"_="+Me++)),d.ifModified&&(lt.lastModified[s]&&k.setRequestHeader("If-Modified-Since",lt.lastModified[s]),lt.etag[s]&&k.setRequestHeader("If-None-Match",lt.etag[s])),(d.data&&d.hasContent&&d.contentType!==!1||i.contentType)&&k.setRequestHeader("Content-Type",d.contentType),k.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+ze+"; q=0.01":""):d.accepts["*"]);for(r in d.headers)k.setRequestHeader(r,d.headers[r]);if(d.beforeSend&&(d.beforeSend.call(p,k,d)===!1||2===w))return k.abort();b="abort";for(r in{success:1,error:1,complete:1})k[r](d[r]);if(u=A(Le,d,i,k)){k.readyState=1,c&&f.trigger("ajaxSend",[k,d]),d.async&&d.timeout>0&&(l=setTimeout(function(){k.abort("timeout")},d.timeout));try{w=1,u.send(y,n)}catch(t){if(!(2>w))throw t;n(-1,t)}}else n(-1,"No Transport");return k},getScript:function(t,i){return lt.get(t,e,i,"script")},getJSON:function(t,e,i){return lt.get(t,e,i,"json")}}),lt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return lt.globalEval(t),t}}}),lt.ajaxPrefilter("script",function(t){t.cache===e&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),lt.ajaxTransport("script",function(t){if(t.crossDomain){var i,n=q.head||lt("head")[0]||q.documentElement;return{send:function(e,o){i=q.createElement("script"),i.async=!0,t.scriptCharset&&(i.charset=t.scriptCharset),i.src=t.url,i.onload=i.onreadystatechange=function(t,e){(e||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,e||o(200,"success"))},n.insertBefore(i,n.firstChild)},abort:function(){i&&i.onload(e,!0)}}}});var We=[],He=/(=)\?(?=&|$)|\?\?/;lt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=We.pop()||lt.expando+"_"+Me++;return this[t]=!0,t}}),lt.ajaxPrefilter("json jsonp",function(i,n,o){var r,s,a,l=i.jsonp!==!1&&(He.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&He.test(i.data)&&"data");return l||"jsonp"===i.dataTypes[0]?(r=i.jsonpCallback=lt.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(He,"$1"+r):i.jsonp!==!1&&(i.url+=(Oe.test(i.url)?"&":"?")+i.jsonp+"="+r),i.converters["script json"]=function(){return a||lt.error(r+" was not called"),a[0]},i.dataTypes[0]="json",s=t[r],t[r]=function(){a=arguments},o.always(function(){t[r]=s,i[r]&&(i.jsonpCallback=n.jsonpCallback,We.push(r)),a&&lt.isFunction(s)&&s(a[0]),a=s=e}),"script"):e});var Ye,qe,Ze=0,Qe=t.ActiveXObject&&function(){var t;for(t in Ye)Ye[t](e,!0)};lt.ajaxSettings.xhr=t.ActiveXObject?function(){return!this.isLocal&&E()||V()}:E,qe=lt.ajaxSettings.xhr(),lt.support.cors=!!qe&&"withCredentials"in qe,qe=lt.support.ajax=!!qe,qe&&lt.ajaxTransport(function(i){if(!i.crossDomain||lt.support.cors){var n;return{send:function(o,r){var s,a,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(a in i.xhrFields)l[a]=i.xhrFields[a];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");try{for(a in o)l.setRequestHeader(a,o[a])}catch(t){}l.send(i.hasContent&&i.data||null),n=function(t,o){var a,c,u,h;try{if(n&&(o||4===l.readyState))if(n=e,s&&(l.onreadystatechange=lt.noop,Qe&&delete Ye[s]),o)4!==l.readyState&&l.abort();else{h={},a=l.status,c=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(h.text=l.responseText);try{u=l.statusText}catch(t){u=""}a||!i.isLocal||i.crossDomain?1223===a&&(a=204):a=h.text?200:404}}catch(t){o||r(-1,t)}h&&r(a,u,h,c)},i.async?4===l.readyState?setTimeout(n):(s=++Ze,Qe&&(Ye||(Ye={},lt(t).unload(Qe)),Ye[s]=n),l.onreadystatechange=n):n()},abort:function(){n&&n(e,!0)}}}});var Xe,Ke,Je=/^(?:toggle|show|hide)$/,ti=RegExp("^(?:([+-])=|)("+ct+")([a-z%]*)$","i"),ei=/queueHooks$/,ii=[N],ni={"*":[function(t,e){var i,n,o=this.createTween(t,e),r=ti.exec(e),s=o.cur(),a=+s||0,l=1,c=20;if(r){if(i=+r[2],n=r[3]||(lt.cssNumber[t]?"":"px"),"px"!==n&&a){a=lt.css(o.elem,t,!0)||i||1;do l=l||".5",a/=l,lt.style(o.elem,t,a+n);while(l!==(l=o.cur()/s)&&1!==l&&--c)}o.unit=n,o.start=a,o.end=r[1]?a+(r[1]+1)*i:i}return o}]};lt.Animation=lt.extend(I,{tweener:function(t,e){lt.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,o=t.length;o>n;n++)i=t[n],ni[i]=ni[i]||[],ni[i].unshift(e)},prefilter:function(t,e){e?ii.unshift(t):ii.push(t)}}),lt.Tween=U,U.prototype={constructor:U,init:function(t,e,i,n,o,r){this.elem=t,this.prop=i,this.easing=o||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=r||(lt.cssNumber[i]?"":"px")},cur:function(){var t=U.propHooks[this.prop];return t&&t.get?t.get(this):U.propHooks._default.get(this)},run:function(t){var e,i=U.propHooks[this.prop];return this.pos=e=this.options.duration?lt.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):U.propHooks._default.set(this),this}},U.prototype.init.prototype=U.prototype,U.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=lt.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){lt.fx.step[t.prop]?lt.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[lt.cssProps[t.prop]]||lt.cssHooks[t.prop])?lt.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},U.propHooks.scrollTop=U.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},lt.each(["toggle","show","hide"],function(t,e){var i=lt.fn[e];lt.fn[e]=function(t,n,o){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(L(e,!0),t,n,o)}}),lt.fn.extend({fadeTo:function(t,e,i,n){return this.filter(k).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var o=lt.isEmptyObject(t),r=lt.speed(e,i,n),s=function(){var e=I(this,lt.extend({},t),r);s.finish=function(){e.stop(!0)},(o||lt._data(this,"finish"))&&e.stop(!0)};return s.finish=s,o||r.queue===!1?this.each(s):this.queue(r.queue,s)},stop:function(t,i,n){var o=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=i,i=t,t=e),i&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,i=null!=t&&t+"queueHooks",r=lt.timers,s=lt._data(this);if(i)s[i]&&s[i].stop&&o(s[i]);else for(i in s)s[i]&&s[i].stop&&ei.test(i)&&o(s[i]);for(i=r.length;i--;)r[i].elem!==this||null!=t&&r[i].queue!==t||(r[i].anim.stop(n),e=!1,r.splice(i,1));(e||!n)&&lt.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,i=lt._data(this),n=i[t+"queue"],o=i[t+"queueHooks"],r=lt.timers,s=n?n.length:0;for(i.finish=!0,lt.queue(this,t,[]),o&&o.cur&&o.cur.finish&&o.cur.finish.call(this),e=r.length;e--;)r[e].elem===this&&r[e].queue===t&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;s>e;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),lt.each({slideDown:L("show"),slideUp:L("hide"),slideToggle:L("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){lt.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),lt.speed=function(t,e,i){var n=t&&"object"==typeof t?lt.extend({},t):{complete:i||!i&&e||lt.isFunction(t)&&t,duration:t,easing:i&&e||e&&!lt.isFunction(e)&&e};return n.duration=lt.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in lt.fx.speeds?lt.fx.speeds[n.duration]:lt.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){lt.isFunction(n.old)&&n.old.call(this),n.queue&&lt.dequeue(this,n.queue)},n},lt.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},lt.timers=[],lt.fx=U.prototype.init,lt.fx.tick=function(){var t,i=lt.timers,n=0;for(Xe=lt.now();i.length>n;n++)t=i[n],t()||i[n]!==t||i.splice(n--,1);i.length||lt.fx.stop(),Xe=e},lt.fx.timer=function(t){t()&&lt.timers.push(t)&&lt.fx.start()},lt.fx.interval=13,lt.fx.start=function(){Ke||(Ke=setInterval(lt.fx.tick,lt.fx.interval))},lt.fx.stop=function(){clearInterval(Ke),Ke=null},lt.fx.speeds={slow:600,fast:200,_default:400},lt.fx.step={},lt.expr&&lt.expr.filters&&(lt.expr.filters.animated=function(t){return lt.grep(lt.timers,function(e){return t===e.elem}).length}),lt.fn.offset=function(t){if(arguments.length)return t===e?this:this.each(function(e){lt.offset.setOffset(this,t,e)});var i,n,o={top:0,left:0},r=this[0],s=r&&r.ownerDocument;return s?(i=s.documentElement,lt.contains(i,r)?(typeof r.getBoundingClientRect!==Y&&(o=r.getBoundingClientRect()),n=z(s),{top:o.top+(n.pageYOffset||i.scrollTop)-(i.clientTop||0),left:o.left+(n.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}):o):void 0},lt.offset={setOffset:function(t,e,i){var n=lt.css(t,"position");"static"===n&&(t.style.position="relative");var o,r,s=lt(t),a=s.offset(),l=lt.css(t,"top"),c=lt.css(t,"left"),u=("absolute"===n||"fixed"===n)&&lt.inArray("auto",[l,c])>-1,h={},d={};u?(d=s.position(),o=d.top,r=d.left):(o=parseFloat(l)||0,r=parseFloat(c)||0),lt.isFunction(e)&&(e=e.call(t,i,a)),null!=e.top&&(h.top=e.top-a.top+o),null!=e.left&&(h.left=e.left-a.left+r),"using"in e?e.using.call(t,h):s.css(h)}},lt.fn.extend({position:function(){if(this[0]){var t,e,i={top:0,left:0},n=this[0];return"fixed"===lt.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),lt.nodeName(t[0],"html")||(i=t.offset()),i.top+=lt.css(t[0],"borderTopWidth",!0),i.left+=lt.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-lt.css(n,"marginTop",!0),left:e.left-i.left-lt.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||q.documentElement;t&&!lt.nodeName(t,"html")&&"static"===lt.css(t,"position");)t=t.offsetParent;return t||q.documentElement})}}),lt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var n=/Y/.test(i);lt.fn[t]=function(o){return lt.access(this,function(t,o,r){var s=z(t);return r===e?s?i in s?s[i]:s.document.documentElement[o]:t[o]:(s?s.scrollTo(n?lt(s).scrollLeft():r,n?r:lt(s).scrollTop()):t[o]=r,e)},t,o,arguments.length,null)}}),lt.each({Height:"height",Width:"width"},function(t,i){lt.each({padding:"inner"+t,content:i,"":"outer"+t},function(n,o){lt.fn[o]=function(o,r){var s=arguments.length&&(n||"boolean"!=typeof o),a=n||(o===!0||r===!0?"margin":"border");return lt.access(this,function(i,n,o){var r;return lt.isWindow(i)?i.document.documentElement["client"+t]:9===i.nodeType?(r=i.documentElement,Math.max(i.body["scroll"+t],r["scroll"+t],i.body["offset"+t],r["offset"+t],r["client"+t])):o===e?lt.css(i,n,a):lt.style(i,n,o,a)},i,s?o:e,s,null)}})}),t.jQuery=t.$=lt,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return lt})}(window),function(t,e){function i(e,i){var o,r,s,a=e.nodeName.toLowerCase();return"area"===a?(o=e.parentNode,r=o.name,!(!e.href||!r||"map"!==o.nodeName.toLowerCase())&&(s=t("img[usemap=#"+r+"]")[0],!!s&&n(s))):(/input|select|textarea|button|object/.test(a)?!e.disabled:"a"===a?e.href||i:i)&&n(e)}function n(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}var o=0,r=/^ui-id-\d+$/;t.ui=t.ui||{},t.extend(t.ui,{version:"1.10.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({focus:function(e){return function(i,n){return"number"==typeof i?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),n&&n.call(e)},i)}):e.apply(this,arguments)}}(t.fn.focus),scrollParent:function(){var e;return e=t.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(t.css(this,"position"))&&/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?t(document):e},zIndex:function(i){if(i!==e)return this.css("zIndex",i);if(this.length)for(var n,o,r=t(this[0]);r.length&&r[0]!==document;){if(n=r.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(o=parseInt(r.css("zIndex"),10),!isNaN(o)&&0!==o))return o;r=r.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++o)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,n){return!!t.data(e,n[3])},focusable:function(e){return i(e,!isNaN(t.attr(e,"tabindex")))},tabbable:function(e){var n=t.attr(e,"tabindex"),o=isNaN(n);return(o||n>=0)&&i(e,!o)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(i,n){function o(e,i,n,o){return t.each(r,function(){i-=parseFloat(t.css(e,"padding"+this))||0,n&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),o&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var r="Width"===n?["Left","Right"]:["Top","Bottom"],s=n.toLowerCase(),a={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+n]=function(i){return i===e?a["inner"+n].call(this):this.each(function(){t(this).css(s,o(this,i)+"px")})},t.fn["outer"+n]=function(e,i){return"number"!=typeof e?a["outer"+n].call(this,e):this.each(function(){t(this).css(s,o(this,e,!0,i)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.support.selectstart="onselectstart"in document.createElement("div"),t.fn.extend({disableSelection:function(){return this.bind((t.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(t){t.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),t.extend(t.ui,{plugin:{add:function(e,i,n){var o,r=t.ui[e].prototype;for(o in n)r.plugins[o]=r.plugins[o]||[],r.plugins[o].push([i,n[o]])},call:function(t,e,i){var n,o=t.plugins[e];if(o&&t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType)for(n=0;n<o.length;n++)t.options[o[n][0]]&&o[n][1].apply(t.element,i)}},hasScroll:function(e,i){if("hidden"===t(e).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",o=!1;return e[n]>0||(e[n]=1,o=e[n]>0,e[n]=0,o)}})}(jQuery),function(t,e){var i=0,n=Array.prototype.slice,o=t.cleanData;t.cleanData=function(e){for(var i,n=0;null!=(i=e[n]);n++)try{t(i).triggerHandler("remove")}catch(t){}o(e)},t.widget=function(e,i,n){var o,r,s,a,l={},c=e.split(".")[0];e=e.split(".")[1],o=c+"-"+e,n||(n=i,i=t.Widget),t.expr[":"][o.toLowerCase()]=function(e){return!!t.data(e,o)},t[c]=t[c]||{},r=t[c][e],s=t[c][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new s(t,e)},t.extend(s,r,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),a=new i,a.options=t.widget.extend({},a.options),t.each(n,function(e,n){return t.isFunction(n)?void(l[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},o=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,r=this._superApply;return this._super=t,this._superApply=o,e=n.apply(this,arguments),this._super=i,this._superApply=r,e}}()):void(l[e]=n)}),s.prototype=t.widget.extend(a,{widgetEventPrefix:r?a.widgetEventPrefix:e},l,{constructor:s,namespace:c,widgetName:e,widgetFullName:o}),r?(t.each(r._childConstructors,function(e,i){var n=i.prototype;t.widget(n.namespace+"."+n.widgetName,s,i._proto)}),delete r._childConstructors):i._childConstructors.push(s),t.widget.bridge(e,s)},t.widget.extend=function(i){for(var o,r,s=n.call(arguments,1),a=0,l=s.length;a<l;a++)for(o in s[a])r=s[a][o],s[a].hasOwnProperty(o)&&r!==e&&(t.isPlainObject(r)?i[o]=t.isPlainObject(i[o])?t.widget.extend({},i[o],r):t.widget.extend({},r):i[o]=r);return i},t.widget.bridge=function(i,o){var r=o.prototype.widgetFullName||i;t.fn[i]=function(s){var a="string"==typeof s,l=n.call(arguments,1),c=this;return s=!a&&l.length?t.widget.extend.apply(null,[s].concat(l)):s,a?this.each(function(){var n,o=t.data(this,r);return o?t.isFunction(o[s])&&"_"!==s.charAt(0)?(n=o[s].apply(o,l),n!==o&&n!==e?(c=n&&n.jquery?c.pushStack(n.get()):n,!1):void 0):t.error("no such method '"+s+"' for "+i+" widget instance"):t.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+s+"'")}):this.each(function(){var e=t.data(this,r);e?e.option(s||{})._init():t.data(this,r,new o(s,this))}),c}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,n){n=t(n||this.defaultElement||this)[0],this.element=t(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=t(),this.hoverable=t(),this.focusable=t(),n!==this&&(t.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===n&&this.destroy()}}),this.document=t(n.style?n.ownerDocument:n.document||n),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(i,n){var o,r,s,a=i;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof i)if(a={},o=i.split("."),i=o.shift(),o.length){for(r=a[i]=t.widget.extend({},this.options[i]),s=0;s<o.length-1;s++)r[o[s]]=r[o[s]]||{},r=r[o[s]];if(i=o.pop(),n===e)return r[i]===e?null:r[i];r[i]=n}else{if(n===e)return this.options[i]===e?null:this.options[i];a[i]=n}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(e,i,n){var o,r=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=o=t(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,o=this.widget()),t.each(n,function(n,s){function a(){if(e||r.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled"))return("string"==typeof s?r[s]:s).apply(r,arguments)}"string"!=typeof s&&(a.guid=s.guid=s.guid||a.guid||t.guid++);var l=n.match(/^(\w+)\s*(.*)$/),c=l[1]+r.eventNamespace,u=l[2];u?o.delegate(u,c,a):i.bind(c,a)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function i(){return("string"==typeof t?n[t]:t).apply(n,arguments)}var n=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,n){var o,r,s=this.options[e];if(n=n||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],r=i.originalEvent)for(o in r)o in i||(i[o]=r[o]);return this.element.trigger(i,n),!(t.isFunction(s)&&s.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(n,o,r){"string"==typeof o&&(o={effect:o});var s,a=o?o===!0||"number"==typeof o?i:o.effect||i:e;o=o||{},"number"==typeof o&&(o={duration:o}),s=!t.isEmptyObject(o),o.complete=r,o.delay&&n.delay(o.delay),s&&t.effects&&t.effects.effect[a]?n[e](o):a!==e&&n[a]?n[a](o.duration,o.easing,r):n.queue(function(i){t(this)[e](),r&&r.call(n[0]),i()})}})}(jQuery),function(t,e){var i=!1;t(document).mouseup(function(){i=!1}),t.widget("ui.mouse",{version:"1.10.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){if(!0===t.data(i.target,e.widgetName+".preventClickEvent"))return t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!i){this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var n=this,o=1===e.which,r=!("string"!=typeof this.options.cancel||!e.target.nodeName)&&t(e.target).closest(this.options.cancel).length;return!(o&&!r&&this._mouseCapture(e))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(e)!==!1,!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return n._mouseMove(t)},this._mouseUpDelegate=function(t){return n._mouseUp(t)},t(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),i=!0,!0))}},_mouseMove:function(e){return t.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button?this._mouseUp(e):this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(t,e){t.widget("ui.draggable",t.ui.mouse,{version:"1.10.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(e){var i=this.options;return!(this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(e),!!this.handle&&(t(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){t("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(t(this).offset()).appendTo("body")}),!0))},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),i.containment&&this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_mouseDrag:function(e,i){if(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(this._trigger("drag",e,n)===!1)return this._mouseUp({}),!1;this.position=n.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i,n=this,o=!1,r=!1;for(t.ui.ddmanager&&!this.options.dropBehaviour&&(r=t.ui.ddmanager.drop(this,e)),this.dropped&&(r=this.dropped,this.dropped=!1),i=this.element[0];i&&(i=i.parentNode);)i===document&&(o=!0);return!(!o&&"original"===this.options.helper)&&("invalid"===this.options.revert&&!r||"valid"===this.options.revert&&r||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,r)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",e)!==!1&&n._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1)},_mouseUp:function(e){return t("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!t(e.target).closest(this.element.find(this.options.handle)).length},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.element.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()
}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,o=this.options;if("parent"===o.containment&&(o.containment=this.helper[0].parentNode),"document"!==o.containment&&"window"!==o.containment||(this.containment=["document"===o.containment?0:t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"===o.containment?0:t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"===o.containment?0:t(window).scrollLeft())+t("document"===o.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"===o.containment?0:t(window).scrollTop())+(t("document"===o.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||o.containment.constructor===Array)o.containment.constructor===Array&&(this.containment=o.containment);else{if(i=t(o.containment),n=i[0],!n)return;e="hidden"!==t(n).css("overflow"),this.containment=[(parseInt(t(n).css("borderLeftWidth"),10)||0)+(parseInt(t(n).css("paddingLeft"),10)||0),(parseInt(t(n).css("borderTopWidth"),10)||0)+(parseInt(t(n).css("paddingTop"),10)||0),(e?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(t(n).css("borderRightWidth"),10)||0)-(parseInt(t(n).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(t(n).css("borderBottomWidth"),10)||0)-(parseInt(t(n).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=i}},_convertPositionTo:function(e,i){i||(i=this.position);var n="absolute"===e?1:-1,o="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(o[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():r?0:o.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():r?0:o.scrollLeft())*n}},_generatePosition:function(e){var i,n,o,r,s=this.options,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(a[0].tagName),c=e.pageX,u=e.pageY;return this.originalPosition&&(this.containment&&(this.relative_container?(n=this.relative_container.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(c=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(u=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(c=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(u=i[3]+this.offset.click.top)),s.grid&&(o=s.grid[1]?this.originalPageY+Math.round((u-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,u=i?o-this.offset.click.top>=i[1]||o-this.offset.click.top>i[3]?o:o-this.offset.click.top>=i[1]?o-s.grid[1]:o+s.grid[1]:o,r=s.grid[0]?this.originalPageX+Math.round((c-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX,c=i?r-this.offset.click.left>=i[0]||r-this.offset.click.left>i[2]?r:r-this.offset.click.left>=i[0]?r-s.grid[0]:r+s.grid[0]:r)),{top:u-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:c-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(e,i,n){return n=n||this._uiHash(),t.ui.plugin.call(this,e,[i,n]),"drag"===e&&(this.positionAbs=this._convertPositionTo("absolute")),t.Widget.prototype._trigger.call(this,e,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i){var n=t(this).data("ui-draggable"),o=n.options,r=t.extend({},i,{item:n.element});n.sortables=[],t(o.connectToSortable).each(function(){var i=t.data(this,"ui-sortable");i&&!i.options.disabled&&(n.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",e,r))})},stop:function(e,i){var n=t(this).data("ui-draggable"),o=t.extend({},i,{item:n.element});t.each(n.sortables,function(){this.instance.isOver?(this.instance.isOver=0,n.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(e),this.instance.options.helper=this.instance.options._helper,"original"===n.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",e,o))})},drag:function(e,i){var n=t(this).data("ui-draggable"),o=this;t.each(n.sortables,function(){var r=!1,s=this;this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(r=!0,t.each(n.sortables,function(){return this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this!==s&&this.instance._intersectsWith(this.instance.containerCache)&&t.contains(s.instance.element[0],this.instance.element[0])&&(r=!1),r})),r?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=t(o).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},e.target=this.instance.currentItem[0],this.instance._mouseCapture(e,!0),this.instance._mouseStart(e,!0,!0),this.instance.offset.click.top=n.offset.click.top,this.instance.offset.click.left=n.offset.click.left,this.instance.offset.parent.left-=n.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=n.offset.parent.top-this.instance.offset.parent.top,n._trigger("toSortable",e),n.dropped=this.instance.element,n.currentItem=n.element,this.instance.fromOutside=n),this.instance.currentItem&&this.instance._mouseDrag(e)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",e,this.instance._uiHash(this.instance)),this.instance._mouseStop(e,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),n._trigger("fromSortable",e),n.dropped=!1)})}}),t.ui.plugin.add("draggable","cursor",{start:function(){var e=t("body"),i=t(this).data("ui-draggable").options;e.css("cursor")&&(i._cursor=e.css("cursor")),e.css("cursor",i.cursor)},stop:function(){var e=t(this).data("ui-draggable").options;e._cursor&&t("body").css("cursor",e._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i){var n=t(i.helper),o=t(this).data("ui-draggable").options;n.css("opacity")&&(o._opacity=n.css("opacity")),n.css("opacity",o.opacity)},stop:function(e,i){var n=t(this).data("ui-draggable").options;n._opacity&&t(i.helper).css("opacity",n._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(){var e=t(this).data("ui-draggable");e.scrollParent[0]!==document&&"HTML"!==e.scrollParent[0].tagName&&(e.overflowOffset=e.scrollParent.offset())},drag:function(e){var i=t(this).data("ui-draggable"),n=i.options,o=!1;i.scrollParent[0]!==document&&"HTML"!==i.scrollParent[0].tagName?(n.axis&&"x"===n.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-e.pageY<n.scrollSensitivity?i.scrollParent[0].scrollTop=o=i.scrollParent[0].scrollTop+n.scrollSpeed:e.pageY-i.overflowOffset.top<n.scrollSensitivity&&(i.scrollParent[0].scrollTop=o=i.scrollParent[0].scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-e.pageX<n.scrollSensitivity?i.scrollParent[0].scrollLeft=o=i.scrollParent[0].scrollLeft+n.scrollSpeed:e.pageX-i.overflowOffset.left<n.scrollSensitivity&&(i.scrollParent[0].scrollLeft=o=i.scrollParent[0].scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(e.pageY-t(document).scrollTop()<n.scrollSensitivity?o=t(document).scrollTop(t(document).scrollTop()-n.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<n.scrollSensitivity&&(o=t(document).scrollTop(t(document).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(e.pageX-t(document).scrollLeft()<n.scrollSensitivity?o=t(document).scrollLeft(t(document).scrollLeft()-n.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<n.scrollSensitivity&&(o=t(document).scrollLeft(t(document).scrollLeft()+n.scrollSpeed)))),o!==!1&&t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(i,e)}}),t.ui.plugin.add("draggable","snap",{start:function(){var e=t(this).data("ui-draggable"),i=e.options;e.snapElements=[],t(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var i=t(this),n=i.offset();this!==e.element[0]&&e.snapElements.push({item:this,width:i.outerWidth(),height:i.outerHeight(),top:n.top,left:n.left})})},drag:function(e,i){var n,o,r,s,a,l,c,u,h,d,p=t(this).data("ui-draggable"),f=p.options,g=f.snapTolerance,m=i.offset.left,v=m+p.helperProportions.width,y=i.offset.top,_=y+p.helperProportions.height;for(h=p.snapElements.length-1;h>=0;h--)a=p.snapElements[h].left,l=a+p.snapElements[h].width,c=p.snapElements[h].top,u=c+p.snapElements[h].height,a-g<m&&m<l+g&&c-g<y&&y<u+g||a-g<m&&m<l+g&&c-g<_&&_<u+g||a-g<v&&v<l+g&&c-g<y&&y<u+g||a-g<v&&v<l+g&&c-g<_&&_<u+g?("inner"!==f.snapMode&&(n=Math.abs(c-_)<=g,o=Math.abs(u-y)<=g,r=Math.abs(a-v)<=g,s=Math.abs(l-m)<=g,n&&(i.position.top=p._convertPositionTo("relative",{top:c-p.helperProportions.height,left:0}).top-p.margins.top),o&&(i.position.top=p._convertPositionTo("relative",{top:u,left:0}).top-p.margins.top),r&&(i.position.left=p._convertPositionTo("relative",{top:0,left:a-p.helperProportions.width}).left-p.margins.left),s&&(i.position.left=p._convertPositionTo("relative",{top:0,left:l}).left-p.margins.left)),d=n||o||r||s,"outer"!==f.snapMode&&(n=Math.abs(c-y)<=g,o=Math.abs(u-_)<=g,r=Math.abs(a-m)<=g,s=Math.abs(l-v)<=g,n&&(i.position.top=p._convertPositionTo("relative",{top:c,left:0}).top-p.margins.top),o&&(i.position.top=p._convertPositionTo("relative",{top:u-p.helperProportions.height,left:0}).top-p.margins.top),r&&(i.position.left=p._convertPositionTo("relative",{top:0,left:a}).left-p.margins.left),s&&(i.position.left=p._convertPositionTo("relative",{top:0,left:l-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[h].snapping&&(n||o||r||s||d)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,e,t.extend(p._uiHash(),{snapItem:p.snapElements[h].item})),p.snapElements[h].snapping=n||o||r||s||d):(p.snapElements[h].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,e,t.extend(p._uiHash(),{snapItem:p.snapElements[h].item})),p.snapElements[h].snapping=!1)}}),t.ui.plugin.add("draggable","stack",{start:function(){var e,i=this.data("ui-draggable").options,n=t.makeArray(t(i.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});n.length&&(e=parseInt(t(n[0]).css("zIndex"),10)||0,t(n).each(function(i){t(this).css("zIndex",e+i)}),this.css("zIndex",e+n.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i){var n=t(i.helper),o=t(this).data("ui-draggable").options;n.css("zIndex")&&(o._zIndex=n.css("zIndex")),n.css("zIndex",o.zIndex)},stop:function(e,i){var n=t(this).data("ui-draggable").options;n._zIndex&&t(i.helper).css("zIndex",n._zIndex)}})}(jQuery),function(t,e){function i(t,e,i){return t>e&&t<e+i}t.widget("ui.droppable",{version:"1.10.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e=this.options,i=e.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(i)?i:function(t){return t.is(i)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},t.ui.ddmanager.droppables[e.scope]=t.ui.ddmanager.droppables[e.scope]||[],t.ui.ddmanager.droppables[e.scope].push(this),e.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var e=0,i=t.ui.ddmanager.droppables[this.options.scope];e<i.length;e++)i[e]===this&&i.splice(e,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,i){"accept"===e&&(this.accept=t.isFunction(i)?i:function(t){return t.is(i)}),t.Widget.prototype._setOption.apply(this,arguments)},_activate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var n=i||t.ui.ddmanager.current,o=!1;return!(!n||(n.currentItem||n.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var e=t.data(this,"ui-droppable");if(e.options.greedy&&!e.options.disabled&&e.options.scope===n.options.scope&&e.accept.call(e.element[0],n.currentItem||n.element)&&t.ui.intersect(n,t.extend(e,{offset:e.element.offset()}),e.options.tolerance))return o=!0,!1}),!o&&(!!this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(n)),this.element)))},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),t.ui.intersect=function(t,e,n){if(!e.offset)return!1;var o,r,s=(t.positionAbs||t.position.absolute).left,a=s+t.helperProportions.width,l=(t.positionAbs||t.position.absolute).top,c=l+t.helperProportions.height,u=e.offset.left,h=u+e.proportions.width,d=e.offset.top,p=d+e.proportions.height;switch(n){case"fit":return u<=s&&a<=h&&d<=l&&c<=p;case"intersect":return u<s+t.helperProportions.width/2&&a-t.helperProportions.width/2<h&&d<l+t.helperProportions.height/2&&c-t.helperProportions.height/2<p;case"pointer":return o=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,r=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,i(r,d,e.proportions.height)&&i(o,u,e.proportions.width);case"touch":return(l>=d&&l<=p||c>=d&&c<=p||l<d&&c>p)&&(s>=u&&s<=h||a>=u&&a<=h||s<u&&a>h);default:return!1}},t.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,i){var n,o,r=t.ui.ddmanager.droppables[e.options.scope]||[],s=i?i.type:null,a=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(n=0;n<r.length;n++)if(!(r[n].options.disabled||e&&!r[n].accept.call(r[n].element[0],e.currentItem||e.element))){for(o=0;o<a.length;o++)if(a[o]===r[n].element[0]){r[n].proportions.height=0;continue t}r[n].visible="none"!==r[n].element.css("display"),r[n].visible&&("mousedown"===s&&r[n]._activate.call(r[n],i),r[n].offset=r[n].element.offset(),r[n].proportions={width:r[n].element[0].offsetWidth,height:r[n].element[0].offsetHeight})}},drop:function(e,i){var n=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance)&&(n=this._drop.call(this,i)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),n},dragStart:function(e,i){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)})},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,o,r,s=t.ui.intersect(e,this,this.options.tolerance),a=!s&&this.isover?"isout":s&&!this.isover?"isover":null;a&&(this.options.greedy&&(o=this.options.scope,r=this.element.parents(":data(ui-droppable)").filter(function(){return t.data(this,"ui-droppable").options.scope===o}),r.length&&(n=t.data(r[0],"ui-droppable"),n.greedyChild="isover"===a)),n&&"isover"===a&&(n.isover=!1,n.isout=!0,n._out.call(n,i)),this[a]=!0,this["isout"===a?"isover":"isout"]=!1,this["isover"===a?"_over":"_out"].call(this,i),n&&"isout"===a&&(n.isout=!1,n.isover=!0,n._over.call(n,i)))}})},dragStop:function(e,i){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}}}(jQuery),function(t,e){function i(t){return parseInt(t,10)||0}function n(t){return!isNaN(parseInt(t,10))}t.widget("ui.resizable",t.ui.mouse,{version:"1.10.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var e,i,n,o,r,s=this,a=this.options;if(this.element.addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=a.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),e=this.handles.split(","),this.handles={},i=0;i<e.length;i++)n=t.trim(e[i]),r="ui-resizable-"+n,o=t("<div class='ui-resizable-handle "+r+"'></div>"),o.css({zIndex:a.zIndex}),"se"===n&&o.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[n]=".ui-resizable-"+n,this.element.append(o);this._renderAxis=function(e){var i,n,o,r;e=e||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=t(this.handles[i],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(n=t(this.handles[i],this.element),r=/sw|ne|nw|se|n|s/.test(i)?n.outerHeight():n.outerWidth(),o=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),e.css(o,r),this._proportionallyResize()),t(this.handles[i]).length},this._renderAxis(this.element),this._handles=t(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){s.resizing||(this.className&&(o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),s.axis=o&&o[1]?o[1]:"se")}),a.autoHide&&(this._handles.hide(),t(this.element).addClass("ui-resizable-autohide").mouseenter(function(){a.disabled||(t(this).removeClass("ui-resizable-autohide"),s._handles.show())}).mouseleave(function(){a.disabled||s.resizing||(t(this).addClass("ui-resizable-autohide"),s._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,i=function(e){t(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(e){var i,n,o=!1;for(i in this.handles)n=t(this.handles[i])[0],(n===e.target||t.contains(n,e.target))&&(o=!0);return!this.options.disabled&&o},_mouseStart:function(e){var n,o,r,s=this.options,a=this.element.position(),l=this.element;return this.resizing=!0,/absolute/.test(l.css("position"))?l.css({position:"absolute",top:l.css("top"),left:l.css("left")}):l.is(".ui-draggable")&&l.css({position:"absolute",top:a.top,left:a.left}),this._renderProxy(),n=i(this.helper.css("left")),o=i(this.helper.css("top")),s.containment&&(n+=t(s.containment).scrollLeft()||0,o+=t(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:n,top:o},this.size=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:{width:l.width(),height:l.height()},this.originalSize=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:{width:l.width(),height:l.height()},this.originalPosition={left:n,top:o},this.sizeDiff={width:l.outerWidth()-l.width(),height:l.outerHeight()-l.height()},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof s.aspectRatio?s.aspectRatio:this.originalSize.width/this.originalSize.height||1,r=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===r?this.axis+"-resize":r),l.addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var i,n=this.helper,o={},r=this.originalMousePosition,s=this.axis,a=this.position.top,l=this.position.left,c=this.size.width,u=this.size.height,h=e.pageX-r.left||0,d=e.pageY-r.top||0,p=this._change[s];return!!p&&(i=p.apply(this,[e,h,d]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(i=this._updateRatio(i,e)),i=this._respectSize(i,e),this._updateCache(i),this._propagate("resize",e),this.position.top!==a&&(o.top=this.position.top+"px"),this.position.left!==l&&(o.left=this.position.left+"px"),this.size.width!==c&&(o.width=this.size.width+"px"),this.size.height!==u&&(o.height=this.size.height+"px"),n.css(o),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(o)||this._trigger("resize",e,this.ui()),!1)},_mouseStop:function(e){this.resizing=!1;var i,n,o,r,s,a,l,c=this.options,u=this;return this._helper&&(i=this._proportionallyResizeElements,n=i.length&&/textarea/i.test(i[0].nodeName),o=n&&t.ui.hasScroll(i[0],"left")?0:u.sizeDiff.height,r=n?0:u.sizeDiff.width,s={width:u.helper.width()-r,height:u.helper.height()-o},a=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,l=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,c.animate||this.element.css(t.extend(s,{top:l,left:a})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!c.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(t){var e,i,o,r,s,a=this.options;s={minWidth:n(a.minWidth)?a.minWidth:0,maxWidth:n(a.maxWidth)?a.maxWidth:1/0,minHeight:n(a.minHeight)?a.minHeight:0,maxHeight:n(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||t)&&(e=s.minHeight*this.aspectRatio,o=s.minWidth/this.aspectRatio,i=s.maxHeight*this.aspectRatio,r=s.maxWidth/this.aspectRatio,e>s.minWidth&&(s.minWidth=e),o>s.minHeight&&(s.minHeight=o),i<s.maxWidth&&(s.maxWidth=i),r<s.maxHeight&&(s.maxHeight=r)),this._vBoundaries=s},_updateCache:function(t){this.offset=this.helper.offset(),n(t.left)&&(this.position.left=t.left),n(t.top)&&(this.position.top=t.top),n(t.height)&&(this.size.height=t.height),n(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,i=this.size,o=this.axis;return n(t.height)?t.width=t.height*this.aspectRatio:n(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===o&&(t.left=e.left+(i.width-t.width),t.top=null),"nw"===o&&(t.top=e.top+(i.height-t.height),t.left=e.left+(i.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,i=this.axis,o=n(t.width)&&e.maxWidth&&e.maxWidth<t.width,r=n(t.height)&&e.maxHeight&&e.maxHeight<t.height,s=n(t.width)&&e.minWidth&&e.minWidth>t.width,a=n(t.height)&&e.minHeight&&e.minHeight>t.height,l=this.originalPosition.left+this.originalSize.width,c=this.position.top+this.size.height,u=/sw|nw|w/.test(i),h=/nw|ne|n/.test(i);return s&&(t.width=e.minWidth),a&&(t.height=e.minHeight),o&&(t.width=e.maxWidth),r&&(t.height=e.maxHeight),s&&u&&(t.left=l-e.minWidth),o&&u&&(t.left=l-e.maxWidth),a&&h&&(t.top=c-e.minHeight),r&&h&&(t.top=c-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var t,e,i,n,o,r=this.helper||this.element;for(t=0;t<this._proportionallyResizeElements.length;t++){if(o=this._proportionallyResizeElements[t],!this.borderDif)for(this.borderDif=[],i=[o.css("borderTopWidth"),o.css("borderRightWidth"),o.css("borderBottomWidth"),o.css("borderLeftWidth")],n=[o.css("paddingTop"),o.css("paddingRight"),o.css("paddingBottom"),o.css("paddingLeft")],e=0;e<i.length;e++)this.borderDif[e]=(parseInt(i[e],10)||0)+(parseInt(n[e],10)||0);o.css({height:r.height()-this.borderDif[0]-this.borderDif[2]||0,width:r.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var e=this.element,i=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize,n=this.originalPosition;return{left:n.left+e,width:i.width-e}},n:function(t,e,i){var n=this.originalSize,o=this.originalPosition;return{top:o.top+i,height:n.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(e,i,n){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,i,n]))},sw:function(e,i,n){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,i,n]))},ne:function(e,i,n){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,i,n]))},nw:function(e,i,n){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,i,n]))}},_propagate:function(e,i){t.ui.plugin.call(this,e,[i,this.ui()]),"resize"!==e&&this._trigger(e,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var i=t(this).data("ui-resizable"),n=i.options,o=i._proportionallyResizeElements,r=o.length&&/textarea/i.test(o[0].nodeName),s=r&&t.ui.hasScroll(o[0],"left")?0:i.sizeDiff.height,a=r?0:i.sizeDiff.width,l={width:i.size.width-a,height:i.size.height-s},c=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,u=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(t.extend(l,u&&c?{top:u,left:c}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var n={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};o&&o.length&&t(o[0]).css({width:n.width,height:n.height}),i._updateCache(n),i._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var e,n,o,r,s,a,l,c=t(this).data("ui-resizable"),u=c.options,h=c.element,d=u.containment,p=d instanceof t?d.get(0):/parent/.test(d)?h.parent().get(0):d;p&&(c.containerElement=t(p),/document/.test(d)||d===document?(c.containerOffset={left:0,top:0},c.containerPosition={left:0,top:0},c.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(e=t(p),n=[],t(["Top","Right","Left","Bottom"]).each(function(t,o){n[t]=i(e.css("padding"+o))}),c.containerOffset=e.offset(),c.containerPosition=e.position(),c.containerSize={height:e.innerHeight()-n[3],width:e.innerWidth()-n[1]},o=c.containerOffset,r=c.containerSize.height,s=c.containerSize.width,a=t.ui.hasScroll(p,"left")?p.scrollWidth:s,l=t.ui.hasScroll(p)?p.scrollHeight:r,c.parentData={element:p,left:o.left,top:o.top,width:a,height:l}))},resize:function(e){var i,n,o,r,s=t(this).data("ui-resizable"),a=s.options,l=s.containerOffset,c=s.position,u=s._aspectRatio||e.shiftKey,h={top:0,left:0},d=s.containerElement;d[0]!==document&&/static/.test(d.css("position"))&&(h=l),c.left<(s._helper?l.left:0)&&(s.size.width=s.size.width+(s._helper?s.position.left-l.left:s.position.left-h.left),u&&(s.size.height=s.size.width/s.aspectRatio),s.position.left=a.helper?l.left:0),c.top<(s._helper?l.top:0)&&(s.size.height=s.size.height+(s._helper?s.position.top-l.top:s.position.top),u&&(s.size.width=s.size.height*s.aspectRatio),s.position.top=s._helper?l.top:0),s.offset.left=s.parentData.left+s.position.left,s.offset.top=s.parentData.top+s.position.top,i=Math.abs((s._helper?s.offset.left-h.left:s.offset.left-h.left)+s.sizeDiff.width),n=Math.abs((s._helper?s.offset.top-h.top:s.offset.top-l.top)+s.sizeDiff.height),
o=s.containerElement.get(0)===s.element.parent().get(0),r=/relative|absolute/.test(s.containerElement.css("position")),o&&r&&(i-=s.parentData.left),i+s.size.width>=s.parentData.width&&(s.size.width=s.parentData.width-i,u&&(s.size.height=s.size.width/s.aspectRatio)),n+s.size.height>=s.parentData.height&&(s.size.height=s.parentData.height-n,u&&(s.size.width=s.size.height*s.aspectRatio))},stop:function(){var e=t(this).data("ui-resizable"),i=e.options,n=e.containerOffset,o=e.containerPosition,r=e.containerElement,s=t(e.helper),a=s.offset(),l=s.outerWidth()-e.sizeDiff.width,c=s.outerHeight()-e.sizeDiff.height;e._helper&&!i.animate&&/relative/.test(r.css("position"))&&t(this).css({left:a.left-o.left-n.left,width:l,height:c}),e._helper&&!i.animate&&/static/.test(r.css("position"))&&t(this).css({left:a.left-o.left-n.left,width:l,height:c})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).data("ui-resizable"),i=e.options,n=function(e){t(e).each(function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?n(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],n(i.alsoResize)):t.each(i.alsoResize,function(t){n(t)})},resize:function(e,i){var n=t(this).data("ui-resizable"),o=n.options,r=n.originalSize,s=n.originalPosition,a={height:n.size.height-r.height||0,width:n.size.width-r.width||0,top:n.position.top-s.top||0,left:n.position.left-s.left||0},l=function(e,n){t(e).each(function(){var e=t(this),o=t(this).data("ui-resizable-alsoresize"),r={},s=n&&n.length?n:e.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(s,function(t,e){var i=(o[e]||0)+(a[e]||0);i&&i>=0&&(r[e]=i||null)}),e.css(r)})};"object"!=typeof o.alsoResize||o.alsoResize.nodeType?l(o.alsoResize):t.each(o.alsoResize,function(t,e){l(t,e)})},stop:function(){t(this).removeData("resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).data("ui-resizable"),i=e.options,n=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).data("ui-resizable");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).data("ui-resizable");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e=t(this).data("ui-resizable"),i=e.options,n=e.size,o=e.originalSize,r=e.originalPosition,s=e.axis,a="number"==typeof i.grid?[i.grid,i.grid]:i.grid,l=a[0]||1,c=a[1]||1,u=Math.round((n.width-o.width)/l)*l,h=Math.round((n.height-o.height)/c)*c,d=o.width+u,p=o.height+h,f=i.maxWidth&&i.maxWidth<d,g=i.maxHeight&&i.maxHeight<p,m=i.minWidth&&i.minWidth>d,v=i.minHeight&&i.minHeight>p;i.grid=a,m&&(d+=l),v&&(p+=c),f&&(d-=l),g&&(p-=c),/^(se|s|e)$/.test(s)?(e.size.width=d,e.size.height=p):/^(ne)$/.test(s)?(e.size.width=d,e.size.height=p,e.position.top=r.top-h):/^(sw)$/.test(s)?(e.size.width=d,e.size.height=p,e.position.left=r.left-u):(e.size.width=d,e.size.height=p,e.position.top=r.top-h,e.position.left=r.left-u)}})}(jQuery),function(t,e){t.widget("ui.selectable",t.ui.mouse,{version:"1.10.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){e=t(i.options.filter,i.element[0]),e.addClass("ui-selectee"),e.each(function(){var e=t(this),i=e.offset();t.data(this,"selectable-item",{element:this,$element:e,left:i.left,top:i.top,right:i.left+e.outerWidth(),bottom:i.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=e.addClass("ui-selectee"),this._mouseInit(),this.helper=t("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(e){var i=this,n=this.options;this.opos=[e.pageX,e.pageY],this.options.disabled||(this.selectees=t(n.filter,this.element[0]),this._trigger("start",e),t(n.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),n.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var n=t.data(this,"selectable-item");n.startselected=!0,e.metaKey||e.ctrlKey||(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,i._trigger("unselecting",e,{unselecting:n.element}))}),t(e.target).parents().addBack().each(function(){var n,o=t.data(this,"selectable-item");if(o)return n=!e.metaKey&&!e.ctrlKey||!o.$element.hasClass("ui-selected"),o.$element.removeClass(n?"ui-unselecting":"ui-selected").addClass(n?"ui-selecting":"ui-unselecting"),o.unselecting=!n,o.selecting=n,o.selected=n,n?i._trigger("selecting",e,{selecting:o.element}):i._trigger("unselecting",e,{unselecting:o.element}),!1}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var i,n=this,o=this.options,r=this.opos[0],s=this.opos[1],a=e.pageX,l=e.pageY;return r>a&&(i=a,a=r,r=i),s>l&&(i=l,l=s,s=i),this.helper.css({left:r,top:s,width:a-r,height:l-s}),this.selectees.each(function(){var i=t.data(this,"selectable-item"),c=!1;i&&i.element!==n.element[0]&&("touch"===o.tolerance?c=!(i.left>a||i.right<r||i.top>l||i.bottom<s):"fit"===o.tolerance&&(c=i.left>r&&i.right<a&&i.top>s&&i.bottom<l),c?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,n._trigger("selecting",e,{selecting:i.element}))):(i.selecting&&((e.metaKey||e.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),n._trigger("unselecting",e,{unselecting:i.element}))),i.selected&&(e.metaKey||e.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",e,{unselecting:i.element})))))}),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,t(".ui-unselecting",this.element[0]).each(function(){var n=t.data(this,"selectable-item");n.$element.removeClass("ui-unselecting"),n.unselecting=!1,n.startselected=!1,i._trigger("unselected",e,{unselected:n.element})}),t(".ui-selecting",this.element[0]).each(function(){var n=t.data(this,"selectable-item");n.$element.removeClass("ui-selecting").addClass("ui-selected"),n.selecting=!1,n.selected=!0,n.startselected=!0,i._trigger("selected",e,{selected:n.element})}),this._trigger("stop",e),this.helper.remove(),!1}})}(jQuery),function(t,e){function i(t,e,i){return t>e&&t<e+i}function n(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))}t.widget("ui.sortable",t.ui.mouse,{version:"1.10.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var t=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=!!this.items.length&&("x"===t.axis||n(this.items[0].item)),this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_setOption:function(e,i){"disabled"===e?(this.options[e]=i,this.widget().toggleClass("ui-sortable-disabled",!!i)):t.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(e,i){var n=null,o=!1,r=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(e),t(e.target).parents().each(function(){if(t.data(this,r.widgetName+"-item")===r)return n=t(this),!1}),t.data(e.target,r.widgetName+"-item")===r&&(n=t(e.target)),!!n&&(!(this.options.handle&&!i&&(t(this.options.handle,n).find("*").addBack().each(function(){this===e.target&&(o=!0)}),!o))&&(this.currentItem=n,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(e,i,n){var o,r,s=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,s.cursorAt&&this._adjustOffsetFromHelper(s.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),s.containment&&this._setContainment(),s.cursor&&"auto"!==s.cursor&&(r=this.document.find("body"),this.storedCursor=r.css("cursor"),r.css("cursor",s.cursor),this.storedStylesheet=t("<style>*{ cursor: "+s.cursor+" !important; }</style>").appendTo(r)),s.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",s.opacity)),s.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",s.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(o=this.containers.length-1;o>=0;o--)this.containers[o]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!s.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,n,o,r,s=this.options,a=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<s.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+s.scrollSpeed:e.pageY-this.overflowOffset.top<s.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-s.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<s.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+s.scrollSpeed:e.pageX-this.overflowOffset.left<s.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-s.scrollSpeed)):(e.pageY-t(document).scrollTop()<s.scrollSensitivity?a=t(document).scrollTop(t(document).scrollTop()-s.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<s.scrollSensitivity&&(a=t(document).scrollTop(t(document).scrollTop()+s.scrollSpeed)),e.pageX-t(document).scrollLeft()<s.scrollSensitivity?a=t(document).scrollLeft(t(document).scrollLeft()-s.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<s.scrollSensitivity&&(a=t(document).scrollLeft(t(document).scrollLeft()+s.scrollSpeed))),a!==!1&&t.ui.ddmanager&&!s.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(n=this.items[i],o=n.item[0],r=this._intersectsWithPointer(n),r&&n.instance===this.currentContainer&&!(o===this.currentItem[0]||this.placeholder[1===r?"next":"prev"]()[0]===o||t.contains(this.placeholder[0],o)||"semi-dynamic"===this.options.type&&t.contains(this.element[0],o))){if(this.direction=1===r?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(e,n),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var n=this,o=this.placeholder.offset(),r=this.options.axis,s={};r&&"x"!==r||(s.left=o.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),r&&"y"!==r||(s.top=o.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(s,parseInt(this.options.revert,10)||500,function(){n._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&n.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!n.length&&e.key&&n.push(e.key+"="),n.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},i.each(function(){n.push(t(e.item||this).attr(e.attribute||"id")||"")}),n},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,n=this.positionAbs.top,o=n+this.helperProportions.height,r=t.left,s=r+t.width,a=t.top,l=a+t.height,c=this.offset.click.top,u=this.offset.click.left,h=n+c>a&&n+c<l&&e+u>r&&e+u<s;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?h:r<e+this.helperProportions.width/2&&i-this.helperProportions.width/2<s&&a<n+this.helperProportions.height/2&&o-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var e="x"===this.options.axis||i(this.positionAbs.top+this.offset.click.top,t.top,t.height),n="y"===this.options.axis||i(this.positionAbs.left+this.offset.click.left,t.left,t.width),o=e&&n,r=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return!!o&&(this.floating?s&&"right"===s||"down"===r?2:1:r&&("down"===r?2:1))},_intersectsWithSides:function(t){var e=i(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),n=i(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),o=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return this.floating&&r?"right"===r&&n||"left"===r&&!n:o&&("down"===o&&e||"up"===o&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){var i,n,o,r,s=[],a=[],l=this._connectWith();if(l&&e)for(i=l.length-1;i>=0;i--)for(o=t(l[i]),n=o.length-1;n>=0;n--)r=t.data(o[n],this.widgetFullName),r&&r!==this&&!r.options.disabled&&a.push([t.isFunction(r.options.items)?r.options.items.call(r.element):t(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r]);for(a.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=a.length-1;i>=0;i--)a[i][0].each(function(){s.push(this)});return t(s)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;i<e.length;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,n,o,r,s,a,l,c,u=this.items,h=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(o=t(d[i]),n=o.length-1;n>=0;n--)r=t.data(o[n],this.widgetFullName),r&&r!==this&&!r.options.disabled&&(h.push([t.isFunction(r.options.items)?r.options.items.call(r.element[0],e,{item:this.currentItem}):t(r.options.items,r.element),r]),this.containers.push(r));for(i=h.length-1;i>=0;i--)for(s=h[i][1],a=h[i][0],n=0,c=a.length;n<c;n++)l=t(a[n]),l.data(this.widgetName+"-item",s),u.push({item:l,instance:s,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,n,o,r;for(i=this.items.length-1;i>=0;i--)n=this.items[i],n.instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(o=this.options.toleranceElement?t(this.options.toleranceElement,n.item):n.item,e||(n.width=o.outerWidth(),n.height=o.outerHeight()),r=o.offset(),n.left=r.left,n.top=r.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)r=this.containers[i].element.offset(),this.containers[i].containerCache.left=r.left,this.containers[i].containerCache.top=r.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,n=e.options;n.placeholder&&n.placeholder.constructor!==String||(i=n.placeholder,n.placeholder={element:function(){var n=e.currentItem[0].nodeName.toLowerCase(),o=t(e.document[0].createElement(n)).addClass(i||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===n?o.append("<td colspan='99'>&#160;</td>"):"img"===n&&o.attr("src",e.currentItem.attr("src")),i||o.css("visibility","hidden"),o},update:function(t,o){i&&!n.forcePlaceholderSize||(o.height()||o.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),o.width()||o.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(n.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),n.placeholder.update(e,e.placeholder)},_contactContainers:function(e){var o,r,s,a,l,c,u,h,d,p,f=null,g=null;for(o=this.containers.length-1;o>=0;o--)if(!t.contains(this.currentItem[0],this.containers[o].element[0]))if(this._intersectsWith(this.containers[o].containerCache)){if(f&&t.contains(this.containers[o].element[0],f.element[0]))continue;f=this.containers[o],g=o}else this.containers[o].containerCache.over&&(this.containers[o]._trigger("out",e,this._uiHash(this)),this.containers[o].containerCache.over=0);if(f)if(1===this.containers.length)this.containers[g].containerCache.over||(this.containers[g]._trigger("over",e,this._uiHash(this)),this.containers[g].containerCache.over=1);else{for(s=1e4,a=null,p=f.floating||n(this.currentItem),l=p?"left":"top",c=p?"width":"height",u=this.positionAbs[l]+this.offset.click[l],r=this.items.length-1;r>=0;r--)t.contains(this.containers[g].element[0],this.items[r].item[0])&&this.items[r].item[0]!==this.currentItem[0]&&(p&&!i(this.positionAbs.top+this.offset.click.top,this.items[r].top,this.items[r].height)||(h=this.items[r].item.offset()[l],d=!1,Math.abs(h-u)>Math.abs(h+this.items[r][c]-u)&&(d=!0,h+=this.items[r][c]),Math.abs(h-u)<s&&(s=Math.abs(h-u),a=this.items[r],this.direction=d?"up":"down")));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[g])return;a?this._rearrange(e,a,null,!0):this._rearrange(e,null,this.containers[g].element,!0),this._trigger("change",e,this._uiHash()),this.containers[g]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[g],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[g]._trigger("over",e,this._uiHash(this)),this.containers[g].containerCache.over=1}},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),n[0].style.width&&!i.forceHelperSize||n.width(this.currentItem.width()),n[0].style.height&&!i.forceHelperSize||n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,o=this.options;"parent"===o.containment&&(o.containment=this.helper[0].parentNode),"document"!==o.containment&&"window"!==o.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,t("document"===o.containment?document:window).width()-this.helperProportions.width-this.margins.left,(t("document"===o.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||(e=t(o.containment)[0],i=t(o.containment).offset(),n="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(n?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(n?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var n="absolute"===e?1:-1,o="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(o[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():r?0:o.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():r?0:o.scrollLeft())*n}},_generatePosition:function(e){var i,n,o=this.options,r=e.pageX,s=e.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(s=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(s=this.containment[3]+this.offset.click.top)),o.grid&&(i=this.originalPageY+Math.round((s-this.originalPageY)/o.grid[1])*o.grid[1],s=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-o.grid[1]:i+o.grid[1]:i,n=this.originalPageX+Math.round((r-this.originalPageX)/o.grid[0])*o.grid[0],r=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-o.grid[0]:n+o.grid[0]:n)),{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}},_rearrange:function(t,e,i,n){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var o=this.counter;this._delay(function(){o===this.counter&&this.refreshPositions(!n)})},_clear:function(t,e){this.reverting=!1;var i,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)"auto"!==this._storedCSS[i]&&"static"!==this._storedCSS[i]||(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&n.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||n.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(n.push(function(t){this._trigger("remove",t,this._uiHash())}),n.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)e||n.push(function(t){return function(e){t._trigger("deactivate",e,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over&&(n.push(function(t){return function(e){t._trigger("out",e,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!e){for(this._trigger("beforeStop",t,this._uiHash()),i=0;i<n.length;i++)n[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}if(e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!e){for(i=0;i<n.length;i++)n[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}})}(jQuery),function(t,e){var i="ui-effects-";t.effects={effect:{}},function(t,e){function i(t,e,i){var n=h[e.type]||{};return null==t?i||!e.def?null:e.def:(t=n.floor?~~t:parseFloat(t),isNaN(t)?e.def:n.mod?(t+n.mod)%n.mod:0>t?0:n.max<t?n.max:t)}function n(e){var i=c(),n=i._rgba=[];return e=e.toLowerCase(),f(l,function(t,o){var r,s=o.re.exec(e),a=s&&o.parse(s),l=o.space||"rgba";if(a)return r=i[l](a),i[u[l].cache]=r[u[l].cache],n=i._rgba=r._rgba,!1}),n.length?("0,0,0,0"===n.join()&&t.extend(n,r.transparent),i):r[e]}function o(t,e,i){return i=(i+1)%1,6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}var r,s="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",a=/^([\-+])=\s*(\d+\.?\d*)/,l=[{
re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],c=t.Color=function(e,i,n,o){return new t.Color.fn.parse(e,i,n,o)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},h={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},d=c.support={},p=t("<p>")[0],f=t.each;p.style.cssText="background-color:rgba(1,1,1,.5)",d.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(u,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),c.fn=t.extend(c.prototype,{parse:function(o,s,a,l){if(o===e)return this._rgba=[null,null,null,null],this;(o.jquery||o.nodeType)&&(o=t(o).css(s),s=e);var h=this,d=t.type(o),p=this._rgba=[];return s!==e&&(o=[o,s,a,l],d="array"),"string"===d?this.parse(n(o)||r._default):"array"===d?(f(u.rgba.props,function(t,e){p[e.idx]=i(o[e.idx],e)}),this):"object"===d?(o instanceof c?f(u,function(t,e){o[e.cache]&&(h[e.cache]=o[e.cache].slice())}):f(u,function(e,n){var r=n.cache;f(n.props,function(t,e){if(!h[r]&&n.to){if("alpha"===t||null==o[t])return;h[r]=n.to(h._rgba)}h[r][e.idx]=i(o[t],e,!0)}),h[r]&&t.inArray(null,h[r].slice(0,3))<0&&(h[r][3]=1,n.from&&(h._rgba=n.from(h[r])))}),this):void 0},is:function(t){var e=c(t),i=!0,n=this;return f(u,function(t,o){var r,s=e[o.cache];return s&&(r=n[o.cache]||o.to&&o.to(n._rgba)||[],f(o.props,function(t,e){if(null!=s[e.idx])return i=s[e.idx]===r[e.idx]})),i}),i},_space:function(){var t=[],e=this;return f(u,function(i,n){e[n.cache]&&t.push(i)}),t.pop()},transition:function(t,e){var n=c(t),o=n._space(),r=u[o],s=0===this.alpha()?c("transparent"):this,a=s[r.cache]||r.to(s._rgba),l=a.slice();return n=n[r.cache],f(r.props,function(t,o){var r=o.idx,s=a[r],c=n[r],u=h[o.type]||{};null!==c&&(null===s?l[r]=c:(u.mod&&(c-s>u.mod/2?s+=u.mod:s-c>u.mod/2&&(s-=u.mod)),l[r]=i((c-s)*e+s,o)))}),this[o](l)},blend:function(e){if(1===this._rgba[3])return this;var i=this._rgba.slice(),n=i.pop(),o=c(e)._rgba;return c(t.map(i,function(t,e){return(1-n)*o[e]+n*t}))},toRgbaString:function(){var e="rgba(",i=t.map(this._rgba,function(t,e){return null==t?e>2?1:0:t});return 1===i[3]&&(i.pop(),e="rgb("),e+i.join()+")"},toHslaString:function(){var e="hsla(",i=t.map(this.hsla(),function(t,e){return null==t&&(t=e>2?1:0),e&&e<3&&(t=Math.round(100*t)+"%"),t});return 1===i[3]&&(i.pop(),e="hsl("),e+i.join()+")"},toHexString:function(e){var i=this._rgba.slice(),n=i.pop();return e&&i.push(~~(255*n)),"#"+t.map(i,function(t){return t=(t||0).toString(16),1===t.length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),c.fn.parse.prototype=c.fn,u.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,i,n=t[0]/255,o=t[1]/255,r=t[2]/255,s=t[3],a=Math.max(n,o,r),l=Math.min(n,o,r),c=a-l,u=a+l,h=.5*u;return e=l===a?0:n===a?60*(o-r)/c+360:o===a?60*(r-n)/c+120:60*(n-o)/c+240,i=0===c?0:h<=.5?c/u:c/(2-u),[Math.round(e)%360,i,h,null==s?1:s]},u.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],n=t[2],r=t[3],s=n<=.5?n*(1+i):n+i-n*i,a=2*n-s;return[Math.round(255*o(a,s,e+1/3)),Math.round(255*o(a,s,e)),Math.round(255*o(a,s,e-1/3)),r]},f(u,function(n,o){var r=o.props,s=o.cache,l=o.to,u=o.from;c.fn[n]=function(n){if(l&&!this[s]&&(this[s]=l(this._rgba)),n===e)return this[s].slice();var o,a=t.type(n),h="array"===a||"object"===a?n:arguments,d=this[s].slice();return f(r,function(t,e){var n=h["object"===a?t:e.idx];null==n&&(n=d[e.idx]),d[e.idx]=i(n,e)}),u?(o=c(u(d)),o[s]=d,o):c(d)},f(r,function(e,i){c.fn[e]||(c.fn[e]=function(o){var r,s=t.type(o),l="alpha"===e?this._hsla?"hsla":"rgba":n,c=this[l](),u=c[i.idx];return"undefined"===s?u:("function"===s&&(o=o.call(this,u),s=t.type(o)),null==o&&i.empty?this:("string"===s&&(r=a.exec(o),r&&(o=u+parseFloat(r[2])*("+"===r[1]?1:-1))),c[i.idx]=o,this[l](c)))})})}),c.hook=function(e){var i=e.split(" ");f(i,function(e,i){t.cssHooks[i]={set:function(e,o){var r,s,a="";if("transparent"!==o&&("string"!==t.type(o)||(r=n(o)))){if(o=c(r||o),!d.rgba&&1!==o._rgba[3]){for(s="backgroundColor"===i?e.parentNode:e;(""===a||"transparent"===a)&&s&&s.style;)try{a=t.css(s,"backgroundColor"),s=s.parentNode}catch(t){}o=o.blend(a&&"transparent"!==a?a:"_default")}o=o.toRgbaString()}try{e.style[i]=o}catch(t){}}},t.fx.step[i]=function(e){e.colorInit||(e.start=c(e.elem,i),e.end=c(e.end),e.colorInit=!0),t.cssHooks[i].set(e.elem,e.start.transition(e.end,e.pos))}})},c.hook(s),t.cssHooks.borderColor={expand:function(t){var e={};return f(["Top","Right","Bottom","Left"],function(i,n){e["border"+n+"Color"]=t}),e}},r=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function i(e){var i,n,o=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,r={};if(o&&o.length&&o[0]&&o[o[0]])for(n=o.length;n--;)i=o[n],"string"==typeof o[i]&&(r[t.camelCase(i)]=o[i]);else for(i in o)"string"==typeof o[i]&&(r[i]=o[i]);return r}function n(e,i){var n,o,s={};for(n in i)o=i[n],e[n]!==o&&(r[n]||!t.fx.step[n]&&isNaN(parseFloat(o))||(s[n]=o));return s}var o=["add","remove","toggle"],r={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,i){t.fx.step[i]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(jQuery.style(t.elem,i,t.end),t.setAttr=!0)}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(e,r,s,a){var l=t.speed(r,s,a);return this.queue(function(){var r,s=t(this),a=s.attr("class")||"",c=l.children?s.find("*").addBack():s;c=c.map(function(){var e=t(this);return{el:e,start:i(this)}}),r=function(){t.each(o,function(t,i){e[i]&&s[i+"Class"](e[i])})},r(),c=c.map(function(){return this.end=i(this.el[0]),this.diff=n(this.start,this.end),this}),s.attr("class",a),c=c.map(function(){var e=this,i=t.Deferred(),n=t.extend({},l,{queue:!1,complete:function(){i.resolve(e)}});return this.el.animate(this.diff,n),i.promise()}),t.when.apply(t,c.get()).done(function(){r(),t.each(arguments,function(){var e=this.el;t.each(this.diff,function(t){e.css(t,"")})}),l.complete.call(s[0])})})},t.fn.extend({addClass:function(e){return function(i,n,o,r){return n?t.effects.animateClass.call(this,{add:i},n,o,r):e.apply(this,arguments)}}(t.fn.addClass),removeClass:function(e){return function(i,n,o,r){return arguments.length>1?t.effects.animateClass.call(this,{remove:i},n,o,r):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(i){return function(n,o,r,s,a){return"boolean"==typeof o||o===e?r?t.effects.animateClass.call(this,o?{add:n}:{remove:n},r,s,a):i.apply(this,arguments):t.effects.animateClass.call(this,{toggle:n},o,r,s)}}(t.fn.toggleClass),switchClass:function(e,i,n,o,r){return t.effects.animateClass.call(this,{add:i,remove:e},n,o,r)}})}(),function(){function n(e,i,n,o){return t.isPlainObject(e)&&(i=e,e=e.effect),e={effect:e},null==i&&(i={}),t.isFunction(i)&&(o=i,n=null,i={}),("number"==typeof i||t.fx.speeds[i])&&(o=n,n=i,i={}),t.isFunction(n)&&(o=n,n=null),i&&t.extend(e,i),n=n||i.duration,e.duration=t.fx.off?0:"number"==typeof n?n:n in t.fx.speeds?t.fx.speeds[n]:t.fx.speeds._default,e.complete=o||i.complete,e}function o(e){return!(e&&"number"!=typeof e&&!t.fx.speeds[e])||("string"==typeof e&&!t.effects.effect[e]||(!!t.isFunction(e)||"object"==typeof e&&!e.effect))}t.extend(t.effects,{version:"1.10.2",save:function(t,e){for(var n=0;n<e.length;n++)null!==e[n]&&t.data(i+e[n],t[0].style[e[n]])},restore:function(t,n){var o,r;for(r=0;r<n.length;r++)null!==n[r]&&(o=t.data(i+n[r]),o===e&&(o=""),t.css(n[r],o))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var i,n;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=t[1]/e.width}return{x:n,y:i}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var i={width:e.outerWidth(!0),height:e.outerHeight(!0),float:e.css("float")},n=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),o={width:e.width(),height:e.height()},r=document.activeElement;try{r.id}catch(t){r=document.body}return e.wrap(n),(e[0]===r||t.contains(e[0],r))&&t(r).focus(),n=e.parent(),"static"===e.css("position")?(n.css({position:"relative"}),e.css({position:"relative"})):(t.extend(i,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],function(t,n){i[n]=e.css(n),isNaN(parseInt(i[n],10))&&(i[n]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(o),n.css(i).show()},removeWrapper:function(e){var i=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===i||t.contains(e[0],i))&&t(i).focus()),e},setTransition:function(e,i,n,o){return o=o||{},t.each(i,function(t,i){var r=e.cssUnit(i);r[0]>0&&(o[i]=r[0]*n+r[1])}),o}}),t.fn.extend({effect:function(){function e(e){function n(){t.isFunction(r)&&r.call(o[0]),t.isFunction(e)&&e()}var o=t(this),r=i.complete,a=i.mode;(o.is(":hidden")?"hide"===a:"show"===a)?(o[a](),n()):s.call(o[0],i,n)}var i=n.apply(this,arguments),o=i.mode,r=i.queue,s=t.effects.effect[i.effect];return t.fx.off||!s?o?this[o](i.duration,i.complete):this.each(function(){i.complete&&i.complete.call(this)}):r===!1?this.each(e):this.queue(r||"fx",e)},show:function(t){return function(e){if(o(e))return t.apply(this,arguments);var i=n.apply(this,arguments);return i.mode="show",this.effect.call(this,i)}}(t.fn.show),hide:function(t){return function(e){if(o(e))return t.apply(this,arguments);var i=n.apply(this,arguments);return i.mode="hide",this.effect.call(this,i)}}(t.fn.hide),toggle:function(t){return function(e){if(o(e)||"boolean"==typeof e)return t.apply(this,arguments);var i=n.apply(this,arguments);return i.mode="toggle",this.effect.call(this,i)}}(t.fn.toggle),cssUnit:function(e){var i=this.css(e),n=[];return t.each(["em","px","%","pt"],function(t,e){i.indexOf(e)>0&&(n=[parseFloat(i),e])}),n}})}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,i){e[i]=function(e){return Math.pow(e,t+2)}}),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;t<((e=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,function(e,i){t.easing["easeIn"+e]=i,t.easing["easeOut"+e]=function(t){return 1-i(1-t)},t.easing["easeInOut"+e]=function(t){return t<.5?i(2*t)/2:1-i(t*-2+2)/2}})}()}(jQuery),function(t,e){var i=0,n={},o={};n.height=n.paddingTop=n.paddingBottom=n.borderTopWidth=n.borderBottomWidth="hide",o.height=o.paddingTop=o.paddingBottom=o.borderTopWidth=o.borderBottomWidth="show",t.widget("ui.accordion",{version:"1.10.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var e=this.options;this.prevShow=this.prevHide=t(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),e.collapsible||e.active!==!1&&null!=e.active||(e.active=0),this._processPanels(),e.active<0&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():t(),content:this.active.length?this.active.next():t()}},_createIcons:function(){var e=this.options.icons;e&&(t("<span>").addClass("ui-accordion-header-icon ui-icon "+e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),t=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){return"active"===t?void this._activate(e):("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||this.options.active!==!1||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons()),void("disabled"===t&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!e)))},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var i=t.ui.keyCode,n=this.headers.length,o=this.headers.index(e.target),r=!1;switch(e.keyCode){case i.RIGHT:case i.DOWN:r=this.headers[(o+1)%n];break;case i.LEFT:case i.UP:r=this.headers[(o-1+n)%n];break;case i.SPACE:case i.ENTER:this._eventHandler(e);break;case i.HOME:r=this.headers[0];break;case i.END:r=this.headers[n-1]}r&&(t(e.target).attr("tabIndex",-1),t(r).attr("tabIndex",0),r.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===t.ui.keyCode.UP&&e.ctrlKey&&t(e.currentTarget).prev().focus()},refresh:function(){var e=this.options;this._processPanels(),(e.active===!1&&e.collapsible===!0||!this.headers.length)&&(e.active=!1,this.active=t()),e.active===!1?this._activate(0):this.active.length&&!t.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=t()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var e,n=this.options,o=n.heightStyle,r=this.element.parent(),s=this.accordionId="ui-accordion-"+(this.element.attr("id")||++i);this.active=this._findActive(n.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(e){var i=t(this),n=i.attr("id"),o=i.next(),r=o.attr("id");n||(n=s+"-header-"+e,i.attr("id",n)),r||(r=s+"-panel-"+e,o.attr("id",r)),i.attr("aria-controls",r),o.attr("aria-labelledby",n)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(n.event),"fill"===o?(e=r.height(),this.element.siblings(":visible").each(function(){var i=t(this),n=i.css("position");"absolute"!==n&&"fixed"!==n&&(e-=i.outerHeight(!0))}),this.headers.each(function(){e-=t(this).outerHeight(!0)}),this.headers.next().each(function(){t(this).height(Math.max(0,e-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===o&&(e=0,this.headers.next().each(function(){e=Math.max(e,t(this).css("height","").height())}).height(e))},_activate:function(e){var i=this._findActive(e)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):t()},_setupEvents:function(e){var i={keydown:"_keydown"};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var i=this.options,n=this.active,o=t(e.currentTarget),r=o[0]===n[0],s=r&&i.collapsible,a=s?t():o.next(),l=n.next(),c={oldHeader:n,oldPanel:l,newHeader:s?t():o,newPanel:a};e.preventDefault(),r&&!i.collapsible||this._trigger("beforeActivate",e,c)===!1||(i.active=!s&&this.headers.index(o),this.active=r?t():o,this._toggle(c),n.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),r||(o.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&o.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),o.next().addClass("ui-accordion-content-active")))},_toggle:function(e){var i=e.newPanel,n=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=n,this.options.animate?this._animate(i,n,e):(n.hide(),i.show(),this._toggleComplete(e)),n.attr({"aria-expanded":"false","aria-hidden":"true"}),n.prev().attr("aria-selected","false"),i.length&&n.length?n.prev().attr("tabIndex",-1):i.length&&this.headers.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),i.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(t,e,i){var r,s,a,l=this,c=0,u=t.length&&(!e.length||t.index()<e.index()),h=this.options.animate||{},d=u&&h.down||h,p=function(){l._toggleComplete(i)};return"number"==typeof d&&(a=d),"string"==typeof d&&(s=d),s=s||d.easing||h.easing,a=a||d.duration||h.duration,e.length?t.length?(r=t.show().outerHeight(),e.animate(n,{duration:a,easing:s,step:function(t,e){e.now=Math.round(t)}}),void t.hide().animate(o,{duration:a,easing:s,complete:p,step:function(t,i){i.now=Math.round(t),"height"!==i.prop?c+=i.now:"content"!==l.options.heightStyle&&(i.now=Math.round(r-e.outerHeight()-c),c=0)}})):e.animate(n,a,s,p):t.animate(o,a,s,p)},_toggleComplete:function(t){var e=t.oldPanel;e.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}})}(jQuery),function(t,e){var i=0;t.widget("ui.autocomplete",{version:"1.10.2",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var e,i,n,o=this.element[0].nodeName.toLowerCase(),r="textarea"===o,s="input"===o;this.isMultiLine=!!r||!s&&this.element.prop("isContentEditable"),this.valueMethod=this.element[r||s?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(o){if(this.element.prop("readOnly"))return e=!0,n=!0,void(i=!0);e=!1,n=!1,i=!1;var r=t.ui.keyCode;switch(o.keyCode){case r.PAGE_UP:e=!0,this._move("previousPage",o);break;case r.PAGE_DOWN:e=!0,this._move("nextPage",o);break;case r.UP:e=!0,this._keyEvent("previous",o);break;case r.DOWN:e=!0,this._keyEvent("next",o);break;case r.ENTER:case r.NUMPAD_ENTER:this.menu.active&&(e=!0,o.preventDefault(),this.menu.select(o));break;case r.TAB:this.menu.active&&this.menu.select(o);break;case r.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(o),o.preventDefault());break;default:i=!0,this._searchTimeout(o)}},keypress:function(n){if(e)return e=!1,void n.preventDefault();if(!i){var o=t.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:this._move("previousPage",n);break;case o.PAGE_DOWN:this._move("nextPage",n);break;case o.UP:this._keyEvent("previous",n);break;case o.DOWN:this._keyEvent("next",n)}}},input:function(t){return n?(n=!1,void t.preventDefault()):void this._searchTimeout(t)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(t),void this._change(t))}}),this._initSource(),this.menu=t("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({input:t(),role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];t(e.target).closest(".ui-menu-item").length||this._delay(function(){var e=this;this.document.one("mousedown",function(n){n.target===e.element[0]||n.target===i||t.contains(i,n.target)||e.close()})})},menufocus:function(e,i){if(this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){t(e.target).trigger(e.originalEvent)});var n=i.item.data("ui-autocomplete-item");!1!==this._trigger("focus",e,{item:n})?e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(n.value):this.liveRegion.text(n.value)},menuselect:function(t,e){var i=e.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=i})),!1!==this._trigger("select",t,{item:i})&&this._value(i.value),this.term=this._value(),this.close(t),this.selectedItem=i}}),this.liveRegion=t("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,i,n=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(i,n){n(t.ui.autocomplete.filter(e,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,o){n.xhr&&n.xhr.abort(),n.xhr=t.ajax({url:i,data:e,dataType:"json",success:function(t){o(t)},error:function(){o([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,t))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):this._trigger("search",e)!==!1?this._search(t):void 0},_search:function(t){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var t=this,e=++i;return function(n){e===i&&t.__response(n),t.pending--,t.pending||t.element.removeClass("ui-autocomplete-loading")}},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,function(e){return"string"==typeof e?{label:e,value:e}:t.extend({label:e.label||e.value,value:e.value||e.label},e)})},_suggest:function(e){var i=this.menu.element.empty();this._renderMenu(i,e),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,i){var n=this;t.each(i,function(t,i){n._renderItemData(e,i)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,i){return t("<li>").append(t("<a>").text(i.label)).appendTo(e)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this._value(this.term),void this.menu.blur()):void this.menu[t](e):void this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(t,e),e.preventDefault())}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,i){var n=new RegExp(t.ui.autocomplete.escapeRegex(i),"i");return t.grep(e,function(t){return n.test(t.label||t.value||t)})}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var e;this._superApply(arguments),this.options.disabled||this.cancelSearch||(e=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.text(e))}})}(jQuery),function(t,e){var i,n,o,r,s="ui-button ui-widget ui-state-default ui-corner-all",a="ui-state-hover ui-state-active ",l="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",c=function(){var e=t(this).find(":ui-button");setTimeout(function(){e.button("refresh")},1)},u=function(e){var i=e.name,n=e.form,o=t([]);return i&&(i=i.replace(/'/g,"\\'"),o=n?t(n).find("[name='"+i+"']"):t("[name='"+i+"']",e.ownerDocument).filter(function(){return!this.form})),o};t.widget("ui.button",{version:"1.10.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,c),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var e=this,a=this.options,l="checkbox"===this.type||"radio"===this.type,h=l?"":"ui-state-active",d="ui-state-focus";null===a.label&&(a.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(s).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){a.disabled||this===i&&t(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){a.disabled||t(this).removeClass(h)}).bind("click"+this.eventNamespace,function(t){a.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){e.buttonElement.addClass(d)}).bind("blur"+this.eventNamespace,function(){e.buttonElement.removeClass(d)}),l&&(this.element.bind("change"+this.eventNamespace,function(){r||e.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(t){a.disabled||(r=!1,n=t.pageX,o=t.pageY)}).bind("mouseup"+this.eventNamespace,function(t){a.disabled||n===t.pageX&&o===t.pageY||(r=!0)})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(a.disabled||r)return!1}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(a.disabled||r)return!1;t(this).addClass("ui-state-active"),e.buttonElement.attr("aria-pressed","true");var i=e.element[0];u(i).not(i).map(function(){return t(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return!a.disabled&&(t(this).addClass("ui-state-active"),i=this,void e.document.one("mouseup",function(){i=null}))}).bind("mouseup"+this.eventNamespace,function(){return!a.disabled&&void t(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(e){return!a.disabled&&void(e.keyCode!==t.ui.keyCode.SPACE&&e.keyCode!==t.ui.keyCode.ENTER||t(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){t(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===t.ui.keyCode.SPACE&&t(this).click()})),this._setOption("disabled",a.disabled),this._resetButton()},_determineButtonType:function(){var t,e,i;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button","checkbox"===this.type||"radio"===this.type?(t=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=t.find(e),this.buttonElement.length||(t=t.length?t.siblings():this.element.siblings(),this.buttonElement=t.filter(e),this.buttonElement.length||(this.buttonElement=t.find(e))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(s+" "+a+" "+l).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),
this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(t,e){return this._super(t,e),"disabled"===t?void(e?this.element.prop("disabled",!0):this.element.prop("disabled",!1)):void this._resetButton()},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e),"radio"===this.type?u(this.element[0]).each(function(){t(this).is(":checked")?t(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):t(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var e=this.buttonElement.removeClass(l),i=t("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),n=this.options.icons,o=n.primary&&n.secondary,r=[];n.primary||n.secondary?(this.options.text&&r.push("ui-button-text-icon"+(o?"s":n.primary?"-primary":"-secondary")),n.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+n.primary+"'></span>"),n.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+n.secondary+"'></span>"),this.options.text||(r.push(o?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||e.attr("title",t.trim(i)))):r.push("ui-button-text-only"),e.addClass(r.join(" "))}}),t.widget("ui.buttonset",{version:"1.10.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(t,e){"disabled"===t&&this.buttons.button("option",t,e),this._super(t,e)},refresh:function(){var e="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(t,e){function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.dpDiv=n(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function n(e){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(i,"mouseout",function(){t(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&t(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&t(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",function(){t.datepicker._isDisabledDatepicker(r.inline?e.parent()[0]:r.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&t(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&t(this).addClass("ui-datepicker-next-hover"))})}function o(e,i){t.extend(e,i);for(var n in i)null==i[n]&&(e[n]=i[n]);return e}t.extend(t.ui,{datepicker:{version:"1.10.2"}});var r,s="datepicker",a=(new Date).getTime();t.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return o(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var n,o,r;n=e.nodeName.toLowerCase(),o="div"===n||"span"===n,e.id||(this.uuid+=1,e.id="dp"+this.uuid),r=this._newInst(t(e),o),r.settings=t.extend({},i||{}),"input"===n?this._connectDatepicker(e,r):o&&this._inlineDatepicker(e,r)},_newInst:function(e,i){var o=e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:o,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?n(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,i){var n=t(e);i.append=t([]),i.trigger=t([]),n.hasClass(this.markerClassName)||(this._attachments(n,i),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),t.data(e,s,i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var n,o,r,s=this._get(i,"appendText"),a=this._get(i,"isRTL");i.append&&i.append.remove(),s&&(i.append=t("<span class='"+this._appendClass+"'>"+s+"</span>"),e[a?"before":"after"](i.append)),e.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),n=this._get(i,"showOn"),"focus"!==n&&"both"!==n||e.focus(this._showDatepicker),"button"!==n&&"both"!==n||(o=this._get(i,"buttonText"),r=this._get(i,"buttonImage"),i.trigger=t(this._get(i,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:r,alt:o,title:o}):t("<button type='button'></button>").addClass(this._triggerClass).html(r?t("<img/>").attr({src:r,alt:o,title:o}):o)),e[a?"before":"after"](i.trigger),i.trigger.click(function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,n,o,r=new Date(2009,11,20),s=this._get(t,"dateFormat");s.match(/[DM]/)&&(e=function(t){for(i=0,n=0,o=0;o<t.length;o++)t[o].length>i&&(i=t[o].length,n=o);return n},r.setMonth(e(this._get(t,s.match(/MM/)?"monthNames":"monthNamesShort"))),r.setDate(e(this._get(t,s.match(/DD/)?"dayNames":"dayNamesShort"))+20-r.getDay())),t.input.attr("size",this._formatDate(t,r).length)}},_inlineDatepicker:function(e,i){var n=t(e);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(i.dpDiv),t.data(e,s,i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css("display","block"))},_dialogDatepicker:function(e,i,n,r,a){var l,c,u,h,d,p=this._dialogInst;return p||(this.uuid+=1,l="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+l+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),t("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},t.data(this._dialogInput[0],s,p)),o(p.settings,r||{}),i=i&&i.constructor===Date?this._formatDate(p,i):i,this._dialogInput.val(i),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(c=document.documentElement.clientWidth,u=document.documentElement.clientHeight,h=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[c/2-100+h,u/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],s,p),this},_destroyDatepicker:function(e){var i,n=t(e),o=t.data(e,s);n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,s),"input"===i?(o.append.remove(),o.trigger.remove(),n.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):"div"!==i&&"span"!==i||n.removeClass(this.markerClassName).empty())},_enableDatepicker:function(e){var i,n,o=t(e),r=t.data(e,s);o.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!1,r.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==i&&"span"!==i||(n=o.children("."+this._inlineClass),n.children().removeClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var i,n,o=t(e),r=t.data(e,s);o.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!0,r.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==i&&"span"!==i||(n=o.children("."+this._inlineClass),n.children().addClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;e<this._disabledInputs.length;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,s)}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(i,n,r){var s,a,l,c,u=this._getInst(i);return 2===arguments.length&&"string"==typeof n?"defaults"===n?t.extend({},t.datepicker._defaults):u?"all"===n?t.extend({},u.settings):this._get(u,n):null:(s=n||{},"string"==typeof n&&(s={},s[n]=r),void(u&&(this._curInst===u&&this._hideDatepicker(),a=this._getDateDatepicker(i,!0),l=this._getMinMaxDate(u,"min"),c=this._getMinMaxDate(u,"max"),o(u.settings,s),null!==l&&s.dateFormat!==e&&s.minDate===e&&(u.settings.minDate=this._formatDate(u,l)),null!==c&&s.dateFormat!==e&&s.maxDate===e&&(u.settings.maxDate=this._formatDate(u,c)),"disabled"in s&&(s.disabled?this._disableDatepicker(i):this._enableDatepicker(i)),this._attachments(t(i),u),this._autoSize(u),this._setDate(u,a),this._updateAlternate(u),this._updateDatepicker(u))))},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,n,o,r=t.datepicker._getInst(e.target),s=!0,a=r.dpDiv.is(".ui-datepicker-rtl");if(r._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),s=!1;break;case 13:return o=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",r.dpDiv),o[0]&&t.datepicker._selectDay(e.target,r.selectedMonth,r.selectedYear,o[0]),i=t.datepicker._get(r,"onSelect"),i?(n=t.datepicker._formatDate(r),i.apply(r.input?r.input[0]:null,[n,r])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(r,"stepBigMonths"):-t.datepicker._get(r,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(r,"stepBigMonths"):+t.datepicker._get(r,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),s=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),s=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,a?1:-1,"D"),s=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(r,"stepBigMonths"):-t.datepicker._get(r,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),s=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,a?-1:1,"D"),s=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(r,"stepBigMonths"):+t.datepicker._get(r,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),s=e.ctrlKey||e.metaKey;break;default:s=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):s=!1;s&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var i,n,o=t.datepicker._getInst(e.target);if(t.datepicker._get(o,"constrainInput"))return i=t.datepicker._possibleChars(t.datepicker._get(o,"dateFormat")),n=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||n<" "||!i||i.indexOf(n)>-1},_doKeyUp:function(e){var i,n=t.datepicker._getInst(e.target);if(n.input.val()!==n.lastVal)try{i=t.datepicker.parseDate(t.datepicker._get(n,"dateFormat"),n.input?n.input.val():null,t.datepicker._getFormatConfig(n)),i&&(t.datepicker._setDateFromField(n),t.datepicker._updateAlternate(n),t.datepicker._updateDatepicker(n))}catch(t){}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!==e.nodeName.toLowerCase()&&(e=t("input",e.parentNode)[0]),!t.datepicker._isDisabledDatepicker(e)&&t.datepicker._lastInput!==e){var i,n,r,s,a,l,c;i=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==i&&(t.datepicker._curInst.dpDiv.stop(!0,!0),i&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),n=t.datepicker._get(i,"beforeShow"),r=n?n.apply(e,[e,i]):{},r!==!1&&(o(i.settings,r),i.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(i),t.datepicker._inDialog&&(e.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),s=!1,t(e).parents().each(function(){return s|="fixed"===t(this).css("position"),!s}),a={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(i),a=t.datepicker._checkOffset(i,a,s),i.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":s?"fixed":"absolute",display:"none",left:a.left+"px",top:a.top+"px"}),i.inline||(l=t.datepicker._get(i,"showAnim"),c=t.datepicker._get(i,"duration"),i.dpDiv.zIndex(t(e).zIndex()+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[l]?i.dpDiv.show(l,t.datepicker._get(i,"showOptions"),c):i.dpDiv[l||"show"](l?c:null),i.input.is(":visible")&&!i.input.is(":disabled")&&i.input.focus(),t.datepicker._curInst=i))}},_updateDatepicker:function(e){this.maxRows=4,r=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e),e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var i,n=this._getNumberOfMonths(e),o=n[1],s=17;e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),o>1&&e.dpDiv.addClass("ui-datepicker-multi-"+o).css("width",s*o+"em"),e.dpDiv[(1!==n[0]||1!==n[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&e.input[0]!==document.activeElement&&e.input.focus(),e.yearshtml&&(i=e.yearshtml,setTimeout(function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null},0))},_getBorders:function(t){var e=function(t){return{thin:1,medium:2,thick:3}[t]||t};return[parseFloat(e(t.css("border-left-width"))),parseFloat(e(t.css("border-top-width")))]},_checkOffset:function(e,i,n){var o=e.dpDiv.outerWidth(),r=e.dpDiv.outerHeight(),s=e.input?e.input.outerWidth():0,a=e.input?e.input.outerHeight():0,l=document.documentElement.clientWidth+(n?0:t(document).scrollLeft()),c=document.documentElement.clientHeight+(n?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?o-s:0,i.left-=n&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=n&&i.top===e.input.offset().top+a?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+o>l&&l>o?Math.abs(i.left+o-l):0),i.top-=Math.min(i.top,i.top+r>c&&c>r?Math.abs(r+a):0),i},_findPos:function(e){for(var i,n=this._getInst(e),o=this._get(n,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[o?"previousSibling":"nextSibling"];return i=t(e).offset(),[i.left,i.top]},_hideDatepicker:function(e){var i,n,o,r,a=this._curInst;!a||e&&a!==t.data(e,s)||this._datepickerShowing&&(i=this._get(a,"showAnim"),n=this._get(a,"duration"),o=function(){t.datepicker._tidyDialog(a)},t.effects&&(t.effects.effect[i]||t.effects[i])?a.dpDiv.hide(i,t.datepicker._get(a,"showOptions"),n,o):a.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?n:null,o),i||o(),this._datepickerShowing=!1,r=this._get(a,"onClose"),r&&r.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),n=t.datepicker._getInst(i[0]);(i[0].id===t.datepicker._mainDivId||0!==i.parents("#"+t.datepicker._mainDivId).length||i.hasClass(t.datepicker.markerClassName)||i.closest("."+t.datepicker._triggerClass).length||!t.datepicker._datepickerShowing||t.datepicker._inDialog&&t.blockUI)&&(!i.hasClass(t.datepicker.markerClassName)||t.datepicker._curInst===n)||t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,n){var o=t(e),r=this._getInst(o[0]);this._isDisabledDatepicker(o[0])||(this._adjustInstDate(r,i+("M"===n?this._get(r,"showCurrentAtPos"):0),n),this._updateDatepicker(r))},_gotoToday:function(e){var i,n=t(e),o=this._getInst(n[0]);this._get(o,"gotoCurrent")&&o.currentDay?(o.selectedDay=o.currentDay,o.drawMonth=o.selectedMonth=o.currentMonth,o.drawYear=o.selectedYear=o.currentYear):(i=new Date,o.selectedDay=i.getDate(),o.drawMonth=o.selectedMonth=i.getMonth(),o.drawYear=o.selectedYear=i.getFullYear()),this._notifyChange(o),this._adjustDate(n)},_selectMonthYear:function(e,i,n){var o=t(e),r=this._getInst(o[0]);r["selected"+("M"===n?"Month":"Year")]=r["draw"+("M"===n?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(r),this._adjustDate(o)},_selectDay:function(e,i,n,o){var r,s=t(e);t(o).hasClass(this._unselectableClass)||this._isDisabledDatepicker(s[0])||(r=this._getInst(s[0]),r.selectedDay=r.currentDay=t("a",o).html(),r.selectedMonth=r.currentMonth=i,r.selectedYear=r.currentYear=n,this._selectDate(e,this._formatDate(r,r.currentDay,r.currentMonth,r.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,"")},_selectDate:function(e,i){var n,o=t(e),r=this._getInst(o[0]);i=null!=i?i:this._formatDate(r),r.input&&r.input.val(i),this._updateAlternate(r),n=this._get(r,"onSelect"),n?n.apply(r.input?r.input[0]:null,[i,r]):r.input&&r.input.trigger("change"),r.inline?this._updateDatepicker(r):(this._hideDatepicker(),this._lastInput=r.input[0],"object"!=typeof r.input[0]&&r.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var i,n,o,r=this._get(e,"altField");r&&(i=this._get(e,"altFormat")||this._get(e,"dateFormat"),n=this._getDate(e),o=this.formatDate(i,n,this._getFormatConfig(e)),t(r).each(function(){t(this).val(o)}))},noWeekends:function(t){var e=t.getDay();return[e>0&&e<6,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(e,i,n){if(null==e||null==i)throw"Invalid arguments";if(i="object"==typeof i?i.toString():i+"",""===i)return null;var o,r,s,a,l=0,c=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),h=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,d=(n?n.dayNames:null)||this._defaults.dayNames,p=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,f=(n?n.monthNames:null)||this._defaults.monthNames,g=-1,m=-1,v=-1,y=-1,_=!1,w=function(t){var i=o+1<e.length&&e.charAt(o+1)===t;return i&&o++,i},b=function(t){var e=w(t),n="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,o=new RegExp("^\\d{1,"+n+"}"),r=i.substring(l).match(o);if(!r)throw"Missing number at position "+l;return l+=r[0].length,parseInt(r[0],10)},k=function(e,n,o){var r=-1,s=t.map(w(e)?o:n,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(t.each(s,function(t,e){var n=e[1];if(i.substr(l,n.length).toLowerCase()===n.toLowerCase())return r=e[0],l+=n.length,!1}),r!==-1)return r+1;throw"Unknown name at position "+l},D=function(){if(i.charAt(l)!==e.charAt(o))throw"Unexpected literal at position "+l;l++};for(o=0;o<e.length;o++)if(_)"'"!==e.charAt(o)||w("'")?D():_=!1;else switch(e.charAt(o)){case"d":v=b("d");break;case"D":k("D",h,d);break;case"o":y=b("o");break;case"m":m=b("m");break;case"M":m=k("M",p,f);break;case"y":g=b("y");break;case"@":a=new Date(b("@")),g=a.getFullYear(),m=a.getMonth()+1,v=a.getDate();break;case"!":a=new Date((b("!")-this._ticksTo1970)/1e4),g=a.getFullYear(),m=a.getMonth()+1,v=a.getDate();break;case"'":w("'")?D():_=!0;break;default:D()}if(l<i.length&&(s=i.substr(l),!/^\s+/.test(s)))throw"Extra/unparsed characters found in date: "+s;if(g===-1?g=(new Date).getFullYear():g<100&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(g<=u?0:-100)),y>-1)for(m=1,v=y;;){if(r=this._getDaysInMonth(g,m-1),v<=r)break;m++,v-=r}if(a=this._daylightSavingAdjust(new Date(g,m-1,v)),a.getFullYear()!==g||a.getMonth()+1!==m||a.getDate()!==v)throw"Invalid date";return a},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(t,e,i){if(!e)return"";var n,o=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,r=(i?i.dayNames:null)||this._defaults.dayNames,s=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,a=(i?i.monthNames:null)||this._defaults.monthNames,l=function(e){var i=n+1<t.length&&t.charAt(n+1)===e;return i&&n++,i},c=function(t,e,i){var n=""+e;if(l(t))for(;n.length<i;)n="0"+n;return n},u=function(t,e,i,n){return l(t)?n[e]:i[e]},h="",d=!1;if(e)for(n=0;n<t.length;n++)if(d)"'"!==t.charAt(n)||l("'")?h+=t.charAt(n):d=!1;else switch(t.charAt(n)){case"d":h+=c("d",e.getDate(),2);break;case"D":h+=u("D",e.getDay(),o,r);break;case"o":h+=c("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":h+=c("m",e.getMonth()+1,2);break;case"M":h+=u("M",e.getMonth(),s,a);break;case"y":h+=l("y")?e.getFullYear():(e.getYear()%100<10?"0":"")+e.getYear()%100;break;case"@":h+=e.getTime();break;case"!":h+=1e4*e.getTime()+this._ticksTo1970;break;case"'":l("'")?h+="'":d=!0;break;default:h+=t.charAt(n)}return h},_possibleChars:function(t){var e,i="",n=!1,o=function(i){var n=e+1<t.length&&t.charAt(e+1)===i;return n&&e++,n};for(e=0;e<t.length;e++)if(n)"'"!==t.charAt(e)||o("'")?i+=t.charAt(e):n=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":o("'")?i+="'":n=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,i){return t.settings[i]!==e?t.settings[i]:this._defaults[i]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),n=t.lastVal=t.input?t.input.val():null,o=this._getDefaultDate(t),r=o,s=this._getFormatConfig(t);try{r=this.parseDate(i,n,s)||o}catch(t){n=e?"":n}t.selectedDay=r.getDate(),t.drawMonth=t.selectedMonth=r.getMonth(),t.drawYear=t.selectedYear=r.getFullYear(),t.currentDay=n?r.getDate():0,t.currentMonth=n?r.getMonth():0,t.currentYear=n?r.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,i,n){var o=function(t){var e=new Date;return e.setDate(e.getDate()+t),e},r=function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),i,t.datepicker._getFormatConfig(e))}catch(t){}for(var n=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,o=n.getFullYear(),r=n.getMonth(),s=n.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=a.exec(i);l;){switch(l[2]||"d"){case"d":case"D":s+=parseInt(l[1],10);break;case"w":case"W":s+=7*parseInt(l[1],10);break;case"m":case"M":r+=parseInt(l[1],10),s=Math.min(s,t.datepicker._getDaysInMonth(o,r));break;case"y":case"Y":o+=parseInt(l[1],10),s=Math.min(s,t.datepicker._getDaysInMonth(o,r))}l=a.exec(i)}return new Date(o,r,s)},s=null==i||""===i?n:"string"==typeof i?r(i):"number"==typeof i?isNaN(i)?n:o(i):new Date(i.getTime());return s=s&&"Invalid Date"===s.toString()?n:s,s&&(s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0)),this._daylightSavingAdjust(s)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var n=!e,o=t.selectedMonth,r=t.selectedYear,s=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=s.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=s.getMonth(),t.drawYear=t.selectedYear=t.currentYear=s.getFullYear(),o===t.selectedMonth&&r===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(n?"":this._formatDate(t))},_getDate:function(t){var e=!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return e},_attachHandlers:function(e){var i=this._get(e,"stepMonths"),n="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){window["DP_jQuery_"+a].datepicker._adjustDate(n,-i,"M")},next:function(){window["DP_jQuery_"+a].datepicker._adjustDate(n,+i,"M")},hide:function(){window["DP_jQuery_"+a].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+a].datepicker._gotoToday(n)},selectDay:function(){return window["DP_jQuery_"+a].datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return window["DP_jQuery_"+a].datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return window["DP_jQuery_"+a].datepicker._selectMonthYear(n,this,"Y"),!1}};t(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,n,o,r,s,a,l,c,u,h,d,p,f,g,m,v,y,_,w,b,k,D,C,R,T,x,S,P,G,A,M,O,F,E,V,B,$,I,j=new Date,N=this._daylightSavingAdjust(new Date(j.getFullYear(),j.getMonth(),j.getDate())),U=this._get(t,"isRTL"),L=this._get(t,"showButtonPanel"),z=this._get(t,"hideIfNoPrevNext"),W=this._get(t,"navigationAsDateFormat"),H=this._getNumberOfMonths(t),Y=this._get(t,"showCurrentAtPos"),q=this._get(t,"stepMonths"),Z=1!==H[0]||1!==H[1],Q=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),X=this._getMinMaxDate(t,"min"),K=this._getMinMaxDate(t,"max"),J=t.drawMonth-Y,tt=t.drawYear;if(J<0&&(J+=12,tt--),K)for(e=this._daylightSavingAdjust(new Date(K.getFullYear(),K.getMonth()-H[0]*H[1]+1,K.getDate())),e=X&&e<X?X:e;this._daylightSavingAdjust(new Date(tt,J,1))>e;)J--,J<0&&(J=11,tt--);for(t.drawMonth=J,t.drawYear=tt,i=this._get(t,"prevText"),i=W?this.formatDate(i,this._daylightSavingAdjust(new Date(tt,J-q,1)),this._getFormatConfig(t)):i,n=this._canAdjustMonth(t,-1,tt,J)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+i+"</span></a>":z?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+i+"</span></a>",o=this._get(t,"nextText"),o=W?this.formatDate(o,this._daylightSavingAdjust(new Date(tt,J+q,1)),this._getFormatConfig(t)):o,r=this._canAdjustMonth(t,1,tt,J)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+o+"</span></a>":z?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+o+"</span></a>",s=this._get(t,"currentText"),a=this._get(t,"gotoCurrent")&&t.currentDay?Q:N,s=W?this.formatDate(s,a,this._getFormatConfig(t)):s,l=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",c=L?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(U?l:"")+(this._isInRange(t,a)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+s+"</button>":"")+(U?"":l)+"</div>":"",u=parseInt(this._get(t,"firstDay"),10),u=isNaN(u)?0:u,h=this._get(t,"showWeek"),d=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),g=this._get(t,"monthNamesShort"),m=this._get(t,"beforeShowDay"),v=this._get(t,"showOtherMonths"),y=this._get(t,"selectOtherMonths"),_=this._getDefaultDate(t),w="",k=0;k<H[0];k++){for(D="",this.maxRows=4,C=0;C<H[1];C++){if(R=this._daylightSavingAdjust(new Date(tt,J,t.selectedDay)),T=" ui-corner-all",x="",Z){if(x+="<div class='ui-datepicker-group",H[1]>1)switch(C){case 0:x+=" ui-datepicker-group-first",T=" ui-corner-"+(U?"right":"left");break;case H[1]-1:x+=" ui-datepicker-group-last",T=" ui-corner-"+(U?"left":"right");break;default:x+=" ui-datepicker-group-middle",T=""}x+="'>"}for(x+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+T+"'>"+(/all|left/.test(T)&&0===k?U?r:n:"")+(/all|right/.test(T)&&0===k?U?n:r:"")+this._generateMonthYearHeader(t,J,tt,X,K,k>0||C>0,f,g)+"</div><table class='ui-datepicker-calendar'><thead><tr>",
S=h?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",b=0;b<7;b++)P=(b+u)%7,S+="<th"+((b+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+d[P]+"'>"+p[P]+"</span></th>";for(x+=S+"</tr></thead><tbody>",G=this._getDaysInMonth(tt,J),tt===t.selectedYear&&J===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,G)),A=(this._getFirstDayOfMonth(tt,J)-u+7)%7,M=Math.ceil((A+G)/7),O=Z&&this.maxRows>M?this.maxRows:M,this.maxRows=O,F=this._daylightSavingAdjust(new Date(tt,J,1-A)),E=0;E<O;E++){for(x+="<tr>",V=h?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(F)+"</td>":"",b=0;b<7;b++)B=m?m.apply(t.input?t.input[0]:null,[F]):[!0,""],$=F.getMonth()!==J,I=$&&!y||!B[0]||X&&F<X||K&&F>K,V+="<td class='"+((b+u+6)%7>=5?" ui-datepicker-week-end":"")+($?" ui-datepicker-other-month":"")+(F.getTime()===R.getTime()&&J===t.selectedMonth&&t._keyEvent||_.getTime()===F.getTime()&&_.getTime()===R.getTime()?" "+this._dayOverClass:"")+(I?" "+this._unselectableClass+" ui-state-disabled":"")+($&&!v?"":" "+B[1]+(F.getTime()===Q.getTime()?" "+this._currentClass:"")+(F.getTime()===N.getTime()?" ui-datepicker-today":""))+"'"+($&&!v||!B[2]?"":" title='"+B[2].replace(/'/g,"&#39;")+"'")+(I?"":" data-handler='selectDay' data-event='click' data-month='"+F.getMonth()+"' data-year='"+F.getFullYear()+"'")+">"+($&&!v?"&#xa0;":I?"<span class='ui-state-default'>"+F.getDate()+"</span>":"<a class='ui-state-default"+(F.getTime()===N.getTime()?" ui-state-highlight":"")+(F.getTime()===Q.getTime()?" ui-state-active":"")+($?" ui-priority-secondary":"")+"' href='#'>"+F.getDate()+"</a>")+"</td>",F.setDate(F.getDate()+1),F=this._daylightSavingAdjust(F);x+=V+"</tr>"}J++,J>11&&(J=0,tt++),x+="</tbody></table>"+(Z?"</div>"+(H[0]>0&&C===H[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),D+=x}w+=D}return w+=c,t._keyEvent=!1,w},_generateMonthYearHeader:function(t,e,i,n,o,r,s,a){var l,c,u,h,d,p,f,g,m=this._get(t,"changeMonth"),v=this._get(t,"changeYear"),y=this._get(t,"showMonthAfterYear"),_="<div class='ui-datepicker-title'>",w="";if(r||!m)w+="<span class='ui-datepicker-month'>"+s[e]+"</span>";else{for(l=n&&n.getFullYear()===i,c=o&&o.getFullYear()===i,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;u<12;u++)(!l||u>=n.getMonth())&&(!c||u<=o.getMonth())&&(w+="<option value='"+u+"'"+(u===e?" selected='selected'":"")+">"+a[u]+"</option>");w+="</select>"}if(y||(_+=w+(!r&&m&&v?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",r||!v)_+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(h=this._get(t,"yearRange").split(":"),d=(new Date).getFullYear(),p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?d+parseInt(t,10):parseInt(t,10);return isNaN(e)?d:e},f=p(h[0]),g=Math.max(f,p(h[1]||"")),f=n?Math.max(f,n.getFullYear()):f,g=o?Math.min(g,o.getFullYear()):g,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";f<=g;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",_+=t.yearshtml,t.yearshtml=null}return _+=this._get(t,"yearSuffix"),y&&(_+=(!r&&m&&v?"":"&#xa0;")+w),_+="</div>"},_adjustInstDate:function(t,e,i){var n=t.drawYear+("Y"===i?e:0),o=t.drawMonth+("M"===i?e:0),r=Math.min(t.selectedDay,this._getDaysInMonth(n,o))+("D"===i?e:0),s=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(n,o,r)));t.selectedDay=s.getDate(),t.drawMonth=t.selectedMonth=s.getMonth(),t.drawYear=t.selectedYear=s.getFullYear(),"M"!==i&&"Y"!==i||this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),n=this._getMinMaxDate(t,"max"),o=i&&e<i?i:e;return n&&o>n?n:o},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,n){var o=this._getNumberOfMonths(t),r=this._daylightSavingAdjust(new Date(i,n+(e<0?e:o[0]*o[1]),1));return e<0&&r.setDate(this._getDaysInMonth(r.getFullYear(),r.getMonth())),this._isInRange(t,r)},_isInRange:function(t,e){var i,n,o=this._getMinMaxDate(t,"min"),r=this._getMinMaxDate(t,"max"),s=null,a=null,l=this._get(t,"yearRange");return l&&(i=l.split(":"),n=(new Date).getFullYear(),s=parseInt(i[0],10),a=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(s+=n),i[1].match(/[+\-].*/)&&(a+=n)),(!o||e.getTime()>=o.getTime())&&(!r||e.getTime()<=r.getTime())&&(!s||e.getFullYear()>=s)&&(!a||e.getFullYear()<=a)},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,n){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var o=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(n,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),o,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).mousedown(t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)}):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new i,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.10.2",window["DP_jQuery_"+a]=t}(jQuery),function(t,e){var i={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},n={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};t.widget("ui.dialog",{version:"1.10.2",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var i=t(this).css(e).offset().top;i<0&&t(this).css("top",e.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&t.fn.draggable&&this._makeDraggable(),this.options.resizable&&t.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?t(e):this.document.find(e||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),t=e.parent.children().eq(e.index),t.length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:t.noop,enable:t.noop,close:function(e){var i=this;this._isOpen&&this._trigger("beforeClose",e)!==!1&&(this._isOpen=!1,this._destroyOverlay(),this.opener.filter(":focusable").focus().length||t(this.document[0].activeElement).blur(),this._hide(this.uiDialog,this.options.hide,function(){i._trigger("close",e)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,e){var i=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return i&&!e&&this._trigger("focus",t),i},open:function(){var e=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=t(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable(),e._trigger("focus")}),void this._trigger("open"))},_focusTabbable:function(){var t=this.element.find("[autofocus]");t.length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).focus()},_keepFocus:function(e){function i(){var e=this.document[0].activeElement,i=this.uiDialog[0]===e||t.contains(this.uiDialog[0],e);i||this._focusTabbable()}e.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=t("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE)return e.preventDefault(),void this.close(e);if(e.keyCode===t.ui.keyCode.TAB){var i=this.uiDialog.find(":tabbable"),n=i.filter(":first"),o=i.filter(":last");e.target!==o[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==n[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(o.focus(1),e.preventDefault()):(n.focus(1),e.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=t("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(e){t(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=t("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),e=t("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(e),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(t){this.options.title||t.html("&#160;"),t.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=t("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=t("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var e=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),t.isEmptyObject(i)||t.isArray(i)&&!i.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(t.each(i,function(i,n){var o,r;n=t.isFunction(n)?{click:n,text:i}:n,n=t.extend({type:"button"},n),o=n.click,n.click=function(){o.apply(e.element[0],arguments)},r={icons:n.icons,text:n.showText},delete n.icons,delete n.showText,t("<button></button>",n).button(r).appendTo(e.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function e(t){return{position:t.position,offset:t.offset}}var i=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,o){t(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",n,e(o))},drag:function(t,n){i._trigger("drag",t,e(n))},stop:function(o,r){n.position=[r.position.left-i.document.scrollLeft(),r.position.top-i.document.scrollTop()],t(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",o,e(r))}})},_makeResizable:function(){function e(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}var i=this,n=this.options,o=n.resizable,r=this.uiDialog.css("position"),s="string"==typeof o?o:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:s,start:function(n,o){t(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",n,e(o))},resize:function(t,n){i._trigger("resize",t,e(n))},stop:function(o,r){n.height=t(this).height(),n.width=t(this).width(),t(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",o,e(r))}}).css("position",r)},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(e){var o=this,r=!1,s={};t.each(e,function(t,e){o._setOption(t,e),t in i&&(r=!0),t in n&&(s[t]=e)}),r&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",s)},_setOption:function(t,e){var i,n,o=this.uiDialog;"dialogClass"===t&&o.removeClass(this.options.dialogClass).addClass(e),"disabled"!==t&&(this._super(t,e),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:""+e}),"draggable"===t&&(i=o.is(":data(ui-draggable)"),i&&!e&&o.draggable("destroy"),!i&&e&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&(n=o.is(":data(ui-resizable)"),n&&!e&&o.resizable("destroy"),n&&"string"==typeof e&&o.resizable("option","handles",e),n||e===!1||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),t=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),e=Math.max(0,n.minHeight-t),i="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-t):"none","auto"===n.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,n.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=t(this);return t("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return!!t(e.target).closest(".ui-dialog").length||!!t(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=this,i=this.widgetFullName;t.ui.dialog.overlayInstances||this._delay(function(){t.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(n){e._allowInteraction(n)||(n.preventDefault(),t(".ui-dialog:visible:last .ui-dialog-content").data(i)._focusTabbable())})}),this.overlay=t("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),t.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&(t.ui.dialog.overlayInstances--,t.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),t.ui.dialog.overlayInstances=0,t.uiBackCompat!==!1&&t.widget("ui.dialog",t.ui.dialog,{_position:function(){var e,i=this.options.position,n=[],o=[0,0];i?(("string"==typeof i||"object"==typeof i&&"0"in i)&&(n=i.split?i.split(" "):[i[0],i[1]],1===n.length&&(n[1]=n[0]),t.each(["left","top"],function(t,e){+n[t]===n[t]&&(o[t]=n[t],n[t]=e)}),i={my:n[0]+(o[0]<0?o[0]:"+"+o[0])+" "+n[1]+(o[1]<0?o[1]:"+"+o[1]),at:n.join(" ")}),i=t.extend({},t.ui.dialog.prototype.options.position,i)):i=t.ui.dialog.prototype.options.position,e=this.uiDialog.is(":visible"),e||this.uiDialog.show(),this.uiDialog.position(i),e||this.uiDialog.hide()}})}(jQuery),function(t,e){var i=/up|down|vertical/,n=/up|left|vertical|horizontal/;t.effects.effect.blind=function(e,o){var r,s,a,l=t(this),c=["position","top","bottom","left","right","height","width"],u=t.effects.setMode(l,e.mode||"hide"),h=e.direction||"up",d=i.test(h),p=d?"height":"width",f=d?"top":"left",g=n.test(h),m={},v="show"===u;l.parent().is(".ui-effects-wrapper")?t.effects.save(l.parent(),c):t.effects.save(l,c),l.show(),r=t.effects.createWrapper(l).css({overflow:"hidden"}),s=r[p](),a=parseFloat(r.css(f))||0,m[p]=v?s:0,g||(l.css(d?"bottom":"right",0).css(d?"top":"left","auto").css({position:"absolute"}),m[f]=v?a:s+a),v&&(r.css(p,0),g||r.css(f,a+s)),r.animate(m,{duration:e.duration,easing:e.easing,queue:!1,complete:function(){"hide"===u&&l.hide(),t.effects.restore(l,c),t.effects.removeWrapper(l),o()}})}}(jQuery),function(t,e){t.effects.effect.bounce=function(e,i){var n,o,r,s=t(this),a=["position","top","bottom","left","right","height","width"],l=t.effects.setMode(s,e.mode||"effect"),c="hide"===l,u="show"===l,h=e.direction||"up",d=e.distance,p=e.times||5,f=2*p+(u||c?1:0),g=e.duration/f,m=e.easing,v="up"===h||"down"===h?"top":"left",y="up"===h||"left"===h,_=s.queue(),w=_.length;for((u||c)&&a.push("opacity"),t.effects.save(s,a),s.show(),t.effects.createWrapper(s),d||(d=s["top"===v?"outerHeight":"outerWidth"]()/3),u&&(r={opacity:1},r[v]=0,s.css("opacity",0).css(v,y?2*-d:2*d).animate(r,g,m)),c&&(d/=Math.pow(2,p-1)),r={},r[v]=0,n=0;n<p;n++)o={},o[v]=(y?"-=":"+=")+d,s.animate(o,g,m).animate(r,g,m),d=c?2*d:d/2;c&&(o={opacity:0},o[v]=(y?"-=":"+=")+d,s.animate(o,g,m)),s.queue(function(){c&&s.hide(),t.effects.restore(s,a),t.effects.removeWrapper(s),i()}),w>1&&_.splice.apply(_,[1,0].concat(_.splice(w,f+1))),s.dequeue()}}(jQuery),function(t,e){t.effects.effect.clip=function(e,i){var n,o,r,s=t(this),a=["position","top","bottom","left","right","height","width"],l=t.effects.setMode(s,e.mode||"hide"),c="show"===l,u=e.direction||"vertical",h="vertical"===u,d=h?"height":"width",p=h?"top":"left",f={};t.effects.save(s,a),s.show(),n=t.effects.createWrapper(s).css({overflow:"hidden"}),o="IMG"===s[0].tagName?n:s,r=o[d](),c&&(o.css(d,0),o.css(p,r/2)),f[d]=c?r:0,f[p]=c?0:r/2,o.animate(f,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){c||s.hide(),t.effects.restore(s,a),t.effects.removeWrapper(s),i()}})}}(jQuery),function(t,e){t.effects.effect.drop=function(e,i){var n,o=t(this),r=["position","top","bottom","left","right","opacity","height","width"],s=t.effects.setMode(o,e.mode||"hide"),a="show"===s,l=e.direction||"left",c="up"===l||"down"===l?"top":"left",u="up"===l||"left"===l?"pos":"neg",h={opacity:a?1:0};t.effects.save(o,r),o.show(),t.effects.createWrapper(o),n=e.distance||o["top"===c?"outerHeight":"outerWidth"](!0)/2,a&&o.css("opacity",0).css(c,"pos"===u?-n:n),h[c]=(a?"pos"===u?"+=":"-=":"pos"===u?"-=":"+=")+n,o.animate(h,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===s&&o.hide(),t.effects.restore(o,r),t.effects.removeWrapper(o),i()}})}}(jQuery),function(t,e){t.effects.effect.explode=function(e,i){function n(){_.push(this),_.length===h*d&&o()}function o(){p.css({visibility:"visible"}),t(_).remove(),g||p.hide(),i()}var r,s,a,l,c,u,h=e.pieces?Math.round(Math.sqrt(e.pieces)):3,d=h,p=t(this),f=t.effects.setMode(p,e.mode||"hide"),g="show"===f,m=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/d),y=Math.ceil(p.outerHeight()/h),_=[];for(r=0;r<h;r++)for(l=m.top+r*y,u=r-(h-1)/2,s=0;s<d;s++)a=m.left+s*v,c=s-(d-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-s*v,top:-r*y}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:y,left:a+(g?c*v:0),top:l+(g?u*y:0),opacity:g?0:1}).animate({left:a+(g?0:c*v),top:l+(g?0:u*y),opacity:g?1:0},e.duration||500,e.easing,n)}}(jQuery),function(t,e){t.effects.effect.fade=function(e,i){var n=t(this),o=t.effects.setMode(n,e.mode||"toggle");n.animate({opacity:o},{queue:!1,duration:e.duration,easing:e.easing,complete:i})}}(jQuery),function(t,e){t.effects.effect.fold=function(e,i){var n,o,r=t(this),s=["position","top","bottom","left","right","height","width"],a=t.effects.setMode(r,e.mode||"hide"),l="show"===a,c="hide"===a,u=e.size||15,h=/([0-9]+)%/.exec(u),d=!!e.horizFirst,p=l!==d,f=p?["width","height"]:["height","width"],g=e.duration/2,m={},v={};t.effects.save(r,s),r.show(),n=t.effects.createWrapper(r).css({overflow:"hidden"}),o=p?[n.width(),n.height()]:[n.height(),n.width()],h&&(u=parseInt(h[1],10)/100*o[c?0:1]),l&&n.css(d?{height:0,width:u}:{height:u,width:0}),m[f[0]]=l?o[0]:u,v[f[1]]=l?o[1]:0,n.animate(m,g,e.easing).animate(v,g,e.easing,function(){c&&r.hide(),t.effects.restore(r,s),t.effects.removeWrapper(r),i()})}}(jQuery),function(t,e){t.effects.effect.highlight=function(e,i){var n=t(this),o=["backgroundImage","backgroundColor","opacity"],r=t.effects.setMode(n,e.mode||"show"),s={backgroundColor:n.css("backgroundColor")};"hide"===r&&(s.opacity=0),t.effects.save(n,o),n.show().css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(s,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===r&&n.hide(),t.effects.restore(n,o),i()}})}}(jQuery),function(t,e){t.effects.effect.pulsate=function(e,i){var n,o=t(this),r=t.effects.setMode(o,e.mode||"show"),s="show"===r,a="hide"===r,l=s||"hide"===r,c=2*(e.times||5)+(l?1:0),u=e.duration/c,h=0,d=o.queue(),p=d.length;for(!s&&o.is(":visible")||(o.css("opacity",0).show(),h=1),n=1;n<c;n++)o.animate({opacity:h},u,e.easing),h=1-h;o.animate({opacity:h},u,e.easing),o.queue(function(){a&&o.hide(),i()}),p>1&&d.splice.apply(d,[1,0].concat(d.splice(p,c+1))),o.dequeue()}}(jQuery),function(t,e){t.effects.effect.puff=function(e,i){var n=t(this),o=t.effects.setMode(n,e.mode||"hide"),r="hide"===o,s=parseInt(e.percent,10)||150,a=s/100,l={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()};t.extend(e,{effect:"scale",queue:!1,fade:!0,mode:o,complete:i,percent:r?s:100,from:r?l:{height:l.height*a,width:l.width*a,outerHeight:l.outerHeight*a,outerWidth:l.outerWidth*a}}),n.effect(e)},t.effects.effect.scale=function(e,i){var n=t(this),o=t.extend(!0,{},e),r=t.effects.setMode(n,e.mode||"effect"),s=parseInt(e.percent,10)||(0===parseInt(e.percent,10)?0:"hide"===r?0:100),a=e.direction||"both",l=e.origin,c={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()},u={y:"horizontal"!==a?s/100:1,x:"vertical"!==a?s/100:1};o.effect="size",o.queue=!1,o.complete=i,"effect"!==r&&(o.origin=l||["middle","center"],o.restore=!0),o.from=e.from||("show"===r?{height:0,width:0,outerHeight:0,outerWidth:0}:c),o.to={height:c.height*u.y,width:c.width*u.x,outerHeight:c.outerHeight*u.y,outerWidth:c.outerWidth*u.x},o.fade&&("show"===r&&(o.from.opacity=0,o.to.opacity=1),"hide"===r&&(o.from.opacity=1,o.to.opacity=0)),n.effect(o)},t.effects.effect.size=function(e,i){var n,o,r,s=t(this),a=["position","top","bottom","left","right","width","height","overflow","opacity"],l=["position","top","bottom","left","right","overflow","opacity"],c=["width","height","overflow"],u=["fontSize"],h=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],d=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=t.effects.setMode(s,e.mode||"effect"),f=e.restore||"effect"!==p,g=e.scale||"both",m=e.origin||["middle","center"],v=s.css("position"),y=f?a:l,_={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&s.show(),n={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},"toggle"===e.mode&&"show"===p?(s.from=e.to||_,s.to=e.from||n):(s.from=e.from||("show"===p?_:n),s.to=e.to||("hide"===p?_:n)),r={from:{y:s.from.height/n.height,x:s.from.width/n.width},to:{y:s.to.height/n.height,x:s.to.width/n.width}},"box"!==g&&"both"!==g||(r.from.y!==r.to.y&&(y=y.concat(h),s.from=t.effects.setTransition(s,h,r.from.y,s.from),s.to=t.effects.setTransition(s,h,r.to.y,s.to)),r.from.x!==r.to.x&&(y=y.concat(d),s.from=t.effects.setTransition(s,d,r.from.x,s.from),s.to=t.effects.setTransition(s,d,r.to.x,s.to))),"content"!==g&&"both"!==g||r.from.y!==r.to.y&&(y=y.concat(u).concat(c),s.from=t.effects.setTransition(s,u,r.from.y,s.from),s.to=t.effects.setTransition(s,u,r.to.y,s.to)),t.effects.save(s,y),s.show(),t.effects.createWrapper(s),s.css("overflow","hidden").css(s.from),m&&(o=t.effects.getBaseline(m,n),s.from.top=(n.outerHeight-s.outerHeight())*o.y,s.from.left=(n.outerWidth-s.outerWidth())*o.x,s.to.top=(n.outerHeight-s.to.outerHeight)*o.y,s.to.left=(n.outerWidth-s.to.outerWidth)*o.x),s.css(s.from),"content"!==g&&"both"!==g||(h=h.concat(["marginTop","marginBottom"]).concat(u),d=d.concat(["marginLeft","marginRight"]),c=a.concat(h).concat(d),s.find("*[width]").each(function(){var i=t(this),n={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&t.effects.save(i,c),i.from={height:n.height*r.from.y,width:n.width*r.from.x,outerHeight:n.outerHeight*r.from.y,outerWidth:n.outerWidth*r.from.x},i.to={height:n.height*r.to.y,width:n.width*r.to.x,outerHeight:n.height*r.to.y,outerWidth:n.width*r.to.x},r.from.y!==r.to.y&&(i.from=t.effects.setTransition(i,h,r.from.y,i.from),i.to=t.effects.setTransition(i,h,r.to.y,i.to)),r.from.x!==r.to.x&&(i.from=t.effects.setTransition(i,d,r.from.x,i.from),i.to=t.effects.setTransition(i,d,r.to.x,i.to)),i.css(i.from),i.animate(i.to,e.duration,e.easing,function(){f&&t.effects.restore(i,c)})})),s.animate(s.to,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){0===s.to.opacity&&s.css("opacity",s.from.opacity),"hide"===p&&s.hide(),t.effects.restore(s,y),f||("static"===v?s.css({position:"relative",top:s.to.top,left:s.to.left}):t.each(["top","left"],function(t,e){s.css(e,function(e,i){var n=parseInt(i,10),o=t?s.to.left:s.to.top;return"auto"===i?o+"px":n+o+"px"})})),t.effects.removeWrapper(s),i()}})}}(jQuery),function(t,e){t.effects.effect.shake=function(e,i){var n,o=t(this),r=["position","top","bottom","left","right","height","width"],s=t.effects.setMode(o,e.mode||"effect"),a=e.direction||"left",l=e.distance||20,c=e.times||3,u=2*c+1,h=Math.round(e.duration/u),d="up"===a||"down"===a?"top":"left",p="up"===a||"left"===a,f={},g={},m={},v=o.queue(),y=v.length;for(t.effects.save(o,r),o.show(),t.effects.createWrapper(o),f[d]=(p?"-=":"+=")+l,g[d]=(p?"+=":"-=")+2*l,m[d]=(p?"-=":"+=")+2*l,o.animate(f,h,e.easing),n=1;n<c;n++)o.animate(g,h,e.easing).animate(m,h,e.easing);o.animate(g,h,e.easing).animate(f,h/2,e.easing).queue(function(){"hide"===s&&o.hide(),t.effects.restore(o,r),t.effects.removeWrapper(o),i()}),y>1&&v.splice.apply(v,[1,0].concat(v.splice(y,u+1))),o.dequeue()}}(jQuery),function(t,e){t.effects.effect.slide=function(e,i){var n,o=t(this),r=["position","top","bottom","left","right","width","height"],s=t.effects.setMode(o,e.mode||"show"),a="show"===s,l=e.direction||"left",c="up"===l||"down"===l?"top":"left",u="up"===l||"left"===l,h={};t.effects.save(o,r),o.show(),n=e.distance||o["top"===c?"outerHeight":"outerWidth"](!0),t.effects.createWrapper(o).css({overflow:"hidden"}),a&&o.css(c,u?isNaN(n)?"-"+n:-n:n),h[c]=(a?u?"+=":"-=":u?"-=":"+=")+n,o.animate(h,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===s&&o.hide(),t.effects.restore(o,r),t.effects.removeWrapper(o),i()}})}}(jQuery),function(t,e){t.effects.effect.transfer=function(e,i){var n=t(this),o=t(e.to),r="fixed"===o.css("position"),s=t("body"),a=r?s.scrollTop():0,l=r?s.scrollLeft():0,c=o.offset(),u={top:c.top-a,left:c.left-l,height:o.innerHeight(),width:o.innerWidth()},h=n.offset(),d=t("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(e.className).css({top:h.top-a,left:h.left-l,height:n.innerHeight(),width:n.innerWidth(),position:r?"fixed":"absolute"}).animate(u,e.duration,e.easing,function(){d.remove(),i()})}}(jQuery),function(t,e){t.widget("ui.menu",{version:"1.10.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,t.proxy(function(t){this.options.disabled&&t.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(t){t.preventDefault()},"click .ui-state-disabled > a":function(t){t.preventDefault()},"click .ui-menu-item:has(a)":function(e){var i=t(e.target).closest(".ui-menu-item");!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(e),i.has(".ui-menu").length?this.expand(e):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){var i=t(e.currentTarget);i.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(e,i)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.children(".ui-menu-item").eq(0);e||this.focus(t,i)},blur:function(e){this._delay(function(){t.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){t(e.target).closest(".ui-menu").length||this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=t(this);e.data("ui-menu-submenu-carat")&&e.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){function i(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var n,o,r,s,a,l=!0;switch(e.keyCode){
case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:l=!1,o=this.previousFilter||"",r=String.fromCharCode(e.keyCode),s=!1,clearTimeout(this.filterTimer),r===o?s=!0:r=o+r,a=new RegExp("^"+i(r),"i"),n=this.activeMenu.children(".ui-menu-item").filter(function(){return a.test(t(this).children("a").text())}),n=s&&n.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):n,n.length||(r=String.fromCharCode(e.keyCode),a=new RegExp("^"+i(r),"i"),n=this.activeMenu.children(".ui-menu-item").filter(function(){return a.test(t(this).children("a").text())})),n.length?(this.focus(e,n),n.length>1?(this.previousFilter=r,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}l&&e.preventDefault()},_activate:function(t){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(t):this.select(t))},refresh:function(){var e,i=this.options.icons.submenu,n=this.element.find(this.options.menus);n.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=t(this),n=e.prev("a"),o=t("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);n.attr("aria-haspopup","true").prepend(o),e.attr("aria-labelledby",n.attr("id"))}),e=n.add(this.element),e.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),e.children(":not(.ui-menu-item)").each(function(){var e=t(this);/[^\-\u2014\u2013\s]/.test(e.text())||e.addClass("ui-widget-content ui-menu-divider")}),e.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){"icons"===t&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(e.submenu),this._super(t,e)},focus:function(t,e){var i,n;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),n=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=e.children(".ui-menu"),i.length&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(e){var i,n,o,r,s,a;this._hasScroll()&&(i=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,n=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,o=e.offset().top-this.activeMenu.offset().top-i-n,r=this.activeMenu.scrollTop(),s=this.activeMenu.height(),a=e.height(),o<0?this.activeMenu.scrollTop(r+o):o+a>s&&this.activeMenu.scrollTop(r+o-s+a))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",t,{item:this.active}))},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(e){var i=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var n=i?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));n.length||(n=this.element),this._close(n),this.blur(e),this.activeMenu=n},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var n;this.active&&(n="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.children(".ui-menu-item")[e]()),this.focus(i,n)},nextPage:function(e){var i,n,o;return this.active?void(this.isLastItem()||(this._hasScroll()?(n=this.active.offset().top,o=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=t(this),i.offset().top-n-o<0}),this.focus(e,i)):this.focus(e,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(e)},previousPage:function(e){var i,n,o;return this.active?void(this.isFirstItem()||(this._hasScroll()?(n=this.active.offset().top,o=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=t(this),i.offset().top-n+o>0}),this.focus(e,i)):this.focus(e,this.activeMenu.children(".ui-menu-item").first()))):void this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,i)}})}(jQuery),function(t,e){function i(t,e,i){return[parseFloat(t[0])*(p.test(t[0])?e/100:1),parseFloat(t[1])*(p.test(t[1])?i/100:1)]}function n(e,i){return parseInt(t.css(e,i),10)||0}function o(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}t.ui=t.ui||{};var r,s=Math.max,a=Math.abs,l=Math.round,c=/left|center|right/,u=/top|center|bottom/,h=/[\+\-]\d+(\.[\d]+)?%?/,d=/^\w+/,p=/%$/,f=t.fn.position;t.position={scrollbarWidth:function(){if(r!==e)return r;var i,n,o=t("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),s=o.children()[0];return t("body").append(o),i=s.offsetWidth,o.css("overflow","scroll"),n=s.offsetWidth,i===n&&(n=o[0].clientWidth),o.remove(),r=i-n},getScrollInfo:function(e){var i=e.isWindow?"":e.element.css("overflow-x"),n=e.isWindow?"":e.element.css("overflow-y"),o="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth,r="scroll"===n||"auto"===n&&e.height<e.element[0].scrollHeight;return{width:r?t.position.scrollbarWidth():0,height:o?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),n=t.isWindow(i[0]);return{element:i,isWindow:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n?i.width():i.outerWidth(),height:n?i.height():i.outerHeight()}}},t.fn.position=function(e){if(!e||!e.of)return f.apply(this,arguments);e=t.extend({},e);var r,p,g,m,v,y,_=t(e.of),w=t.position.getWithinInfo(e.within),b=t.position.getScrollInfo(w),k=(e.collision||"flip").split(" "),D={};return y=o(_),_[0].preventDefault&&(e.at="left top"),p=y.width,g=y.height,m=y.offset,v=t.extend({},m),t.each(["my","at"],function(){var t,i,n=(e[this]||"").split(" ");1===n.length&&(n=c.test(n[0])?n.concat(["center"]):u.test(n[0])?["center"].concat(n):["center","center"]),n[0]=c.test(n[0])?n[0]:"center",n[1]=u.test(n[1])?n[1]:"center",t=h.exec(n[0]),i=h.exec(n[1]),D[this]=[t?t[0]:0,i?i[0]:0],e[this]=[d.exec(n[0])[0],d.exec(n[1])[0]]}),1===k.length&&(k[1]=k[0]),"right"===e.at[0]?v.left+=p:"center"===e.at[0]&&(v.left+=p/2),"bottom"===e.at[1]?v.top+=g:"center"===e.at[1]&&(v.top+=g/2),r=i(D.at,p,g),v.left+=r[0],v.top+=r[1],this.each(function(){var o,c,u=t(this),h=u.outerWidth(),d=u.outerHeight(),f=n(this,"marginLeft"),y=n(this,"marginTop"),C=h+f+n(this,"marginRight")+b.width,R=d+y+n(this,"marginBottom")+b.height,T=t.extend({},v),x=i(D.my,u.outerWidth(),u.outerHeight());"right"===e.my[0]?T.left-=h:"center"===e.my[0]&&(T.left-=h/2),"bottom"===e.my[1]?T.top-=d:"center"===e.my[1]&&(T.top-=d/2),T.left+=x[0],T.top+=x[1],t.support.offsetFractions||(T.left=l(T.left),T.top=l(T.top)),o={marginLeft:f,marginTop:y},t.each(["left","top"],function(i,n){t.ui.position[k[i]]&&t.ui.position[k[i]][n](T,{targetWidth:p,targetHeight:g,elemWidth:h,elemHeight:d,collisionPosition:o,collisionWidth:C,collisionHeight:R,offset:[r[0]+x[0],r[1]+x[1]],my:e.my,at:e.at,within:w,elem:u})}),e.using&&(c=function(t){var i=m.left-T.left,n=i+p-h,o=m.top-T.top,r=o+g-d,l={target:{element:_,left:m.left,top:m.top,width:p,height:g},element:{element:u,left:T.left,top:T.top,width:h,height:d},horizontal:n<0?"left":i>0?"right":"center",vertical:r<0?"top":o>0?"bottom":"middle"};p<h&&a(i+n)<p&&(l.horizontal="center"),g<d&&a(o+r)<g&&(l.vertical="middle"),s(a(i),a(n))>s(a(o),a(r))?l.important="horizontal":l.important="vertical",e.using.call(this,t,l)}),u.offset(t.extend(T,{using:c}))})},t.ui.position={fit:{left:function(t,e){var i,n=e.within,o=n.isWindow?n.scrollLeft:n.offset.left,r=n.width,a=t.left-e.collisionPosition.marginLeft,l=o-a,c=a+e.collisionWidth-r-o;e.collisionWidth>r?l>0&&c<=0?(i=t.left+l+e.collisionWidth-r-o,t.left+=l-i):c>0&&l<=0?t.left=o:l>c?t.left=o+r-e.collisionWidth:t.left=o:l>0?t.left+=l:c>0?t.left-=c:t.left=s(t.left-a,t.left)},top:function(t,e){var i,n=e.within,o=n.isWindow?n.scrollTop:n.offset.top,r=e.within.height,a=t.top-e.collisionPosition.marginTop,l=o-a,c=a+e.collisionHeight-r-o;e.collisionHeight>r?l>0&&c<=0?(i=t.top+l+e.collisionHeight-r-o,t.top+=l-i):c>0&&l<=0?t.top=o:l>c?t.top=o+r-e.collisionHeight:t.top=o:l>0?t.top+=l:c>0?t.top-=c:t.top=s(t.top-a,t.top)}},flip:{left:function(t,e){var i,n,o=e.within,r=o.offset.left+o.scrollLeft,s=o.width,l=o.isWindow?o.scrollLeft:o.offset.left,c=t.left-e.collisionPosition.marginLeft,u=c-l,h=c+e.collisionWidth-s-l,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];u<0?(i=t.left+d+p+f+e.collisionWidth-s-r,(i<0||i<a(u))&&(t.left+=d+p+f)):h>0&&(n=t.left-e.collisionPosition.marginLeft+d+p+f-l,(n>0||a(n)<h)&&(t.left+=d+p+f))},top:function(t,e){var i,n,o=e.within,r=o.offset.top+o.scrollTop,s=o.height,l=o.isWindow?o.scrollTop:o.offset.top,c=t.top-e.collisionPosition.marginTop,u=c-l,h=c+e.collisionHeight-s-l,d="top"===e.my[1],p=d?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,g=-2*e.offset[1];u<0?(n=t.top+p+f+g+e.collisionHeight-s-r,t.top+p+f+g>u&&(n<0||n<a(u))&&(t.top+=p+f+g)):h>0&&(i=t.top-e.collisionPosition.marginTop+p+f+g-l,t.top+p+f+g>h&&(i>0||a(i)<h)&&(t.top+=p+f+g))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,i,n,o,r,s=document.getElementsByTagName("body")[0],a=document.createElement("div");e=document.createElement(s?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},s&&t.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(r in n)e.style[r]=n[r];e.appendChild(a),i=s||document.documentElement,i.insertBefore(e,i.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",o=t(a).offset().left,t.support.offsetFractions=o>10&&o<11,e.innerHTML="",i.removeChild(e)}()}(jQuery),function(t,e){t.widget("ui.progressbar",{version:"1.10.2",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=t("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(t){return t===e?this.options.value:(this.options.value=this._constrainedValue(t),void this._refreshValue())},_constrainedValue:function(t){return t===e&&(t=this.options.value),this.indeterminate=t===!1,"number"!=typeof t&&(t=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),this._super(t,e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=t("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}})}(jQuery),function(t,e){var i=5;t.widget("ui.slider",t.ui.mouse,{version:"1.10.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,n=this.options,o=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),r="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",s=[];for(i=n.values&&n.values.length||1,o.length>i&&(o.slice(i).remove(),o=o.slice(0,i)),e=o.length;e<i;e++)s.push(r);this.handles=o.add(t(s.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(e){t(this).data("ui-slider-handle-index",e)})},_createRange:function(){var e=this.options,i="";e.range?(e.range===!0&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=t("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):this.range=t([])},_setupEvents:function(){var t=this.handles.add(this.range).filter("a");this._off(t),this._on(t,this._handleEvents),this._hoverable(t),this._focusable(t)},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var i,n,o,r,s,a,l,c,u=this,h=this.options;return!h.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(i),o=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var i=Math.abs(n-u.values(e));(o>i||o===i&&(e===u._lastChangedValue||u.values(e)===h.min))&&(o=i,r=t(this),s=e)}),a=this._start(e,s),a!==!1&&(this._mouseSliding=!0,this._handleIndex=s,r.addClass("ui-state-active").focus(),l=r.offset(),c=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=c?{left:0,top:0}:{left:e.pageX-l.left-r.width()/2,top:e.pageY-l.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,s,n),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,n,o,r;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),n=i/e,n>1&&(n=1),n<0&&(n=0),"vertical"===this.orientation&&(n=1-n),o=this._valueMax()-this._valueMin(),r=this._valueMin()+n*o,this._trimAlignValue(r)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("start",t,i)},_slide:function(t,e,i){var n,o,r;this.options.values&&this.options.values.length?(n=this.values(e?0:1),2===this.options.values.length&&this.options.range===!0&&(0===e&&i>n||1===e&&i<n)&&(i=n),i!==this.values(e)&&(o=this.values(),o[e]=i,r=this._trigger("slide",t,{handle:this.handles[e],value:i,values:o}),n=this.values(e?0:1),r!==!1&&this.values(e,i,!0))):i!==this.value()&&(r=this._trigger("slide",t,{handle:this.handles[e],value:i}),r!==!1&&this.value(i))},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("stop",t,i)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._lastChangedValue=e,this._trigger("change",t,i)}},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,i){var n,o,r;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(n=this.options.values,o=arguments[0],r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(o[r]),this._change(null,r);this._refreshValue()},_setOption:function(e,i){var n,o=0;switch("range"===e&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(o=this.options.values.length),t.Widget.prototype._setOption.apply(this,arguments),e){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=0;n<o;n+=1)this._change(null,n);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,n;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),n=0;n<i.length;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(t){if(t<=this._valueMin())return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,n=t-i;return 2*Math.abs(i)>=e&&(n+=i>0?e:-e),parseFloat(n.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var e,i,n,o,r,s=this.options.range,a=this.options,l=this,c=!this._animateOff&&a.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(n){i=(l.values(n)-l._valueMin())/(l._valueMax()-l._valueMin())*100,u["horizontal"===l.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[c?"animate":"css"](u,a.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===n&&l.range.stop(1,1)[c?"animate":"css"]({left:i+"%"},a.animate),1===n&&l.range[c?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:a.animate})):(0===n&&l.range.stop(1,1)[c?"animate":"css"]({bottom:i+"%"},a.animate),1===n&&l.range[c?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:a.animate}))),e=i}):(n=this.value(),o=this._valueMin(),r=this._valueMax(),i=r!==o?(n-o)/(r-o)*100:0,u["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[c?"animate":"css"](u,a.animate),"min"===s&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:i+"%"},a.animate),"max"===s&&"horizontal"===this.orientation&&this.range[c?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:a.animate}),"min"===s&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:i+"%"},a.animate),"max"===s&&"vertical"===this.orientation&&this.range[c?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:a.animate}))},_handleEvents:{keydown:function(e){var n,o,r,s,a=t(e.target).data("ui-slider-handle-index");switch(e.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,t(e.target).addClass("ui-state-active"),n=this._start(e,a),n===!1))return}switch(s=this.options.step,o=r=this.options.values&&this.options.values.length?this.values(a):this.value(),e.keyCode){case t.ui.keyCode.HOME:r=this._valueMin();break;case t.ui.keyCode.END:r=this._valueMax();break;case t.ui.keyCode.PAGE_UP:r=this._trimAlignValue(o+(this._valueMax()-this._valueMin())/i);break;case t.ui.keyCode.PAGE_DOWN:r=this._trimAlignValue(o-(this._valueMax()-this._valueMin())/i);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(o===this._valueMax())return;r=this._trimAlignValue(o+s);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(o===this._valueMin())return;r=this._trimAlignValue(o-s)}this._slide(e,a,r)},click:function(t){t.preventDefault()},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),t(e.target).removeClass("ui-state-active"))}}})}(jQuery),function(t){function e(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}t.widget("ui.spinner",{version:"1.10.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e={},i=this.element;return t.each(["min","max","step"],function(t,n){var o=i.attr(n);void 0!==o&&o.length&&(e[n]=o)}),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",t)))},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(e){function i(){var t=this.element[0]===this.document[0].activeElement;t||(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n}))}var n;n=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(e)!==!1&&this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){if(t(e.currentTarget).hasClass("ui-state-active"))return this._start(e)!==!1&&void this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var t=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=t.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*t.height())&&t.height()>0&&t.height(t.height()),this.options.disabled&&this.disable()},_keydown:function(e){var i=this.options,n=t.ui.keyCode;switch(e.keyCode){case n.UP:return this._repeat(null,1,e),!0;case n.DOWN:return this._repeat(null,-1,e),!0;case n.PAGE_UP:return this._repeat(null,i.page,e),!0;case n.PAGE_DOWN:return this._repeat(null,-i.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(t){return!(!this.spinning&&this._trigger("start",t)===!1)&&(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&this._trigger("spin",e,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(e){var i=this.options.incremental;return i?t.isFunction(i)?i(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=t.toString(),i=e.indexOf(".");return i===-1?0:e.length-i-1},_adjustValue:function(t){var e,i,n=this.options;return e=null!==n.min?n.min:0,i=t-e,i=Math.round(i/n.step)*n.step,t=e+i,t=parseFloat(t.toFixed(this._precision())),null!==n.max&&t>n.max?n.max:null!==n.min&&t<n.min?n.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){if("culture"===t||"numberFormat"===t){var i=this._parse(this.element.val());return this.options[t]=e,void this.element.val(this._format(i))}"max"!==t&&"min"!==t&&"step"!==t||"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(e.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(e.down)),this._super(t,e),"disabled"===t&&(e?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:e(function(t){this._super(t),this._value(this.element.val())}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(t,e){var i;""!==t&&(i=this._parse(t),null!==i&&(e||(i=this._adjustValue(i)),t=this._format(i))),this.element.val(t),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:e(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:e(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:e(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:e(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){return arguments.length?void e(this._value).call(this,t):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}(jQuery),function(t,e){function i(){return++o}function n(t){return t.hash.length>1&&decodeURIComponent(t.href.replace(r,""))===decodeURIComponent(location.href.replace(r,""))}var o=0,r=/#.*$/;t.widget("ui.tabs",{version:"1.10.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var e=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(e){
t(this).is(".ui-state-disabled")&&e.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),i.active=this._initialActive(),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),function(t){return e.tabs.index(t)}))).sort()),this.options.active!==!1&&this.anchors.length?this.active=this._findActive(i.active):this.active=t(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var e=this.options.active,i=this.options.collapsible,n=location.hash.substring(1);return null===e&&(n&&this.tabs.each(function(i,o){if(t(o).attr("aria-controls")===n)return e=i,!1}),null===e&&(e=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null!==e&&e!==-1||(e=!!this.tabs.length&&0)),e!==!1&&(e=this.tabs.index(this.tabs.eq(e)),e===-1&&(e=!i&&0)),!i&&e===!1&&this.anchors.length&&(e=0),e},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(e){var i=t(this.document[0].activeElement).closest("li"),n=this.tabs.index(i),o=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:n++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:o=!1,n--;break;case t.ui.keyCode.END:n=this.anchors.length-1;break;case t.ui.keyCode.HOME:n=0;break;case t.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(n);case t.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(n!==this.options.active&&n);default:return}e.preventDefault(),clearTimeout(this.activating),n=this._focusNextTab(n,o),e.ctrlKey||(i.attr("aria-selected","false"),this.tabs.eq(n).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",n)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(e){return e.altKey&&e.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,i){function n(){return e>o&&(e=0),e<0&&(e=o),e}for(var o=this.tabs.length-1;t.inArray(n(),this.options.disabled)!==-1;)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).focus(),t},_setOption:function(t,e){return"active"===t?void this._activate(e):"disabled"===t?void this._setupDisabled(e):(this._super(t,e),"collapsible"===t&&(this.element.toggleClass("ui-tabs-collapsible",e),e||this.options.active!==!1||this._activate(0)),"event"===t&&this._setupEvents(e),void("heightStyle"===t&&this._setupHeightStyle(e)))},_tabId:function(t){return t.attr("aria-controls")||"ui-tabs-"+i()},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,i=this.tablist.children(":has(a[href])");e.disabled=t.map(i.filter(".ui-state-disabled"),function(t){return i.index(t)}),this._processTabs(),e.active!==!1&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return t("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=t(),this.anchors.each(function(i,o){var r,s,a,l=t(o).uniqueId().attr("id"),c=t(o).closest("li"),u=c.attr("aria-controls");n(o)?(r=o.hash,s=e.element.find(e._sanitizeSelector(r))):(a=e._tabId(c),r="#"+a,s=e.element.find(r),s.length||(s=e._createPanel(a),s.insertAfter(e.panels[i-1]||e.tablist)),s.attr("aria-live","polite")),s.length&&(e.panels=e.panels.add(s)),u&&c.data("ui-tabs-aria-controls",u),c.attr({"aria-controls":r.substring(1),"aria-labelledby":l}),s.attr("aria-labelledby",l)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var i,n=0;i=this.tabs[n];n++)e===!0||t.inArray(n,e)!==-1?t(i).addClass("ui-state-disabled").attr("aria-disabled","true"):t(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var i={click:function(t){t.preventDefault()}};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,n=this.element.parent();"fill"===e?(i=n.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var e=t(this),n=e.css("position");"absolute"!==n&&"fixed"!==n&&(i-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=t(this).outerHeight(!0)}),this.panels.each(function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each(function(){i=Math.max(i,t(this).height("").height())}).height(i))},_eventHandler:function(e){var i=this.options,n=this.active,o=t(e.currentTarget),r=o.closest("li"),s=r[0]===n[0],a=s&&i.collapsible,l=a?t():this._getPanelForTab(r),c=n.length?this._getPanelForTab(n):t(),u={oldTab:n,oldPanel:c,newTab:a?t():r,newPanel:l};e.preventDefault(),r.hasClass("ui-state-disabled")||r.hasClass("ui-tabs-loading")||this.running||s&&!i.collapsible||this._trigger("beforeActivate",e,u)===!1||(i.active=!a&&this.tabs.index(r),this.active=s?t():r,this.xhr&&this.xhr.abort(),c.length||l.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),l.length&&this.load(this.tabs.index(r),e),this._toggle(e,u))},_toggle:function(e,i){function n(){r.running=!1,r._trigger("activate",e,i)}function o(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),s.length&&r.options.show?r._show(s,r.options.show,n):(s.show(),n())}var r=this,s=i.newPanel,a=i.oldPanel;this.running=!0,a.length&&this.options.hide?this._hide(a,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),o()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a.hide(),o()),a.attr({"aria-expanded":"false","aria-hidden":"true"}),i.oldTab.attr("aria-selected","false"),s.length&&a.length?i.oldTab.attr("tabIndex",-1):s.length&&this.tabs.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),s.attr({"aria-expanded":"true","aria-hidden":"false"}),i.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(e){var i,n=this._findActive(e);n[0]!==this.active[0]&&(n.length||(n=this.active),i=n.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return e===!1?t():this.tabs.eq(e)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+t+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var e=t(this),i=e.data("ui-tabs-aria-controls");i?e.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var n=this.options.disabled;n!==!1&&(i===e?n=!1:(i=this._getIndex(i),n=t.isArray(n)?t.map(n,function(t){return t!==i?t:null}):t.map(this.tabs,function(t,e){return e!==i?e:null})),this._setupDisabled(n))},disable:function(i){var n=this.options.disabled;if(n!==!0){if(i===e)n=!0;else{if(i=this._getIndex(i),t.inArray(i,n)!==-1)return;n=t.isArray(n)?t.merge([i],n).sort():[i]}this._setupDisabled(n)}},load:function(e,i){e=this._getIndex(e);var o=this,r=this.tabs.eq(e),s=r.find(".ui-tabs-anchor"),a=this._getPanelForTab(r),l={tab:r,panel:a};n(s[0])||(this.xhr=t.ajax(this._ajaxSettings(s,i,l)),this.xhr&&"canceled"!==this.xhr.statusText&&(r.addClass("ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.success(function(t){setTimeout(function(){a.html(t),o._trigger("load",i,l)},1)}).complete(function(t,e){setTimeout(function(){"abort"===e&&o.panels.stop(!1,!0),r.removeClass("ui-tabs-loading"),a.removeAttr("aria-busy"),t===o.xhr&&delete o.xhr},1)})))},_ajaxSettings:function(e,i,n){var o=this;return{url:e.attr("href"),beforeSend:function(e,r){return o._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:r},n))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}})}(jQuery),function(t){function e(e,i){var n=(e.attr("aria-describedby")||"").split(/\s+/);n.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(n.join(" ")))}function i(e){var i=e.data("ui-tooltip-id"),n=(e.attr("aria-describedby")||"").split(/\s+/),o=t.inArray(i,n);o!==-1&&n.splice(o,1),e.removeData("ui-tooltip-id"),n=t.trim(n.join(" ")),n?e.attr("aria-describedby",n):e.removeAttr("aria-describedby")}var n=0;t.widget("ui.tooltip",{version:"1.10.2",options:{content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(e,i){var n=this;return"disabled"===e?(this[i?"_disable":"_enable"](),void(this.options[e]=i)):(this._super(e,i),void("content"===e&&t.each(this.tooltips,function(t,e){n._updateContent(e)})))},_disable:function(){var e=this;t.each(this.tooltips,function(i,n){var o=t.Event("blur");o.target=o.currentTarget=n[0],e.close(o,!0)}),this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var i=this,n=t(e?e.target:this.element).closest(this.options.items);n.length&&!n.data("ui-tooltip-id")&&(n.attr("title")&&n.data("ui-tooltip-title",n.attr("title")),n.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&n.parents().each(function(){var e,n=t(this);n.data("ui-tooltip-open")&&(e=t.Event("blur"),e.target=e.currentTarget=this,i.close(e,!0)),n.attr("title")&&(n.uniqueId(),i.parents[this.id]={element:this,title:n.attr("title")},n.attr("title",""))}),this._updateContent(n,e))},_updateContent:function(t,e){var i,n=this.options.content,o=this,r=e?e.type:null;return"string"==typeof n?this._open(e,t,n):(i=n.call(t[0],function(i){t.data("ui-tooltip-open")&&o._delay(function(){e&&(e.type=r),this._open(e,t,i)})}),void(i&&this._open(e,t,i)))},_open:function(i,n,o){function r(t){c.of=t,s.is(":hidden")||s.position(c)}var s,a,l,c=t.extend({},this.options.position);if(o){if(s=this._find(n),s.length)return void s.find(".ui-tooltip-content").html(o);n.is("[title]")&&(i&&"mouseover"===i.type?n.attr("title",""):n.removeAttr("title")),s=this._tooltip(n),e(n,s.attr("id")),s.find(".ui-tooltip-content").html(o),this.options.track&&i&&/^mouse/.test(i.type)?(this._on(this.document,{mousemove:r}),r(i)):s.position(t.extend({of:n},this.options.position)),s.hide(),this._show(s,this.options.show),this.options.show&&this.options.show.delay&&(l=this.delayedShow=setInterval(function(){s.is(":visible")&&(r(c.of),clearInterval(l))},t.fx.interval)),this._trigger("open",i,{tooltip:s}),a={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var i=t.Event(e);i.currentTarget=n[0],this.close(i,!0)}},remove:function(){this._removeTooltip(s)}},i&&"mouseover"!==i.type||(a.mouseleave="close"),i&&"focusin"!==i.type||(a.focusout="close"),this._on(!0,n,a)}},close:function(e){var n=this,o=t(e?e.currentTarget:this.element),r=this._find(o);this.closing||(clearInterval(this.delayedShow),o.data("ui-tooltip-title")&&o.attr("title",o.data("ui-tooltip-title")),i(o),r.stop(!0),this._hide(r,this.options.hide,function(){n._removeTooltip(t(this))}),o.removeData("ui-tooltip-open"),this._off(o,"mouseleave focusout keyup"),o[0]!==this.element[0]&&this._off(o,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,function(e,i){t(i.element).attr("title",i.title),delete n.parents[e]}),this.closing=!0,this._trigger("close",e,{tooltip:r}),this.closing=!1)},_tooltip:function(e){var i="ui-tooltip-"+n++,o=t("<div>").attr({id:i,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return t("<div>").addClass("ui-tooltip-content").appendTo(o),o.appendTo(this.document[0].body),this.tooltips[i]=e,o},_find:function(e){var i=e.data("ui-tooltip-id");return i?t("#"+i):t()},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_destroy:function(){var e=this;t.each(this.tooltips,function(i,n){var o=t.Event("blur");o.target=o.currentTarget=n[0],e.close(o,!0),t("#"+i).remove(),n.data("ui-tooltip-title")&&(n.attr("title",n.data("ui-tooltip-title")),n.removeData("ui-tooltip-title"))})}})}(jQuery),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(e){return t.isFunction(e)||"object"==typeof e?e:{top:e,left:e}}var i=t.scrollTo=function(e,i,n){return t(window).scrollTo(e,i,n)};return i.defaults={axis:"xy",duration:parseFloat(t.fn.jquery)>=1.3?0:1,limit:!0},i.window=function(e){return t(window)._scrollable()},t.fn._scrollable=function(){return this.map(function(){var e=this,i=!e.nodeName||t.inArray(e.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!i)return e;var n=(e.contentWindow||e).document||e.ownerDocument||e;return/webkit/i.test(navigator.userAgent)||"BackCompat"==n.compatMode?n.body:n.documentElement})},t.fn.scrollTo=function(n,o,r){return"object"==typeof o&&(r=o,o=0),"function"==typeof r&&(r={onAfter:r}),"max"==n&&(n=9e9),r=t.extend({},i.defaults,r),o=o||r.duration,r.queue=r.queue&&r.axis.length>1,r.queue&&(o/=2),r.offset=e(r.offset),r.over=e(r.over),this._scrollable().each(function(){function s(t){c.animate(h,o,r.easing,t&&function(){t.call(this,u,r)})}if(null!=n){var a,l=this,c=t(l),u=n,h={},d=c.is("html,body");switch(typeof u){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(u)){u=e(u);break}if(u=t(u,this),!u.length)return;case"object":(u.is||u.style)&&(a=(u=t(u)).offset())}var p=t.isFunction(r.offset)&&r.offset(l,u)||r.offset;t.each(r.axis.split(""),function(t,e){var n="x"==e?"Left":"Top",o=n.toLowerCase(),f="scroll"+n,g=l[f],m=i.max(l,e);if(a)h[f]=a[o]+(d?0:g-c.offset()[o]),r.margin&&(h[f]-=parseInt(u.css("margin"+n))||0,h[f]-=parseInt(u.css("border"+n+"Width"))||0),h[f]+=p[o]||0,r.over[o]&&(h[f]+=u["x"==e?"width":"height"]()*r.over[o]);else{var v=u[o];h[f]=v.slice&&"%"==v.slice(-1)?parseFloat(v)/100*m:v}r.limit&&/^\d+$/.test(h[f])&&(h[f]=h[f]<=0?0:Math.min(h[f],m)),!t&&r.queue&&(g!=h[f]&&s(r.onAfterFirst),delete h[f])}),s(r.onAfter)}}).end()},i.max=function(e,i){var n="x"==i?"Width":"Height",o="scroll"+n;if(!t(e).is("html,body"))return e[o]-t(e)[n.toLowerCase()]();var r="client"+n,s=e.ownerDocument.documentElement,a=e.ownerDocument.body;return Math.max(s[o],a[o])-Math.min(s[r],a[r])},i}),!function(t){"use strict";function e(){t(n).each(function(){i(t(this)).removeClass("open")})}function i(e){var i,n=e.attr("data-target");return n||(n=e.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),i=n&&t(n),i&&i.length||(i=e.parent()),i}var n="[data-toggle=dropdown]",o=function(e){var i=t(e).on("click.dropdown.data-api",this.toggle);t("html").on("click.dropdown.data-api",function(){i.parent().removeClass("open")})};o.prototype={constructor:o,toggle:function(n){var o,r,s=t(this);if(!s.is(".disabled, :disabled"))return o=i(s),r=o.hasClass("open"),e(),r||o.toggleClass("open"),s.focus(),!1},keydown:function(e){var o,r,s,a,l;if(/(38|40|27)/.test(e.keyCode)&&(o=t(this),e.preventDefault(),e.stopPropagation(),!o.is(".disabled, :disabled"))){if(s=i(o),a=s.hasClass("open"),!a||a&&27==e.keyCode)return 27==e.which&&s.find(n).focus(),o.click();r=t("[role=menu] li:not(.divider):visible a",s),r.length&&(l=r.index(r.filter(":focus")),38==e.keyCode&&l>0&&l--,40==e.keyCode&&l<r.length-1&&l++,~l||(l=0),r.eq(l).focus())}}};var r=t.fn.dropdown;t.fn.dropdown=function(e){return this.each(function(){var i=t(this),n=i.data("dropdown");n||i.data("dropdown",n=new o(this)),"string"==typeof e&&n[e].call(i)})},t.fn.dropdown.Constructor=o,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=r,this},t(document).on("click.dropdown.data-api",e).on("click.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.dropdown-menu",function(t){t.stopPropagation()}).on("click.dropdown.data-api",n,o.prototype.toggle).on("keydown.dropdown.data-api",n+", [role=menu]",o.prototype.keydown)}(window.jQuery),!function(t){"use strict";var e=function(e,i){this.options=i,this.$element=t(e).delegate('[data-dismiss="modal"]',"click.dismiss.modal",t.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};e.prototype={constructor:e,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var e=this,i=t.Event("show");this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var i=t.support.transition&&e.$element.hasClass("fade");e.$element.parent().length||e.$element.appendTo(document.body),e.$element.show(),i&&e.$element[0].offsetWidth,e.$element.addClass("in").attr("aria-hidden",!1),e.enforceFocus(),i?e.$element.one(t.support.transition.end,function(){e.$element.focus().trigger("shown")}):e.$element.focus().trigger("shown")}))},hide:function(e){e&&e.preventDefault();e=t.Event("hide"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),t(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),t.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var e=this;t(document).on("focusin.modal",function(t){e.$element[0]===t.target||e.$element.has(t.target).length||e.$element.focus()})},escape:function(){var t=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(e){27==e.which&&t.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var e=this,i=setTimeout(function(){e.$element.off(t.support.transition.end),e.hideModal()},500);this.$element.one(t.support.transition.end,function(){clearTimeout(i),e.hideModal()})},hideModal:function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(e){var i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=t.support.transition&&i;if(this.$backdrop=t('<div class="modal-backdrop '+i+'" />').appendTo(document.body),this.$backdrop.click("static"==this.options.backdrop?t.proxy(this.$element[0].focus,this.$element[0]):t.proxy(this.hide,this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;n?this.$backdrop.one(t.support.transition.end,e):e()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(t.support.transition.end,e):e()):e&&e()}};var i=t.fn.modal;t.fn.modal=function(i){return this.each(function(){var n=t(this),o=n.data("modal"),r=t.extend({},t.fn.modal.defaults,n.data(),"object"==typeof i&&i);o||n.data("modal",o=new e(this,r)),"string"==typeof i?o[i]():r.show&&o.show()})},t.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},t.fn.modal.Constructor=e,t.fn.modal.noConflict=function(){return t.fn.modal=i,this},t(document).on("click.modal.data-api",'[data-toggle="modal"]',function(e){var i=t(this),n=i.attr("href"),o=t(i.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,"")),r=o.data("modal")?"toggle":t.extend({remote:!/#/.test(n)&&n},o.data(),i.data());e.preventDefault(),o.modal(r).one("hide",function(){i.focus()})})}(window.jQuery),!function(t){"use strict";var e=function(t,e){this.init("tooltip",t,e)};e.prototype={constructor:e,init:function(e,i,n){var o,r,s,a,l;for(this.type=e,this.$element=t(i),this.options=this.getOptions(n),this.enabled=!0,s=this.options.trigger.split(" "),l=s.length;l--;)a=s[l],"click"==a?this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this)):"manual"!=a&&(o="hover"==a?"mouseenter":"focus",r="hover"==a?"mouseleave":"blur",this.$element.on(o+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(r+"."+this.type,this.options.selector,t.proxy(this.leave,this)));this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(e){return e=t.extend({},t.fn[this.type].defaults,this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},enter:function(e){var i,n=t.fn[this.type].defaults,o={};return this._options&&t.each(this._options,function(t,e){n[t]!=e&&(o[t]=e)},this),i=t(e.currentTarget)[this.type](o).data(this.type),i.options.delay&&i.options.delay.show?(clearTimeout(this.timeout),i.hoverState="in",void(this.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show))):i.show()},leave:function(e){var i=t(e.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),i.options.delay&&i.options.delay.hide?(i.hoverState="out",void(this.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide))):i.hide()},show:function(){var e,i,n,o,r,s,a=t.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(a),a.isDefaultPrevented())return;switch(e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),r="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,e.detach().css({top:0,left:0,display:"block"}),this.options.container?e.appendTo(this.options.container):e.insertAfter(this.$element),i=this.getPosition(),n=e[0].offsetWidth,o=e[0].offsetHeight,r){case"bottom":s={top:i.top+i.height,left:i.left+i.width/2-n/2};break;case"top":s={top:i.top-o,left:i.left+i.width/2-n/2};break;case"left":s={top:i.top+i.height/2-o/2,left:i.left-n};break;case"right":s={top:i.top+i.height/2-o/2,left:i.left+i.width}}this.applyPlacement(s,r),this.$element.trigger("shown")}},applyPlacement:function(t,e){var i,n,o,r,s=this.tip(),a=s[0].offsetWidth,l=s[0].offsetHeight;s.offset(t).addClass(e).addClass("in"),i=s[0].offsetWidth,n=s[0].offsetHeight,"top"==e&&n!=l&&(t.top=t.top+l-n,r=!0),"bottom"==e||"top"==e?(o=0,t.left<0&&(o=t.left*-2,t.left=0,s.offset(t),i=s[0].offsetWidth,n=s[0].offsetHeight),this.replaceArrow(o-a+i,i,"left")):this.replaceArrow(n-l,n,"top"),r&&s.offset(t)},replaceArrow:function(t,e,i){this.arrow().css(i,t?50*(1-t/e)+"%":"")},setContent:function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},hide:function(){function e(){var e=setTimeout(function(){i.off(t.support.transition.end).detach()},500);i.one(t.support.transition.end,function(){clearTimeout(e),i.detach()})}var i=this.tip(),n=t.Event("hide");if(this.$element.trigger(n),!n.isDefaultPrevented())return i.removeClass("in"),t.support.transition&&this.$tip.hasClass("fade")?e():i.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var e=this.$element[0];return t.extend({},"function"==typeof e.getBoundingClientRect?e.getBoundingClientRect():{width:e.offsetWidth,height:e.offsetHeight},this.$element.offset())},getTitle:function(){var t,e=this.$element,i=this.options;return t=e.attr("data-original-title")||("function"==typeof i.title?i.title.call(e[0]):i.title)},tip:function(){return this.$tip=this.$tip||t(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(e){var i=e?t(e.currentTarget)[this.type](this._options).data(this.type):this;i.tip().hasClass("in")?i.hide():i.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var i=t.fn.tooltip;t.fn.tooltip=function(i){return this.each(function(){var n=t(this),o=n.data("tooltip"),r="object"==typeof i&&i;o||n.data("tooltip",o=new e(this,r)),"string"==typeof i&&o[i]()})},t.fn.tooltip.Constructor=e,t.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.fn.tooltip.noConflict=function(){return t.fn.tooltip=i,this}}(window.jQuery),!function(t){"use strict";var e=function(t,e){this.init("popover",t,e)};e.prototype=t.extend({},t.fn.tooltip.Constructor.prototype,{constructor:e,setContent:function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content")[this.options.html?"html":"text"](i),t.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var t,e=this.$element,i=this.options;return t=("function"==typeof i.content?i.content.call(e[0]):i.content)||e.attr("data-content")},tip:function(){return this.$tip||(this.$tip=t(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var i=t.fn.popover;t.fn.popover=function(i){return this.each(function(){var n=t(this),o=n.data("popover"),r="object"==typeof i&&i;o||n.data("popover",o=new e(this,r)),"string"==typeof i&&o[i]()})},t.fn.popover.Constructor=e,t.fn.popover.defaults=t.extend({},t.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.fn.popover.noConflict=function(){return t.fn.popover=i,this}}(window.jQuery),function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,i){var n=(new Date).getTime(),o=Math.max(0,16-(n-t)),r=window.setTimeout(function(){e(n+o)},o);return t=n+o,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),function(t){function e(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())}function i(t,e){return String(t)==String(e)}function n(t,e){if(t instanceof Date)return n(t.getFullYear(),t.getMonth());if(1==e){var i=!(t%4!=0||t%100==0&&t%400!=0);return i?29:28}return 3==e||5==e||8==e||10==e?30:31}function o(t){var e=t.getFullYear(),i=t.getMonth(),o=t.getDate(),r=n(t);return o==r?11==i?new Date(e+1,0,1):new Date(e,i+1,1):new Date(e,i,o+1)}function r(t){var e=t.getFullYear(),i=t.getMonth(),o=t.getDate();return 1==o?0==i?new Date(e-1,11,n(e-1,11)):new Date(e,i-1,n(e,i-1)):new Date(e,i,o-1)}function s(t,e){return 11==e?new Date(t+1,0,1):new Date(t,e+1,1)}function a(t,e){e=e||{},e.separator=e.separator||"/";var i;return i=e.usa?t.getMonth()+1+e.separator+t.getDate():t.getDate()+e.separator+(t.getMonth()+1),i+e.separator+t.getFullYear()}function l(t,e){e=e||{};var i,n,o,r;return i=t.split(/\D/),e.usa?(o=i.shift(),n=i.shift()):(n=i.shift(),o=i.shift()),r=i.shift(),new Date(o+"/"+n+"/"+r)}function c(t,e,i){var n=e;if(e<10&&(n="0"+e),i.isoTime){var o=t;return o<10&&(o="0"+t),o+":"+n}var o=t%12;if(0==o&&(o=12),i.meridiemUpperCase){var r=t<12?"AM":"PM";24==t&&(r="AM")}else{var r=t<12?"am":"pm";24==t&&(r="am")}if(0===e){if(0===t)return"Start of day";if(24===t)return"End of day"}return o+":"+n+r}function u(t){if("End of day"===t)return{hour:24,minute:0};if("Start of day"===t)return{hour:0,minute:0};var e=e=/(\d+)\s*[:\-\.,]\s*(\d+)\s*(am|pm)?/i.exec(t);if(e&&e.length>=3){var i=Number(e[1]),n=Number(e[2]);return 12==i&&e[3]&&(i-=12),e[3]&&"pm"==e[3].toLowerCase()&&(i+=12),{hour:i,minute:n}}return null}function h(t){return t&&60*t.hour+t.minute}function d(e,i,n,o){var r=t("<thead />"),s=t("<tr />").appendTo(r);t("<th />").addClass("monthCell").append(t('<a href="javascript:;">&laquo;</a>').addClass("prevMonth").mousedown(function(t){p(e,0==n?i-1:i,0==n?11:n-1,o),t.preventDefault()})).appendTo(s),t("<th />").addClass("monthCell").attr("colSpan",5).append(t('<a href="javascript:;">'+g[n]+" "+i+"</a>").addClass("monthName")).appendTo(s),t("<th />").addClass("monthCell").append(t('<a href="javascript:;">&raquo;</a>').addClass("nextMonth").mousedown(function(){p(e,11==n?i+1:i,11==n?0:n+1,o)})).appendTo(s);var a=t("<tr />").appendTo(r);return t.each(String("SMTWTFS").split(""),function(e,i){t("<td />").addClass("dayName").append(i).appendTo(a)}),r}function p(n,a,l,c){
c=c||{};var u=e(),h=new Date(a,l,1),p=s(a,l),f=6-p.getDay();f<6&&(f+=7);for(var g=0;g<f;g++)p=o(p);var m=t("<table />");d(n,a,l,c).appendTo(m);for(var v=t("<tbody />").appendTo(m),y=t("<tr />"),_=h.getDay()+7,g=0;g<_;g++)h=r(h);for(;h<=p;){var w=t("<td />").addClass("day").append(t('<a href="javascript:;">'+h.getDate()+"</a>").click(function(){var t=h;return function(){c&&c.selectDate&&c.selectDate(t)}}())).appendTo(y),b=i(h,u),k=c.selected&&i(c.selected,h);b&&w.addClass("today"),k&&w.addClass("selected"),b&&k&&w.addClass("today_selected"),h.getMonth()!=l&&w.addClass("nonMonth"),dow=h.getDay(),6==dow&&(v.append(y),y=t("<tr />")),h=o(h)}y.children().length?v.append(y):y.remove(),n.empty().append(m)}function f(e,i){var n=h(i.minTime),o=h(i.maxTime),r=h(i.defaultTime),s=i.selection&&h(u(i.selection));s=s&&Math.floor((s-n)/i.timeInterval)*i.timeInterval+n;var a,l,d=t("<ul />");l=i.showDuration?o+i.timeInterval:o;for(var p=n;p<=l;p+=i.timeInterval)!function(e){var o=Math.floor(e/60),l=e%60,u=c(o,l,i),h=u;if(i.showDuration){var p=e-n;h+=p<60?" ("+p+" mins)":60==p?" (1 hr)":" ("+Math.round(p/60*10)/10+" hrs)"}var f=t("<li />").append(t('<a href="javascript:;">'+h+"</a>").click(function(){i&&i.selectTime&&i.selectTime(u)}).mousemove(function(){t("li.selected",d).removeClass("selected")})).appendTo(d);a||e!=r||(a=f),s==e&&(f.addClass("selected"),a=f)}(p);a&&setTimeout(function(){e[0].scrollTop=a[0].offsetTop-2*a.height()},0),e.empty().append(d)}var g=["January","February","March","April","May","June","July","August","September","October","November","December"];t.fn.calendricalDate=function(i){return i=i||{},i.padding=i.padding||4,this.each(function(){var n,o=t(this),r=!1;o.bind("focus click",function(){if(!n){var s=o.position();o.css("padding-left");n=t("<div />").addClass("calendricalDatePopup").mouseenter(function(){r=!0}).mouseleave(function(){r=!1}).mousedown(function(t){t.preventDefault()}).css({position:"absolute",left:s.left,top:s.top+o.height()+2*i.padding}),o.after(n);var c=l(o.val(),i);c.getFullYear()||(c=e()),p(n,c.getFullYear(),c.getMonth(),{selected:c,selectDate:function(t){if(r=!1,o.val(a(t,i)).change(),n.remove(),n=null,i.endDate){var e=l(i.endDate.val(),i);e>=c&&i.endDate.val(a(new Date(t.getTime()+e.getTime()-c.getTime()),i.usa,i.separator))}}})}}).blur(function(){return r?void(n&&o.focus()):void(n&&(n.remove(),n=null))})})},t.fn.calendricalDateRange=function(e){return this.length>=2&&(t(this[0]).calendricalDate(t.extend({endDate:t(this[1])},e)),t(this[1]).calendricalDate(e)),this},t.fn.calendricalTime=function(e){return e=e||{},e.timeInterval=e.timeInterval||30,e.padding=e.padding||4,this.each(function(){var n,o=t(this),r=!1;o.attr("autocomplete","off"),o.bind("focus click",function(){if(!n){var s=o.position();n=t("<div />").addClass("calendricalTimePopup").mouseenter(function(){r=!0}).mouseleave(function(){r=!1}).mousedown(function(t){t.preventDefault()}).css({position:"absolute",left:s.left,top:s.top+o.height()+2*e.padding}),o.after(n);var a={selection:o.val(),selectTime:function(t){r=!1,o.val(t).change(),n.remove(),n=null},isoTime:e.isoTime||!1,meridiemUpperCase:e.meridiemUpperCase||!1,defaultTime:e.defaultTime||{hour:8,minute:0},minTime:e.minTime||{hour:0,minute:0},maxTime:e.maxTime||{hour:23,minute:59},timeInterval:e.timeInterval||30};if(e.startTime){var c=u(e.startTime.val());e.startDate&&e.endDate&&!i(l(e.startDate.val(),e),l(e.endDate.val(),e))&&(c=null),c&&(a.minTime=c,a.defaultTime=c,a.showDuration=!0,n.addClass("calendricalEndTimePopup"))}f(n,a)}}).blur(function(){return r?void(n&&o.focus()):void(n&&(n.remove(),n=null))})})},t.fn.calendricalTimeRange=function(e){return this.length>=2&&(t(this[0]).calendricalTime(e),t(this[1]).calendricalTime(t.extend({startTime:t(this[0])},e))),this},t.fn.calendricalDateTimeRange=function(e){return this.length>=4&&(t(this[0]).calendricalDate(t.extend({endDate:t(this[2])},e)),t(this[1]).calendricalTime(e),t(this[2]).calendricalDate(e),t(this[3]).calendricalTime(t.extend({startTime:t(this[1]),startDate:t(this[0]),endDate:t(this[2])},e))),this}}(jQuery),function(t){"use strict";function e(t,e){return Math.round(t/e)*e}function i(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)}function n(t){var e=Math.pow(10,7);return Number((Math.round(t*e)/e).toFixed(7))}function o(t,e,i){t.addClass(e),setTimeout(function(){t.removeClass(e)},i)}function r(t){return Math.max(Math.min(t,100),0)}function s(e){return t.isArray(e)?e:[e]}function a(t){var e=t.split(".");return e.length>1?e[1].length:0}function l(t,e){return 100/(e-t)}function c(t,e){return 100*e/(t[1]-t[0])}function u(t,e){return c(t,t[0]<0?e+Math.abs(t[0]):e-t[0])}function h(t,e){return e*(t[1]-t[0])/100+t[0]}function d(t,e){for(var i=1;t>=e[i];)i+=1;return i}function p(t,e,i){if(i>=t.slice(-1)[0])return 100;var n,o,r,s,a=d(i,t);return n=t[a-1],o=t[a],r=e[a-1],s=e[a],r+u([n,o],i)/l(r,s)}function f(t,e,i){if(i>=100)return t.slice(-1)[0];var n,o,r,s,a=d(i,e);return n=t[a-1],o=t[a],r=e[a-1],s=e[a],h([n,o],(i-r)*l(r,s))}function g(t,i,n,o){if(100===o)return o;var r,s,a=d(o,t);return n?(r=t[a-1],s=t[a],o-r>(s-r)/2?s:r):i[a-1]?t[a-1]+e(o-t[a-1],i[a-1]):o}function m(t,e,n){var o;if("number"==typeof e&&(e=[e]),"[object Array]"!==Object.prototype.toString.call(e))throw new Error("noUiSlider: 'range' contains invalid value.");if(o="min"===t?0:"max"===t?100:parseFloat(t),!i(o)||!i(e[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");n.xPct.push(o),n.xVal.push(e[0]),o?n.xSteps.push(!isNaN(e[1])&&e[1]):isNaN(e[1])||(n.xSteps[0]=e[1])}function v(t,e,i){return!e||void(i.xSteps[t]=c([i.xVal[t],i.xVal[t+1]],e)/l(i.xPct[t],i.xPct[t+1]))}function y(t,e,i,n){this.xPct=[],this.xVal=[],this.xSteps=[n||!1],this.xNumSteps=[!1],this.snap=e,this.direction=i;var o,r=[];for(o in t)t.hasOwnProperty(o)&&r.push([t[o],o]);for(r.sort(function(t,e){return t[0]-e[0]}),o=0;o<r.length;o++)m(r[o][1],r[o][0],this);for(this.xNumSteps=this.xSteps.slice(0),o=0;o<this.xNumSteps.length;o++)v(o,this.xNumSteps[o],this)}function _(t,e){if(!i(e))throw new Error("noUiSlider: 'step' is not numeric.");t.singleStep=e}function w(e,i){if("object"!=typeof i||t.isArray(i))throw new Error("noUiSlider: 'range' is not an object.");if(void 0===i.min||void 0===i.max)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");e.spectrum=new y(i,e.snap,e.dir,e.singleStep)}function b(e,i){if(i=s(i),!t.isArray(i)||!i.length||i.length>2)throw new Error("noUiSlider: 'start' option is incorrect.");e.handles=i.length,e.start=i}function k(t,e){if(t.snap=e,"boolean"!=typeof e)throw new Error("noUiSlider: 'snap' option must be a boolean.")}function D(t,e){if(t.animate=e,"boolean"!=typeof e)throw new Error("noUiSlider: 'animate' option must be a boolean.")}function C(t,e){if("lower"===e&&1===t.handles)t.connect=1;else if("upper"===e&&1===t.handles)t.connect=2;else if(e===!0&&2===t.handles)t.connect=3;else{if(e!==!1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");t.connect=0}}function R(t,e){switch(e){case"horizontal":t.ort=0;break;case"vertical":t.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function T(t,e){if(!i(e))throw new Error("noUiSlider: 'margin' option must be numeric.");if(t.margin=t.spectrum.getMargin(e),!t.margin)throw new Error("noUiSlider: 'margin' option is only supported on linear sliders.")}function x(t,e){if(!i(e))throw new Error("noUiSlider: 'limit' option must be numeric.");if(t.limit=t.spectrum.getMargin(e),!t.limit)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders.")}function S(t,e){switch(e){case"ltr":t.dir=0;break;case"rtl":t.dir=1,t.connect=[0,2,1,3][t.connect];break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function P(t,e){if("string"!=typeof e)throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var i=e.indexOf("tap")>=0,n=e.indexOf("drag")>=0,o=e.indexOf("fixed")>=0,r=e.indexOf("snap")>=0;t.events={tap:i||r,drag:n,fixed:o,snap:r}}function G(t,e){if(t.format=e,"function"==typeof e.to&&"function"==typeof e.from)return!0;throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.")}function A(e){var i,n={margin:0,limit:0,animate:!0,format:Y};return i={step:{r:!1,t:_},start:{r:!0,t:b},connect:{r:!0,t:C},direction:{r:!0,t:S},snap:{r:!1,t:k},animate:{r:!1,t:D},range:{r:!0,t:w},orientation:{r:!1,t:R},margin:{r:!1,t:T},limit:{r:!1,t:x},behaviour:{r:!0,t:P},format:{r:!1,t:G}},e=t.extend({connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal"},e),t.each(i,function(t,i){if(void 0===e[t]){if(i.r)throw new Error("noUiSlider: '"+t+"' is required.");return!0}i.t(n,e[t])}),n.style=n.ort?"top":"left",n}function M(t,e,i){var n=t+e[0],o=t+e[1];return i?(n<0&&(o+=Math.abs(n)),o>100&&(n-=o-100),[r(n),r(o)]):[n,o]}function O(t){t.preventDefault();var e,i,n=0===t.type.indexOf("touch"),o=0===t.type.indexOf("mouse"),r=0===t.type.indexOf("pointer"),s=t;return 0===t.type.indexOf("MSPointer")&&(r=!0),t.originalEvent&&(t=t.originalEvent),n&&(e=t.changedTouches[0].pageX,i=t.changedTouches[0].pageY),(o||r)&&(r||void 0!==window.pageXOffset||(window.pageXOffset=document.documentElement.scrollLeft,window.pageYOffset=document.documentElement.scrollTop),e=t.clientX+window.pageXOffset,i=t.clientY+window.pageYOffset),s.points=[e,i],s.cursor=o,s}function F(e,i){var n=t("<div><div/></div>").addClass(H[2]),o=["-lower","-upper"];return e&&o.reverse(),n.children().addClass(H[3]+" "+H[3]+o[i]),n}function E(t,e,i){switch(t){case 1:e.addClass(H[7]),i[0].addClass(H[6]);break;case 3:i[1].addClass(H[6]);case 2:i[0].addClass(H[7]);case 0:e.addClass(H[6])}}function V(t,e,i){var n,o=[];for(n=0;n<t;n+=1)o.push(F(e,n).appendTo(i));return o}function B(e,i,n){return n.addClass([H[0],H[8+e],H[4+i]].join(" ")),t("<div/>").appendTo(n).addClass(H[1])}function $(e,i,n){function l(){return S[["width","height"][i.ort]]()}function c(t){var e,i=[G.val()];for(e=0;e<t.length;e+=1)G.trigger(t[e],i)}function u(t){return 1===t.length?t[0]:i.dir?t.reverse():t}function h(t){return function(e,i){G.val([t?null:i,t?i:null],!0)}}function d(e){var i=t.inArray(e,I);G[0].linkAPI&&G[0].linkAPI[e]&&G[0].linkAPI[e].change($[i],P[i].children(),G)}function p(e,n){var o=t.inArray(e,I);return n&&n.appendTo(P[o].children()),i.dir&&i.handles>1&&(o=1===o?0:1),h(o)}function f(){var t,e;for(t=0;t<I.length;t+=1)this.linkAPI&&this.linkAPI[e=I[t]]&&this.linkAPI[e].reconfirm(e)}function g(t,e,n,o){return t=t.replace(/\s/g,z+" ")+z,e.on(t,function(t){return!G.attr("disabled")&&(!G.hasClass(H[14])&&(t=O(t),t.calcPoint=t.points[i.ort],void n(t,o)))})}function m(t,e){var i,n=e.handles||P,o=!1,r=100*(t.calcPoint-e.start)/l(),s=n[0][0]!==P[0][0]?1:0;i=M(r,e.positions,n.length>1),o=b(n[0],i[s],1===n.length),n.length>1&&(o=b(n[1],i[s?0:1],!1)||o),o&&c(["slide"])}function v(e){t("."+H[15]).removeClass(H[15]),e.cursor&&t("body").css("cursor","").off(z),U.off(z),G.removeClass(H[12]),c(["set","change"])}function y(e,i){1===i.handles.length&&i.handles[0].children().addClass(H[15]),e.stopPropagation(),g(W.move,U,m,{start:e.calcPoint,handles:i.handles,positions:[A[0],A[P.length-1]]}),g(W.end,U,v,null),e.cursor&&(t("body").css("cursor",t(e.target).css("cursor")),P.length>1&&G.addClass(H[12]),t("body").on("selectstart"+z,!1))}function _(e){var n,r=e.calcPoint,s=0;e.stopPropagation(),t.each(P,function(){s+=this.offset()[i.style]}),s=r<s/2||1===P.length?0:1,r-=S.offset()[i.style],n=100*r/l(),i.events.snap||o(G,H[14],300),b(P[s],n),c(["slide","set","change"]),i.events.snap&&y(e,{handles:[P[s]]})}function w(t){var e,i;if(!t.fixed)for(e=0;e<P.length;e+=1)g(W.start,P[e].children(),y,{handles:[P[e]]});t.tap&&g(W.start,S,_,{handles:P}),t.drag&&(i=S.find("."+H[7]).addClass(H[10]),t.fixed&&(i=i.add(S.children().not(i).children())),g(W.start,i,y,{handles:P}))}function b(t,e,n){var o=t[0]!==P[0][0]?1:0,s=A[0]+i.margin,a=A[1]-i.margin,l=A[0]+i.limit,c=A[1]-i.limit;return P.length>1&&(e=o?Math.max(e,s):Math.min(e,a)),n!==!1&&i.limit&&P.length>1&&(e=o?Math.min(e,l):Math.max(e,c)),e=F.getStep(e),e=r(parseFloat(e.toFixed(7))),e!==A[o]&&(t.css(i.style,e+"%"),t.is(":first-child")&&t.toggleClass(H[17],e>50),A[o]=e,$[o]=F.fromStepping(e),d(I[o]),!0)}function k(t,e){var n,o,r;for(i.limit&&(t+=1),n=0;n<t;n+=1)o=n%2,r=e[o],null!==r&&r!==!1&&("number"==typeof r&&(r=String(r)),r=i.format.from(r),(r===!1||isNaN(r)||b(P[o],F.toStepping(r),n===3-i.dir)===!1)&&d(I[o]))}function D(t){if(G[0].LinkIsEmitting)return this;var e,n=s(t);return i.dir&&i.handles>1&&n.reverse(),i.animate&&A[0]!==-1&&o(G,H[14],300),e=P.length>1?3:1,1===n.length&&(e=1),k(e,n),c(["set"]),this}function C(){var t,e=[];for(t=0;t<i.handles;t+=1)e[t]=i.format.to($[t]);return u(e)}function R(){return t(this).off(z).removeClass(H.join(" ")).empty(),delete this.LinkUpdate,delete this.LinkConfirm,delete this.LinkDefaultFormatter,delete this.LinkDefaultFlag,delete this.reappend,delete this.vGet,delete this.vSet,delete this.getCurrentStep,delete this.getInfo,delete this.destroy,n}function T(){var e=t.map(A,function(t,e){var i=F.getApplicableStep(t),n=a(String(i[2])),o=$[e],r=100===t?null:i[2],s=Number((o-i[2]).toFixed(n)),l=0===t?null:s>=i[1]?i[2]:i[0]||!1;return[[l,r]]});return u(e)}function x(){return n}var S,P,G=t(e),A=[-1,-1],F=i.spectrum,$=[],I=["lower","upper"].slice(0,i.handles);if(i.dir&&I.reverse(),e.LinkUpdate=d,e.LinkConfirm=p,e.LinkDefaultFormatter=i.format,e.LinkDefaultFlag="lower",e.reappend=f,G.hasClass(H[0]))throw new Error("Slider was already initialized.");S=B(i.dir,i.ort,G),P=V(i.handles,i.dir,S),E(i.connect,G,P),w(i.events),e.vSet=D,e.vGet=C,e.destroy=R,e.getCurrentStep=T,e.getOriginalOptions=x,e.getInfo=function(){return[F,i.style,i.ort]},G.val(i.start)}function I(t){var e=A(t,this);return this.each(function(){$(this,e,t)})}function j(e){return this.each(function(){if(!this.destroy)return void t(this).noUiSlider(e);var i=t(this).val(),n=this.destroy(),o=t.extend({},n,e);t(this).noUiSlider(o),this.reappend(),n.start===o.start&&t(this).val(i)})}function N(){return this[0][arguments.length?"vSet":"vGet"].apply(this[0],arguments)}var U=t(document),L=t.fn.val,z=".nui",W=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},H=["noUi-target","noUi-base","noUi-origin","noUi-handle","noUi-horizontal","noUi-vertical","noUi-background","noUi-connect","noUi-ltr","noUi-rtl","noUi-dragable","","noUi-state-drag","","noUi-state-tap","noUi-active","","noUi-stacking"];y.prototype.getMargin=function(t){return 2===this.xPct.length&&c(this.xVal,t)},y.prototype.toStepping=function(t){return t=p(this.xVal,this.xPct,t),this.direction&&(t=100-t),t},y.prototype.fromStepping=function(t){return this.direction&&(t=100-t),n(f(this.xVal,this.xPct,t))},y.prototype.getStep=function(t){return this.direction&&(t=100-t),t=g(this.xPct,this.xSteps,this.snap,t),this.direction&&(t=100-t),t},y.prototype.getApplicableStep=function(t){var e=d(t,this.xPct),i=100===t?2:1;return[this.xNumSteps[e-2],this.xVal[e-i],this.xNumSteps[e-i]]},y.prototype.convert=function(t){return this.getStep(this.toStepping(t))};var Y={to:function(t){return t.toFixed(2)},from:Number};t.fn.val=function(e){function i(t){return t.hasClass(H[0])?N:L}if(!arguments.length){var n=t(this[0]);return i(n).call(n)}var o=t.isFunction(e);return this.each(function(n){var r=e,s=t(this);o&&(r=e.call(this,n,s.val())),i(s).call(s,r)})},t.fn.noUiSlider=function(t,e){switch(t){case"step":return this[0].getCurrentStep();case"options":return this[0].getOriginalOptions()}return(e?j:I).call(this,t)}}(window.jQuery||window.Zepto),!function(t,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Spinner=e()}(this,function(){"use strict";function t(t,e){var i,n=document.createElement(t||"div");for(i in e)n[i]=e[i];return n}function e(t){for(var e=1,i=arguments.length;i>e;e++)t.appendChild(arguments[e]);return t}function i(t,e,i,n){var o=["opacity",e,~~(100*t),i,n].join("-"),r=.01+i/n*100,s=Math.max(1-(1-t)/e*(100-r),t),a=c.substring(0,c.indexOf("Animation")).toLowerCase(),l=a&&"-"+a+"-"||"";return h[o]||(d.insertRule("@"+l+"keyframes "+o+"{0%{opacity:"+s+"}"+r+"%{opacity:"+t+"}"+(r+.01)+"%{opacity:1}"+(r+e)%100+"%{opacity:"+t+"}100%{opacity:"+s+"}}",d.cssRules.length),h[o]=1),o}function n(t,e){var i,n,o=t.style;for(e=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<u.length;n++)if(i=u[n]+e,void 0!==o[i])return i;return void 0!==o[e]?e:void 0}function o(t,e){for(var i in e)t.style[n(t,i)||i]=e[i];return t}function r(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)void 0===t[n]&&(t[n]=i[n])}return t}function s(t,e){return"string"==typeof t?t:t[e%t.length]}function a(t){this.opts=r(t||{},a.defaults,p)}function l(){function i(e,i){return t("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',i)}d.addRule(".spin-vml","behavior:url(#default#VML)"),a.prototype.lines=function(t,n){function r(){return o(i("group",{coordsize:u+" "+u,coordorigin:-c+" "+-c}),{width:u,height:u})}function a(t,a,l){e(d,e(o(r(),{rotation:360/n.lines*t+"deg",left:~~a}),e(o(i("roundrect",{arcsize:n.corners}),{width:c,height:n.width,left:n.radius,top:-n.width>>1,filter:l}),i("fill",{color:s(n.color,t),opacity:n.opacity}),i("stroke",{opacity:0}))))}var l,c=n.length+n.width,u=2*c,h=2*-(n.width+n.length)+"px",d=o(r(),{position:"absolute",top:h,left:h});if(n.shadow)for(l=1;l<=n.lines;l++)a(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=n.lines;l++)a(l);return e(t,d)},a.prototype.opacity=function(t,e,i,n){var o=t.firstChild;n=n.shadow&&n.lines||0,o&&e+n<o.childNodes.length&&(o=o.childNodes[e+n],o=o&&o.firstChild,o=o&&o.firstChild,o&&(o.opacity=i))}}var c,u=["webkit","Moz","ms","O"],h={},d=function(){var i=t("style",{type:"text/css"});return e(document.getElementsByTagName("head")[0],i),i.sheet||i.styleSheet}(),p={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};a.defaults={},r(a.prototype,{spin:function(e){this.stop();var i=this,n=i.opts,r=i.el=o(t(0,{className:n.className}),{position:n.position,width:0,zIndex:n.zIndex});if(n.radius+n.length+n.width,o(r,{left:n.left,top:n.top}),e&&e.insertBefore(r,e.firstChild||null),r.setAttribute("role","progressbar"),i.lines(r,i.opts),!c){var s,a=0,l=(n.lines-1)*(1-n.direction)/2,u=n.fps,h=u/n.speed,d=(1-n.opacity)/(h*n.trail/100),p=h/n.lines;!function t(){a++;for(var e=0;e<n.lines;e++)s=Math.max(1-(a+(n.lines-e)*p)%h*d,n.opacity),i.opacity(r,e*n.direction+l,s,n);i.timeout=i.el&&setTimeout(t,~~(1e3/u))}()}return i},stop:function(){var t=this.el;return t&&(clearTimeout(this.timeout),t.parentNode&&t.parentNode.removeChild(t),this.el=void 0),this},lines:function(n,r){function a(e,i){return o(t(),{position:"absolute",width:r.length+r.width+"px",height:r.width+"px",background:e,boxShadow:i,transformOrigin:"left",transform:"rotate("+~~(360/r.lines*u+r.rotate)+"deg) translate("+r.radius+"px,0)",borderRadius:(r.corners*r.width>>1)+"px"})}for(var l,u=0,h=(r.lines-1)*(1-r.direction)/2;u<r.lines;u++)l=o(t(),{position:"absolute",top:1+~(r.width/2)+"px",transform:r.hwaccel?"translate3d(0,0,0)":"",opacity:r.opacity,animation:c&&i(r.opacity,r.trail,h+u*r.direction,r.lines)+" "+1/r.speed+"s linear infinite"}),r.shadow&&e(l,o(a("#000","0 0 4px #000"),{top:"2px"})),e(n,e(l,a(s(r.color,u),"0 0 1px rgba(0,0,0,.1)")));return n},opacity:function(t,e,i){e<t.childNodes.length&&(t.childNodes[e].style.opacity=i)}});var f=o(t("group"),{behavior:"url(#default#VML)"});return!n(f,"transform")&&f.adj?l():c=n(f,"animation"),a}),function(){var t;t=function(){function t(){this.options_index=0,this.parsed=[]}return t.prototype.add_node=function(t){return"OPTGROUP"===t.nodeName.toUpperCase()?this.add_group(t):this.add_option(t)},t.prototype.add_group=function(t){var e,i,n,o,r,s;for(e=this.parsed.length,this.parsed.push({array_index:e,group:!0,label:t.label,children:0,disabled:t.disabled}),r=t.childNodes,s=[],n=0,o=r.length;o>n;n++)i=r[n],s.push(this.add_option(i,e,t.disabled));return s},t.prototype.add_option=function(t,e,i){return"OPTION"===t.nodeName.toUpperCase()?(""!==t.text?(null!=e&&(this.parsed[e].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:t.value,text:t.text,html:t.innerHTML,selected:t.selected,disabled:i===!0?i:t.disabled,group_array_index:e,classes:t.className,style:t.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},t}(),t.select_to_array=function(e){var i,n,o,r,s;for(n=new t,s=e.childNodes,o=0,r=s.length;r>o;o++)i=s[o],n.add_node(i);return n.parsed},this.SelectParser=t}.call(this),function(){var t,e;e=this,t=function(){function t(e,i){this.form_field=e,this.options=null!=i?i:{},t.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.finish_setup())}return t.prototype.set_default_values=function(){var t=this;return this.click_test_action=function(e){return t.test_active_click(e)},this.activate_action=function(e){return t.activate_field(e)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text&&this.options.allow_single_deselect,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null==this.options.enable_split_word_search||this.options.enable_split_word_search,this.search_contains=this.options.search_contains||!1,this.choices=0,this.single_backstroke_delete=this.options.single_backstroke_delete||!1,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1},t.prototype.set_default_text=function(){return this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||t.default_multiple_text:this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||t.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||t.default_no_result_text},t.prototype.mouse_enter=function(){return this.mouse_on_container=!0},t.prototype.mouse_leave=function(){return this.mouse_on_container=!1},t.prototype.input_focus=function(t){var e=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return e.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},t.prototype.input_blur=function(t){var e=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return e.blur_test()},100))},t.prototype.result_add_option=function(t){var e,i;return t.disabled?"":(t.dom_id=this.container_id+"_o_"+t.array_index,e=t.selected&&this.is_multiple?[]:["active-result"],t.selected&&e.push("result-selected"),null!=t.group_array_index&&e.push("group-option"),""!==t.classes&&e.push(t.classes),i=""!==t.style.cssText?' style="'+t.style+'"':"",'<li id="'+t.dom_id+'" class="'+e.join(" ")+'"'+i+">"+t.html+"</li>")},t.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},t.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},t.prototype.results_search=function(t){return this.results_showing?this.winnow_results():this.results_show()},t.prototype.choices_click=function(t){return t.preventDefault(),this.results_showing?void 0:this.results_show()},t.prototype.keyup_checker=function(t){var e,i;switch(e=null!=(i=t.which)?i:t.keyCode,this.search_field_scale(),e){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(t.preventDefault(),this.results_showing)return this.result_select(t);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},t.prototype.generate_field_id=function(){var t;return t=this.generate_random_id(),this.form_field.id=t,t},t.prototype.generate_random_char=function(){var t,e,i;return t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=Math.floor(Math.random()*t.length),e=t.substring(i,i+1)},t.prototype.container_width=function(){var t;return null!=this.options.width?this.options.width:(t=null!=window.getComputedStyle?parseFloat(window.getComputedStyle(this.form_field).getPropertyValue("width")):"undefined"!=typeof jQuery&&null!==jQuery&&null!=this.form_field_jq?this.form_field_jq.outerWidth():this.form_field.getWidth(),t+"px")},t.browser_is_supported=function(){var t;return"Microsoft Internet Explorer"!==window.navigator.appName||null!==(t=document.documentMode)&&t>=8},t.default_multiple_text="Select Some Options",t.default_single_text="Select an Option",t.default_no_result_text="No results match",t}(),e.AbstractChosen=t}.call(this),function(){var t,e,i,n={}.hasOwnProperty,o=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};i=this,t=jQuery,t.fn.extend({chosen:function(i){return AbstractChosen.browser_is_supported()?this.each(function(n){var o;return o=t(this),o.hasClass("chzn-done")?void 0:o.data("chosen",new e(this,i))}):this}}),e=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return o(n,e),n.prototype.setup=function(){return this.form_field_jq=t(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")},n.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")},n.prototype.set_up_html=function(){var e,i;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id(),this.container_id+="_chzn",e=["chzn-container"],e.push("chzn-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&e.push(this.form_field.className),this.is_rtl&&e.push("chzn-rtl"),i={id:this.container_id,class:e.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.container=t("<div />",i),this.is_multiple?this.container.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop"><ul class="chzn-results"></ul></div>'):this.container.html('<a href="javascript:void(0)" class="chzn-single chzn-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chzn-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior(),this.form_field_jq.trigger("liszt:ready",{chosen:this})},n.prototype.register_observers=function(){var t=this;return this.container.mousedown(function(e){t.container_mousedown(e)}),this.container.mouseup(function(e){t.container_mouseup(e)}),this.container.mouseenter(function(e){t.mouse_enter(e)}),this.container.mouseleave(function(e){t.mouse_leave(e)}),this.search_results.mouseup(function(e){t.search_results_mouseup(e)}),this.search_results.mouseover(function(e){t.search_results_mouseover(e)}),this.search_results.mouseout(function(e){t.search_results_mouseout(e)}),this.search_results.bind("mousewheel DOMMouseScroll",function(e){t.search_results_mousewheel(e)}),this.form_field_jq.bind("liszt:updated",function(e){t.results_update_field(e)}),this.form_field_jq.bind("liszt:activate",function(e){t.activate_field(e)}),this.form_field_jq.bind("liszt:open",function(e){t.container_mousedown(e)}),this.search_field.blur(function(e){t.input_blur(e)}),this.search_field.keyup(function(e){t.keyup_checker(e)}),this.search_field.keydown(function(e){t.keydown_checker(e)}),this.search_field.focus(function(e){t.input_focus(e)}),this.is_multiple?this.search_choices.click(function(e){t.choices_click(e)}):this.container.click(function(t){t.preventDefault()})},n.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field()):(this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus",this.activate_action))},n.prototype.container_mousedown=function(e){return this.is_disabled||(e&&"mousedown"===e.type&&!this.results_showing&&e.preventDefault(),null!=e&&t(e.target).hasClass("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!e||t(e.target)[0]!==this.selected_item[0]&&!t(e.target).parents("a.chzn-single").length||(e.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),t(document).click(this.click_test_action),this.results_show()),this.activate_field())},n.prototype.container_mouseup=function(t){return"ABBR"!==t.target.nodeName||this.is_disabled?void 0:this.results_reset(t)},n.prototype.search_results_mousewheel=function(t){var e,i,n;return e=-(null!=(i=t.originalEvent)?i.wheelDelta:void 0)||(null!=(n=t.originialEvent)?n.detail:void 0),null!=e?(t.preventDefault(),"DOMMouseScroll"===t.type&&(e=40*e),this.search_results.scrollTop(e+this.search_results.scrollTop())):void 0},n.prototype.blur_test=function(t){return!this.active_field&&this.container.hasClass("chzn-container-active")?this.close_field():void 0},n.prototype.close_field=function(){return t(document).unbind("click",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.winnow_results_clear(),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},n.prototype.activate_field=function(){return this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},n.prototype.test_active_click=function(e){return t(e.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},n.prototype.results_build=function(){var t,e,n,o,r;for(this.parsing=!0,this.results_data=i.SelectParser.select_to_array(this.form_field),this.is_multiple&&this.choices>0?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||(this.selected_item.addClass("chzn-default").find("sp ").text(this.default_text),
this.disable_search||this.form_field.options.length<=this.disable_search_threshold?this.container.addClass("chzn-container-single-nosearch"):this.container.removeClass("chzn-container-single-nosearch")),t="",r=this.results_data,n=0,o=r.length;o>n;n++)e=r[n],e.group?t+=this.result_add_group(e):e.empty||(t+=this.result_add_option(e),e.selected&&this.is_multiple?this.choice_build(e):e.selected&&!this.is_multiple&&(this.selected_item.removeClass("chzn-default").find("span").text(e.text),this.allow_single_deselect&&this.single_deselect_control_build()));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(t),this.parsing=!1},n.prototype.result_add_group=function(e){return e.disabled?"":(e.dom_id=this.container_id+"_g_"+e.array_index,'<li id="'+e.dom_id+'" class="group-result">'+t("<div />").text(e.label).html()+"</li>")},n.prototype.result_do_highlight=function(t){var e,i,n,o,r;return t.length?(this.result_clear_highlight(),this.result_highlight=t,this.result_highlight.addClass("highlighted"),n=parseInt(this.search_results.css("maxHeight"),10),r=this.search_results.scrollTop(),o=n+r,i=this.result_highlight.position().top+this.search_results.scrollTop(),e=i+this.result_highlight.outerHeight(),this.search_results.scrollTop()):void 0},n.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},n.prototype.results_show=function(){if(null!=this.result_single_selected)this.result_do_highlight(this.result_single_selected);else if(this.is_multiple&&this.max_selected_options<=this.choices)return this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1;return this.container.addClass("chzn-with-drop"),this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results()},n.prototype.results_hide=function(){return this.result_clear_highlight(),this.container.removeClass("chzn-with-drop"),this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this}),this.results_showing=!1},n.prototype.set_tab_index=function(t){var e;return this.form_field_jq.attr("tabindex")?(e=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.search_field.attr("tabindex",e)):void 0},n.prototype.set_label_behavior=function(){var e=this;return this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=t("label[for="+this.form_field.id+"]")),this.form_field_label.length>0?this.form_field_label.click(function(t){return e.is_multiple?e.container_mousedown(t):e.activate_field()}):void 0},n.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},n.prototype.search_results_mouseup=function(e){var i;return i=t(e.target).hasClass("active-result")?t(e.target):t(e.target).parents(".active-result").first(),i.length?(this.result_highlight=i,this.result_select(e),this.search_field.focus()):void 0},n.prototype.search_results_mouseover=function(e){var i;return i=t(e.target).hasClass("active-result")?t(e.target):t(e.target).parents(".active-result").first(),i?this.result_do_highlight(i):void 0},n.prototype.search_results_mouseout=function(e){return t(e.target).hasClass("active-result")?this.result_clear_highlight():void 0},n.prototype.choice_build=function(e){var i,n,o,r=this;return this.is_multiple&&this.max_selected_options<=this.choices?(this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1):(i=this.container_id+"_c_"+e.array_index,this.choices+=1,n=e.disabled?'<li class="search-choice search-choice-disabled" id="'+i+'"><span>'+e.html+"</span></li>":'<li class="search-choice" id="'+i+'"><span>'+e.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+e.array_index+'"></a></li>',this.search_container.before(n),o=t("#"+i).find("a").first(),o.click(function(t){return r.choice_destroy_link_click(t)}))},n.prototype.choice_destroy_link_click=function(e){return e.preventDefault(),e.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(t(e.target))},n.prototype.choice_destroy=function(t){return this.result_deselect(t.attr("rel"))?(this.choices-=1,this.show_search_field_default(),this.is_multiple&&this.choices>0&&this.search_field.val().length<1&&this.results_hide(),t.parents("li").first().remove(),this.search_field_scale()):void 0},n.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_item.find("span").text(this.default_text),this.is_multiple||this.selected_item.addClass("chzn-default"),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},n.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},n.prototype.result_select=function(t){var e,i,n,o;return this.result_highlight?(e=this.result_highlight,i=e.attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(e):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=e,this.selected_item.removeClass("chzn-default")),e.addClass("result-selected"),o=i.substr(i.lastIndexOf("_")+1),n=this.results_data[o],n.selected=!0,this.form_field.options[n.options_index].selected=!0,this.is_multiple?this.choice_build(n):(this.selected_item.find("span").first().text(n.text),this.allow_single_deselect&&this.single_deselect_control_build()),(t.metaKey||t.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[n.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale()):void 0},n.prototype.result_activate=function(t){return t.addClass("active-result")},n.prototype.result_deactivate=function(t){return t.removeClass("active-result")},n.prototype.result_deselect=function(e){var i,n;return n=this.results_data[e],!this.form_field.options[n.options_index].disabled&&(n.selected=!1,this.form_field.options[n.options_index].selected=!1,i=t("#"+this.container_id+"_o_"+e),i.removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[n.options_index].value}),this.search_field_scale(),!0)},n.prototype.single_deselect_control_build=function(){return this.allow_single_deselect&&this.selected_item.find("abbr").length<1?this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'):void 0},n.prototype.winnow_results=function(){var e,i,n,o,r,s,a,l,c,u,h,d,p,f,g,m,v,y;for(this.no_results_clear(),c=0,u=this.search_field.val()===this.default_text?"":t("<div/>").text(t.trim(this.search_field.val())).html(),s=this.search_contains?"":"^",r=new RegExp(s+u.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),p=new RegExp(u.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),y=this.results_data,f=0,m=y.length;m>f;f++)if(i=y[f],!i.disabled&&!i.empty)if(i.group)t("#"+i.dom_id).css("display","none");else if(!this.is_multiple||!i.selected){if(e=!1,l=i.dom_id,a=t("#"+l),r.test(i.html))e=!0,c+=1;else if(this.enable_split_word_search&&(i.html.indexOf(" ")>=0||0===i.html.indexOf("["))&&(o=i.html.replace(/\[|\]/g,"").split(" "),o.length))for(g=0,v=o.length;v>g;g++)n=o[g],r.test(n)&&(e=!0,c+=1);e?(u.length?(h=i.html.search(p),d=i.html.substr(0,h+u.length)+"</em>"+i.html.substr(h+u.length),d=d.substr(0,h)+"<em>"+d.substr(h)):d=i.html,a.html(d),this.result_activate(a),null!=i.group_array_index&&t("#"+this.results_data[i.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&l===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(a))}return 1>c&&u.length?this.no_results(u):this.winnow_results_set_highlight()},n.prototype.winnow_results_clear=function(){var e,i,n,o,r;for(this.search_field.val(""),i=this.search_results.find("li"),r=[],n=0,o=i.length;o>n;n++)e=i[n],e=t(e),e.hasClass("group-result")?r.push(e.css("display","auto")):this.is_multiple&&e.hasClass("result-selected")?r.push(void 0):r.push(this.result_activate(e));return r},n.prototype.winnow_results_set_highlight=function(){var t,e;return this.result_highlight||(e=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),t=e.length?e.first():this.search_results.find(".active-result").first(),null==t)?void 0:this.result_do_highlight(t)},n.prototype.no_results=function(e){var i;return i=t('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),i.find("span").first().html(e),this.search_results.append(i)},n.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},n.prototype.keydown_arrow=function(){var e,i;return this.result_highlight?this.results_showing&&(i=this.result_highlight.nextAll("li.active-result").first(),i&&this.result_do_highlight(i)):(e=this.search_results.find("li.active-result").first(),e&&this.result_do_highlight(t(e))),this.results_showing?void 0:this.results_show()},n.prototype.keyup_arrow=function(){var t;return this.results_showing||this.is_multiple?this.result_highlight?(t=this.result_highlight.prevAll("li.active-result"),t.length?this.result_do_highlight(t.first()):(this.choices>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},n.prototype.keydown_backstroke=function(){var t;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(t=this.search_container.siblings("li.search-choice").last(),t.length&&!t.hasClass("search-choice-disabled")?(this.pending_backstroke=t,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},n.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},n.prototype.keydown_checker=function(t){var e,i;switch(e=null!=(i=t.which)?i:t.keyCode,this.search_field_scale(),8!==e&&this.pending_backstroke&&this.clear_backstroke(),e){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(t),this.mouse_on_container=!1;break;case 13:t.preventDefault();break;case 38:t.preventDefault(),this.keyup_arrow();break;case 40:this.keydown_arrow()}},n.prototype.search_field_scale=function(){var e,i,n,o,r,s,a,l;if(this.is_multiple){for(i=0,s=0,o="position:absolute; left: -1000px; top: -1000px; display:none;",r=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],a=0,l=r.length;l>a;a++)n=r[a],o+=n+":"+this.search_field.css(n)+";";return e=t("<div />",{style:o}),e.text(this.search_field.val()),t("body").append(e),s=e.width()+25,e.remove(),this.f_width||(this.f_width=this.container.outerWidth()),s>this.f_width-10&&(s=this.f_width-10),this.search_field.css({width:s+"px"})}},n.prototype.generate_random_id=function(){var e;for(e="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();t("#"+e).length>0;)e+=this.generate_random_char();return e},n}(AbstractChosen),i.Chosen=e}.call(this),function(t){function e(t,e,i){switch(arguments.length){case 2:return null!=t?t:e;case 3:return null!=t?t:null!=e?e:i;default:throw new Error("Implement me")}}function i(t,e){return Rt.call(t,e)}function n(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function o(t){_t.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function r(t,e){var i=!0;return d(function(){return i&&(o(t),i=!1),e.apply(this,arguments)},e)}function s(t,e){me[t]||(o(e),me[t]=!0)}function a(t,e){return function(i){return g(t.call(this,i),e)}}function l(t,e){return function(i){return this.localeData().ordinal(t.call(this,i),e)}}function c(){}function u(t,e){e!==!1&&A(t),p(this,t),this._d=new Date((+t._d))}function h(t){var e=C(t),i=e.year||0,n=e.quarter||0,o=e.month||0,r=e.week||0,s=e.day||0,a=e.hour||0,l=e.minute||0,c=e.second||0,u=e.millisecond||0;this._milliseconds=+u+1e3*c+6e4*l+36e5*a,this._days=+s+7*r,this._months=+o+3*n+12*i,this._data={},this._locale=_t.localeData(),this._bubble()}function d(t,e){for(var n in e)i(e,n)&&(t[n]=e[n]);return i(e,"toString")&&(t.toString=e.toString),i(e,"valueOf")&&(t.valueOf=e.valueOf),t}function p(t,e){var i,n,o;if("undefined"!=typeof e._isAMomentObject&&(t._isAMomentObject=e._isAMomentObject),"undefined"!=typeof e._i&&(t._i=e._i),"undefined"!=typeof e._f&&(t._f=e._f),"undefined"!=typeof e._l&&(t._l=e._l),"undefined"!=typeof e._strict&&(t._strict=e._strict),"undefined"!=typeof e._tzm&&(t._tzm=e._tzm),"undefined"!=typeof e._isUTC&&(t._isUTC=e._isUTC),"undefined"!=typeof e._offset&&(t._offset=e._offset),"undefined"!=typeof e._pf&&(t._pf=e._pf),"undefined"!=typeof e._locale&&(t._locale=e._locale),Ft.length>0)for(i in Ft)n=Ft[i],o=e[n],"undefined"!=typeof o&&(t[n]=o);return t}function f(t){return t<0?Math.ceil(t):Math.floor(t)}function g(t,e,i){for(var n=""+Math.abs(t),o=t>=0;n.length<e;)n="0"+n;return(o?i?"+":"":"-")+n}function m(t,e){var i={milliseconds:0,months:0};return i.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(i.months,"M").isAfter(e)&&--i.months,i.milliseconds=+e-+t.clone().add(i.months,"M"),i}function v(t,e){var i;return e=V(e,t),t.isBefore(e)?i=m(t,e):(i=m(e,t),i.milliseconds=-i.milliseconds,i.months=-i.months),i}function y(t,e){return function(i,n){var o,r;return null===n||isNaN(+n)||(s(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period)."),r=i,i=n,n=r),i="string"==typeof i?+i:i,o=_t.duration(i,n),_(this,o,t),this}}function _(t,e,i,n){var o=e._milliseconds,r=e._days,s=e._months;n=null==n||n,o&&t._d.setTime(+t._d+o*i),r&&pt(t,"Date",dt(t,"Date")+r*i),s&&ht(t,dt(t,"Month")+s*i),n&&_t.updateOffset(t,r||s)}function w(t){return"[object Array]"===Object.prototype.toString.call(t)}function b(t){return"[object Date]"===Object.prototype.toString.call(t)||t instanceof Date}function k(t,e,i){var n,o=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),s=0;for(n=0;n<o;n++)(i&&t[n]!==e[n]||!i&&T(t[n])!==T(e[n]))&&s++;return s+r}function D(t){if(t){var e=t.toLowerCase().replace(/(.)s$/,"$1");t=ce[t]||ue[e]||e}return t}function C(t){var e,n,o={};for(n in t)i(t,n)&&(e=D(n),e&&(o[e]=t[n]));return o}function R(e){var i,n;if(0===e.indexOf("week"))i=7,n="day";else{if(0!==e.indexOf("month"))return;i=12,n="month"}_t[e]=function(o,r){var s,a,l=_t._locale[e],c=[];if("number"==typeof o&&(r=o,o=t),a=function(t){var e=_t().utc().set(n,t);return l.call(_t._locale,e,o||"")},null!=r)return a(r);for(s=0;s<i;s++)c.push(a(s));return c}}function T(t){var e=+t,i=0;return 0!==e&&isFinite(e)&&(i=e>=0?Math.floor(e):Math.ceil(e)),i}function x(t,e){return new Date(Date.UTC(t,e+1,0)).getUTCDate()}function S(t,e,i){return at(_t([t,11,31+e-i]),e,i).week}function P(t){return G(t)?366:365}function G(t){return t%4===0&&t%100!==0||t%400===0}function A(t){var e;t._a&&t._pf.overflow===-2&&(e=t._a[xt]<0||t._a[xt]>11?xt:t._a[St]<1||t._a[St]>x(t._a[Tt],t._a[xt])?St:t._a[Pt]<0||t._a[Pt]>23?Pt:t._a[Gt]<0||t._a[Gt]>59?Gt:t._a[At]<0||t._a[At]>59?At:t._a[Mt]<0||t._a[Mt]>999?Mt:-1,t._pf._overflowDayOfYear&&(e<Tt||e>St)&&(e=St),t._pf.overflow=e)}function M(t){return null==t._isValid&&(t._isValid=!isNaN(t._d.getTime())&&t._pf.overflow<0&&!t._pf.empty&&!t._pf.invalidMonth&&!t._pf.nullInput&&!t._pf.invalidFormat&&!t._pf.userInvalidated,t._strict&&(t._isValid=t._isValid&&0===t._pf.charsLeftOver&&0===t._pf.unusedTokens.length)),t._isValid}function O(t){return t?t.toLowerCase().replace("_","-"):t}function F(t){for(var e,i,n,o,r=0;r<t.length;){for(o=O(t[r]).split("-"),e=o.length,i=O(t[r+1]),i=i?i.split("-"):null;e>0;){if(n=E(o.slice(0,e).join("-")))return n;if(i&&i.length>=e&&k(o,i,!0)>=e-1)break;e--}r++}return null}function E(t){var e=null;if(!Ot[t]&&Et)try{e=_t.locale(),require("./locale/"+t),_t.locale(e)}catch(t){}return Ot[t]}function V(t,e){return e._isUTC?_t(t).zone(e._offset||0):_t(t).local()}function B(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function $(t){var e,i,n=t.match(It);for(e=0,i=n.length;e<i;e++)ge[n[e]]?n[e]=ge[n[e]]:n[e]=B(n[e]);return function(o){var r="";for(e=0;e<i;e++)r+=n[e]instanceof Function?n[e].call(o,t):n[e];return r}}function I(t,e){return t.isValid()?(e=j(e,t.localeData()),he[e]||(he[e]=$(e)),he[e](t)):t.localeData().invalidDate()}function j(t,e){function i(t){return e.longDateFormat(t)||t}var n=5;for(jt.lastIndex=0;n>=0&&jt.test(t);)t=t.replace(jt,i),jt.lastIndex=0,n-=1;return t}function N(t,e){var i,n=e._strict;switch(t){case"Q":return Xt;case"DDDD":return Jt;case"YYYY":case"GGGG":case"gggg":return n?te:Lt;case"Y":case"G":case"g":return ie;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return n?ee:zt;case"S":if(n)return Xt;case"SS":if(n)return Kt;case"SSS":if(n)return Jt;case"DDD":return Ut;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Ht;case"a":case"A":return e._locale._meridiemParse;case"X":return Zt;case"Z":case"ZZ":return Yt;case"T":return qt;case"SSSS":return Wt;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return n?Kt:Nt;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return Nt;case"Do":return Qt;default:return i=new RegExp(Q(Z(t.replace("\\","")),"i"))}}function U(t){t=t||"";var e=t.match(Yt)||[],i=e[e.length-1]||[],n=(i+"").match(ae)||["-",0,0],o=+(60*n[1])+T(n[2]);return"+"===n[0]?-o:o}function L(t,e,i){var n,o=i._a;switch(t){case"Q":null!=e&&(o[xt]=3*(T(e)-1));break;case"M":case"MM":null!=e&&(o[xt]=T(e)-1);break;case"MMM":case"MMMM":n=i._locale.monthsParse(e),null!=n?o[xt]=n:i._pf.invalidMonth=e;break;case"D":case"DD":null!=e&&(o[St]=T(e));break;case"Do":null!=e&&(o[St]=T(parseInt(e,10)));break;case"DDD":case"DDDD":null!=e&&(i._dayOfYear=T(e));break;case"YY":o[Tt]=_t.parseTwoDigitYear(e);break;case"YYYY":case"YYYYY":case"YYYYYY":o[Tt]=T(e);break;case"a":case"A":i._isPm=i._locale.isPM(e);break;case"H":case"HH":case"h":case"hh":o[Pt]=T(e);break;case"m":case"mm":o[Gt]=T(e);break;case"s":case"ss":o[At]=T(e);break;case"S":case"SS":case"SSS":case"SSSS":o[Mt]=T(1e3*("0."+e));break;case"X":i._d=new Date(1e3*parseFloat(e));break;case"Z":case"ZZ":i._useUTC=!0,i._tzm=U(e);break;case"dd":case"ddd":case"dddd":n=i._locale.weekdaysParse(e),null!=n?(i._w=i._w||{},i._w.d=n):i._pf.invalidWeekday=e;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":t=t.substr(0,1);case"gggg":case"GGGG":case"GGGGG":t=t.substr(0,2),e&&(i._w=i._w||{},i._w[t]=T(e));break;case"gg":case"GG":i._w=i._w||{},i._w[t]=_t.parseTwoDigitYear(e)}}function z(t){var i,n,o,r,s,a,l;i=t._w,null!=i.GG||null!=i.W||null!=i.E?(s=1,a=4,n=e(i.GG,t._a[Tt],at(_t(),1,4).year),o=e(i.W,1),r=e(i.E,1)):(s=t._locale._week.dow,a=t._locale._week.doy,n=e(i.gg,t._a[Tt],at(_t(),s,a).year),o=e(i.w,1),null!=i.d?(r=i.d,r<s&&++o):r=null!=i.e?i.e+s:s),l=lt(n,o,r,a,s),t._a[Tt]=l.year,t._dayOfYear=l.dayOfYear}function W(t){var i,n,o,r,s=[];if(!t._d){for(o=Y(t),t._w&&null==t._a[St]&&null==t._a[xt]&&z(t),t._dayOfYear&&(r=e(t._a[Tt],o[Tt]),t._dayOfYear>P(r)&&(t._pf._overflowDayOfYear=!0),n=nt(r,0,t._dayOfYear),t._a[xt]=n.getUTCMonth(),t._a[St]=n.getUTCDate()),i=0;i<3&&null==t._a[i];++i)t._a[i]=s[i]=o[i];for(;i<7;i++)t._a[i]=s[i]=null==t._a[i]?2===i?1:0:t._a[i];t._d=(t._useUTC?nt:it).apply(null,s),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()+t._tzm)}}function H(t){var e;t._d||(e=C(t._i),t._a=[e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond],W(t))}function Y(t){var e=new Date;return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function q(t){if(t._f===_t.ISO_8601)return void K(t);t._a=[],t._pf.empty=!0;var e,i,n,o,r,s=""+t._i,a=s.length,l=0;for(n=j(t._f,t._locale).match(It)||[],e=0;e<n.length;e++)o=n[e],i=(s.match(N(o,t))||[])[0],i&&(r=s.substr(0,s.indexOf(i)),r.length>0&&t._pf.unusedInput.push(r),s=s.slice(s.indexOf(i)+i.length),l+=i.length),ge[o]?(i?t._pf.empty=!1:t._pf.unusedTokens.push(o),L(o,i,t)):t._strict&&!i&&t._pf.unusedTokens.push(o);t._pf.charsLeftOver=a-l,s.length>0&&t._pf.unusedInput.push(s),t._isPm&&t._a[Pt]<12&&(t._a[Pt]+=12),t._isPm===!1&&12===t._a[Pt]&&(t._a[Pt]=0),W(t),A(t)}function Z(t){return t.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,i,n,o){return e||i||n||o})}function Q(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function X(t){var e,i,o,r,s;if(0===t._f.length)return t._pf.invalidFormat=!0,void(t._d=new Date(NaN));for(r=0;r<t._f.length;r++)s=0,e=p({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._pf=n(),e._f=t._f[r],q(e),M(e)&&(s+=e._pf.charsLeftOver,s+=10*e._pf.unusedTokens.length,e._pf.score=s,(null==o||s<o)&&(o=s,i=e));d(t,i||e)}function K(t){var e,i,n=t._i,o=ne.exec(n);if(o){for(t._pf.iso=!0,e=0,i=re.length;e<i;e++)if(re[e][1].exec(n)){t._f=re[e][0]+(o[6]||" ");break}for(e=0,i=se.length;e<i;e++)if(se[e][1].exec(n)){t._f+=se[e][0];break}n.match(Yt)&&(t._f+="Z"),q(t)}else t._isValid=!1}function J(t){K(t),t._isValid===!1&&(delete t._isValid,_t.createFromInputFallback(t))}function tt(t,e){var i,n=[];for(i=0;i<t.length;++i)n.push(e(t[i],i));return n}function et(e){var i,n=e._i;n===t?e._d=new Date:b(n)?e._d=new Date((+n)):null!==(i=Vt.exec(n))?e._d=new Date((+i[1])):"string"==typeof n?J(e):w(n)?(e._a=tt(n.slice(0),function(t){return parseInt(t,10)}),W(e)):"object"==typeof n?H(e):"number"==typeof n?e._d=new Date(n):_t.createFromInputFallback(e)}function it(t,e,i,n,o,r,s){var a=new Date(t,e,i,n,o,r,s);return t<1970&&a.setFullYear(t),a}function nt(t){var e=new Date(Date.UTC.apply(null,arguments));return t<1970&&e.setUTCFullYear(t),e}function ot(t,e){if("string"==typeof t)if(isNaN(t)){if(t=e.weekdaysParse(t),"number"!=typeof t)return null}else t=parseInt(t,10);return t}function rt(t,e,i,n,o){return o.relativeTime(e||1,!!i,t,n)}function st(t,e,i){var n=_t.duration(t).abs(),o=Ct(n.as("s")),r=Ct(n.as("m")),s=Ct(n.as("h")),a=Ct(n.as("d")),l=Ct(n.as("M")),c=Ct(n.as("y")),u=o<de.s&&["s",o]||1===r&&["m"]||r<de.m&&["mm",r]||1===s&&["h"]||s<de.h&&["hh",s]||1===a&&["d"]||a<de.d&&["dd",a]||1===l&&["M"]||l<de.M&&["MM",l]||1===c&&["y"]||["yy",c];return u[2]=e,u[3]=+t>0,u[4]=i,rt.apply({},u)}function at(t,e,i){var n,o=i-e,r=i-t.day();return r>o&&(r-=7),r<o-7&&(r+=7),n=_t(t).add(r,"d"),{week:Math.ceil(n.dayOfYear()/7),year:n.year()}}function lt(t,e,i,n,o){var r,s,a=nt(t,0,1).getUTCDay();return a=0===a?7:a,i=null!=i?i:o,r=o-a+(a>n?7:0)-(a<o?7:0),s=7*(e-1)+(i-o)+r+1,{year:s>0?t:t-1,dayOfYear:s>0?s:P(t-1)+s}}function ct(e){var i=e._i,n=e._f;return e._locale=e._locale||_t.localeData(e._l),null===i||n===t&&""===i?_t.invalid({nullInput:!0}):("string"==typeof i&&(e._i=i=e._locale.preparse(i)),_t.isMoment(i)?new u(i,(!0)):(n?w(n)?X(e):q(e):et(e),new u(e)))}function ut(t,e){var i,n;if(1===e.length&&w(e[0])&&(e=e[0]),!e.length)return _t();for(i=e[0],n=1;n<e.length;++n)e[n][t](i)&&(i=e[n]);return i}function ht(t,e){var i;return"string"==typeof e&&(e=t.localeData().monthsParse(e),"number"!=typeof e)?t:(i=Math.min(t.date(),x(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,i),t)}function dt(t,e){return t._d["get"+(t._isUTC?"UTC":"")+e]()}function pt(t,e,i){return"Month"===e?ht(t,i):t._d["set"+(t._isUTC?"UTC":"")+e](i)}function ft(t,e){return function(i){return null!=i?(pt(this,t,i),_t.updateOffset(this,e),this):dt(this,t)}}function gt(t){return 400*t/146097}function mt(t){return 146097*t/400}function vt(t){_t.duration.fn[t]=function(){return this._data[t]}}function yt(t){"undefined"==typeof ender&&(wt=Dt.moment,t?Dt.moment=r("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",_t):Dt.moment=_t)}for(var _t,wt,bt,kt="2.8.3",Dt="undefined"!=typeof global?global:this,Ct=Math.round,Rt=Object.prototype.hasOwnProperty,Tt=0,xt=1,St=2,Pt=3,Gt=4,At=5,Mt=6,Ot={},Ft=[],Et="undefined"!=typeof module&&module.exports,Vt=/^\/?Date\((\-?\d+)/i,Bt=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,$t=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,It=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,jt=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,Nt=/\d\d?/,Ut=/\d{1,3}/,Lt=/\d{1,4}/,zt=/[+\-]?\d{1,6}/,Wt=/\d+/,Ht=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Yt=/Z|[\+\-]\d\d:?\d\d/gi,qt=/T/i,Zt=/[\+\-]?\d+(\.\d{1,3})?/,Qt=/\d{1,2}/,Xt=/\d/,Kt=/\d\d/,Jt=/\d{3}/,te=/\d{4}/,ee=/[+-]?\d{6}/,ie=/[+-]?\d+/,ne=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,oe="YYYY-MM-DDTHH:mm:ssZ",re=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],se=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],ae=/([\+\-]|\d\d)/gi,le=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),ce={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},ue={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},he={},de={s:45,m:45,h:22,d:26,M:11},pe="DDD w W M D d".split(" "),fe="M D H h m s w W".split(" "),ge={M:function(){return this.month()+1},MMM:function(t){return this.localeData().monthsShort(this,t)},MMMM:function(t){return this.localeData().months(this,t)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(t){return this.localeData().weekdaysMin(this,t)},ddd:function(t){return this.localeData().weekdaysShort(this,t)},dddd:function(t){return this.localeData().weekdays(this,t)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return g(this.year()%100,2)},YYYY:function(){return g(this.year(),4)},YYYYY:function(){return g(this.year(),5)},YYYYYY:function(){var t=this.year(),e=t>=0?"+":"-";return e+g(Math.abs(t),6)},gg:function(){return g(this.weekYear()%100,2)},gggg:function(){return g(this.weekYear(),4)},ggggg:function(){return g(this.weekYear(),5)},GG:function(){return g(this.isoWeekYear()%100,2)},GGGG:function(){return g(this.isoWeekYear(),4)},GGGGG:function(){return g(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return T(this.milliseconds()/100)},SS:function(){return g(T(this.milliseconds()/10),2)},SSS:function(){return g(this.milliseconds(),3)},SSSS:function(){return g(this.milliseconds(),3)},Z:function(){var t=-this.zone(),e="+";return t<0&&(t=-t,e="-"),e+g(T(t/60),2)+":"+g(T(t)%60,2)},ZZ:function(){var t=-this.zone(),e="+";return t<0&&(t=-t,e="-"),e+g(T(t/60),2)+g(T(t)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},me={},ve=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];pe.length;)bt=pe.pop(),ge[bt+"o"]=l(ge[bt],bt);for(;fe.length;)bt=fe.pop(),ge[bt+bt]=a(ge[bt],2);ge.DDDD=a(ge.DDD,3),d(c.prototype,{set:function(t){var e,i;for(i in t)e=t[i],"function"==typeof e?this[i]=e:this["_"+i]=e},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(t){return this._months[t.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(t){return this._monthsShort[t.month()]},monthsParse:function(t){var e,i,n;for(this._monthsParse||(this._monthsParse=[]),e=0;e<12;e++)if(this._monthsParse[e]||(i=_t.utc([2e3,e]),n="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[e]=new RegExp(n.replace(".",""),"i")),this._monthsParse[e].test(t))return e},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(t){return this._weekdays[t.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(t){return this._weekdaysShort[t.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(t){return this._weekdaysMin[t.day()]},weekdaysParse:function(t){var e,i,n;for(this._weekdaysParse||(this._weekdaysParse=[]),e=0;e<7;e++)if(this._weekdaysParse[e]||(i=_t([2e3,1]).day(e),n="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[e]=new RegExp(n.replace(".",""),"i")),this._weekdaysParse[e].test(t))return e},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(t){var e=this._longDateFormat[t];return!e&&this._longDateFormat[t.toUpperCase()]&&(e=this._longDateFormat[t.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t]=e),e},isPM:function(t){return"p"===(t+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(t,e,i){return t>11?i?"pm":"PM":i?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(t,e){var i=this._calendar[t];return"function"==typeof i?i.apply(e):i},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(t,e,i,n){var o=this._relativeTime[i];return"function"==typeof o?o(t,e,i,n):o.replace(/%d/i,t)},pastFuture:function(t,e){var i=this._relativeTime[t>0?"future":"past"];return"function"==typeof i?i(e):i.replace(/%s/i,e)},ordinal:function(t){return this._ordinal.replace("%d",t)},_ordinal:"%d",preparse:function(t){return t},postformat:function(t){return t},week:function(t){return at(t,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),_t=function(e,i,o,r){var s;return"boolean"==typeof o&&(r=o,o=t),s={},s._isAMomentObject=!0,s._i=e,s._f=i,s._l=o,s._strict=r,s._isUTC=!1,s._pf=n(),ct(s)},_t.suppressDeprecationWarnings=!1,_t.createFromInputFallback=r("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(t){t._d=new Date(t._i)}),_t.min=function(){var t=[].slice.call(arguments,0);return ut("isBefore",t)},_t.max=function(){var t=[].slice.call(arguments,0);return ut("isAfter",t)},_t.utc=function(e,i,o,r){var s;
return"boolean"==typeof o&&(r=o,o=t),s={},s._isAMomentObject=!0,s._useUTC=!0,s._isUTC=!0,s._l=o,s._i=e,s._f=i,s._strict=r,s._pf=n(),ct(s).utc()},_t.unix=function(t){return _t(1e3*t)},_t.duration=function(t,e){var n,o,r,s,a=t,l=null;return _t.isDuration(t)?a={ms:t._milliseconds,d:t._days,M:t._months}:"number"==typeof t?(a={},e?a[e]=t:a.milliseconds=t):(l=Bt.exec(t))?(n="-"===l[1]?-1:1,a={y:0,d:T(l[St])*n,h:T(l[Pt])*n,m:T(l[Gt])*n,s:T(l[At])*n,ms:T(l[Mt])*n}):(l=$t.exec(t))?(n="-"===l[1]?-1:1,r=function(t){var e=t&&parseFloat(t.replace(",","."));return(isNaN(e)?0:e)*n},a={y:r(l[2]),M:r(l[3]),d:r(l[4]),h:r(l[5]),m:r(l[6]),s:r(l[7]),w:r(l[8])}):"object"==typeof a&&("from"in a||"to"in a)&&(s=v(_t(a.from),_t(a.to)),a={},a.ms=s.milliseconds,a.M=s.months),o=new h(a),_t.isDuration(t)&&i(t,"_locale")&&(o._locale=t._locale),o},_t.version=kt,_t.defaultFormat=oe,_t.ISO_8601=function(){},_t.momentProperties=Ft,_t.updateOffset=function(){},_t.relativeTimeThreshold=function(e,i){return de[e]!==t&&(i===t?de[e]:(de[e]=i,!0))},_t.lang=r("moment.lang is deprecated. Use moment.locale instead.",function(t,e){return _t.locale(t,e)}),_t.locale=function(t,e){var i;return t&&(i="undefined"!=typeof e?_t.defineLocale(t,e):_t.localeData(t),i&&(_t.duration._locale=_t._locale=i)),_t._locale._abbr},_t.defineLocale=function(t,e){return null!==e?(e.abbr=t,Ot[t]||(Ot[t]=new c),Ot[t].set(e),_t.locale(t),Ot[t]):(delete Ot[t],null)},_t.langData=r("moment.langData is deprecated. Use moment.localeData instead.",function(t){return _t.localeData(t)}),_t.localeData=function(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return _t._locale;if(!w(t)){if(e=E(t))return e;t=[t]}return F(t)},_t.isMoment=function(t){return t instanceof u||null!=t&&i(t,"_isAMomentObject")},_t.isDuration=function(t){return t instanceof h};for(bt=ve.length-1;bt>=0;--bt)R(ve[bt]);_t.normalizeUnits=function(t){return D(t)},_t.invalid=function(t){var e=_t.utc(NaN);return null!=t?d(e._pf,t):e._pf.userInvalidated=!0,e},_t.parseZone=function(){return _t.apply(null,arguments).parseZone()},_t.parseTwoDigitYear=function(t){return T(t)+(T(t)>68?1900:2e3)},d(_t.fn=u.prototype,{clone:function(){return _t(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date((+this)):this._d},toISOString:function(){var t=_t(this).utc();return 0<t.year()&&t.year()<=9999?I(t,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):I(t,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var t=this;return[t.year(),t.month(),t.date(),t.hours(),t.minutes(),t.seconds(),t.milliseconds()]},isValid:function(){return M(this)},isDSTShifted:function(){return!!this._a&&(this.isValid()&&k(this._a,(this._isUTC?_t.utc(this._a):_t(this._a)).toArray())>0)},parsingFlags:function(){return d({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(t){return this.zone(0,t)},local:function(t){return this._isUTC&&(this.zone(0,t),this._isUTC=!1,t&&this.add(this._dateTzOffset(),"m")),this},format:function(t){var e=I(this,t||_t.defaultFormat);return this.localeData().postformat(e)},add:y(1,"add"),subtract:y(-1,"subtract"),diff:function(t,e,i){var n,o,r,s=V(t,this),a=6e4*(this.zone()-s.zone());return e=D(e),"year"===e||"month"===e?(n=432e5*(this.daysInMonth()+s.daysInMonth()),o=12*(this.year()-s.year())+(this.month()-s.month()),r=this-_t(this).startOf("month")-(s-_t(s).startOf("month")),r-=6e4*(this.zone()-_t(this).startOf("month").zone()-(s.zone()-_t(s).startOf("month").zone())),o+=r/n,"year"===e&&(o/=12)):(n=this-s,o="second"===e?n/1e3:"minute"===e?n/6e4:"hour"===e?n/36e5:"day"===e?(n-a)/864e5:"week"===e?(n-a)/6048e5:n),i?o:f(o)},from:function(t,e){return _t.duration({to:this,from:t}).locale(this.locale()).humanize(!e)},fromNow:function(t){return this.from(_t(),t)},calendar:function(t){var e=t||_t(),i=V(e,this).startOf("day"),n=this.diff(i,"days",!0),o=n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse";return this.format(this.localeData().calendar(o,this))},isLeapYear:function(){return G(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(t){var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=ot(t,this.localeData()),this.add(t-e,"d")):e},month:ft("Month",!0),startOf:function(t){switch(t=D(t)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t?this.weekday(0):"isoWeek"===t&&this.isoWeekday(1),"quarter"===t&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(t){return t=D(t),this.startOf(t).add(1,"isoWeek"===t?"week":t).subtract(1,"ms")},isAfter:function(t,e){return e=D("undefined"!=typeof e?e:"millisecond"),"millisecond"===e?(t=_t.isMoment(t)?t:_t(t),+this>+t):+this.clone().startOf(e)>+_t(t).startOf(e)},isBefore:function(t,e){return e=D("undefined"!=typeof e?e:"millisecond"),"millisecond"===e?(t=_t.isMoment(t)?t:_t(t),+this<+t):+this.clone().startOf(e)<+_t(t).startOf(e)},isSame:function(t,e){return e=D(e||"millisecond"),"millisecond"===e?(t=_t.isMoment(t)?t:_t(t),+this===+t):+this.clone().startOf(e)===+V(t,this).startOf(e)},min:r("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(t){return t=_t.apply(null,arguments),t<this?this:t}),max:r("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(t){return t=_t.apply(null,arguments),t>this?this:t}),zone:function(t,e){var i,n=this._offset||0;return null==t?this._isUTC?n:this._dateTzOffset():("string"==typeof t&&(t=U(t)),Math.abs(t)<16&&(t=60*t),!this._isUTC&&e&&(i=this._dateTzOffset()),this._offset=t,this._isUTC=!0,null!=i&&this.subtract(i,"m"),n!==t&&(!e||this._changeInProgress?_(this,_t.duration(n-t,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,_t.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(t){return t=t?_t(t).zone():0,(this.zone()-t)%60===0},daysInMonth:function(){return x(this.year(),this.month())},dayOfYear:function(t){var e=Ct((_t(this).startOf("day")-_t(this).startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},quarter:function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},weekYear:function(t){var e=at(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==t?e:this.add(t-e,"y")},isoWeekYear:function(t){var e=at(this,1,4).year;return null==t?e:this.add(t-e,"y")},week:function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},isoWeek:function(t){var e=at(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},weekday:function(t){var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},isoWeekday:function(t){return null==t?this.day()||7:this.day(this.day()%7?t:t-7)},isoWeeksInYear:function(){return S(this.year(),1,4)},weeksInYear:function(){var t=this.localeData()._week;return S(this.year(),t.dow,t.doy)},get:function(t){return t=D(t),this[t]()},set:function(t,e){return t=D(t),"function"==typeof this[t]&&this[t](e),this},locale:function(e){var i;return e===t?this._locale._abbr:(i=_t.localeData(e),null!=i&&(this._locale=i),this)},lang:r("moment().lang() is deprecated. Use moment().localeData() instead.",function(e){return e===t?this.localeData():this.locale(e)}),localeData:function(){return this._locale},_dateTzOffset:function(){return 15*Math.round(this._d.getTimezoneOffset()/15)}}),_t.fn.millisecond=_t.fn.milliseconds=ft("Milliseconds",!1),_t.fn.second=_t.fn.seconds=ft("Seconds",!1),_t.fn.minute=_t.fn.minutes=ft("Minutes",!1),_t.fn.hour=_t.fn.hours=ft("Hours",!0),_t.fn.date=ft("Date",!0),_t.fn.dates=r("dates accessor is deprecated. Use date instead.",ft("Date",!0)),_t.fn.year=ft("FullYear",!0),_t.fn.years=r("years accessor is deprecated. Use year instead.",ft("FullYear",!0)),_t.fn.days=_t.fn.day,_t.fn.months=_t.fn.month,_t.fn.weeks=_t.fn.week,_t.fn.isoWeeks=_t.fn.isoWeek,_t.fn.quarters=_t.fn.quarter,_t.fn.toJSON=_t.fn.toISOString,d(_t.duration.fn=h.prototype,{_bubble:function(){var t,e,i,n=this._milliseconds,o=this._days,r=this._months,s=this._data,a=0;s.milliseconds=n%1e3,t=f(n/1e3),s.seconds=t%60,e=f(t/60),s.minutes=e%60,i=f(e/60),s.hours=i%24,o+=f(i/24),a=f(gt(o)),o-=f(mt(a)),r+=f(o/30),o%=30,a+=f(r/12),r%=12,s.days=o,s.months=r,s.years=a},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return f(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*T(this._months/12)},humanize:function(t){var e=st(this,!t,this.localeData());return t&&(e=this.localeData().pastFuture(+this,e)),this.localeData().postformat(e)},add:function(t,e){var i=_t.duration(t,e);return this._milliseconds+=i._milliseconds,this._days+=i._days,this._months+=i._months,this._bubble(),this},subtract:function(t,e){var i=_t.duration(t,e);return this._milliseconds-=i._milliseconds,this._days-=i._days,this._months-=i._months,this._bubble(),this},get:function(t){return t=D(t),this[t.toLowerCase()+"s"]()},as:function(t){var e,i;if(t=D(t),"month"===t||"year"===t)return e=this._days+this._milliseconds/864e5,i=this._months+12*gt(e),"month"===t?i:i/12;switch(e=this._days+mt(this._months/12),t){case"week":return e/7+this._milliseconds/6048e5;case"day":return e+this._milliseconds/864e5;case"hour":return 24*e+this._milliseconds/36e5;case"minute":return 24*e*60+this._milliseconds/6e4;case"second":return 24*e*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(24*e*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+t)}},lang:_t.fn.lang,locale:_t.fn.locale,toIsoString:r("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var t=Math.abs(this.years()),e=Math.abs(this.months()),i=Math.abs(this.days()),n=Math.abs(this.hours()),o=Math.abs(this.minutes()),r=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(t?t+"Y":"")+(e?e+"M":"")+(i?i+"D":"")+(n||o||r?"T":"")+(n?n+"H":"")+(o?o+"M":"")+(r?r+"S":""):"P0D"},localeData:function(){return this._locale}}),_t.duration.fn.toString=_t.duration.fn.toISOString;for(bt in le)i(le,bt)&&vt(bt.toLowerCase());_t.duration.fn.asMilliseconds=function(){return this.as("ms")},_t.duration.fn.asSeconds=function(){return this.as("s")},_t.duration.fn.asMinutes=function(){return this.as("m")},_t.duration.fn.asHours=function(){return this.as("h")},_t.duration.fn.asDays=function(){return this.as("d")},_t.duration.fn.asWeeks=function(){return this.as("weeks")},_t.duration.fn.asMonths=function(){return this.as("M")},_t.duration.fn.asYears=function(){return this.as("y")},_t.locale("en",{ordinal:function(t){var e=t%10,i=1===T(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th";return t+i}}),Et?module.exports=_t:"function"==typeof define&&define.amd?(define("moment",function(t,e,i){return i.config&&i.config()&&i.config().noGlobal===!0&&(Dt.moment=wt),_t}),yt(!0)):yt()}.call(this),function(t){"undefined"==typeof t.fn.each2&&t.extend(t.fn,{each2:function(e){for(var i=t([0]),n=-1,o=this.length;++n<o&&(i.context=i[0]=this[n])&&e.call(i[0],n,i)!==!1;);return this}})}(jQuery),function(t,e){"use strict";function i(e){var i=t(document.createTextNode(""));e.before(i),i.before(e),i.remove()}function n(t){function e(t){return j[t]||t}return t.replace(/[^\u0000-\u007E]/g,e)}function o(t,e){for(var i=0,n=e.length;i<n;i+=1)if(s(t,e[i]))return i;return-1}function r(){var e=t(I);e.appendTo(document.body);var i={width:e.width()-e[0].clientWidth,height:e.height()-e[0].clientHeight};return e.remove(),i}function s(t,i){return t===i||t!==e&&i!==e&&(null!==t&&null!==i&&(t.constructor===String?t+""==i+"":i.constructor===String&&i+""==t+""))}function a(t,e,i){var n,o,r;if(null===t||t.length<1)return[];for(n=t.split(e),o=0,r=n.length;o<r;o+=1)n[o]=i(n[o]);return n}function l(t){return t.outerWidth(!1)-t.width()}function c(i){var n="keyup-change-value";i.on("keydown",function(){t.data(i,n)===e&&t.data(i,n,i.val())}),i.on("keyup",function(){var o=t.data(i,n);o!==e&&i.val()!==o&&(t.removeData(i,n),i.trigger("keyup-change"))})}function u(i){i.on("mousemove",function(i){var n=B;n!==e&&n.x===i.pageX&&n.y===i.pageY||t(i.target).trigger("mousemove-filtered",i)})}function h(t,i,n){n=n||e;var o;return function(){var e=arguments;window.clearTimeout(o),o=window.setTimeout(function(){i.apply(n,e)},t)}}function d(t,e){var i=h(t,function(t){e.trigger("scroll-debounced",t)});e.on("scroll",function(t){o(t.target,e.get())>=0&&i(t)})}function p(t){t[0]!==document.activeElement&&window.setTimeout(function(){var e,i=t[0],n=t.val().length;t.focus();var o=i.offsetWidth>0||i.offsetHeight>0;o&&i===document.activeElement&&(i.setSelectionRange?i.setSelectionRange(n,n):i.createTextRange&&(e=i.createTextRange(),e.collapse(!1),e.select()))},0)}function f(e){e=t(e)[0];var i=0,n=0;if("selectionStart"in e)i=e.selectionStart,n=e.selectionEnd-i;else if("selection"in document){e.focus();var o=document.selection.createRange();n=document.selection.createRange().text.length,o.moveStart("character",-e.value.length),i=o.text.length-n}return{offset:i,length:n}}function g(t){t.preventDefault(),t.stopPropagation()}function m(t){t.preventDefault(),t.stopImmediatePropagation()}function v(e){if(!F){var i=e[0].currentStyle||window.getComputedStyle(e[0],null);F=t(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:i.fontSize,fontFamily:i.fontFamily,fontStyle:i.fontStyle,fontWeight:i.fontWeight,letterSpacing:i.letterSpacing,textTransform:i.textTransform,whiteSpace:"nowrap"}),F.attr("class","select2-sizer"),t(document.body).append(F)}return F.text(e.val()),F.width()}function y(e,i,n){var o,r,s=[];o=t.trim(e.attr("class")),o&&(o=""+o,t(o.split(/\s+/)).each2(function(){0===this.indexOf("select2-")&&s.push(this)})),o=t.trim(i.attr("class")),o&&(o=""+o,t(o.split(/\s+/)).each2(function(){0!==this.indexOf("select2-")&&(r=n(this),r&&s.push(r))})),e.attr("class",s.join(" "))}function _(t,e,i,o){var r=n(t.toUpperCase()).indexOf(n(e.toUpperCase())),s=e.length;return r<0?void i.push(o(t)):(i.push(o(t.substring(0,r))),i.push("<span class='select2-match'>"),i.push(o(t.substring(r,r+s))),i.push("</span>"),void i.push(o(t.substring(r+s,t.length))))}function w(t){var e={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(t).replace(/[&<>"'\/\\]/g,function(t){return e[t]})}function b(i){var n,o=null,r=i.quietMillis||100,s=i.url,a=this;return function(l){window.clearTimeout(n),n=window.setTimeout(function(){var n=i.data,r=s,c=i.transport||t.fn.select2.ajaxDefaults.transport,u={type:i.type||"GET",cache:i.cache||!1,jsonpCallback:i.jsonpCallback||e,dataType:i.dataType||"json"},h=t.extend({},t.fn.select2.ajaxDefaults.params,u);n=n?n.call(a,l.term,l.page,l.context):null,r="function"==typeof r?r.call(a,l.term,l.page,l.context):r,o&&"function"==typeof o.abort&&o.abort(),i.params&&(t.isFunction(i.params)?t.extend(h,i.params.call(a)):t.extend(h,i.params)),t.extend(h,{url:r,dataType:i.dataType,data:n,success:function(t){var e=i.results(t,l.page,l);l.callback(e)},error:function(t,e,i){var n={hasError:!0,jqXHR:t,textStatus:e,errorThrown:i};l.callback(n)}}),o=c.call(a,h)},r)}}function k(e){var i,n,o=e,r=function(t){return""+t.text};t.isArray(o)&&(n=o,o={results:n}),t.isFunction(o)===!1&&(n=o,o=function(){return n});var s=o();return s.text&&(r=s.text,t.isFunction(r)||(i=s.text,r=function(t){return t[i]})),function(e){var i,n=e.term,s={results:[]};return""===n?void e.callback(o()):(i=function(o,s){var a,l;if(o=o[0],o.children){a={};for(l in o)o.hasOwnProperty(l)&&(a[l]=o[l]);a.children=[],t(o.children).each2(function(t,e){i(e,a.children)}),(a.children.length||e.matcher(n,r(a),o))&&s.push(a)}else e.matcher(n,r(o),o)&&s.push(o)},t(o().results).each2(function(t,e){i(e,s.results)}),void e.callback(s))}}function D(i){var n=t.isFunction(i);return function(o){var r=o.term,s={results:[]},a=n?i(o):i;t.isArray(a)&&(t(a).each(function(){var t=this.text!==e,i=t?this.text:this;(""===r||o.matcher(r,i))&&s.results.push(t?this:{id:this,text:this})}),o.callback(s))}}function C(e,i){if(t.isFunction(e))return!0;if(!e)return!1;if("string"==typeof e)return!0;throw new Error(i+" must be a string, function, or falsy value")}function R(e,i){if(t.isFunction(e)){var n=Array.prototype.slice.call(arguments,2);return e.apply(i,n)}return e}function T(e){var i=0;return t.each(e,function(t,e){e.children?i+=T(e.children):i++}),i}function x(t,i,n,o){var r,a,l,c,u,h=t,d=!1;if(!o.createSearchChoice||!o.tokenSeparators||o.tokenSeparators.length<1)return e;for(;;){for(a=-1,l=0,c=o.tokenSeparators.length;l<c&&(u=o.tokenSeparators[l],a=t.indexOf(u),!(a>=0));l++);if(a<0)break;if(r=t.substring(0,a),t=t.substring(a+u.length),r.length>0&&(r=o.createSearchChoice.call(this,r,i),r!==e&&null!==r&&o.id(r)!==e&&null!==o.id(r))){for(d=!1,l=0,c=i.length;l<c;l++)if(s(o.id(r),o.id(i[l]))){d=!0;break}d||n(r)}}return h!==t?t:void 0}function S(){var e=this;t.each(arguments,function(t,i){e[i].remove(),e[i]=null})}function P(e,i){var n=function(){};return n.prototype=new e,n.prototype.constructor=n,n.prototype.parent=e.prototype,n.prototype=t.extend(n.prototype,i),n}if(window.Select2===e){var G,A,M,O,F,E,V,B={x:0,y:0},$={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(t){switch(t=t.which?t.which:t){case $.LEFT:case $.RIGHT:case $.UP:case $.DOWN:return!0}return!1},isControl:function(t){var e=t.which;switch(e){case $.SHIFT:case $.CTRL:case $.ALT:return!0}return!!t.metaKey},isFunctionKey:function(t){return t=t.which?t.which:t,t>=112&&t<=123}},I="<div class='select2-measure-scrollbar'></div>",j={"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"AA","":"AE","":"AE","":"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"DZ","":"DZ","":"Dz","":"Dz","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"F","":"F","":"F","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"J","":"J","":"J","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"LJ","":"Lj","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"NJ","":"Nj","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"OI","":"OO","":"OU","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"Q","":"Q","":"Q","":"Q","":"Q","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"TZ","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"VY","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"aa","":"ae","":"ae","":"ae","":"ao","":"au","":"av","":"av","":"ay","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"dz","":"dz","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"f","":"f","":"f","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"hv","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"j","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"lj","":"m","":"m","":"m","":"m","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"nj","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"oi","":"ou","":"oo","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"q","":"q","":"q","":"q","":"q","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"tz","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"vy","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};E=t(document),O=function(){var t=1;return function(){return t++}}(),G=P(Object,{bind:function(t){var e=this;return function(){t.apply(e,arguments)}},init:function(i){var n,o,s=".select2-results";this.opts=i=this.prepareOpts(i),this.id=i.id,i.element.data("select2")!==e&&null!==i.element.data("select2")&&i.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=t(".select2-hidden-accessible"),0==this.liveRegion.length&&(this.liveRegion=t("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body)),this.containerId="s2id_"+(i.element.attr("id")||"autogen"+O()),this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.container.attr("title",i.element.attr("title")),this.body=t(document.body),y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",i.element.attr("style")),this.container.css(R(i.containerCss,this.opts.element)),this.container.addClass(R(i.containerCssClass,this.opts.element)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",g),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(R(i.dropdownCssClass,this.opts.element)),this.dropdown.data("select2",this),this.dropdown.on("click",g),this.results=n=this.container.find(s),this.search=o=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",g),u(this.results),this.dropdown.on("mousemove-filtered",s,this.bind(this.highlightUnderEvent)),this.dropdown.on("touchstart touchmove touchend",s,this.bind(function(t){this._touchEvent=!0,this.highlightUnderEvent(t)})),this.dropdown.on("touchmove",s,this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",s,this.bind(this.clearTouchMoved)),this.dropdown.on("click",this.bind(function(t){this._touchEvent&&(this._touchEvent=!1,this.selectHighlighted())})),d(80,this.results),this.dropdown.on("scroll-debounced",s,this.bind(this.loadMoreIfNeeded)),t(this.container).on("change",".select2-input",function(t){t.stopPropagation()}),t(this.dropdown).on("change",".select2-input",function(t){t.stopPropagation()}),t.fn.mousewheel&&n.mousewheel(function(t,e,i,o){var r=n.scrollTop();o>0&&r-o<=0?(n.scrollTop(0),g(t)):o<0&&n.get(0).scrollHeight-n.scrollTop()+o<=n.height()&&(n.scrollTop(n.get(0).scrollHeight-n.height()),g(t))}),c(o),o.on("keyup-change input paste",this.bind(this.updateResults)),o.on("focus",function(){o.addClass("select2-focused")}),o.on("blur",function(){o.removeClass("select2-focused")}),this.dropdown.on("mouseup",s,this.bind(function(e){t(e.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(e),this.selectHighlighted(e))})),this.dropdown.on("click mouseup mousedown touchstart touchend focusin",function(t){t.stopPropagation()}),this.lastSearchTerm=e,t.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==i.maximumInputLength&&this.search.attr("maxlength",i.maximumInputLength);var a=i.element.prop("disabled");a===e&&(a=!1),this.enable(!a);var l=i.element.prop("readonly");l===e&&(l=!1),this.readonly(l),V=V||r(),this.autofocus=i.element.prop("autofocus"),i.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",i.searchInputPlaceholder)},destroy:function(){var t=this.opts.element,i=t.data("select2"),n=this;this.close(),t.length&&t[0].detachEvent&&n._sync&&t.each(function(){n._sync&&this.detachEvent("onpropertychange",n._sync)}),this.propertyObserver&&(this.propertyObserver.disconnect(),this.propertyObserver=null),this._sync=null,i!==e&&(i.container.remove(),i.liveRegion.remove(),i.dropdown.remove(),t.removeData("select2").off(".select2"),t.is("input[type='hidden']")?t.css("display",""):(t.show().prop("autofocus",this.autofocus||!1),this.elementTabIndex?t.attr({tabindex:this.elementTabIndex}):t.removeAttr("tabindex"),t.show())),S.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(t){return t.is("option")?{id:t.prop("value"),text:t.text(),element:t.get(),css:t.attr("class"),disabled:t.prop("disabled"),locked:s(t.attr("locked"),"locked")||s(t.data("locked"),!0)}:t.is("optgroup")?{text:t.attr("label"),children:[],element:t.get(),css:t.attr("class")}:void 0},prepareOpts:function(i){var n,o,r,l,c=this;if(n=i.element,"select"===n.get(0).tagName.toLowerCase()&&(this.select=o=i.element),o&&t.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in i)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),i.debug=i.debug||t.fn.select2.defaults.debug,i.debug&&console&&console.warn&&(null!=i.id&&console.warn("Select2: The `id` option has been removed in Select2 4.0.0, consider renaming your `id` property or mapping the property before your data makes it to Select2. You can read more at https://select2.github.io/announcements-4.0.html#changed-id"),null!=i.text&&console.warn("Select2: The `text` option has been removed in Select2 4.0.0, consider renaming your `text` property or mapping the property before your data makes it to Select2. You can read more at https://select2.github.io/announcements-4.0.html#changed-id"),null!=i.sortResults&&console.warn("Select2: the `sortResults` option has been renamed to `sorter` in Select2 4.0.0. "),null!=i.selectOnBlur&&console.warn("Select2: The `selectOnBlur` option has been renamed to `selectOnClose` in Select2 4.0.0."),null!=i.ajax&&null!=i.ajax.results&&console.warn("Select2: The `ajax.results` option has been renamed to `ajax.processResults` in Select2 4.0.0."),null!=i.formatNoResults&&console.warn("Select2: The `formatNoResults` option has been renamed to `language.noResults` in Select2 4.0.0."),null!=i.formatSearching&&console.warn("Select2: The `formatSearching` option has been renamed to `language.searching` in Select2 4.0.0."),null!=i.formatInputTooShort&&console.warn("Select2: The `formatInputTooShort` option has been renamed to `language.inputTooShort` in Select2 4.0.0."),null!=i.formatInputTooLong&&console.warn("Select2: The `formatInputTooLong` option has been renamed to `language.inputTooLong` in Select2 4.0.0."),
null!=i.formatLoading&&console.warn("Select2: The `formatLoading` option has been renamed to `language.loadingMore` in Select2 4.0.0."),null!=i.formatSelectionTooBig&&console.warn("Select2: The `formatSelectionTooBig` option has been renamed to `language.maximumSelected` in Select2 4.0.0."),i.element.data("select2Tags")&&console.warn("Select2: The `data-select2-tags` attribute has been renamed to `data-tags` in Select2 4.0.0.")),null!=i.element.data("tags")){var u=i.element.data("tags");t.isArray(u)||(u=[]),i.element.data("select2Tags",u)}if(null!=i.sorter&&(i.sortResults=i.sorter),null!=i.selectOnClose&&(i.selectOnBlur=i.selectOnClose),null!=i.ajax&&t.isFunction(i.ajax.processResults)&&(i.ajax.results=i.ajax.processResults),null!=i.language){var h=i.language;t.isFunction(h.noMatches)&&(i.formatNoMatches=h.noMatches),t.isFunction(h.searching)&&(i.formatSearching=h.searching),t.isFunction(h.inputTooShort)&&(i.formatInputTooShort=h.inputTooShort),t.isFunction(h.inputTooLong)&&(i.formatInputTooLong=h.inputTooLong),t.isFunction(h.loadingMore)&&(i.formatLoading=h.loadingMore),t.isFunction(h.maximumSelected)&&(i.formatSelectionTooBig=h.maximumSelected)}if(i=t.extend({},{populateResults:function(n,o,r){var s,a=this.opts.id,l=this.liveRegion;(s=function(n,o,u){var h,d,p,f,g,m,v,y,_,w;n=i.sortResults(n,o,r);var b=[];for(h=0,d=n.length;h<d;h+=1)p=n[h],g=p.disabled===!0,f=!g&&a(p)!==e,m=p.children&&p.children.length>0,v=t("<li></li>"),v.addClass("select2-results-dept-"+u),v.addClass("select2-result"),v.addClass(f?"select2-result-selectable":"select2-result-unselectable"),g&&v.addClass("select2-disabled"),m&&v.addClass("select2-result-with-children"),v.addClass(c.opts.formatResultCssClass(p)),v.attr("role","presentation"),y=t(document.createElement("div")),y.addClass("select2-result-label"),y.attr("id","select2-result-label-"+O()),y.attr("role","option"),w=i.formatResult(p,y,r,c.opts.escapeMarkup),w!==e&&(y.html(w),v.append(y)),m&&(_=t("<ul></ul>"),_.addClass("select2-result-sub"),s(p.children,_,u+1),v.append(_)),v.data("select2-data",p),b.push(v[0]);o.append(b),l.text(i.formatMatches(n.length))})(o,n,0)}},t.fn.select2.defaults,i),"function"!=typeof i.id&&(r=i.id,i.id=function(t){return t[r]}),t.isArray(i.element.data("select2Tags"))){if("tags"in i)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+i.element.attr("id");i.tags=i.element.data("select2Tags")}if(o?(i.query=this.bind(function(t){var i,o,r,s={results:[],more:!1},a=t.term;r=function(e,i){var n;e.is("option")?t.matcher(a,e.text(),e)&&i.push(c.optionToData(e)):e.is("optgroup")&&(n=c.optionToData(e),e.children().each2(function(t,e){r(e,n.children)}),n.children.length>0&&i.push(n))},i=n.children(),this.getPlaceholder()!==e&&i.length>0&&(o=this.getPlaceholderOption(),o&&(i=i.not(o))),i.each2(function(t,e){r(e,s.results)}),t.callback(s)}),i.id=function(t){return t.id}):"query"in i||("ajax"in i?(l=i.element.data("ajax-url"),l&&l.length>0&&(i.ajax.url=l),i.query=b.call(i.element,i.ajax)):"data"in i?i.query=k(i.data):"tags"in i&&(i.query=D(i.tags),i.createSearchChoice===e&&(i.createSearchChoice=function(e){return{id:t.trim(e),text:t.trim(e)}}),i.initSelection===e&&(i.initSelection=function(e,n){var o=[];t(a(e.val(),i.separator,i.transformVal)).each(function(){var e={id:this,text:this},n=i.tags;t.isFunction(n)&&(n=n()),t(n).each(function(){if(s(this.id,e.id))return e=this,!1}),o.push(e)}),n(o)}))),"function"!=typeof i.query)throw"query function not defined for Select2 "+i.element.attr("id");if("top"===i.createSearchChoicePosition)i.createSearchChoicePosition=function(t,e){t.unshift(e)};else if("bottom"===i.createSearchChoicePosition)i.createSearchChoicePosition=function(t,e){t.push(e)};else if("function"!=typeof i.createSearchChoicePosition)throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return i},monitorSource:function(){var i,n=this.opts.element,o=this;n.on("change.select2",this.bind(function(t){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),this._sync=this.bind(function(){var t=n.prop("disabled");t===e&&(t=!1),this.enable(!t);var i=n.prop("readonly");i===e&&(i=!1),this.readonly(i),this.container&&(y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(R(this.opts.containerCssClass,this.opts.element))),this.dropdown&&(y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(R(this.opts.dropdownCssClass,this.opts.element)))}),n.length&&n[0].attachEvent&&n.each(function(){this.attachEvent("onpropertychange",o._sync)}),i=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,i!==e&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new i(function(e){t.each(e,o._sync)}),this.propertyObserver.observe(n.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(e){var i=t.Event("select2-selecting",{val:this.id(e),object:e,choice:e});return this.opts.element.trigger(i),!i.isDefaultPrevented()},triggerChange:function(e){e=e||{},e=t.extend({},e,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(e),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var t=this._enabled&&!this._readonly,e=!t;return t!==this.enabledInterface&&(this.container.toggleClass("select2-container-disabled",e),this.close(),this.enabledInterface=t,!0)},enable:function(t){t===e&&(t=!0),this._enabled!==t&&(this._enabled=t,this.opts.element.prop("disabled",!t),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(t){t===e&&(t=!1),this._readonly!==t&&(this._readonly=t,this.opts.element.prop("readonly",t),this.enableInterface())},opened:function(){return!!this.container&&this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var e,i,n,o,r,s=this.dropdown,a=this.container,l=a.offset(),c=a.outerHeight(!1),u=a.outerWidth(!1),h=s.outerHeight(!1),d=t(window),p=d.width(),f=d.height(),g=d.scrollLeft()+p,m=d.scrollTop()+f,v=l.top+c,y=l.left,_=v+h<=m,w=l.top-h>=d.scrollTop(),b=s.outerWidth(!1),k=function(){return y+b<=g},D=function(){return l.left+g+a.outerWidth(!1)>b},C=s.hasClass("select2-drop-above");C?(i=!0,!w&&_&&(n=!0,i=!1)):(i=!1,!_&&w&&(n=!0,i=!0)),n&&(s.hide(),l=this.container.offset(),c=this.container.outerHeight(!1),u=this.container.outerWidth(!1),h=s.outerHeight(!1),g=d.scrollLeft()+p,m=d.scrollTop()+f,v=l.top+c,y=l.left,b=s.outerWidth(!1),s.show(),this.focusSearch()),this.opts.dropdownAutoWidth?(r=t(".select2-results",s)[0],s.addClass("select2-drop-auto-width"),s.css("width",""),b=s.outerWidth(!1)+(r.scrollHeight===r.clientHeight?0:V.width),b>u?u=b:b=u,h=s.outerHeight(!1)):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body.css("position")&&(e=this.body.offset(),v-=e.top,y-=e.left),!k()&&D()&&(y=l.left+this.container.outerWidth(!1)-b),o={left:y,width:u},i?(this.container.addClass("select2-drop-above"),s.addClass("select2-drop-above"),h=s.outerHeight(!1),o.top=l.top-h,o.bottom="auto"):(o.top=v,o.bottom="auto",this.container.removeClass("select2-drop-above"),s.removeClass("select2-drop-above")),o=t.extend(o,R(this.opts.dropdownCss,this.opts.element)),s.css(o)},shouldOpen:function(){var e;return!this.opened()&&(this._enabled!==!1&&this._readonly!==!0&&(e=t.Event("select2-opening"),this.opts.element.trigger(e),!e.isDefaultPrevented()))},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return!!this.shouldOpen()&&(this.opening(),E.on("mousemove.select2Event",function(t){B.x=t.pageX,B.y=t.pageY}),!0)},opening:function(){var e,n=this.containerEventName,o="scroll."+n,r="resize."+n,s="orientationchange."+n;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),e=t("#select2-drop-mask"),0===e.length&&(e=t(document.createElement("div")),e.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),e.hide(),e.appendTo(this.body),e.on("mousedown touchstart click",function(n){i(e);var o,r=t("#select2-drop");r.length>0&&(o=r.data("select2"),o.opts.selectOnBlur&&o.selectHighlighted({noFocus:!0}),o.close(),n.preventDefault(),n.stopPropagation())})),this.dropdown.prev()[0]!==e[0]&&this.dropdown.before(e),t("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),e.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var a=this;this.container.parents().add(window).each(function(){t(this).on(r+" "+o+" "+s,function(t){a.opened()&&a.positionDropdown()})})},close:function(){if(this.opened()){var e=this.containerEventName,i="scroll."+e,n="resize."+e,o="orientationchange."+e;this.container.parents().add(window).each(function(){t(this).off(i).off(n).off(o)}),this.clearDropdownAlignmentPreference(),t("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),E.off("mousemove.select2Event"),this.clearSearch(),this.search.removeClass("select2-active"),this.search.removeAttr("aria-activedescendant"),this.opts.element.trigger(t.Event("select2-close"))}},externalSearch:function(t){this.open(),this.search.val(t),this.updateResults(!1)},clearSearch:function(){},prefillNextSearchTerm:function(){if(""!==this.search.val())return!1;var t=this.opts.nextSearchTerm(this.data(),this.lastSearchTerm);return t!==e&&(this.search.val(t),this.search.select(),!0)},getMaximumSelectionSize:function(){return R(this.opts.maximumSelectionSize,this.opts.element)},ensureHighlightVisible:function(){var e,i,n,o,r,s,a,l,c=this.results;if(i=this.highlight(),!(i<0)){if(0==i)return void c.scrollTop(0);e=this.findHighlightableChoices().find(".select2-result-label"),n=t(e[i]),l=(n.offset()||{}).top||0,o=l+n.outerHeight(!0),i===e.length-1&&(a=c.find("li.select2-more-results"),a.length>0&&(o=a.offset().top+a.outerHeight(!0))),r=c.offset().top+c.outerHeight(!1),o>r&&c.scrollTop(c.scrollTop()+(o-r)),s=l-c.offset().top,s<0&&"none"!=n.css("display")&&c.scrollTop(c.scrollTop()+s)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(e){for(var i=this.findHighlightableChoices(),n=this.highlight();n>-1&&n<i.length;){n+=e;var o=t(i[n]);if(o.hasClass("select2-result-selectable")&&!o.hasClass("select2-disabled")&&!o.hasClass("select2-selected")){this.highlight(n);break}}},highlight:function(e){var i,n,r=this.findHighlightableChoices();return 0===arguments.length?o(r.filter(".select2-highlighted")[0],r.get()):(e>=r.length&&(e=r.length-1),e<0&&(e=0),this.removeHighlight(),i=t(r[e]),i.addClass("select2-highlighted"),this.search.attr("aria-activedescendant",i.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(i.text()),n=i.data("select2-data"),void(n&&this.opts.element.trigger({type:"select2-highlight",val:this.id(n),choice:n})))},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(e){var i=t(e.target).closest(".select2-result-selectable");if(i.length>0&&!i.is(".select2-highlighted")){var n=this.findHighlightableChoices();this.highlight(n.index(i))}else 0==i.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var t,e=this.results,i=e.find("li.select2-more-results"),n=this.resultsPage+1,o=this,r=this.search.val(),s=this.context;0!==i.length&&(t=i.offset().top-e.offset().top-e.height(),t<=this.opts.loadMorePadding&&(i.addClass("select2-active"),this.opts.query({element:this.opts.element,term:r,page:n,context:s,matcher:this.opts.matcher,callback:this.bind(function(t){o.opened()&&(o.opts.populateResults.call(this,e,t.results,{term:r,page:n,context:s}),o.postprocessResults(t,!1,!1),t.more===!0?(i.detach().appendTo(e).html(o.opts.escapeMarkup(R(o.opts.formatLoadMore,o.opts.element,n+1))),window.setTimeout(function(){o.loadMoreIfNeeded()},10)):i.remove(),o.positionDropdown(),o.resultsPage=n,o.context=t.context,this.opts.element.trigger({type:"select2-loaded",items:t}))})})))},tokenize:function(){},updateResults:function(i){function n(){c.removeClass("select2-active"),d.positionDropdown(),u.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?d.liveRegion.text(u.text()):d.liveRegion.text(d.opts.formatMatches(u.find('.select2-result-selectable:not(".select2-selected")').length))}function o(t){u.html(t),n()}var r,a,l,c=this.search,u=this.results,h=this.opts,d=this,p=c.val(),f=t.data(this.container,"select2-last-term");if((i===!0||!f||!s(p,f))&&(t.data(this.container,"select2-last-term",p),i===!0||this.showSearchInput!==!1&&this.opened())){l=++this.queryCount;var g=this.getMaximumSelectionSize();if(g>=1&&(r=this.data(),t.isArray(r)&&r.length>=g&&C(h.formatSelectionTooBig,"formatSelectionTooBig")))return void o("<li class='select2-selection-limit'>"+R(h.formatSelectionTooBig,h.element,g)+"</li>");if(c.val().length<h.minimumInputLength)return o(C(h.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+R(h.formatInputTooShort,h.element,c.val(),h.minimumInputLength)+"</li>":""),void(i&&this.showSearch&&this.showSearch(!0));if(h.maximumInputLength&&c.val().length>h.maximumInputLength)return void o(C(h.formatInputTooLong,"formatInputTooLong")?"<li class='select2-no-results'>"+R(h.formatInputTooLong,h.element,c.val(),h.maximumInputLength)+"</li>":"");h.formatSearching&&0===this.findHighlightableChoices().length&&o("<li class='select2-searching'>"+R(h.formatSearching,h.element)+"</li>"),c.addClass("select2-active"),this.removeHighlight(),a=this.tokenize(),a!=e&&null!=a&&c.val(a),this.resultsPage=1,h.query({element:h.element,term:c.val(),page:this.resultsPage,context:null,matcher:h.matcher,callback:this.bind(function(r){var a;if(l==this.queryCount){if(!this.opened())return void this.search.removeClass("select2-active");if(r.hasError!==e&&C(h.formatAjaxError,"formatAjaxError"))return void o("<li class='select2-ajax-error'>"+R(h.formatAjaxError,h.element,r.jqXHR,r.textStatus,r.errorThrown)+"</li>");if(this.context=r.context===e?null:r.context,this.opts.createSearchChoice&&""!==c.val()&&(a=this.opts.createSearchChoice.call(d,c.val(),r.results),a!==e&&null!==a&&d.id(a)!==e&&null!==d.id(a)&&0===t(r.results).filter(function(){return s(d.id(this),d.id(a))}).length&&this.opts.createSearchChoicePosition(r.results,a)),0===r.results.length&&C(h.formatNoMatches,"formatNoMatches"))return o("<li class='select2-no-results'>"+R(h.formatNoMatches,h.element,c.val())+"</li>"),void(this.showSearch&&this.showSearch(c.val()));u.empty(),d.opts.populateResults.call(this,u,r.results,{term:c.val(),page:this.resultsPage,context:null}),r.more===!0&&C(h.formatLoadMore,"formatLoadMore")&&(u.append("<li class='select2-more-results'>"+h.escapeMarkup(R(h.formatLoadMore,h.element,this.resultsPage))+"</li>"),window.setTimeout(function(){d.loadMoreIfNeeded()},10)),this.postprocessResults(r,i),n(),this.opts.element.trigger({type:"select2-loaded",items:r})}})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){p(this.search)},selectHighlighted:function(t){if(this._touchMoved)return void this.clearTouchMoved();var e=this.highlight(),i=this.results.find(".select2-highlighted"),n=i.closest(".select2-result").data("select2-data");n?(this.highlight(e),this.onSelect(n,t)):t&&t.noFocus&&this.close()},getPlaceholder:function(){var t;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((t=this.getPlaceholderOption())!==e?t.text():e)},getPlaceholderOption:function(){if(this.select){var i=this.select.children("option").first();if(this.opts.placeholderOption!==e)return"first"===this.opts.placeholderOption&&i||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===t.trim(i.text())&&""===i.val())return i}},initContainerWidth:function(){function e(){var e,i,n,o,r,s;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(e=this.opts.element.attr("style"),"string"==typeof e)for(i=e.split(";"),o=0,r=i.length;o<r;o+=1)if(s=i[o].replace(/\s/g,""),n=s.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==n&&n.length>=1)return n[1];return"resolve"===this.opts.width?(e=this.opts.element.css("width"),e.indexOf("%")>0?e:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return t.isFunction(this.opts.width)?this.opts.width():this.opts.width}var i=e.call(this);null!==i&&this.container.css("width",i)}}),A=P(G,{createContainer:function(){var e=t(document.createElement("div")).attr({class:"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""));return e},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var e,i,n;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.opts.shouldFocusInput(this)&&(this.search.focus(),e=this.search.get(0),e.createTextRange?(i=e.createTextRange(),i.collapse(!1),i.select()):e.setSelectionRange&&(n=this.search.val().length,e.setSelectionRange(n,n))),this.prefillNextSearchTerm(),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(t.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){t("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),S.call(this,"selection","focusser")},initContainer:function(){var e,n,o=this.container,r=this.dropdown,s=O();this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=e=o.find(".select2-choice"),this.focusser=o.find(".select2-focusser"),e.find(".select2-chosen").attr("id","select2-chosen-"+s),this.focusser.attr("aria-labelledby","select2-chosen-"+s),this.results.attr("id","select2-results-"+s),this.search.attr("aria-owns","select2-results-"+s),this.focusser.attr("id","s2id_autogen"+s),n=t("label[for='"+this.opts.element.attr("id")+"']"),this.opts.element.on("focus.select2",this.bind(function(){this.focus()})),this.focusser.prev().text(n.text()).attr("for",this.focusser.attr("id"));var a=this.opts.element.attr("title");this.opts.element.attr("title",a||n.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text(t("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind(function(t){if(this.isInterfaceEnabled()&&229!=t.keyCode){if(t.which===$.PAGE_UP||t.which===$.PAGE_DOWN)return void g(t);switch(t.which){case $.UP:case $.DOWN:return this.moveHighlight(t.which===$.UP?-1:1),void g(t);case $.ENTER:return this.selectHighlighted(),void g(t);case $.TAB:return void this.selectHighlighted({noFocus:!0});case $.ESC:return this.cancel(t),void g(t)}}})),this.search.on("blur",this.bind(function(t){document.activeElement===this.body.get(0)&&window.setTimeout(this.bind(function(){this.opened()&&this.results&&this.results.length>1&&this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(t){if(this.isInterfaceEnabled()&&t.which!==$.TAB&&!$.isControl(t)&&!$.isFunctionKey(t)&&t.which!==$.ESC){if(this.opts.openOnEnter===!1&&t.which===$.ENTER)return void g(t);if(t.which==$.DOWN||t.which==$.UP||t.which==$.ENTER&&this.opts.openOnEnter){if(t.altKey||t.ctrlKey||t.shiftKey||t.metaKey)return;return this.open(),void g(t)}return t.which==$.DELETE||t.which==$.BACKSPACE?(this.opts.allowClear&&this.clear(),void g(t)):void 0}})),c(this.focusser),this.focusser.on("keyup-change input",this.bind(function(t){if(this.opts.minimumResultsForSearch>=0){if(t.stopPropagation(),this.opened())return;this.open()}})),e.on("mousedown touchstart","abbr",this.bind(function(t){this.isInterfaceEnabled()&&(this.clear(),m(t),this.close(),this.selection&&this.selection.focus())})),e.on("mousedown touchstart",this.bind(function(n){i(e),this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),g(n)})),r.on("mousedown touchstart",this.bind(function(){this.opts.shouldFocusInput(this)&&this.search.focus()})),e.on("focus",this.bind(function(t){g(t)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(t.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.hide(),this.setPlaceholder()},clear:function(e){var i=this.selection.data("select2-data");if(i){var n=t.Event("select2-clearing");if(this.opts.element.trigger(n),n.isDefaultPrevented())return;var o=this.getPlaceholderOption();this.opts.element.val(o?o.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),e!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(i),choice:i}),this.triggerChange({removed:i}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var t=this;this.opts.initSelection.call(null,this.opts.element,function(i){i!==e&&null!==i&&(t.updateSelection(i),t.close(),t.setPlaceholder(),t.lastSearchTerm=t.search.val())})}},isPlaceholderOptionSelected:function(){var t;return this.getPlaceholder()!==e&&((t=this.getPlaceholderOption())!==e&&t.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===e||null===this.opts.element.val())},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments),i=this;return"select"===e.element.get(0).tagName.toLowerCase()?e.initSelection=function(t,e){var n=t.find("option").filter(function(){return this.selected&&!this.disabled});e(i.optionToData(n))}:"data"in e&&(e.initSelection=e.initSelection||function(i,n){var o=i.val(),r=null;e.query({matcher:function(t,i,n){var a=s(o,e.id(n));return a&&(r=n),a},callback:t.isFunction(n)?function(){n(r)}:t.noop})}),e},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===e?e:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var t=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&t!==e){if(this.select&&this.getPlaceholderOption()===e)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(t)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(t,e,i){var n=0,o=this;if(this.findHighlightableChoices().each2(function(t,e){if(s(o.id(e.data("select2-data")),o.opts.element.val()))return n=t,!1}),i!==!1&&(e===!0&&n>=0?this.highlight(n):this.highlight(0)),e===!0){var r=this.opts.minimumResultsForSearch;r>=0&&this.showSearch(T(t.results)>=r)}},showSearch:function(e){this.showSearchInput!==e&&(this.showSearchInput=e,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!e),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!e),t(this.dropdown,this.container).toggleClass("select2-with-searchbox",e))},onSelect:function(t,e){if(this.triggerSelect(t)){var i=this.opts.element.val(),n=this.data();this.opts.element.val(this.id(t)),this.updateSelection(t),this.opts.element.trigger({type:"select2-selected",val:this.id(t),choice:t}),this.lastSearchTerm=this.search.val(),this.close(),e&&e.noFocus||!this.opts.shouldFocusInput(this)||this.focusser.focus(),s(i,this.id(t))||this.triggerChange({added:t,removed:n})}},updateSelection:function(t){var i,n,o=this.selection.find(".select2-chosen");this.selection.data("select2-data",t),o.empty(),null!==t&&(i=this.opts.formatSelection(t,o,this.opts.escapeMarkup)),i!==e&&o.append(i),n=this.opts.formatSelectionCssClass(t,o),n!==e&&o.addClass(n),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==e&&this.container.addClass("select2-allowclear")},val:function(){var t,i=!1,n=null,o=this,r=this.data();if(0===arguments.length)return this.opts.element.val();if(t=arguments[0],arguments.length>1&&(i=arguments[1],this.opts.debug&&console&&console.warn&&console.warn('Select2: The second option to `select2("val")` is not supported in Select2 4.0.0. The `change` event will always be triggered in 4.0.0.')),this.select)this.opts.debug&&console&&console.warn&&console.warn('Select2: Setting the value on a <select> using `select2("val")` is no longer supported in 4.0.0. You can use the `.val(newValue).trigger("change")` method provided by jQuery instead.'),this.select.val(t).find("option").filter(function(){return this.selected}).each2(function(t,e){return n=o.optionToData(e),!1}),this.updateSelection(n),this.setPlaceholder(),i&&this.triggerChange({added:n,removed:r});else{if(!t&&0!==t)return void this.clear(i);if(this.opts.initSelection===e)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(t),this.opts.initSelection(this.opts.element,function(t){o.opts.element.val(t?o.id(t):""),o.updateSelection(t),o.setPlaceholder(),i&&o.triggerChange({added:t,removed:r})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(t){var i,n=!1;return 0===arguments.length?(i=this.selection.data("select2-data"),i==e&&(i=null),i):(this.opts.debug&&console&&console.warn&&console.warn('Select2: The `select2("data")` method can no longer set selected values in 4.0.0, consider using the `.val()` method instead.'),arguments.length>1&&(n=arguments[1]),t?(i=this.data(),this.opts.element.val(t?this.id(t):""),this.updateSelection(t),n&&this.triggerChange({added:t,removed:i})):this.clear(n),void 0)}}),M=P(G,{createContainer:function(){var e=t(document.createElement("div")).attr({class:"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return e},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments),i=this;return"select"===e.element.get(0).tagName.toLowerCase()?e.initSelection=function(t,e){var n=[];t.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(t,e){n.push(i.optionToData(e))}),e(n)}:"data"in e&&(e.initSelection=e.initSelection||function(i,n){var o=a(i.val(),e.separator,e.transformVal),r=[];e.query({matcher:function(i,n,a){var l=t.grep(o,function(t){return s(t,e.id(a))}).length;return l&&r.push(a),l},callback:t.isFunction(n)?function(){for(var t=[],i=0;i<o.length;i++)for(var a=o[i],l=0;l<r.length;l++){var c=r[l];if(s(a,e.id(c))){t.push(c),r.splice(l,1);break}}n(t)}:t.noop})}),e},selectChoice:function(t){var e=this.container.find(".select2-search-choice-focus");e.length&&t&&t[0]==e[0]||(e.length&&this.opts.element.trigger("choice-deselected",e),e.removeClass("select2-search-choice-focus"),t&&t.length&&(this.close(),t.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",t)))},destroy:function(){t("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),S.call(this,"searchContainer","selection")},initContainer:function(){var e,i=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=e=this.container.find(i);var n=this;this.selection.on("click",".select2-container:not(.select2-container-disabled) .select2-search-choice:not(.select2-locked)",function(e){n.search[0].focus(),n.selectChoice(t(this))}),this.search.attr("id","s2id_autogen"+O()),this.search.prev().text(t("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.opts.element.on("focus.select2",this.bind(function(){this.focus()})),this.search.on("input paste",this.bind(function(){this.search.attr("placeholder")&&0==this.search.val().length||this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(t){if(this.isInterfaceEnabled()){++this.keydowns;var i=e.find(".select2-search-choice-focus"),n=i.prev(".select2-search-choice:not(.select2-locked)"),o=i.next(".select2-search-choice:not(.select2-locked)"),r=f(this.search);if(i.length&&(t.which==$.LEFT||t.which==$.RIGHT||t.which==$.BACKSPACE||t.which==$.DELETE||t.which==$.ENTER)){var s=i;return t.which==$.LEFT&&n.length?s=n:t.which==$.RIGHT?s=o.length?o:null:t.which===$.BACKSPACE?this.unselect(i.first())&&(this.search.width(10),s=n.length?n:o):t.which==$.DELETE?this.unselect(i.first())&&(this.search.width(10),s=o.length?o:null):t.which==$.ENTER&&(s=null),this.selectChoice(s),g(t),void(s&&s.length||this.open());
}if((t.which===$.BACKSPACE&&1==this.keydowns||t.which==$.LEFT)&&0==r.offset&&!r.length)return this.selectChoice(e.find(".select2-search-choice:not(.select2-locked)").last()),void g(t);if(this.selectChoice(null),this.opened())switch(t.which){case $.UP:case $.DOWN:return this.moveHighlight(t.which===$.UP?-1:1),void g(t);case $.ENTER:return this.selectHighlighted(),void g(t);case $.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case $.ESC:return this.cancel(t),void g(t)}if(t.which!==$.TAB&&!$.isControl(t)&&!$.isFunctionKey(t)&&t.which!==$.BACKSPACE&&t.which!==$.ESC){if(t.which===$.ENTER){if(this.opts.openOnEnter===!1)return;if(t.altKey||t.ctrlKey||t.shiftKey||t.metaKey)return}this.open(),t.which!==$.PAGE_UP&&t.which!==$.PAGE_DOWN||g(t),t.which===$.ENTER&&g(t)}}})),this.search.on("keyup",this.bind(function(t){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),e.stopImmediatePropagation(),this.opts.element.trigger(t.Event("select2-blur"))})),this.container.on("click",i,this.bind(function(e){this.isInterfaceEnabled()&&(t(e.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.open(),this.focusSearch(),e.preventDefault()))})),this.container.on("focus",i,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.hide(),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var t=this;this.opts.initSelection.call(null,this.opts.element,function(i){i!==e&&null!==i&&(t.updateSelection(i),t.close(),t.clearSearch())})}},clearSearch:function(){var t=this.getPlaceholder(),i=this.getMaxSearchWidth();t!==e&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(t).addClass("select2-default"),this.search.width(i>0?i:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.prefillNextSearchTerm(),this.updateResults(!0),this.opts.shouldFocusInput(this)&&this.search.focus(),this.opts.element.trigger(t.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(e){var i={},n=[],o=this;t(e).each(function(){o.id(this)in i||(i[o.id(this)]=0,n.push(this))}),this.selection.find(".select2-search-choice").remove(),this.addSelectedChoice(n),o.postprocessResults()},tokenize:function(){var t=this.search.val();t=this.opts.tokenizer.call(this,t,this.data(),this.bind(this.onSelect),this.opts),null!=t&&t!=e&&(this.search.val(t),t.length>0&&this.open())},onSelect:function(t,e){this.triggerSelect(t)&&""!==t.text&&(this.addSelectedChoice(t),this.opts.element.trigger({type:"selected",val:this.id(t),choice:t}),this.lastSearchTerm=this.search.val(),this.clearSearch(),this.updateResults(),!this.select&&this.opts.closeOnSelect||this.postprocessResults(t,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.prefillNextSearchTerm()&&this.updateResults(),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:t}),e&&e.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(e){var i=this.getVal(),n=this;t(e).each(function(){i.push(n.createChoice(this))}),this.setVal(i)},createChoice:function(i){var n,o,r=!i.locked,s=t("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),a=t("<li class='select2-search-choice select2-locked'><div></div></li>"),l=r?s:a,c=this.id(i);return n=this.opts.formatSelection(i,l.find("div"),this.opts.escapeMarkup),n!=e&&l.find("div").replaceWith(t("<div></div>").html(n)),o=this.opts.formatSelectionCssClass(i,l.find("div")),o!=e&&l.addClass(o),r&&l.find(".select2-search-choice-close").on("mousedown",g).on("click dblclick",this.bind(function(e){this.isInterfaceEnabled()&&(this.unselect(t(e.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),g(e),this.close(),this.focusSearch())})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),l.data("select2-data",i),l.insertBefore(this.searchContainer),c},unselect:function(e){var i,n,r=this.getVal();if(e=e.closest(".select2-search-choice"),0===e.length)throw"Invalid argument: "+e+". Must be .select2-search-choice";if(i=e.data("select2-data")){var s=t.Event("select2-removing");if(s.val=this.id(i),s.choice=i,this.opts.element.trigger(s),s.isDefaultPrevented())return!1;for(;(n=o(this.id(i),r))>=0;)r.splice(n,1),this.setVal(r),this.select&&this.postprocessResults();return e.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(i),choice:i}),this.triggerChange({removed:i}),!0}},postprocessResults:function(t,e,i){var n=this.getVal(),r=this.results.find(".select2-result"),s=this.results.find(".select2-result-with-children"),a=this;r.each2(function(t,e){var i=a.id(e.data("select2-data"));o(i,n)>=0&&(e.addClass("select2-selected"),e.find(".select2-result-selectable").addClass("select2-selected"))}),s.each2(function(t,e){e.is(".select2-result-selectable")||0!==e.find(".select2-result-selectable:not(.select2-selected)").length||e.addClass("select2-selected")}),this.highlight()==-1&&i!==!1&&this.opts.closeOnSelect===!0&&a.highlight(0),!this.opts.createSearchChoice&&!r.filter(".select2-result:not(.select2-selected)").length>0&&(!t||t&&!t.more&&0===this.results.find(".select2-no-results").length)&&C(a.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+R(a.opts.formatNoMatches,a.opts.element,a.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-l(this.search)},resizeSearch:function(){var t,e,i,n,o,r=l(this.search);t=v(this.search)+10,e=this.search.offset().left,i=this.selection.width(),n=this.selection.offset().left,o=i-(e-n)-r,o<t&&(o=i-r),o<40&&(o=i-r),o<=0&&(o=t),this.search.width(Math.floor(o))},getVal:function(){var t;return this.select?(t=this.select.val(),null===t?[]:t):(t=this.opts.element.val(),a(t,this.opts.separator,this.opts.transformVal))},setVal:function(e){if(this.select)this.select.val(e);else{var i=[],n={};t(e).each(function(){this in n||(i.push(this),n[this]=0)}),this.opts.element.val(0===i.length?"":i.join(this.opts.separator))}},buildChangeDetails:function(t,e){for(var e=e.slice(0),t=t.slice(0),i=0;i<e.length;i++)for(var n=0;n<t.length;n++)if(s(this.opts.id(e[i]),this.opts.id(t[n]))){e.splice(i,1),i--,t.splice(n,1);break}return{added:e,removed:t}},val:function(i,n){var o,r=this;if(0===arguments.length)return this.getVal();if(o=this.data(),o.length||(o=[]),!i&&0!==i)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(n&&this.triggerChange({added:this.data(),removed:o}));if(this.setVal(i),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),n&&this.triggerChange(this.buildChangeDetails(o,this.data()));else{if(this.opts.initSelection===e)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(e){var i=t.map(e,r.id);r.setVal(i),r.updateSelection(e),r.clearSearch(),n&&r.triggerChange(r.buildChangeDetails(o,r.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var e=[],i=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){e.push(i.opts.id(t(this).data("select2-data")))}),this.setVal(e),this.triggerChange()},data:function(e,i){var n,o,r=this;return 0===arguments.length?this.selection.children(".select2-search-choice").map(function(){return t(this).data("select2-data")}).get():(o=this.data(),e||(e=[]),n=t.map(e,function(t){return r.opts.id(t)}),this.setVal(n),this.updateSelection(e),this.clearSearch(),i&&this.triggerChange(this.buildChangeDetails(o,this.data())),void 0)}}),t.fn.select2=function(){var i,n,r,s,a,l=Array.prototype.slice.call(arguments,0),c=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],u=["opened","isFocused","container","dropdown"],h=["val","data"],d={search:"externalSearch"};return this.each(function(){if(0===l.length||"object"==typeof l[0])i=0===l.length?{}:t.extend({},l[0]),i.element=t(this),"select"===i.element.get(0).tagName.toLowerCase()?a=i.element.prop("multiple"):(a=i.multiple||!1,"tags"in i&&(i.multiple=a=!0)),n=a?new window.Select2.class.multi:new window.Select2.class.single,n.init(i);else{if("string"!=typeof l[0])throw"Invalid arguments to select2 plugin: "+l;if(o(l[0],c)<0)throw"Unknown method: "+l[0];if(s=e,n=t(this).data("select2"),n===e)return;if(r=l[0],"container"===r?s=n.container:"dropdown"===r?s=n.dropdown:(d[r]&&(r=d[r]),s=n[r].apply(n,l.slice(1))),o(l[0],u)>=0||o(l[0],h)>=0&&1==l.length)return!1}}),s===e?this:s},t.fn.select2.defaults={debug:!1,width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(t,e,i,n){var o=[];return _(this.text(t),i.term,o,n),o.join("")},transformVal:function(e){return t.trim(e)},formatSelection:function(t,i,n){return t?n(this.text(t)):e},sortResults:function(t,e,i){return t},formatResultCssClass:function(t){return t.css},formatSelectionCssClass:function(t,i){return e},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(t){return t==e?null:t.id},text:function(e){return e&&this.data&&this.data.text?t.isFunction(this.data.text)?this.data.text(e):e[this.data.text]:e.text},matcher:function(t,e){return n(""+e).toUpperCase().indexOf(n(""+t).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:x,escapeMarkup:w,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(t){return t},adaptDropdownCssClass:function(t){return null},nextSearchTerm:function(t,i){return e},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(t){var e="ontouchstart"in window||navigator.msMaxTouchPoints>0;return!e||!(t.opts.minimumResultsForSearch<0)}},t.fn.select2.locales=[],t.fn.select2.locales.en={formatMatches:function(t){return 1===t?"One result is available, press enter to select it.":t+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatAjaxError:function(t,e,i){return"Loading failed"},formatInputTooShort:function(t,e){var i=e-t.length;return"Please enter "+i+" or more character"+(1==i?"":"s")},formatInputTooLong:function(t,e){var i=t.length-e;return"Please delete "+i+" character"+(1==i?"":"s")},formatSelectionTooBig:function(t){return"You can only select "+t+" item"+(1==t?"":"s")},formatLoadMore:function(t){return"Loading more results"},formatSearching:function(){return"Searching"}},t.extend(t.fn.select2.defaults,t.fn.select2.locales.en),t.fn.select2.ajaxDefaults={transport:t.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:b,local:k,tags:D},util:{debounce:h,markMatch:_,escapeMarkup:w,stripDiacritics:n},class:{abstract:G,single:A,multi:M}}}}(jQuery),function(t){function e(t,n){if(t=t?t:"",n=n||{},t instanceof e)return t;if(!(this instanceof e))return new e(t,n);var o=i(t);this._originalInput=t,this._r=o.r,this._g=o.g,this._b=o.b,this._a=o.a,this._roundA=j(100*this._a)/100,this._format=n.format||o.format,this._gradientType=n.gradientType,this._r<1&&(this._r=j(this._r)),this._g<1&&(this._g=j(this._g)),this._b<1&&(this._b=j(this._b)),this._ok=o.ok,this._tc_id=I++}function i(t){var e={r:0,g:0,b:0},i=1,o=null,s=null,l=null,c=!1,u=!1;return"string"==typeof t&&(t=E(t)),"object"==typeof t&&(F(t.r)&&F(t.g)&&F(t.b)?(e=n(t.r,t.g,t.b),c=!0,u="%"===String(t.r).substr(-1)?"prgb":"rgb"):F(t.h)&&F(t.s)&&F(t.v)?(o=A(t.s),s=A(t.v),e=a(t.h,o,s),c=!0,u="hsv"):F(t.h)&&F(t.s)&&F(t.l)&&(o=A(t.s),l=A(t.l),e=r(t.h,o,l),c=!0,u="hsl"),t.hasOwnProperty("a")&&(i=t.a)),i=C(i),{ok:c,format:t.format||u,r:N(255,U(e.r,0)),g:N(255,U(e.g,0)),b:N(255,U(e.b,0)),a:i}}function n(t,e,i){return{r:255*R(t,255),g:255*R(e,255),b:255*R(i,255)}}function o(t,e,i){t=R(t,255),e=R(e,255),i=R(i,255);var n,o,r=U(t,e,i),s=N(t,e,i),a=(r+s)/2;if(r==s)n=o=0;else{var l=r-s;switch(o=a>.5?l/(2-r-s):l/(r+s),r){case t:n=(e-i)/l+(e<i?6:0);break;case e:n=(i-t)/l+2;break;case i:n=(t-e)/l+4}n/=6}return{h:n,s:o,l:a}}function r(t,e,i){function n(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}var o,r,s;if(t=R(t,360),e=R(e,100),i=R(i,100),0===e)o=r=s=i;else{var a=i<.5?i*(1+e):i+e-i*e,l=2*i-a;o=n(l,a,t+1/3),r=n(l,a,t),s=n(l,a,t-1/3)}return{r:255*o,g:255*r,b:255*s}}function s(t,e,i){t=R(t,255),e=R(e,255),i=R(i,255);var n,o,r=U(t,e,i),s=N(t,e,i),a=r,l=r-s;if(o=0===r?0:l/r,r==s)n=0;else{switch(r){case t:n=(e-i)/l+(e<i?6:0);break;case e:n=(i-t)/l+2;break;case i:n=(t-e)/l+4}n/=6}return{h:n,s:o,v:a}}function a(e,i,n){e=6*R(e,360),i=R(i,100),n=R(n,100);var o=t.floor(e),r=e-o,s=n*(1-i),a=n*(1-r*i),l=n*(1-(1-r)*i),c=o%6,u=[n,a,s,s,l,n][c],h=[l,n,n,a,s,s][c],d=[s,s,l,n,n,a][c];return{r:255*u,g:255*h,b:255*d}}function l(t,e,i,n){var o=[G(j(t).toString(16)),G(j(e).toString(16)),G(j(i).toString(16))];return n&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function c(t,e,i,n){var o=[G(M(n)),G(j(t).toString(16)),G(j(e).toString(16)),G(j(i).toString(16))];return o.join("")}function u(t,i){i=0===i?0:i||10;var n=e(t).toHsl();return n.s-=i/100,n.s=T(n.s),e(n)}function h(t,i){i=0===i?0:i||10;var n=e(t).toHsl();return n.s+=i/100,n.s=T(n.s),e(n)}function d(t){return e(t).desaturate(100)}function p(t,i){i=0===i?0:i||10;var n=e(t).toHsl();return n.l+=i/100,n.l=T(n.l),e(n)}function f(t,i){i=0===i?0:i||10;var n=e(t).toRgb();return n.r=U(0,N(255,n.r-j(255*-(i/100)))),n.g=U(0,N(255,n.g-j(255*-(i/100)))),n.b=U(0,N(255,n.b-j(255*-(i/100)))),e(n)}function g(t,i){i=0===i?0:i||10;var n=e(t).toHsl();return n.l-=i/100,n.l=T(n.l),e(n)}function m(t,i){var n=e(t).toHsl(),o=(n.h+i)%360;return n.h=o<0?360+o:o,e(n)}function v(t){var i=e(t).toHsl();return i.h=(i.h+180)%360,e(i)}function y(t){var i=e(t).toHsl(),n=i.h;return[e(t),e({h:(n+120)%360,s:i.s,l:i.l}),e({h:(n+240)%360,s:i.s,l:i.l})]}function _(t){var i=e(t).toHsl(),n=i.h;return[e(t),e({h:(n+90)%360,s:i.s,l:i.l}),e({h:(n+180)%360,s:i.s,l:i.l}),e({h:(n+270)%360,s:i.s,l:i.l})]}function w(t){var i=e(t).toHsl(),n=i.h;return[e(t),e({h:(n+72)%360,s:i.s,l:i.l}),e({h:(n+216)%360,s:i.s,l:i.l})]}function b(t,i,n){i=i||6,n=n||30;var o=e(t).toHsl(),r=360/n,s=[e(t)];for(o.h=(o.h-(r*i>>1)+720)%360;--i;)o.h=(o.h+r)%360,s.push(e(o));return s}function k(t,i){i=i||6;for(var n=e(t).toHsv(),o=n.h,r=n.s,s=n.v,a=[],l=1/i;i--;)a.push(e({h:o,s:r,v:s})),s=(s+l)%1;return a}function D(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[t[i]]=i);return e}function C(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function R(e,i){S(e)&&(e="100%");var n=P(e);return e=N(i,U(0,parseFloat(e))),n&&(e=parseInt(e*i,10)/100),t.abs(e-i)<1e-6?1:e%i/parseFloat(i)}function T(t){return N(1,U(0,t))}function x(t){return parseInt(t,16)}function S(t){return"string"==typeof t&&t.indexOf(".")!=-1&&1===parseFloat(t)}function P(t){return"string"==typeof t&&t.indexOf("%")!=-1}function G(t){return 1==t.length?"0"+t:""+t}function A(t){return t<=1&&(t=100*t+"%"),t}function M(e){return t.round(255*parseFloat(e)).toString(16)}function O(t){return x(t)/255}function F(t){return!!H.CSS_UNIT.exec(t)}function E(t){t=t.replace(B,"").replace($,"").toLowerCase();var e=!1;if(z[t])t=z[t],e=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};var i;return(i=H.rgb.exec(t))?{r:i[1],g:i[2],b:i[3]}:(i=H.rgba.exec(t))?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=H.hsl.exec(t))?{h:i[1],s:i[2],l:i[3]}:(i=H.hsla.exec(t))?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=H.hsv.exec(t))?{h:i[1],s:i[2],v:i[3]}:(i=H.hsva.exec(t))?{h:i[1],s:i[2],v:i[3],a:i[4]}:(i=H.hex8.exec(t))?{a:O(i[1]),r:x(i[2]),g:x(i[3]),b:x(i[4]),format:e?"name":"hex8"}:(i=H.hex6.exec(t))?{r:x(i[1]),g:x(i[2]),b:x(i[3]),format:e?"name":"hex"}:!!(i=H.hex3.exec(t))&&{r:x(i[1]+""+i[1]),g:x(i[2]+""+i[2]),b:x(i[3]+""+i[3]),format:e?"name":"hex"}}function V(t){var e,i;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),i=(t.size||"small").toLowerCase(),"AA"!==e&&"AAA"!==e&&(e="AA"),"small"!==i&&"large"!==i&&(i="small"),{level:e,size:i}}var B=/^\s+/,$=/\s+$/,I=0,j=t.round,N=t.min,U=t.max,L=t.random;e.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var e,i,n,o,r,s,a=this.toRgb();return e=a.r/255,i=a.g/255,n=a.b/255,o=e<=.03928?e/12.92:t.pow((e+.055)/1.055,2.4),r=i<=.03928?i/12.92:t.pow((i+.055)/1.055,2.4),s=n<=.03928?n/12.92:t.pow((n+.055)/1.055,2.4),.2126*o+.7152*r+.0722*s},setAlpha:function(t){return this._a=C(t),this._roundA=j(100*this._a)/100,this},toHsv:function(){var t=s(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=s(this._r,this._g,this._b),e=j(360*t.h),i=j(100*t.s),n=j(100*t.v);return 1==this._a?"hsv("+e+", "+i+"%, "+n+"%)":"hsva("+e+", "+i+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var t=o(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=o(this._r,this._g,this._b),e=j(360*t.h),i=j(100*t.s),n=j(100*t.l);return 1==this._a?"hsl("+e+", "+i+"%, "+n+"%)":"hsla("+e+", "+i+"%, "+n+"%, "+this._roundA+")"},toHex:function(t){return l(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return c(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:j(this._r),g:j(this._g),b:j(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+j(this._r)+", "+j(this._g)+", "+j(this._b)+")":"rgba("+j(this._r)+", "+j(this._g)+", "+j(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:j(100*R(this._r,255))+"%",g:j(100*R(this._g,255))+"%",b:j(100*R(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+j(100*R(this._r,255))+"%, "+j(100*R(this._g,255))+"%, "+j(100*R(this._b,255))+"%)":"rgba("+j(100*R(this._r,255))+"%, "+j(100*R(this._g,255))+"%, "+j(100*R(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(W[l(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var i="#"+c(this._r,this._g,this._b,this._a),n=i,o=this._gradientType?"GradientType = 1, ":"";if(t){var r=e(t);n=r.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+o+"startColorstr="+i+",endColorstr="+n+")"},toString:function(t){var e=!!t;t=t||this._format;var i=!1,n=this._a<1&&this._a>=0,o=!e&&n&&("hex"===t||"hex6"===t||"hex3"===t||"name"===t);return o?"name"===t&&0===this._a?this.toName():this.toRgbString():("rgb"===t&&(i=this.toRgbString()),"prgb"===t&&(i=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(i=this.toHexString()),"hex3"===t&&(i=this.toHexString(!0)),"hex8"===t&&(i=this.toHex8String()),"name"===t&&(i=this.toName()),"hsl"===t&&(i=this.toHslString()),"hsv"===t&&(i=this.toHsvString()),i||this.toHexString())},clone:function(){return e(this.toString())},_applyModification:function(t,e){var i=t.apply(null,[this].concat([].slice.call(e)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(p,arguments)},brighten:function(){return this._applyModification(f,arguments)},darken:function(){return this._applyModification(g,arguments)},desaturate:function(){return this._applyModification(u,arguments)},saturate:function(){return this._applyModification(h,arguments)},greyscale:function(){return this._applyModification(d,arguments)},spin:function(){return this._applyModification(m,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(b,arguments)},complement:function(){return this._applyCombination(v,arguments)},monochromatic:function(){return this._applyCombination(k,arguments)},splitcomplement:function(){return this._applyCombination(w,arguments)},triad:function(){return this._applyCombination(y,arguments)},tetrad:function(){return this._applyCombination(_,arguments)}},e.fromRatio=function(t,i){if("object"==typeof t){var n={};for(var o in t)t.hasOwnProperty(o)&&("a"===o?n[o]=t[o]:n[o]=A(t[o]));t=n}return e(t,i)},e.equals=function(t,i){return!(!t||!i)&&e(t).toRgbString()==e(i).toRgbString()},e.random=function(){return e.fromRatio({r:L(),g:L(),b:L()})},e.mix=function(t,i,n){n=0===n?0:n||50;var o=e(t).toRgb(),r=e(i).toRgb(),s=n/100,a={r:(r.r-o.r)*s+o.r,g:(r.g-o.g)*s+o.g,b:(r.b-o.b)*s+o.b,a:(r.a-o.a)*s+o.a};return e(a)},e.readability=function(i,n){var o=e(i),r=e(n);return(t.max(o.getLuminance(),r.getLuminance())+.05)/(t.min(o.getLuminance(),r.getLuminance())+.05)},e.isReadable=function(t,i,n){var o,r,s=e.readability(t,i);switch(r=!1,o=V(n),o.level+o.size){case"AAsmall":case"AAAlarge":r=s>=4.5;break;case"AAlarge":r=s>=3;break;case"AAAsmall":r=s>=7}return r},e.mostReadable=function(t,i,n){var o,r,s,a,l=null,c=0;n=n||{},r=n.includeFallbackColors,s=n.level,a=n.size;for(var u=0;u<i.length;u++)o=e.readability(t,i[u]),o>c&&(c=o,l=e(i[u]));return e.isReadable(t,l,{level:s,size:a})||!r?l:(n.includeFallbackColors=!1,e.mostReadable(t,["#fff","#000"],n))};var z=e.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},W=e.hexNames=D(z),H=function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",i="(?:"+e+")|(?:"+t+")",n="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?",o="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?";return{CSS_UNIT:new RegExp(i),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+o),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+o),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+o),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();"undefined"!=typeof module&&module.exports?module.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):window.tinycolor=e}(Math),function(t){var e,i;!function(){var t={},n={};e=function(e,i,n){t[e]={deps:i,callback:n}},e.registry=t,i=function(e){if(n[e])return n[e];if(n[e]={},!t[e])throw new Error("Could not find module "+e);for(var o,r=t[e],s=r.deps,a=r.callback,l=[],c=0,u=s.length;c<u;c++)"exports"===s[c]?l.push(o={}):l.push(i(s[c]));var h=a.apply(this,l);return n[e]=o||h}}(),e("backburner/deferred_action_queues",["backburner/queue","exports"],function(t,e){"use strict";function i(t,e){var i=this.queues={};this.queueNames=t=t||[];for(var n,r=0,s=t.length;r<s;r++)n=t[r],i[n]=new o(this,n,e[n])}function n(t,e){for(var i,n,o=0,r=e;o<=r;o++)if(i=t.queueNames[o],n=t.queues[i],n._queue.length)return o;return-1}var o=t.Queue;i.prototype={queueNames:null,queues:null,schedule:function(t,e,i,n,o,r){var s=this.queues,a=s[t];if(!a)throw new Error("You attempted to schedule an action in a queue ("+t+") that doesn't exist");return o?a.pushUnique(e,i,n,r):a.push(e,i,n,r)},flush:function(){for(var t,e,i,o,r=this.queues,s=this.queueNames,a=0,l=s.length;a<l;){t=s[a],e=r[t],i=e._queueBeingFlushed=e._queue.slice(),e._queue=[];var c,u,h,d,p=e.options,f=p&&p.before,g=p&&p.after,m=0,v=i.length;for(v&&f&&f();m<v;)c=i[m],u=i[m+1],h=i[m+2],d=i[m+3],"string"==typeof u&&(u=c[u]),u&&(h&&h.length>0?u.apply(c,h):u.call(c)),m+=4;e._queueBeingFlushed=null,v&&g&&g(),(o=n(this,a))===-1?a++:a=o}}},e.DeferredActionQueues=i}),e("backburner/queue",["exports"],function(t){"use strict";function e(t,e,i){this.daq=t,this.name=e,this.options=i,this._queue=[]}e.prototype={daq:null,name:null,options:null,_queue:null,push:function(t,e,i,n){var o=this._queue;return o.push(t,e,i,n),{queue:this,target:t,method:e}},pushUnique:function(t,e,i,n){var o,r,s,a,l=this._queue;for(s=0,a=l.length;s<a;s+=4)if(o=l[s],r=l[s+1],o===t&&r===e)return l[s+2]=i,l[s+3]=n,{queue:this,target:t,method:e};return this._queue.push(t,e,i,n),{queue:this,target:t,method:e}},flush:function(){var t,e,i,n,o,r=this._queue,s=this.options,a=s&&s.before,l=s&&s.after,c=r.length;for(c&&a&&a(),o=0;o<c;o+=4)t=r[o],e=r[o+1],i=r[o+2],n=r[o+3],i&&i.length>0?e.apply(t,i):e.call(t);c&&l&&l(),r.length>c?(this._queue=r.slice(c),this.flush()):this._queue.length=0},cancel:function(t){var e,i,n,o,r=this._queue;for(n=0,o=r.length;n<o;n+=4)if(e=r[n],i=r[n+1],e===t.target&&i===t.method)return r.splice(n,4),!0;if(r=this._queueBeingFlushed)for(n=0,o=r.length;n<o;n+=4)if(e=r[n],i=r[n+1],e===t.target&&i===t.method)return r[n+1]=null,!0}},t.Queue=e}),e("backburner",["backburner/deferred_action_queues","exports"],function(t,e){"use strict";function i(t){return"number"==typeof t||w.test(t)}function n(t,e){this.queueNames=t,this.options=e||{},this.options.defaultQueue||(this.options.defaultQueue=t[0]),this.instanceStack=[]}function o(t){t.begin(),u=_.setTimeout(function(){u=null,t.end()})}function r(t,e,i){(!h||e<d)&&(h&&clearTimeout(h),h=_.setTimeout(function(){h=null,d=null,s(t)},i),d=e)}function s(t){var e,i,n,o=+new Date;t.run(function(){for(i=c(o,y,0,y.length-2),e=y.splice(0,i),i=1,n=e.length;i<n;i+=2)t.schedule(t.options.defaultQueue,null,e[i])}),y.length&&r(t,y[0],y[0]-o)}function a(t,e){for(var i,n=-1,o=0,r=v.length;o<r;o++)if(i=v[o],i[0]===t&&i[1]===e){n=o;break}return n}function l(t,e){for(var i,n=-1,o=0,r=m.length;o<r;o++)if(i=m[o],i[0]===t&&i[1]===e){n=o;break}return n}function c(t,e,i,n){for(var o;i<n;)o=i+Math.floor((n-i)/4),t>=e[o]?i=o+2:n=o;return void 0!==e[i]&&t>e[i]?i+2:i}var u,h,d,p=t.DeferredActionQueues,f=[].slice,g=[].pop,m=[],v=[],y=[],_=this,w=/\d+/;n.prototype={queueNames:null,options:null,currentInstance:null,instanceStack:null,begin:function(){var t=this.options&&this.options.onBegin,e=this.currentInstance;e&&this.instanceStack.push(e),this.currentInstance=new p(this.queueNames,this.options),t&&t(this.currentInstance,e)},end:function(){var t=this.options&&this.options.onEnd,e=this.currentInstance,i=null;try{e.flush()}finally{this.currentInstance=null,this.instanceStack.length&&(i=this.instanceStack.pop(),this.currentInstance=i),t&&t(e,i)}},run:function(t,e){var i;this.begin(),e||(e=t,t=null),"string"==typeof e&&(e=t[e]);var n=!1;try{i=arguments.length>2?e.apply(t,f.call(arguments,2)):e.call(t)}finally{n||(n=!0,this.end())}return i},defer:function(t,e,i){i||(i=e,e=null),"string"==typeof i&&(i=e[i]);var n=this.DEBUG?new Error:void 0,r=arguments.length>3?f.call(arguments,3):void 0;return this.currentInstance||o(this),this.currentInstance.schedule(t,e,i,r,!1,n)},deferOnce:function(t,e,i){i||(i=e,e=null),"string"==typeof i&&(i=e[i]);var n=this.DEBUG?new Error:void 0,r=arguments.length>3?f.call(arguments,3):void 0;return this.currentInstance||o(this),this.currentInstance.schedule(t,e,i,r,!0,n)},setTimeout:function(){function t(){e.apply(o,u)}var e,n,o,s,a,l,u=f.call(arguments),h=u.length,d=this;if(0!==h){if(1===h)e=u.shift(),n=0;else if(2===h)s=u[0],a=u[1],"function"==typeof a||"function"==typeof s[a]?(o=u.shift(),e=u.shift(),n=0):i(a)?(e=u.shift(),n=u.shift()):(e=u.shift(),n=0);else{var p=u[u.length-1];n=i(p)?u.pop():0,s=u[0],l=u[1],"function"==typeof l||"string"==typeof l&&null!==s&&l in s?(o=u.shift(),
e=u.shift()):e=u.shift()}var g=+new Date+parseInt(n,10);"string"==typeof e&&(e=o[e]);var m=c(g,y,0,y.length-2);return y.splice(m,0,g,t),r(d,g,n),t}},throttle:function(t,e){var i,n,o,r,s=this,a=arguments,c=g.call(a);return"number"==typeof c||"string"==typeof c?(i=c,c=!0):i=g.call(a),i=parseInt(i,10),o=l(t,e),o>-1?m[o]:(r=_.setTimeout(function(){c||s.run.apply(s,a);var i=l(t,e);i>-1&&m.splice(i,1)},i),c&&s.run.apply(s,a),n=[t,e,r],m.push(n),n)},debounce:function(t,e){var i,n,o,r,s=this,l=arguments,c=g.call(l);return"number"==typeof c||"string"==typeof c?(i=c,c=!1):i=g.call(l),i=parseInt(i,10),n=a(t,e),n>-1&&(o=v[n],v.splice(n,1),clearTimeout(o[2])),r=_.setTimeout(function(){c||s.run.apply(s,l);var i=a(t,e);i>-1&&v.splice(i,1)},i),c&&n===-1&&s.run.apply(s,l),o=[t,e,r],v.push(o),o},cancelTimers:function(){var t,e;for(t=0,e=m.length;t<e;t++)clearTimeout(m[t][2]);for(m=[],t=0,e=v.length;t<e;t++)clearTimeout(v[t][2]);v=[],h&&(clearTimeout(h),h=null),y=[],u&&(clearTimeout(u),u=null)},hasTimers:function(){return!!y.length||u},cancel:function(t){var e=typeof t;if(t&&"object"===e&&t.queue&&t.method)return t.queue.cancel(t);if("function"!==e)return"[object Array]"===Object.prototype.toString.call(t)?this._cancelItem(l,m,t)||this._cancelItem(a,v,t):void 0;for(var i=0,n=y.length;i<n;i+=2)if(y[i+1]===t)return y.splice(i,2),!0},_cancelItem:function(t,e,i){var n,o;return!(i.length<3)&&(o=t(i[0],i[1]),o>-1&&(n=e[o],n[2]===i[2])&&(e.splice(o,1),clearTimeout(i[2]),!0))}},n.prototype.schedule=n.prototype.defer,n.prototype.scheduleOnce=n.prototype.deferOnce,n.prototype.later=n.prototype.setTimeout,e.Backburner=n}),window.backburner=i("backburner")}(window),function(){function t(t){function e(e,i,n,o,r,s){for(;r>=0&&s>r;r+=t){var a=o?o[r]:r;n=i(n,e[a],a,e)}return n}return function(i,n,o,r){n=_(n,r,4);var s=!T(i)&&y.keys(i),a=(s||i).length,l=t>0?0:a-1;return arguments.length<3&&(o=i[s?s[l]:l],l+=t),e(i,n,o,s,l,a)}}function e(t){return function(e,i,n){i=w(i,n);for(var o=R(e),r=t>0?0:o-1;r>=0&&o>r;r+=t)if(i(e[r],r,e))return r;return-1}}function i(t,e,i){return function(n,o,r){var s=0,a=R(n);if("number"==typeof r)t>0?s=r>=0?r:Math.max(r+a,s):a=r>=0?Math.min(r+1,a):r+a+1;else if(i&&r&&a)return r=i(n,o),n[r]===o?r:-1;if(o!==o)return r=e(u.call(n,s,a),y.isNaN),r>=0?r+s:-1;for(r=t>0?s:a-1;r>=0&&a>r;r+=t)if(n[r]===o)return r;return-1}}function n(t,e){var i=A.length,n=t.constructor,o=y.isFunction(n)&&n.prototype||a,r="constructor";for(y.has(t,r)&&!y.contains(e,r)&&e.push(r);i--;)r=A[i],r in t&&t[r]!==o[r]&&!y.contains(e,r)&&e.push(r)}var o=this,r=o._,s=Array.prototype,a=Object.prototype,l=Function.prototype,c=s.push,u=s.slice,h=a.toString,d=a.hasOwnProperty,p=Array.isArray,f=Object.keys,g=l.bind,m=Object.create,v=function(){},y=function(t){return t instanceof y?t:this instanceof y?void(this._wrapped=t):new y(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=y),exports._=y):o._=y,y.VERSION="1.8.3";var _=function(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,o){return t.call(e,i,n,o)};case 4:return function(i,n,o,r){return t.call(e,i,n,o,r)}}return function(){return t.apply(e,arguments)}},w=function(t,e,i){return null==t?y.identity:y.isFunction(t)?_(t,e,i):y.isObject(t)?y.matcher(t):y.property(t)};y.iteratee=function(t,e){return w(t,e,1/0)};var b=function(t,e){return function(i){var n=arguments.length;if(2>n||null==i)return i;for(var o=1;n>o;o++)for(var r=arguments[o],s=t(r),a=s.length,l=0;a>l;l++){var c=s[l];e&&void 0!==i[c]||(i[c]=r[c])}return i}},k=function(t){if(!y.isObject(t))return{};if(m)return m(t);v.prototype=t;var e=new v;return v.prototype=null,e},D=function(t){return function(e){return null==e?void 0:e[t]}},C=Math.pow(2,53)-1,R=D("length"),T=function(t){var e=R(t);return"number"==typeof e&&e>=0&&C>=e};y.each=y.forEach=function(t,e,i){e=_(e,i);var n,o;if(T(t))for(n=0,o=t.length;o>n;n++)e(t[n],n,t);else{var r=y.keys(t);for(n=0,o=r.length;o>n;n++)e(t[r[n]],r[n],t)}return t},y.map=y.collect=function(t,e,i){e=w(e,i);for(var n=!T(t)&&y.keys(t),o=(n||t).length,r=Array(o),s=0;o>s;s++){var a=n?n[s]:s;r[s]=e(t[a],a,t)}return r},y.reduce=y.foldl=y.inject=t(1),y.reduceRight=y.foldr=t(-1),y.find=y.detect=function(t,e,i){var n;return n=T(t)?y.findIndex(t,e,i):y.findKey(t,e,i),void 0!==n&&n!==-1?t[n]:void 0},y.filter=y.select=function(t,e,i){var n=[];return e=w(e,i),y.each(t,function(t,i,o){e(t,i,o)&&n.push(t)}),n},y.reject=function(t,e,i){return y.filter(t,y.negate(w(e)),i)},y.every=y.all=function(t,e,i){e=w(e,i);for(var n=!T(t)&&y.keys(t),o=(n||t).length,r=0;o>r;r++){var s=n?n[r]:r;if(!e(t[s],s,t))return!1}return!0},y.some=y.any=function(t,e,i){e=w(e,i);for(var n=!T(t)&&y.keys(t),o=(n||t).length,r=0;o>r;r++){var s=n?n[r]:r;if(e(t[s],s,t))return!0}return!1},y.contains=y.includes=y.include=function(t,e,i,n){return T(t)||(t=y.values(t)),("number"!=typeof i||n)&&(i=0),y.indexOf(t,e,i)>=0},y.invoke=function(t,e){var i=u.call(arguments,2),n=y.isFunction(e);return y.map(t,function(t){var o=n?e:t[e];return null==o?o:o.apply(t,i)})},y.pluck=function(t,e){return y.map(t,y.property(e))},y.where=function(t,e){return y.filter(t,y.matcher(e))},y.findWhere=function(t,e){return y.find(t,y.matcher(e))},y.max=function(t,e,i){var n,o,r=-1/0,s=-1/0;if(null==e&&null!=t){t=T(t)?t:y.values(t);for(var a=0,l=t.length;l>a;a++)n=t[a],n>r&&(r=n)}else e=w(e,i),y.each(t,function(t,i,n){o=e(t,i,n),(o>s||o===-1/0&&r===-1/0)&&(r=t,s=o)});return r},y.min=function(t,e,i){var n,o,r=1/0,s=1/0;if(null==e&&null!=t){t=T(t)?t:y.values(t);for(var a=0,l=t.length;l>a;a++)n=t[a],r>n&&(r=n)}else e=w(e,i),y.each(t,function(t,i,n){o=e(t,i,n),(s>o||1/0===o&&1/0===r)&&(r=t,s=o)});return r},y.shuffle=function(t){for(var e,i=T(t)?t:y.values(t),n=i.length,o=Array(n),r=0;n>r;r++)e=y.random(0,r),e!==r&&(o[r]=o[e]),o[e]=i[r];return o},y.sample=function(t,e,i){return null==e||i?(T(t)||(t=y.values(t)),t[y.random(t.length-1)]):y.shuffle(t).slice(0,Math.max(0,e))},y.sortBy=function(t,e,i){return e=w(e,i),y.pluck(y.map(t,function(t,i,n){return{value:t,index:i,criteria:e(t,i,n)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}),"value")};var x=function(t){return function(e,i,n){var o={};return i=w(i,n),y.each(e,function(n,r){var s=i(n,r,e);t(o,n,s)}),o}};y.groupBy=x(function(t,e,i){y.has(t,i)?t[i].push(e):t[i]=[e]}),y.indexBy=x(function(t,e,i){t[i]=e}),y.countBy=x(function(t,e,i){y.has(t,i)?t[i]++:t[i]=1}),y.toArray=function(t){return t?y.isArray(t)?u.call(t):T(t)?y.map(t,y.identity):y.values(t):[]},y.size=function(t){return null==t?0:T(t)?t.length:y.keys(t).length},y.partition=function(t,e,i){e=w(e,i);var n=[],o=[];return y.each(t,function(t,i,r){(e(t,i,r)?n:o).push(t)}),[n,o]},y.first=y.head=y.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:y.initial(t,t.length-e)},y.initial=function(t,e,i){return u.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},y.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:y.rest(t,Math.max(0,t.length-e))},y.rest=y.tail=y.drop=function(t,e,i){return u.call(t,null==e||i?1:e)},y.compact=function(t){return y.filter(t,y.identity)};var S=function(t,e,i,n){for(var o=[],r=0,s=n||0,a=R(t);a>s;s++){var l=t[s];if(T(l)&&(y.isArray(l)||y.isArguments(l))){e||(l=S(l,e,i));var c=0,u=l.length;for(o.length+=u;u>c;)o[r++]=l[c++]}else i||(o[r++]=l)}return o};y.flatten=function(t,e){return S(t,e,!1)},y.without=function(t){return y.difference(t,u.call(arguments,1))},y.uniq=y.unique=function(t,e,i,n){y.isBoolean(e)||(n=i,i=e,e=!1),null!=i&&(i=w(i,n));for(var o=[],r=[],s=0,a=R(t);a>s;s++){var l=t[s],c=i?i(l,s,t):l;e?(s&&r===c||o.push(l),r=c):i?y.contains(r,c)||(r.push(c),o.push(l)):y.contains(o,l)||o.push(l)}return o},y.union=function(){return y.uniq(S(arguments,!0,!0))},y.intersection=function(t){for(var e=[],i=arguments.length,n=0,o=R(t);o>n;n++){var r=t[n];if(!y.contains(e,r)){for(var s=1;i>s&&y.contains(arguments[s],r);s++);s===i&&e.push(r)}}return e},y.difference=function(t){var e=S(arguments,!0,!0,1);return y.filter(t,function(t){return!y.contains(e,t)})},y.zip=function(){return y.unzip(arguments)},y.unzip=function(t){for(var e=t&&y.max(t,R).length||0,i=Array(e),n=0;e>n;n++)i[n]=y.pluck(t,n);return i},y.object=function(t,e){for(var i={},n=0,o=R(t);o>n;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},y.findIndex=e(1),y.findLastIndex=e(-1),y.sortedIndex=function(t,e,i,n){i=w(i,n,1);for(var o=i(e),r=0,s=R(t);s>r;){var a=Math.floor((r+s)/2);i(t[a])<o?r=a+1:s=a}return r},y.indexOf=i(1,y.findIndex,y.sortedIndex),y.lastIndexOf=i(-1,y.findLastIndex),y.range=function(t,e,i){null==e&&(e=t||0,t=0),i=i||1;for(var n=Math.max(Math.ceil((e-t)/i),0),o=Array(n),r=0;n>r;r++,t+=i)o[r]=t;return o};var P=function(t,e,i,n,o){if(!(n instanceof e))return t.apply(i,o);var r=k(t.prototype),s=t.apply(r,o);return y.isObject(s)?s:r};y.bind=function(t,e){if(g&&t.bind===g)return g.apply(t,u.call(arguments,1));if(!y.isFunction(t))throw new TypeError("Bind must be called on a function");var i=u.call(arguments,2),n=function(){return P(t,n,e,this,i.concat(u.call(arguments)))};return n},y.partial=function(t){var e=u.call(arguments,1),i=function(){for(var n=0,o=e.length,r=Array(o),s=0;o>s;s++)r[s]=e[s]===y?arguments[n++]:e[s];for(;n<arguments.length;)r.push(arguments[n++]);return P(t,i,this,this,r)};return i},y.bindAll=function(t){var e,i,n=arguments.length;if(1>=n)throw new Error("bindAll must be passed function names");for(e=1;n>e;e++)i=arguments[e],t[i]=y.bind(t[i],t);return t},y.memoize=function(t,e){var i=function(n){var o=i.cache,r=""+(e?e.apply(this,arguments):n);return y.has(o,r)||(o[r]=t.apply(this,arguments)),o[r]};return i.cache={},i},y.delay=function(t,e){var i=u.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},y.defer=y.partial(y.delay,y,1),y.throttle=function(t,e,i){var n,o,r,s=null,a=0;i||(i={});var l=function(){a=i.leading===!1?0:y.now(),s=null,r=t.apply(n,o),s||(n=o=null)};return function(){var c=y.now();a||i.leading!==!1||(a=c);var u=e-(c-a);return n=this,o=arguments,0>=u||u>e?(s&&(clearTimeout(s),s=null),a=c,r=t.apply(n,o),s||(n=o=null)):s||i.trailing===!1||(s=setTimeout(l,u)),r}},y.debounce=function(t,e,i){var n,o,r,s,a,l=function(){var c=y.now()-s;e>c&&c>=0?n=setTimeout(l,e-c):(n=null,i||(a=t.apply(r,o),n||(r=o=null)))};return function(){r=this,o=arguments,s=y.now();var c=i&&!n;return n||(n=setTimeout(l,e)),c&&(a=t.apply(r,o),r=o=null),a}},y.wrap=function(t,e){return y.partial(e,t)},y.negate=function(t){return function(){return!t.apply(this,arguments)}},y.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,n=t[e].apply(this,arguments);i--;)n=t[i].call(this,n);return n}},y.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},y.before=function(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),1>=t&&(e=null),i}},y.once=y.partial(y.before,2);var G=!{toString:null}.propertyIsEnumerable("toString"),A=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];y.keys=function(t){if(!y.isObject(t))return[];if(f)return f(t);var e=[];for(var i in t)y.has(t,i)&&e.push(i);return G&&n(t,e),e},y.allKeys=function(t){if(!y.isObject(t))return[];var e=[];for(var i in t)e.push(i);return G&&n(t,e),e},y.values=function(t){for(var e=y.keys(t),i=e.length,n=Array(i),o=0;i>o;o++)n[o]=t[e[o]];return n},y.mapObject=function(t,e,i){e=w(e,i);for(var n,o=y.keys(t),r=o.length,s={},a=0;r>a;a++)n=o[a],s[n]=e(t[n],n,t);return s},y.pairs=function(t){for(var e=y.keys(t),i=e.length,n=Array(i),o=0;i>o;o++)n[o]=[e[o],t[e[o]]];return n},y.invert=function(t){for(var e={},i=y.keys(t),n=0,o=i.length;o>n;n++)e[t[i[n]]]=i[n];return e},y.functions=y.methods=function(t){var e=[];for(var i in t)y.isFunction(t[i])&&e.push(i);return e.sort()},y.extend=b(y.allKeys),y.extendOwn=y.assign=b(y.keys),y.findKey=function(t,e,i){e=w(e,i);for(var n,o=y.keys(t),r=0,s=o.length;s>r;r++)if(n=o[r],e(t[n],n,t))return n},y.pick=function(t,e,i){var n,o,r={},s=t;if(null==s)return r;y.isFunction(e)?(o=y.allKeys(s),n=_(e,i)):(o=S(arguments,!1,!1,1),n=function(t,e,i){return e in i},s=Object(s));for(var a=0,l=o.length;l>a;a++){var c=o[a],u=s[c];n(u,c,s)&&(r[c]=u)}return r},y.omit=function(t,e,i){if(y.isFunction(e))e=y.negate(e);else{var n=y.map(S(arguments,!1,!1,1),String);e=function(t,e){return!y.contains(n,e)}}return y.pick(t,e,i)},y.defaults=b(y.allKeys,!0),y.create=function(t,e){var i=k(t);return e&&y.extendOwn(i,e),i},y.clone=function(t){return y.isObject(t)?y.isArray(t)?t.slice():y.extend({},t):t},y.tap=function(t,e){return e(t),t},y.isMatch=function(t,e){var i=y.keys(e),n=i.length;if(null==t)return!n;for(var o=Object(t),r=0;n>r;r++){var s=i[r];if(e[s]!==o[s]||!(s in o))return!1}return!0};var M=function(t,e,i,n){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof y&&(t=t._wrapped),e instanceof y&&(e=e._wrapped);var o=h.call(t);if(o!==h.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var r="[object Array]"===o;if(!r){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(y.isFunction(s)&&s instanceof s&&y.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}i=i||[],n=n||[];for(var l=i.length;l--;)if(i[l]===t)return n[l]===e;if(i.push(t),n.push(e),r){if(l=t.length,l!==e.length)return!1;for(;l--;)if(!M(t[l],e[l],i,n))return!1}else{var c,u=y.keys(t);if(l=u.length,y.keys(e).length!==l)return!1;for(;l--;)if(c=u[l],!y.has(e,c)||!M(t[c],e[c],i,n))return!1}return i.pop(),n.pop(),!0};y.isEqual=function(t,e){return M(t,e)},y.isEmpty=function(t){return null==t||(T(t)&&(y.isArray(t)||y.isString(t)||y.isArguments(t))?0===t.length:0===y.keys(t).length)},y.isElement=function(t){return!(!t||1!==t.nodeType)},y.isArray=p||function(t){return"[object Array]"===h.call(t)},y.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},y.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){y["is"+t]=function(e){return h.call(e)==="[object "+t+"]"}}),y.isArguments(arguments)||(y.isArguments=function(t){return y.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(y.isFunction=function(t){return"function"==typeof t||!1}),y.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},y.isNaN=function(t){return y.isNumber(t)&&t!==+t},y.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===h.call(t)},y.isNull=function(t){return null===t},y.isUndefined=function(t){return void 0===t},y.has=function(t,e){return null!=t&&d.call(t,e)},y.noConflict=function(){return o._=r,this},y.identity=function(t){return t},y.constant=function(t){return function(){return t}},y.noop=function(){},y.property=D,y.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},y.matcher=y.matches=function(t){return t=y.extendOwn({},t),function(e){return y.isMatch(e,t)}},y.times=function(t,e,i){var n=Array(Math.max(0,t));e=_(e,i,1);for(var o=0;t>o;o++)n[o]=e(o);return n},y.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},y.now=Date.now||function(){return(new Date).getTime()};var O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},F=y.invert(O),E=function(t){var e=function(e){return t[e]},i="(?:"+y.keys(t).join("|")+")",n=RegExp(i),o=RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(o,e):t}};y.escape=E(O),y.unescape=E(F),y.result=function(t,e,i){var n=null==t?void 0:t[e];return void 0===n&&(n=i),y.isFunction(n)?n.call(t):n};var V=0;y.uniqueId=function(t){var e=++V+"";return t?t+e:e},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,$={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\u2028|\u2029/g,j=function(t){return"\\"+$[t]};y.template=function(t,e,i){!e&&i&&(e=i),e=y.defaults({},e,y.templateSettings);var n=RegExp([(e.escape||B).source,(e.interpolate||B).source,(e.evaluate||B).source].join("|")+"|$","g"),o=0,r="__p+='";t.replace(n,function(e,i,n,s,a){return r+=t.slice(o,a).replace(I,j),o=a+e.length,i?r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?r+="'+\n((__t=("+n+"))==null?'':__t)+\n'":s&&(r+="';\n"+s+"\n__p+='"),e}),r+="';\n",e.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var s=new Function(e.variable||"obj","_",r)}catch(t){throw t.source=r,t}var a=function(t){return s.call(this,t,y)},l=e.variable||"obj";return a.source="function("+l+"){\n"+r+"}",a},y.chain=function(t){var e=y(t);return e._chain=!0,e};var N=function(t,e){return t._chain?y(e).chain():e};y.mixin=function(t){y.each(y.functions(t),function(e){var i=y[e]=t[e];y.prototype[e]=function(){var t=[this._wrapped];return c.apply(t,arguments),N(this,i.apply(y,t))}})},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=s[t];y.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0],N(this,i)}}),y.each(["concat","join","slice"],function(t){var e=s[t];y.prototype[t]=function(){return N(this,e.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return y})}.call(this),function(t){var e="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global;if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(i,n,o){e.Backbone=t(e,o,i,n)});else if("undefined"!=typeof exports){var i,n=require("underscore");try{i=require("jquery")}catch(t){}t(e,exports,n,i)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(function(t,e,i,n){var o=t.Backbone,r=[].slice;e.VERSION="1.2.1",e.$=n,e.noConflict=function(){return t.Backbone=o,this},e.emulateHTTP=!1,e.emulateJSON=!1;var s=function(t,e,n){switch(t){case 1:return function(){return i[e](this[n])};case 2:return function(t){return i[e](this[n],t)};case 3:return function(t,o){return i[e](this[n],t,o)};case 4:return function(t,o,r){return i[e](this[n],t,o,r)};default:return function(){var t=r.call(arguments);return t.unshift(this[n]),i[e].apply(i,t)}}},a=function(t,e,n){i.each(e,function(e,o){i[o]&&(t.prototype[o]=s(e,o,n))})},l=e.Events={},c=/\s+/,u=function(t,e,n,o,r){var s,a=0;if(n&&"object"==typeof n){void 0!==o&&"context"in r&&void 0===r.context&&(r.context=o);for(s=i.keys(n);a<s.length;a++)e=t(e,s[a],n[s[a]],r)}else if(n&&c.test(n))for(s=n.split(c);a<s.length;a++)e=t(e,s[a],o,r);else e=t(e,n,o,r);return e};l.on=function(t,e,i){return h(this,t,e,i)};var h=function(t,e,i,n,o){if(t._events=u(d,t._events||{},e,i,{context:n,ctx:t,listening:o}),o){var r=t._listeners||(t._listeners={});r[o.id]=o}return t};l.listenTo=function(t,e,n){if(!t)return this;var o=t._listenId||(t._listenId=i.uniqueId("l")),r=this._listeningTo||(this._listeningTo={}),s=r[o];if(!s){var a=this._listenId||(this._listenId=i.uniqueId("l"));s=r[o]={obj:t,objId:o,id:a,listeningTo:r,count:0}}return h(t,e,n,this,s),this};var d=function(t,e,i,n){if(i){var o=t[e]||(t[e]=[]),r=n.context,s=n.ctx,a=n.listening;a&&a.count++,o.push({callback:i,context:r,ctx:r||s,listening:a})}return t};l.off=function(t,e,i){return this._events?(this._events=u(p,this._events,t,e,{context:i,listeners:this._listeners}),this):this},l.stopListening=function(t,e,n){var o=this._listeningTo;if(!o)return this;for(var r=t?[t._listenId]:i.keys(o),s=0;s<r.length;s++){var a=o[r[s]];if(!a)break;a.obj.off(e,n,this)}return i.isEmpty(o)&&(this._listeningTo=void 0),this};var p=function(t,e,n,o){if(t){var r,s=0,a=o.context,l=o.listeners;if(e||n||a){for(var c=e?[e]:i.keys(t);s<c.length;s++){e=c[s];var u=t[e];if(!u)break;for(var h=[],d=0;d<u.length;d++){var p=u[d];n&&n!==p.callback&&n!==p.callback._callback||a&&a!==p.context?h.push(p):(r=p.listening,r&&0===--r.count&&(delete l[r.id],delete r.listeningTo[r.objId]))}h.length?t[e]=h:delete t[e]}return i.size(t)?t:void 0}for(var f=i.keys(l);s<f.length;s++)r=l[f[s]],delete l[r.id],delete r.listeningTo[r.objId]}};l.once=function(t,e,n){var o=u(f,{},t,e,i.bind(this.off,this));return this.on(o,void 0,n)},l.listenToOnce=function(t,e,n){var o=u(f,{},e,n,i.bind(this.stopListening,this,t));return this.listenTo(t,o)};var f=function(t,e,n,o){if(n){var r=t[e]=i.once(function(){o(e,r),n.apply(this,arguments)});r._callback=n}return t};l.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),i=Array(e),n=0;n<e;n++)i[n]=arguments[n+1];return u(g,this._events,t,void 0,i),this};var g=function(t,e,i,n){if(t){var o=t[e],r=t.all;o&&r&&(r=r.slice()),o&&m(o,n),r&&m(r,[e].concat(n))}return t},m=function(t,e){var i,n=-1,o=t.length,r=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++n<o;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=t[n]).callback.call(i.ctx,r);return;case 2:for(;++n<o;)(i=t[n]).callback.call(i.ctx,r,s);return;case 3:for(;++n<o;)(i=t[n]).callback.call(i.ctx,r,s,a);return;default:for(;++n<o;)(i=t[n]).callback.apply(i.ctx,e);return}};l.bind=l.on,l.unbind=l.off,i.extend(e,l);var v=e.Model=function(t,e){var n=t||{};e||(e={}),this.cid=i.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(v.prototype,l,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(t){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!i.iteratee(t,this)(this.attributes)},set:function(t,e,n){if(null==t)return this;var o;if("object"==typeof t?(o=t,n=e):(o={})[t]=e,n||(n={}),!this._validate(o,n))return!1;var r=n.unset,s=n.silent,a=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=i.clone(this.attributes),this.changed={});var c=this.attributes,u=this.changed,h=this._previousAttributes;this.idAttribute in o&&(this.id=o[this.idAttribute]);for(var d in o)e=o[d],i.isEqual(c[d],e)||a.push(d),i.isEqual(h[d],e)?delete u[d]:u[d]=e,r?delete c[d]:c[d]=e;if(!s){a.length&&(this._pending=n);for(var p=0;p<a.length;p++)this.trigger("change:"+a[p],this,c[a[p]],n)}if(l)return this;if(!s)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&i.clone(this.changed);var e=this._changing?this._previousAttributes:this.attributes,n={};for(var o in t){var r=t[o];i.isEqual(e[o],r)||(n[o]=r)}return!!i.size(n)&&n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=i.extend({parse:!0},t);var e=this,n=t.success;return t.success=function(i){var o=t.parse?e.parse(i,t):i;return!!e.set(o,t)&&(n&&n.call(t.context,e,i,t),void e.trigger("sync",e,i,t))},I(this,t),this.sync("read",this,t)},save:function(t,e,n){var o;null==t||"object"==typeof t?(o=t,n=e):(o={})[t]=e,n=i.extend({validate:!0,parse:!0},n);var r=n.wait;if(o&&!r){if(!this.set(o,n))return!1}else if(!this._validate(o,n))return!1;var s=this,a=n.success,l=this.attributes;n.success=function(t){s.attributes=l;var e=n.parse?s.parse(t,n):t;return r&&(e=i.extend({},o,e)),!(e&&!s.set(e,n))&&(a&&a.call(n.context,s,t,n),void s.trigger("sync",s,t,n))},I(this,n),o&&r&&(this.attributes=i.extend({},l,o));var c=this.isNew()?"create":n.patch?"patch":"update";"patch"!==c||n.attrs||(n.attrs=o);var u=this.sync(c,this,n);return this.attributes=l,u},destroy:function(t){t=t?i.clone(t):{};var e=this,n=t.success,o=t.wait,r=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};t.success=function(i){o&&r(),n&&n.call(t.context,e,i,t),e.isNew()||e.trigger("sync",e,i,t)};var s=!1;return this.isNew()?i.defer(t.success):(I(this,t),s=this.sync("delete",this,t)),o||r(),s},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||$();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.defaults({validate:!0},t))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return!n||(this.trigger("invalid",this,n,i.extend(e,{validationError:n})),!1)}});var y={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};a(v,y,"attributes");var _=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},w={add:!0,remove:!0,merge:!0},b={add:!0,remove:!1};i.extend(_.prototype,l,{model:v,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,b))},remove:function(t,e){e=i.extend({},e);var n=!i.isArray(t);t=n?[t]:i.clone(t);var o=this._removeModels(t,e);return!e.silent&&o&&this.trigger("update",this,e),n?o[0]:o},set:function(t,e){e=i.defaults({},e,w),e.parse&&!this._isModel(t)&&(t=this.parse(t,e));var n=!i.isArray(t);t=n?t?[t]:[]:t.slice();var o,r,s,a,l,c=e.at;null!=c&&(c=+c),c<0&&(c+=this.length+1);for(var u=this.comparator&&null==c&&e.sort!==!1,h=i.isString(this.comparator)?this.comparator:null,d=[],p=[],f={},g=e.add,m=e.merge,v=e.remove,y=!(u||!g||!v)&&[],_=!1,b=0;b<t.length;b++){if(s=t[b],a=this.get(s))v&&(f[a.cid]=!0),m&&s!==a&&(s=this._isModel(s)?s.attributes:s,e.parse&&(s=a.parse(s,e)),a.set(s,e),u&&!l&&a.hasChanged(h)&&(l=!0)),t[b]=a;else if(g){if(r=t[b]=this._prepareModel(s,e),!r)continue;d.push(r),this._addReference(r,e)}r=a||r,r&&(o=this.modelId(r.attributes),!y||!r.isNew()&&f[o]||(y.push(r),_=_||!this.models[b]||r.cid!==this.models[b].cid),f[o]=!0)}if(v){for(var b=0;b<this.length;b++)f[(r=this.models[b]).cid]||p.push(r);p.length&&this._removeModels(p,e)}if(d.length||_)if(u&&(l=!0),this.length+=d.length,null!=c)for(var b=0;b<d.length;b++)this.models.splice(c+b,0,d[b]);else{y&&(this.models.length=0);for(var k=y||d,b=0;b<k.length;b++)this.models.push(k[b])}if(l&&this.sort({silent:!0}),!e.silent){for(var D=null!=c?i.clone(e):e,b=0;b<d.length;b++)null!=c&&(D.index=c+b),(r=d[b]).trigger("add",r,this,D);(l||_)&&this.trigger("sort",this,e),(d.length||p.length)&&this.trigger("update",this,e)}return n?t[0]:t},reset:function(t,e){e=e?i.clone(e):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return r.apply(this.models,arguments)},get:function(t){if(null!=t){var e=this.modelId(this._isModel(t)?t.attributes:t);return this._byId[t]||this._byId[e]||this._byId[t.cid]}},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){var n=i.matches(t);return this[e?"find":"filter"](function(t){return n(t.attributes)})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return i.invoke(this.models,"get",t)},fetch:function(t){t=i.extend({parse:!0},t);var e=t.success,n=this;return t.success=function(i){var o=t.reset?"reset":"set";n[o](i,t),e&&e.call(t.context,n,i,t),n.trigger("sync",n,i,t)},I(this,t),this.sync("read",this,t)},create:function(t,e){e=e?i.clone(e):{};var n=e.wait;if(t=this._prepareModel(t,e),!t)return!1;n||this.add(t,e);var o=this,r=e.success;return e.success=function(t,e,i){n&&o.add(t,i),r&&r.call(i.context,t,e,i)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;e=e?i.clone(e):{},e.collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_removeModels:function(t,e){for(var i=[],n=0;n<t.length;n++){var o=this.get(t[n]);if(o){var r=this.indexOf(o);this.models.splice(r,1),this.length--,e.silent||(e.index=r,o.trigger("remove",o,this,e)),i.push(o),this._removeReference(o,e)}}return!!i.length&&i},_isModel:function(t){return t instanceof v},_addReference:function(t,e){this._byId[t.cid]=t;var i=this.modelId(t.attributes);null!=i&&(this._byId[i]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var i=this.modelId(t.attributes);null!=i&&delete this._byId[i],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){if("add"!==t&&"remove"!==t||i===this){if("destroy"===t&&this.remove(e,n),"change"===t){var o=this.modelId(e.previousAttributes()),r=this.modelId(e.attributes);o!==r&&(null!=o&&delete this._byId[o],null!=r&&(this._byId[r]=e))}this.trigger.apply(this,arguments)}}});var k={forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:2,contains:2,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3};a(_,k,"models");var D=["groupBy","countBy","sortBy","indexBy"];i.each(D,function(t){i[t]&&(_.prototype[t]=function(e,n){var o=i.isFunction(e)?e:function(t){return t.get(e)};return i[t](this.models,o,n)})});var C=e.View=function(t){this.cid=i.uniqueId("view"),i.extend(this,i.pick(t,T)),this._ensureElement(),this.initialize.apply(this,arguments)},R=/^(\S+)\s*(.*)$/,T=["model","collection","el","id","attributes","className","tagName","events"];i.extend(C.prototype,l,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),
this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=i.result(this,"events")),!t)return this;this.undelegateEvents();for(var e in t){var n=t[e];if(i.isFunction(n)||(n=this[n]),n){var o=e.match(R);this.delegate(o[1],o[2],i.bind(n,this))}}return this},delegate:function(t,e,i){return this.$el.on(t+".delegateEvents"+this.cid,e,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,i){return this.$el.off(t+".delegateEvents"+this.cid,e,i),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"));else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t.class=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}}),e.sync=function(t,n,o){var r=x[t];i.defaults(o||(o={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var s={type:r,dataType:"json"};if(o.url||(s.url=i.result(n,"url")||$()),null!=o.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(o.attrs||n.toJSON(o))),o.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),o.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){s.type="POST",o.emulateJSON&&(s.data._method=r);var a=o.beforeSend;o.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",r),a)return a.apply(this,arguments)}}"GET"===s.type||o.emulateJSON||(s.processData=!1);var l=o.error;o.error=function(t,e,i){o.textStatus=e,o.errorThrown=i,l&&l.call(o.context,t,e,i)};var c=o.xhr=e.ajax(i.extend(s,o));return n.trigger("request",n,c,o),c};var x={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var S=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},P=/\((.*?)\)/g,G=/(\(\?)?:\w+/g,A=/\*\w+/g,M=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(S.prototype,l,{initialize:function(){},route:function(t,n,o){i.isRegExp(t)||(t=this._routeToRegExp(t)),i.isFunction(n)&&(o=n,n=""),o||(o=this[n]);var r=this;return e.history.route(t,function(i){var s=r._extractParameters(t,i);r.execute(o,s,n)!==!1&&(r.trigger.apply(r,["route:"+n].concat(s)),r.trigger("route",n,s),e.history.trigger("route",r,n,s))}),this},execute:function(t,e,i){t&&t.apply(this,e)},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(M,"\\$&").replace(P,"(?:$1)?").replace(G,function(t,e){return e?t:"([^/?]+)"}).replace(A,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return i.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}});var O=e.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},F=/^[#\/]|\s+$/g,E=/^\/+|\/+$/g,V=/#.*$/;O.started=!1,i.extend(O.prototype,l,{interval:50,atRoot:function(){var t=this.location.pathname.replace(/[^\/]$/,"$&/");return t===this.root&&!this.getSearch()},matchRoot:function(){var t=this.decodeFragment(this.location.pathname),e=t.slice(0,this.root.length-1)+"/";return e===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(F,"")},start:function(t){if(O.started)throw new Error("Backbone.history has already been started");if(O.started=!0,this.options=i.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window,this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(E,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var n=document.body,o=n.insertBefore(this.iframe,n.firstChild).contentWindow;o.document.open(),o.document.close(),o.location.hash="#"+this.fragment}var r=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?r("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?r("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),O.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e!==this.fragment&&(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(t){return!!this.matchRoot()&&(t=this.fragment=this.getFragment(t),i.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0}))},navigate:function(t,e){if(!O.started)return!1;e&&e!==!0||(e={trigger:!!e}),t=this.getFragment(t||"");var i=this.root;""!==t&&"?"!==t.charAt(0)||(i=i.slice(0,-1)||"/");var n=i+t;if(t=this.decodeFragment(t.replace(V,"")),this.fragment!==t){if(this.fragment=t,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var o=this.iframe.contentWindow;e.replace||(o.document.open(),o.document.close()),this._updateHash(o.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),e.history=new O;var B=function(t,e){var n,o=this;n=t&&i.has(t,"constructor")?t.constructor:function(){return o.apply(this,arguments)},i.extend(n,o,e);var r=function(){this.constructor=n};return r.prototype=o.prototype,n.prototype=new r,t&&i.extend(n.prototype,t),n.__super__=o.prototype,n};v.extend=_.extend=S.extend=C.extend=O.extend=B;var $=function(){throw new Error('A "url" property or function must be specified')},I=function(t,e){var i=e.error;e.error=function(n){i&&i.call(e.context,t,n,e),t.trigger("error",t,n,e)}};return e}),function(t,e){"function"==typeof define&&define.amd?define(e):"undefined"!=typeof exports?module.exports=e():t.Autolinker=e()}(this,function(){var t=function(t){t=t||{};for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e])};return t.prototype={constructor:t,newWindow:!0,stripPrefix:!1,twitter:!0,email:!0,urls:!0,className:"",matcherRegex:function(){var t=/(^|[^\w])@(\w{1,15})/,e=/(?:[\-;:&=\+\$,\w\.]+@)/,i=/(?:[A-Za-z]{3,9}:(?:\/\/)?)/,n=/(?:www\.)/,o=/[A-Za-z0-9\.\-]*[A-Za-z0-9\-]/,r=/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/,s=/(?:[\-A-Za-z0-9+&@#\/%?=~_()|!:,.;]*[\-A-Za-z0-9+&@#\/%=~_()|])?/;return new RegExp(["(",t.source,")","|","(",e.source,o.source,r.source,")","|","(","(?:","(?:",i.source,o.source,")","|","(?:","(.?//)?",n.source,o.source,")","|","(?:","(.?//)?",o.source,r.source,")",")",s.source,")"].join(""),"gi")}(),protocolRelativeRegex:/(.)?\/\//,htmlRegex:function(){var t=/[0-9a-zA-Z:]+/,e=/[^\s\0"'>\/=\x01-\x1F\x7F]+/,i=/(?:".*?"|'.*?'|[^'"=<>`\s]+)/;return new RegExp(["<(/)?","("+t.source+")","(?:","\\s+",e.source,"(?:\\s*=\\s*"+i.source+")?",")*","\\s*",">"].join(""),"g")}(),urlPrefixRegex:/^(https?:\/\/)?(www\.)?/i,link:function(t){return this.processHtml(t)},processHtml:function(t){for(var e,i,n=this.htmlRegex,o=0,r=0,s=[];null!==(e=n.exec(t));){var a=e[0],l=e[2],c=!!e[1];i=t.substring(o,e.index),o=e.index+a.length,"a"===l?c?(r=Math.max(r-1,0),0===r&&s.push(i)):(r++,s.push(this.processTextNode(i))):0===r?s.push(this.processTextNode(i)):s.push(i),s.push(a)}if(o<t.length){var u=this.processTextNode(t.substring(o));s.push(u)}return s.join("")},processTextNode:function(t){var e=this,i=this.matcherRegex,n=this.twitter,o=this.email,r=this.urls;return t.replace(i,function(t,i,s,a,l,c,u,h){var d=i,p=s,f=a,g=l,m=c,v=u||h,y="",_="";if(d&&!n||g&&!o||m&&!r||m&&m.indexOf(".")===-1||m&&/^[A-Za-z]{3,9}:/.test(m)&&!/:.*?[A-Za-z]/.test(m)||v&&/^[\w]\/\//.test(v))return t;var w=t.charAt(t.length-1);if(")"===w){var b=t.match(/\(/g),k=t.match(/\)/g),D=b&&b.length||0,C=k&&k.length||0;D<C&&(t=t.substr(0,t.length-1),_=")")}var R,T=t,x=t;if(d)R="twitter",y=p,T="https://twitter.com/"+f,x="@"+f;else if(g)R="email",T="mailto:"+g,x=g;else if(R="url",v){var S=new RegExp("^"+e.protocolRelativeRegex.source),P=v.match(S)[1]||"";y=P+y,T=T.replace(S,"//"),x=x.replace(S,"")}else/^[A-Za-z]{3,9}:/i.test(T)||(T="http://"+T);var G=e.createAnchorTag(R,T,x);return y+G+_})},createAnchorTag:function(t,e,i){var n=this.createAnchorAttrsStr(t,e);return i=this.processAnchorText(i),"<a "+n+">"+i+"</a>"},createAnchorAttrsStr:function(t,e){var i=['href="'+e+'"'],n=this.createCssClass(t);return n&&i.push('class="'+n+'"'),this.newWindow&&null==e.match(/(?:mailto:)/)&&i.push('target="_blank"'),i.join(" ")},createCssClass:function(t){var e=this.className;return e?e+" "+e+"-"+t:""},processAnchorText:function(t){return this.stripPrefix&&(t=this.stripUrlPrefix(t)),t=this.removeTrailingSlash(t),t=this.doTruncate(t)},stripUrlPrefix:function(t){return t.replace(this.urlPrefixRegex,"")},removeTrailingSlash:function(t){return"/"===t.charAt(t.length-1)&&(t=t.slice(0,-1)),t},doTruncate:function(t){var e=this.truncate;return e&&t.length>e&&(t=t.substring(0,e-2)+".."),t}},t.link=function(e,i){var n=new t(i);return n.link(e)},t}),function(){function t(t,e){var i=function(){};i.prototype=e.prototype,t.super_=e,t.prototype=new i,t.prototype.constructor=t}function e(t,e){this._options=e?e:{},this._validateBuilder(t);this._builder=t,this.reset()}function i(t,e){this.reset(),this._options=e?e:{},void 0===this._options.ignoreWhitespace&&(this._options.ignoreWhitespace=!1),void 0===this._options.includeLocation&&(this._options.includeLocation=!1),void 0===this._options.verbose&&(this._options.verbose=!0),void 0===this._options.enforceEmptyTags&&(this._options.enforceEmptyTags=!0),void 0===this._options.caseSensitiveTags&&(this._options.caseSensitiveTags=!1),void 0===this._options.caseSensitiveAttr&&(this._options.caseSensitiveAttr=!1),"function"==typeof t&&(this._callback=t)}function n(t){n.super_.call(this,t,{ignoreWhitespace:!0,verbose:!1,enforceEmptyTags:!1,caseSensitiveTags:!0})}var o;if("undefined"!=typeof module&&"undefined"!=typeof module.exports)o=module.exports;else{if(o={},this.Tautologistics||(this.Tautologistics={}),this.Tautologistics.NodeHtmlParser)return;this.Tautologistics.NodeHtmlParser=o}var r={Text:"text",Tag:"tag",Attr:"attr",CData:"cdata",Doctype:"doctype",Comment:"comment"};if("undefined"!=typeof module&&"undefined"!=typeof module.exports){var s=require("stream");t(e,s),e.prototype.writable=!0,e.prototype.write=function(t){t instanceof Buffer&&(t=t.toString()),this.parseChunk(t)},e.prototype.end=function(t){arguments.length&&this.write(t),this.writable=!1,this.done()},e.prototype.destroy=function(){this.writable=!1}}e.prototype.reset=function(){this._state={mode:r.Text,pos:0,data:null,pendingText:null,pendingWrite:null,lastTag:null,isScript:!1,needData:!1,output:[],done:!1},this._builder.reset()},e.prototype.parseChunk=function(t){for(this._state.needData=!1,this._state.data=null!==this._state.data?this._state.data.substr(this.pos)+t:t;this._state.pos<this._state.data.length&&!this._state.needData;)this._parse(this._state)},e.prototype.parseComplete=function(t){this.reset(),this.parseChunk(t),this.done()},e.prototype.done=function(){this._state.done=!0,this._parse(this._state),this._flushWrite(),this._builder.done()},e.prototype._validateBuilder=function(t){if("object"!=typeof t)throw new Error("Builder is not an object");if("function"!=typeof t.reset)throw new Error("Builder method 'reset' is invalid");if("function"!=typeof t.done)throw new Error("Builder method 'done' is invalid");if("function"!=typeof t.write)throw new Error("Builder method 'write' is invalid");if("function"!=typeof t.error)throw new Error("Builder method 'error' is invalid")},e.prototype._parse=function(){switch(this._state.mode){case r.Text:return this._parseText(this._state);case r.Tag:return this._parseTag(this._state);case r.Attr:return this._parseAttr(this._state);case r.CData:return this._parseCData(this._state);case r.Doctype:return this._parseDoctype(this._state);case r.Comment:return this._parseComment(this._state)}},e.prototype._writePending=function(t){this._state.pendingWrite||(this._state.pendingWrite=[]),this._state.pendingWrite.push(t)},e.prototype._flushWrite=function(){if(this._state.pendingWrite){for(var t=0,e=this._state.pendingWrite.length;t<e;t++){var i=this._state.pendingWrite[t];this._builder.write(i)}this._state.pendingWrite=null}},e.prototype._write=function(t){this._flushWrite(),this._builder.write(t)},e._re_parseText_scriptClose=/<\s*\/\s*script/gi,e.prototype._parseText=function(){var t,i=this._state;i.isScript?(e._re_parseText_scriptClose.lastIndex=i.pos,t=e._re_parseText_scriptClose.exec(i.data),t=t?t.index:-1):t=i.data.indexOf("<",i.pos);var n=t===-1?i.data.substring(i.pos,i.data.length):i.data.substring(i.pos,t);if(t<0&&i.done&&(t=i.data.length),t<0){if(i.isScript)return void(i.needData=!0);i.pendingText||(i.pendingText=[]),i.pendingText.push(i.data.substring(i.pos,i.data.length)),i.pos=i.data.length}else i.pendingText?(i.pendingText.push(i.data.substring(i.pos,t)),n=i.pendingText.join(""),i.pendingText=null):n=i.data.substring(i.pos,t),""!==n&&this._write({type:r.Text,data:n}),i.pos=t+1,i.mode=r.Tag},e.re_parseTag=/\s*(\/?)\s*([^\s>\/]+)(\s*)\??(>?)/g,e.prototype._parseTag=function(){var t=this._state;e.re_parseTag.lastIndex=t.pos;var i=e.re_parseTag.exec(t.data);if(i){if(!i[1]&&"!--"===i[2].substr(0,3))return t.mode=r.Comment,void(t.pos+=3);if(!i[1]&&"![CDATA["===i[2].substr(0,8))return t.mode=r.CData,void(t.pos+=8);if(!i[1]&&"!DOCTYPE"===i[2].substr(0,8))return t.mode=r.Doctype,void(t.pos+=8);if(!t.done&&t.pos+i[0].length===t.data.length)return void(t.needData=!0);var n;">"===i[4]?(t.mode=r.Text,n=i[0].substr(0,i[0].length-1)):(t.mode=r.Attr,n=i[0]),t.pos+=i[0].length;var o={type:r.Tag,name:i[1]+i[2],raw:n};t.mode===r.Attr&&(t.lastTag=o),"script"===o.name.toLowerCase()?t.isScript=!0:"/script"===o.name.toLowerCase()&&(t.isScript=!1),t.mode===r.Attr?this._writePending(o):this._write(o)}else t.needData=!0},e.re_parseAttr_findName=/\s*([^=<>\s'"\/]+)\s*/g,e.prototype._parseAttr_findName=function(){e.re_parseAttr_findName.lastIndex=this._state.pos;var t=e.re_parseAttr_findName.exec(this._state.data);return t?this._state.pos+t[0].length!==e.re_parseAttr_findName.lastIndex?null:{match:t[0],name:t[1]}:null},e.re_parseAttr_findValue=/\s*=\s*(?:'([^']*)'|"([^"]*)"|([^'"\s\/>]+))\s*/g,e.re_parseAttr_findValue_last=/\s*=\s*['"]?(.*)$/g,e.prototype._parseAttr_findValue=function(){var t=this._state;e.re_parseAttr_findValue.lastIndex=t.pos;var i=e.re_parseAttr_findValue.exec(t.data);return i?t.pos+i[0].length!==e.re_parseAttr_findValue.lastIndex?null:{match:i[0],value:i[1]||i[2]||i[3]}:t.done?(e.re_parseAttr_findValue_last.lastIndex=t.pos,i=e.re_parseAttr_findValue_last.exec(t.data),i?{match:i[0],value:""!==i[1]?i[1]:null}:null):null},e.re_parseAttr_splitValue=/\s*=\s*['"]?/g,e.re_parseAttr_selfClose=/(\s*\/\s*)(>?)/g,e.prototype._parseAttr=function(){var t=this._state,i=this._parseAttr_findName(t);if(i&&"?"!==i.name){if(!t.done&&t.pos+i.match.length===t.data.length)return t.needData=!0,null;t.pos+=i.match.length;var n=this._parseAttr_findValue(t);if(n){if(!t.done&&t.pos+n.match.length===t.data.length)return t.needData=!0,void(t.pos-=i.match.length);t.pos+=n.match.length}else{if(e.re_parseAttr_splitValue.lastIndex=t.pos,e.re_parseAttr_splitValue.exec(t.data))return t.needData=!0,void(t.pos-=i.match.length);n={match:"",value:null}}t.lastTag.raw+=i.match+n.match,this._writePending({type:r.Attr,name:i.name,data:n.value})}else{e.re_parseAttr_selfClose.lastIndex=t.pos;var o=e.re_parseAttr_selfClose.exec(t.data);if(o&&o.index===t.pos){if(!t.done&&!o[2]&&t.pos+o[0].length===t.data.length)return void(t.needData=!0);t.lastTag.raw+=o[1],this._write({type:r.Tag,name:"/"+t.lastTag.name,raw:null}),t.pos+=o[1].length}var s=t.data.indexOf(">",t.pos);if(s<0){if(t.done)return t.lastTag.raw+=t.data.substr(t.pos),void(t.pos=t.data.length);t.needData=!0}else t.pos=s+1,t.mode=r.Text}},e.re_parseCData_findEnding=/\]{1,2}$/,e.prototype._parseCData=function(){var t=this._state,i=t.data.indexOf("]]>",t.pos);if(i<0&&t.done&&(i=t.data.length),i<0){e.re_parseCData_findEnding.lastIndex=t.pos;var n=e.re_parseCData_findEnding.exec(t.data);if(n)return void(t.needData=!0);t.pendingText||(t.pendingText=[]),t.pendingText.push(t.data.substr(t.pos,t.data.length)),t.pos=t.data.length,t.needData=!0}else{var o;t.pendingText?(t.pendingText.push(t.data.substring(t.pos,i)),o=t.pendingText.join(""),t.pendingText=null):o=t.data.substring(t.pos,i),this._write({type:r.CData,data:o}),t.mode=r.Text,t.pos=i+3}},e.prototype._parseDoctype=function(){var t=this._state,i=t.data.indexOf(">",t.pos);if(i<0&&t.done&&(i=t.data.length),i<0)e.re_parseCData_findEnding.lastIndex=t.pos,t.pendingText||(t.pendingText=[]),t.pendingText.push(t.data.substr(t.pos,t.data.length)),t.pos=t.data.length,t.needData=!0;else{var n;t.pendingText?(t.pendingText.push(t.data.substring(t.pos,i)),n=t.pendingText.join(""),t.pendingText=null):n=t.data.substring(t.pos,i),this._write({type:r.Doctype,data:n}),t.mode=r.Text,t.pos=i+1}},e.re_parseComment_findEnding=/\-{1,2}$/,e.prototype._parseComment=function(){var t=this._state,i=t.data.indexOf("-->",t.pos);if(i<0&&t.done&&(i=t.data.length),i<0){e.re_parseComment_findEnding.lastIndex=t.pos;var n=e.re_parseComment_findEnding.exec(t.data);if(n)return void(t.needData=!0);t.pendingText||(t.pendingText=[]),t.pendingText.push(t.data.substr(t.pos,t.data.length)),t.pos=t.data.length,t.needData=!0}else{var o;t.pendingText?(t.pendingText.push(t.data.substring(t.pos,i)),o=t.pendingText.join(""),t.pendingText=null):o=t.data.substring(t.pos,i),this._write({type:r.Comment,data:o}),t.mode=r.Text,t.pos=i+3}},i._emptyTags={area:1,base:1,basefont:1,br:1,col:1,frame:1,hr:1,img:1,input:1,isindex:1,link:1,meta:1,param:1,embed:1,"?xml":1},i.reWhitespace=/^\s*$/,i.prototype.dom=null,i.prototype.reset=function(){this.dom=[],this._done=!1,this._tagStack=[],this._lastTag=null,this._tagStack.last=function(){return this.length?this[this.length-1]:null},this._line=1,this._col=1},i.prototype.done=function(){this._done=!0,this.handleCallback(null)},i.prototype.error=function(t){this.handleCallback(t)},i.prototype.handleCallback=function(t){if("function"==typeof this._callback)this._callback(t,this.dom);else if(t)throw t},i.prototype.isEmptyTag=function(t){var e=t.name.toLowerCase();return"?"==e.charAt(0)||("/"==e.charAt(0)&&(e=e.substring(1)),this._options.enforceEmptyTags&&!!i._emptyTags[e])},i.prototype._getLocation=function(){return{line:this._line,col:this._col}},i.prototype._updateLocation=function(t){var e=t.type===r.Tag?t.raw:t.data;if(null!==e){var i=e.split("\n");this._line+=i.length-1,i.length>1&&(this._col=1),this._col+=i[i.length-1].length,t.type===r.Tag?this._col+=2:t.type===r.Comment?this._col+=7:t.type===r.CData&&(this._col+=12)}},i.prototype._copyElement=function(t){var e={type:t.type};if(this._options.verbose&&void 0!==t.raw&&(e.raw=t.raw),void 0!==t.name)switch(t.type){case r.Tag:e.name=this._options.caseSensitiveTags?t.name:t.name.toLowerCase();break;case r.Attr:e.name=this._options.caseSensitiveAttr?t.name:t.name.toLowerCase();break;default:e.name=this._options.caseSensitiveTags?t.name:t.name.toLowerCase()}return void 0!==t.data&&(e.data=t.data),t.location&&(e.location={line:t.location.line,col:t.location.col}),e},i.prototype.write=function(t){if(this._done&&this.handleCallback(new Error("Writing to the builder after done() called is not allowed without a reset()")),this._options.includeLocation&&t.type!==r.Attr&&(t.location=this._getLocation(),this._updateLocation(t)),t.type!==r.Text||!this._options.ignoreWhitespace||!i.reWhitespace.test(t.data)){var e,n;if(this._tagStack.last())if(t.type===r.Tag)if("/"==t.name.charAt(0)){var o=this._options.caseSensitiveTags?t.name.substring(1):t.name.substring(1).toLowerCase();if(!this.isEmptyTag(t)){for(var s=this._tagStack.length-1;s>-1&&this._tagStack[s--].name!=o;);if(s>-1||this._tagStack[0].name==o)for(;s<this._tagStack.length-1;)this._tagStack.pop()}}else e=this._tagStack.last(),t.type===r.Attr?(e.attributes||(e.attributes={}),e.attributes[this._options.caseSensitiveAttr?t.name:t.name.toLowerCase()]=t.data):(n=this._copyElement(t),e.children||(e.children=[]),e.children.push(n),this.isEmptyTag(n)||this._tagStack.push(n),t.type===r.Tag&&(this._lastTag=n));else e=this._tagStack.last(),t.type===r.Attr?(e.attributes||(e.attributes={}),e.attributes[this._options.caseSensitiveAttr?t.name:t.name.toLowerCase()]=t.data):(e.children||(e.children=[]),e.children.push(this._copyElement(t)));else t.type===r.Tag?"/"!=t.name.charAt(0)&&(n=this._copyElement(t),this.dom.push(n),this.isEmptyTag(n)||this._tagStack.push(n),this._lastTag=n):t.type===r.Attr&&this._lastTag?(this._lastTag.attributes||(this._lastTag.attributes={}),this._lastTag.attributes[this._options.caseSensitiveAttr?t.name:t.name.toLowerCase()]=t.data):this.dom.push(this._copyElement(t))}},i.prototype._options=null,i.prototype._callback=null,i.prototype._done=!1,i.prototype._tagStack=null,t(n,i),n.prototype.done=function(){var t,e={},i=a.getElementsByTagName(function(t){return"rss"==t||"feed"==t},this.dom,!1);if(i.length&&(t=i[0]),t){if("rss"==t.name){e.type="rss",t=t.children[0],e.id="";try{e.title=a.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(t){}try{e.link=a.getElementsByTagName("link",t.children,!1)[0].children[0].data}catch(t){}try{e.description=a.getElementsByTagName("description",t.children,!1)[0].children[0].data}catch(t){}try{e.updated=new Date(a.getElementsByTagName("lastBuildDate",t.children,!1)[0].children[0].data)}catch(t){}try{e.author=a.getElementsByTagName("managingEditor",t.children,!1)[0].children[0].data}catch(t){}e.items=[],a.getElementsByTagName("item",t.children).forEach(function(t,i,n){var o={};try{o.id=a.getElementsByTagName("guid",t.children,!1)[0].children[0].data}catch(t){}try{o.title=a.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(t){}try{o.link=a.getElementsByTagName("link",t.children,!1)[0].children[0].data}catch(t){}try{o.description=a.getElementsByTagName("description",t.children,!1)[0].children[0].data}catch(t){}try{o.pubDate=new Date(a.getElementsByTagName("pubDate",t.children,!1)[0].children[0].data)}catch(t){}e.items.push(o)})}else{e.type="atom";try{e.id=a.getElementsByTagName("id",t.children,!1)[0].children[0].data}catch(t){}try{e.title=a.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(t){}try{e.link=a.getElementsByTagName("link",t.children,!1)[0].attributes.href}catch(t){}try{e.description=a.getElementsByTagName("subtitle",t.children,!1)[0].children[0].data}catch(t){}try{e.updated=new Date(a.getElementsByTagName("updated",t.children,!1)[0].children[0].data)}catch(t){}try{e.author=a.getElementsByTagName("email",t.children,!0)[0].children[0].data}catch(t){}e.items=[],a.getElementsByTagName("entry",t.children).forEach(function(t,i,n){var o={};try{o.id=a.getElementsByTagName("id",t.children,!1)[0].children[0].data}catch(t){}try{o.title=a.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(t){}try{o.link=a.getElementsByTagName("link",t.children,!1)[0].attributes.href}catch(t){}try{o.description=a.getElementsByTagName("summary",t.children,!1)[0].children[0].data}catch(t){}try{o.pubDate=new Date(a.getElementsByTagName("updated",t.children,!1)[0].children[0].data)}catch(t){}e.items.push(o)})}this.dom=e}n.super_.prototype.done.call(this)};var a={testElement:function(t,e){if(!e)return!1;for(var i in t)if(t.hasOwnProperty(i))if("tag_name"==i){if(e.type!==r.Tag)return!1;if(!t.tag_name(e.name))return!1}else if("tag_type"==i){if(!t.tag_type(e.type))return!1}else if("tag_contains"==i){if(e.type!==r.Text&&e.type!==r.Comment&&e.type!==r.CData)return!1;if(!t.tag_contains(e.data))return!1}else if(!e.attributes||!t[i](e.attributes[i]))return!1;return!0},getElements:function(t,e,i,n){function o(t){return function(e){return e==t}}if(i=void 0===i||null===i||!!i,n=isNaN(parseInt(n))?-1:parseInt(n),!e)return[];var r,s=[];for(var l in t)"function"!=typeof t[l]&&(t[l]=o(t[l]));if(a.testElement(t,e)&&s.push(e),n>=0&&s.length>=n)return s;if(i&&e.children)r=e.children;else{if(!(e instanceof Array))return s;r=e}for(var c=0;c<r.length&&(s=s.concat(a.getElements(t,r[c],i,n)),!(n>=0&&s.length>=n));c++);return s},getElementById:function(t,e,i){var n=a.getElements({id:t},e,i,1);return n.length?n[0]:null},getElementsByTagName:function(t,e,i,n){return a.getElements({tag_name:t},e,i,n)},getElementsByTagType:function(t,e,i,n){return a.getElements({tag_type:t},e,i,n)}};o.Parser=e,o.HtmlBuilder=i,o.RssBuilder=n,o.ElementType=r,o.DomUtils=a}(),Array.prototype.find||(Array.prototype.find=function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,i=Object(this),n=i.length>>>0,o=arguments[1],r=0;r<n;r++)if(e=i[r],t.call(o,e,r,i))return e}),Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),i=this,n=function(){},o=function(){return i.apply(this instanceof n?this:t,e.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(n.prototype=this.prototype),o.prototype=new n,o}),function(){var t,e;window.RG={Calendar:{Units:{}},Models:{},Collections:{},Commands:{},Controllers:{},Popovers:null,Renderer:{},Factories:{},Validators:{},DTO:{},FSM:{},Interactions:{},Views:{Calendar:{},CustomAvailability:{},Downtimes:{},Dialogs:{},Factories:{},Filters:{},Resource:{},Selectors:{}},Routers:{},Support:{},Utils:{},Parsers:{},Variables:{lastRenderCall:new Date,colorSets:{},DowntimeType:{publicHoliday:"Public holiday",vacation:"Vacation (personal)",personalHoliday:"Holiday (personal)",maternity:"Maternity/paternity leave",sick:"Sick leave",compassionate:"Compassionate leave"},Validation:{Project:{Archived:"Sorry, this project has been archived and can't be scheduled beyond the date when it was archived."},Client:{Archived:"Sorry, this client has been archived and can't be scheduled beyond the date when it was archived."}},MaximumDowntimeLength:parseInt(null!=(t=window.validationData)?t.MaximumDowntimeLength:void 0)||365,MaximumCustomAvailabilityLength:parseInt(null!=(e=window.validationData)?e.MaximumCustomAvailabilityLength:void 0)||365},initialize:function(t){this.router=new RG.Routers.Calendar({root:t}),Backbone.history.start()},scrollToDate:function(t){window.location.hash=t},scrollToToday:function(){var t;t=$("aside").width()-1,setTimeout(function(){return $(window).scrollLeft($(".cal-unit.current").offset().left-t)},500)},getApiRoot:function(){return"/v1/"},getCurrentAccount:function(){return null!=this._currentAccount?this._currentAccount:this._currentAccount=new RG.Models.Account({subdomain:window.location.host.substr(0,window.location.host.indexOf(".")),downtimes:window.downtimes})},getLayerHeight:function(){var t;return(null!=(t=document.getElementById("calendar"))?t.classList.contains("detailed"):void 0)?72:38},getUnitWidth:function(){var t;return(null!=(t=document.getElementById("calendar"))?t.classList.contains("detailed"):void 0)?160:40},resizeBookingWidths:function(t){window.dateController.triggerChange(),window.resources.each(function(t){return t.trigger("change",t)})},resizeCards:function(){null==this.cardResizer&&(this.cardResizer=new RG.Utils.CardResizer),RG.backburner.debounce("resizeCards",this.cardResizer.resize,100)},getDateAtClientX:function(t){var e,i,n;for(i=document.elementFromPoint(t,134),e=$(i).closest(".cal-unit").data("date"),n=144;!e&&n<$(window).height();)i=document.elementFromPoint(t,n),$(i).closest(".booking").hasClass("ui-draggable-dragging")||(e=$(i).closest(".resources--cal-unit").data("date")),n+=10;return RG.Utils.BookingMerger.getDateFromStr(e)},getCurrentResource:function(){var t;return t=$("#calendar").hasClass("detailed")?180:200,RG.getResourceAtClientY(t)},setCurrentResource:function(t){var e,i;i=$(".resource-line[data-resource-id="+t.cid+"]"),
e=$("#calendar").hasClass("detailed")?135:167,$(window).scrollTop(i.offset().top-e)},getResourceAtClientY:function(t){var e;return e=$(document.elementFromPoint(1,t)).closest(".resource"),window.resources.find(function(t){return t.cid===e.data("resource-id")})},setHoverElement:function(t){this._currentHover!==t&&window.requestAnimationFrame(function(e){return function(){var i;null!=(i=e._currentHover)&&i.classList.remove("hover"),e._currentHover=t,e._currentHover.classList.add("hover")}}(this))},updateLongBookings:function(){var t,e,i,n,o,r,s,a,l;for(s=window.resources.models,e=0,n=s.length;e<n;e++)for(l=s[e],a=l.bookings.models,i=0,o=a.length;i<o;i++)t=a[i],r=t.getSavedDateRange(),r.getNumberOfDays()>RG.Utils.numberOfVisibleDays()&&t.trigger("reset")},moveToDate:function(t){var e;e=$(".cal-unit[data-date="+RG.Utils.DateFormatter.getISODate(t)+"]"),$(window).scrollLeft(e.offset().left-250)},spin:function(t,e){null==e&&(e={lines:9,length:3,width:2,radius:2,corners:1,rotate:0,speed:1,shadow:!1,hwaccel:!1,left:"160px"}),window.requestAnimationFrame(function(i){return function(){i.stopSpinners(),t&&(i.Variables.spinner=new Spinner(e).spin(t))}}(this))},stopSpinners:function(){window.requestAnimationFrame(function(t){return function(){t.Variables.spinner&&(t.Variables.spinner.stop(),t.Variables.spinner=null)}}(this))},getStylesheet:function(){return this._stylesheet?this._stylesheet:this._stylesheet=function(){var t;return t=document.createElement("style"),t.appendChild(document.createTextNode("")),document.head.appendChild(t),t.sheet}()},closeAllSelections:function(){var t,e;RG.Utils.select2Close($(".select2-drop-active"),!0),null!=(t=$(".match-type-select.select2-container-active"))&&null!=(e=t.data("select2"))&&e.close(),$(".filters").removeClass("open")},closeSelectedOptions:function(){var t,e;RG.Utils.select2Close($(".select2-drop-active"),!0),null!=(t=$(".match-type-select.select2-container-active"))&&null!=(e=t.data("select2"))&&e.close()},clearStaleDropdowns:function(){$(".select2-drop-active").select2("enable",!1).select2("enable",!0)},closeAllDropdowns:function(){$(".years-dropdown").removeClass("open"),$(".color-by.dropdown").removeClass("open"),$(".right-menu li.dropdown.open").removeClass("open"),$(".filters").removeClass("open")},closeControlDropdowns:function(){$(".right-menu li.dropdown.open").removeClass("open"),$(".years-dropdown").removeClass("open"),$(".color-by.dropdown").removeClass("open")},backburner:new backburner.Backburner(["layers","resizeCards","render","renderCheck"]),getBookingById:function(t){var e,i,n,o,r,s,a,l;for(s=window.resources.models,i=0,o=s.length;i<o;i++)for(l=s[i],a=l.bookings.models,n=0,r=a.length;n<r;n++)if(e=a[n],e.id===t)return e}}}.call(this),function(){RG.Factories.AvailabilityManager=function(){function t(t){this.resource=t}return t.prototype.create=function(){return new RG.Utils.AvailabilityManager({availablePeriods:this.resource.availablePeriods,customAvailablePeriods:this.resource.customAvailablePeriods,overtimes:this.resource.overtimes,downtimes:this.resource.downtimes,resource:this.resource,timeZone:this.resource.getTimeZone()})},t}()}.call(this),function(){RG.Validators.CustomAvailabilityLengthValidator=function(){function t(){}return t.prototype.validate=function(t){return t.getDateRange().getNumberOfDays()<=RG.Variables.MaximumCustomAvailabilityLength?($(t.el).find(".error").hide(),!0):($(t.el).find(".error").text("Woah there, you're changing the availability for over a year. It is much better to make this type of change to the resource's \"normal availability\" which you can edit in the Resources section. Alternatively, you can make multiple changes here with each one spanning less than a year.").show(),!1)},t}()}.call(this),function(){RG.Validators.DowntimeLengthValidator=function(){function t(){}return t.prototype.validate=function(t){return t.dateRangeSelector.getDateRange().getNumberOfDays()<=RG.Variables.MaximumDowntimeLength?($(t.el).find(".error").hide(),!0):($(t.el).find(".error").text("Woah there, you're changing the availability for over a year. It is much better to make this type of change to the resource's \"normal availability\" which you can edit in the Resources section. Alternatively, you can make multiple changes here with each one spanning less than a year.").show(),!1)},t}()}.call(this),function(){RG.Utils.AvailabilityToggle=function(){function t(t,e){this.linesView=t,this.bToggle=new RG.Utils.BinaryToggle(e,"availabilityToggle"),this.title=this.toggleTitle(this.bToggle.mode),this.analytics=window.analytics||{track:function(){return console.log("Analytics not initialized")}}}return t.prototype.toggleTitle=function(t){return t?"Hide Availability":"Show Availability"},t.prototype.toggle=function(){return this.bToggle.toggle(),this.title=this.toggleTitle(this.bToggle.mode),this._refreshCalendar(),this._track()},t.prototype.shouldRenderUtilisation=function(){return this.bToggle.mode},t.prototype._refreshCalendar=function(){return setTimeout(function(t){return function(){var e,i,n;return n=t.linesView.dateController._startDate(),i=t.linesView.dateController._endDate(),e=new RG.Utils.DateRange(n,i),t.linesView.collection.each(function(t){return t.availability.trigger("refresh",e)})}}(this),0)},t.prototype._track=function(){return setTimeout(function(t){return function(){return t.analytics.track("Toggled Availability Bar")}}(this),1e3)},t}()}.call(this),function(){RG.Utils.BinaryToggle=function(){function t(t,e){this.mode=null!=t&&t,this.storageString=null!=e?e:"binaryToggle"}return t.prototype.toggle=function(){return this.mode=!this.mode,window.localStorage[this.storageString]=this.mode},t}()}.call(this),function(){RG.Utils.BookingDataParser={boot:function(t){var e,i,n,o,r,s;return this.host=t,this.lastPoll=new Date,this.pollId=0,this.resourcesToReset={},this.bookingsEtag=this.resourcesEtag=this.downtimesEtag=null,this.lastResourceBookingRender={},o={calendar:1},window.location.hash&&(o.date=window.location.hash.replace("#","")),r=o.date?new Date(o.date):new Date,isNaN(r)&&(r=new Date),i={},n=Q.promise(function(t){return $.ajax("/schedule/bootstrap",{data:o,timeout:3e4,success:function(e,n,o){var r,s,a,l;for(window.currentUserDate.set(e.today),RG.Variables.dataDateRange=new RG.Utils.DateRange(RG.Utils.BookingDataParser.getDateFromStr(e.start_date),RG.Utils.BookingDataParser.getDateFromStr(e.end_date)),l=["today","end_date","start_date"],r=0,a=l.length;r<a;r++)s=l[r],delete e[s];return i=_.extend(i,e),t()},error:function(t){return 400===t.status&&"Bad Request"===t.statusText?alert(t.responseText):$("body").html(t.responseText)}})}),s=Q.promise(function(t){return $.ajax(RG.getApiRoot()+"/resources?detail=1&limit=0",{timeout:3e4,success:function(e,n,o){var r;return r=o.getResponseHeader("CustomETag"),i=_.extend(i,{resources:JSON.stringify(e),resources_etag:r}),t()},error:function(t){return 400===t.status&&"Bad Request"===t.statusText?alert(t.responseText):$("body").html(t.responseText)}})}),e=Q.promise(function(t){var e,n,o,s;return o=new Date(r),o.setDate(o.getDate()-28),s=RG.Utils.DateFormatter.getISODate(o),e=new Date(r),e.setDate(e.getDate()+84),n=RG.Utils.DateFormatter.getISODate(e),$.ajax(RG.getApiRoot()+"/bookings?start_date="+s+"&end_date="+n+"&limit=0&calendar=1",{timeout:3e4,success:function(e,n,o){var r;return r=o.getResponseHeader("CustomETag"),i=_.extend(i,{bookings:JSON.stringify(e),bookings_etag:r}),t()},error:function(t){return 400===t.status&&"Bad Request"===t.statusText?alert(t.responseText):$("body").html(t.responseText)}})}),Q.allSettled([n,s,e]).then(function(){return RG.Utils.BookingDataParser.parse(i).then(function(){var t;return $("#calendar").show(),RG.resizeCards(),t=50,window.resourceScroller=new RG.Utils.InfiniteResourceScroller($(window),$(document),window.resourcePaginator,o.resources,t),window.resourceScroller.start()})})},parse:function(t){return Q.promise(function(e){return function(i){var n,o,r;e.setupEtags(t),o={};for(n in t)r=t[n],o[n]=$.parseJSON(r);return e.setupTimeZones(o),e.setupBookers(o),e.setupDeletedBookers(o),e.setupDowntimeTypes(o),e.setupNotice(o),e.setupResourceTypes(o),e.setupClients(o),e.setupDeletedClients(o),e.setupProjects(o),e.setupDeletedProjects(o),e.setupResources(o),e.setupDowntimes(o.downtimes),e.setupFilters(o),e.setupDefaultBookingHours(),setTimeout(function(){return RG.initialize($("#calendar")),i()},1)}}(this))},setupEtags:function(t){return RG.Utils.BookingDataParser.resourcesEtag=t.resources_etag,RG.Utils.BookingDataParser.downtimesEtag=t.downtimes_etag,RG.Utils.BookingDataParser.bookingsEtag=t.bookings_etag,delete t.resources_etag,delete t.downtimes_etag,delete t.bookings_etag},setupTimeZones:function(t){return window.timeZones=new RG.Collections.TimeZones(t.time_zones)},setupDefaultBookingHours:function(){var t,e,i,n,o,r,s,a,l,c,u,h,d;for(u=window.resourceTypes.models,d=[],o=0,r=u.length;o<r;o++)h=u[o],"Person"===h.get("name")?(t=window.localStorage)[s="Duration:"+h.get("name")]||(t[s]=480):(e=window.localStorage)[a="Duration:"+h.get("name")]||(e[a]=60),(i=window.localStorage)[l="TimeRange:StartTime:"+h.get("name")]||(i[l]=540),d.push((n=window.localStorage)[c="TimeRange:EndTime:"+h.get("name")]||(n[c]=600));return d},getDateFromStr:function(t){var e,i,n;return n=parseInt(t.substr(0,4),10),i=parseInt(t.substr(5,2),10),e=parseInt(t.substr(8,2),10),new Date(n,i-1,e)},setupNotice:function(t){return window.onboardingNotice=t.notice},setupDowntimeTypes:function(t){return window.downtimeTypes.reset(t.downtime_types)},setupDowntimes:function(t){var e,i;return e=RG.Utils.BookingDataParser.getDateFromStr,i=new RG.Parsers.DowntimeParser(t,e,window.downtimes,window.timeZones,window.downtimeTypes),i.parse()},setupFilters:function(t){var e;return e=new RG.Parsers.SavedFilterParser(t.saved_filters,window.savedFilters),e.parse()},setupBookers:function(t){var e;return e=new RG.Parsers.BookerParser(t.users,t.resources,window.bookers),e.parse()},setupDeletedBookers:function(t){var e;return e=new RG.Parsers.DeletedBookerParser(t.deleted_bookers,window.deletedBookers),e.parse()},setupResourceTypes:function(t){var e;return e=new RG.Parsers.ResourceTypeParser(t.resource_types,window.resourceTypes),e.parse()},setupResources:function(t){var e,i,n;return e=RG.Utils.BookingDataParser.getDateFromStr,this.bookingBuilder=new RG.Parsers.BookingBuilder(e,new RG.Parsers.DurationParser(e),window.projects,window.clients,window.deletedProjects,window.deletedClients,window.bookers,window.deletedBookers),i={resourceTypes:window.resourceTypes,clients:window.clients,projects:window.projects,bookingParser:new RG.Parsers.BookingParser(t.bookings,this.bookingBuilder),customFieldParser:new RG.Parsers.CustomFieldParser,availablePeriodParser:new RG.Parsers.AvailablePeriodParser(e),customAvailablePeriodParser:new RG.Parsers.CustomAvailablePeriodParser(e),overtimeParser:new RG.Parsers.OvertimeParser(t.overtimes,e)},n=new RG.Parsers.ResourceParser(t.resources,window.resources,i),n.parse()},setupClients:function(t){var e;return e=new RG.Parsers.ClientParser(t.clients,t.clients_archived,window.clients),e.parse()},setupDeletedClients:function(t){var e;return e=new RG.Parsers.DeletedClientParser(t.deleted_clients,window.deletedClients),e.parse()},setupProjects:function(t){var e;return e=new RG.Parsers.ProjectParser(t.projects,t.projects_archived,window.clients.models,window.projects),e.parse()},setupDeletedProjects:function(t){var e;return e=new RG.Parsers.DeletedProjectParser(t.deleted_projects,window.clients.models,window.deletedProjects),e.parse()},processRawBookingData:function(t){var e,i,n,o,r,s,a,l,c,u,h,d,p;for(c=window.resources.models,p=[],n=0,s=c.length;n<s;n++){for(h=c[n],o=0,a=t.length;o<a;o++)if(i=t[o],i.resource_id===h.get("id")){for(d=!1,u=h.bookings.models,r=0,l=u.length;r<l;r++)if(e=u[r],i.id===e.get("id")){d=!0;break}d||h.bookings.add(this.bookingBuilder.build(i),{silent:!0})}p.push(h.bookings.trigger("reset"))}return p},resourcesPoll:function(t){return $.ajax("/v1/"+RG.Utils.BookingDataParser.host+"/resources?detail=1&limit=0",{headers:{"If-None-Match":RG.Utils.BookingDataParser.resourcesEtag},timeout:3e4,success:function(e,i,n){var o;if(!t())return RG.Utils.BookingDataParser.resourcesEtag=n.getResponseHeader("CustomETag"),o=!1,RG.backburner.run(function(){var t,i,r,s,a,l,c,u,h,d,p,f,g,m,v,y,w,b,k,D,C;if(200!==n.status)return!0;for(d=new Date(RG.Utils.BookingDataParser.lastPoll),d.setSeconds(RG.Utils.BookingDataParser.lastPoll.getSeconds()-8),D=[],c=0,p=e.length;c<p;c++)if(k=e[c],new Date(k.updated_at)>d&&(C=window.resources.findWhere({id:k.id}))){for(m=C.attributes.bookedClients.map(function(t){return t.id}).sort(),v=C.attributes.bookedProjects.map(function(t){return t.id}).sort(),C.set("bookedClients",window.clients.select(function(t){return _.contains(k.booked_client_ids,t.id)})),C.set("bookedProjects",window.projects.select(function(t){return _.contains(k.booked_project_ids,t.id)})),_.isEqual(m,k.booked_client_ids.sort())&&_.isEqual(v,k.booked_project_ids.sort())||(o=!0),r=[],w=k.available_periods,u=0,f=w.length;u<f;u++)t=w[u],i=new RG.Models.AvailablePeriod({weekDay:t.week_day,startTime:t.start_time,endTime:t.end_time,validFrom:RG.Utils.BookingDataParser.getDateFromStr(t.valid_from)}),t.valid_until&&i.set({validUntil:RG.Utils.BookingDataParser.getDateFromStr(t.valid_until)}),r.push(i);for(_.isEqual(RG.Utils.getModelAttributes(r),RG.Utils.getModelAttributes(C.availablePeriods.models))||C.availablePeriods.reset(r),l=[],b=k.custom_available_periods,h=0,g=b.length;h<g;h++)s=b[h],a=new RG.Models.CustomAvailablePeriod({weekDay:s.week_day,startTime:s.start_time,endTime:s.end_time,date:RG.Utils.BookingDataParser.getDateFromStr(s.date),creator_id:s.creator_id}),l.push(a);_.isEqual(RG.Utils.getModelAttributes(l),RG.Utils.getModelAttributes(C.customAvailablePeriods.models))||C.customAvailablePeriods.reset(l),k.overtimes?(y=new RG.Parsers.OvertimeParser(k.overtimes,RG.Utils.BookingDataParser.getDateFromStr),D.push(y.parse(C,k.overtimes))):D.push(void 0)}return D}),o?window.resources.trigger("change:booked"):void 0}})},downtimesPoll:function(t,e){return window.rgFeatures.TimeOff?(null==e&&(e=new RG.Utils.DateRange(RG.Utils.firstVisibleDate(),RG.Utils.lastVisibleDate())),$.ajax("/v1/"+RG.Utils.BookingDataParser.host+"/downtimes",{headers:{"If-None-Match":RG.Utils.BookingDataParser.downtimesEtag},timeout:3e4,data:{from:encodeURIComponent(e.startDate.format("YYYY-MM-DD")),to:encodeURIComponent(e.endDate.format("YYYY-MM-DD"))},success:function(e,i,n){if(!t())return RG.Utils.BookingDataParser.downtimesEtag=n.getResponseHeader("CustomETag"),200!==n.status||void RG.Utils.BookingDataParser.setupDowntimes(e)}})):Q.delay(0)},bookingsPoll:function(t){var e;return e=new Date,$.ajax("/v1/"+RG.Utils.BookingDataParser.host+"/bookings",{headers:{"If-None-Match":RG.Utils.BookingDataParser.bookingsEtag},timeout:3e4,data:{start_date:encodeURIComponent(RG.Utils.firstVisibleDate().format("YYYY-MM-DD")),end_date:encodeURIComponent(RG.Utils.lastVisibleDate().format("YYYY-MM-DD")),calendar:1},success:function(e,i,n){if(!t())return RG.Utils.BookingDataParser.bookingsEtag=n.getResponseHeader("CustomETag"),RG.backburner.run(function(){var i;return 200!==n.status||(i=new Date(RG.Utils.BookingDataParser.lastPoll),i.setSeconds(RG.Utils.BookingDataParser.lastPoll.getSeconds()-8),window.resources.each(function(i){var n,o,r;return o=e.filter(function(t){return t.resource_id===i.id}),n=e.filter(function(t){return t.resource_id===i.id}).map(function(t){return t.id}),r=i.bookings.filter(function(t){return n.indexOf(t.get("id"))===-1}),o.forEach(function(e){var n,o,r,s,a,l,c;if(n=i.bookings.findWhere({id:e.id}),null==n&&(n=new RG.Models.Booking),r=new Date(e.updated_at),(null!=(c=n.get("updatedAt"))?c.getTime():void 0)!==r.getTime())return a={id:e.id,notes:e.notes,startDate:RG.Utils.BookingDataParser.getDateFromStr(e.start_date),endDate:RG.Utils.BookingDataParser.getDateFromStr(e.end_date),refreshable:e.refreshable,createdAt:new Date(e.created_at),updatedAt:r,client:null,project:null,booker:null},e.project_id?(l=window.projects.find(function(t){return t.id===e.project_id}),l?a.project=l:a.project=window.deletedProjects.findWhere({id:e.project_id})):e.client_id&&(s=window.clients.find(function(t){return t.id===e.client_id}),s?a.client=s:a.client=window.deletedClients.findWhere({id:e.client_id})),o=window.bookers.findWhere({id:e.booker.id}),o?a.booker=o:a.booker=window.deletedBookers.findWhere({id:e.booker.id}),RG.renderer.enqueue(new RG.Renderer.ResourceDateLock(i,a.startDate,a.endDate),function(){var o;if(!t())return o=new RG.Parsers.DurationParser(RG.Utils.BookingDataParser.getDateFromStr),o.parse(n,e),n.set(a),n.collection!==i.bookings&&i.bookings.add(n),n.collection=i.bookings})}),RG.renderer.enqueue(new RG.Renderer.ResourceDateLock(i,RG.Utils.firstVisibleDate(),RG.Utils.lastVisibleDate()),function(){if(!t())return r.forEach(function(t){return i.bookings.remove(t)})})}))})}})},todayPoll:function(){return Q.Promise(function(t,e,i){return $.ajax("/v1/today",{success:function(e,i,n){return window.currentUserDate.set(e),t("Today poll data processed")},error:function(t,i,n){return e(new Error("Status code for today poll was "+i))}})})},updateCalendar:function(t){var e;return e=function(){return t!==RG.Utils.BookingDataParser.pollId},this.todayPoll(),this.resourcesPoll(e),this.bookingsPoll(e),this.downtimesPoll(e)},renderResource:function(t,e){return RG.Utils.interactionInProgress()?Q.delay(100).then(function(){return RG.Utils.BookingDataParser.renderResource(t,e)}):(t.availability.trigger("reset"),e.resolve())},poll:function(){return RG.Utils.BookingDataParser.pollPromise()},expirePolls:function(){return this.pollId+=1},pollPromise:function(){return this.expirePolls(),function(t){return Q.Promise(function(e,i,n){return Q.delay(100).then(function(){return RG.Utils.bookingBeingSaved()?i(new Error("bookingBeingSaved")):RG.Utils.BookingDataParser.updateCalendar(t).then(function(){return RG.Utils.BookingDataParser.resourcesToReset={},RG.Utils.BookingDataParser.lastPoll=new Date,e("pollComplete")}).catch(function(t){return i(t)})})}).catch(function(t){if(RG.Utils.BookingDataParser.resourcesToReset={},_.contains(["staleData","interactionInProgress"],t.message))return RG.Utils.BookingDataParser.pollPromise()})}(this.pollId)}}}.call(this),function(){RG.Utils.BookingMerger={getDateFromStr:function(t){return RG.Utils.BookingDataParser.getDateFromStr(t)},merge:function(t,e){var i;return i=[],_.each(e,function(e){var n,o,r,s,a,l,c,u,h;for(n=new RG.Models.Booking({id:e.id,notes:e.notes,startDate:RG.Utils.BookingMerger.getDateFromStr(e.start_date),endDate:RG.Utils.BookingMerger.getDateFromStr(e.end_date),refreshable:e.refreshable}),n.set({booker:window.bookers.findWhere({id:e.booker.id})}),e.project_id?(u=window.projects.find(function(t){return t.id===e.project_id}),u&&n.set({project:u})):e.client_id&&(o=window.clients.find(function(t){return t.id===e.client_id}),o&&n.set({client:o})),a=[],h=e.durations,l=0,c=h.length;l<c;l++)s=h[l],r=RG.Utils.BookingMerger.getDateFromStr(s.date),s.start_time||0===s.start_time?a.push(new RG.Models.FixedDuration({date:r,startTime:s.start_time,endTime:s.end_time,waiting:s.waiting})):a.push(new RG.Models.Duration({date:r,minutes:s.duration,waiting:s.waiting}));return n.durations.reset(a),t.remove(t.findWhere({id:n.id})),t.add(n,{merge:!0}),i.push(n)}),i}},Date.fromISO=function(t){return RG.Utils.BookingMerger.getDateFromStr(t)}}.call(this),function(){RG.Utils.BookingPopoverPlacer=function(){function t(t){this.event=t}return t.prototype.getCalUnit=function(){return this.calUnit||(this.calUnit=this._findCalUnit())},t.prototype.createAnchor=function(t){var e,i,n,o,r;return i=t.className,this.getCalUnit(),e=$(document.createElement("div")).addClass("dropdown-anchor").addClass(i),this.calUnit.append(e),r=this.event.pageY-this.calUnit.offset().top,this.booking?(n=this.booking.outerHeight(),o=this.booking.offset(),e.callback=function(t){return function(i){return i&&(n=0),!t.adjustedHeight&&RG.Utils.isZoomedIn()&&(n-=n/4,t.adjustedHeight=!0),e.offset({top:o.top+n})}}(this),e):(e.offset({top:this.calUnit.offset().top+r}),e)},t.prototype._findCalUnit=function(){var t,e,i,n,o;for(e=[],o=$(this.event.target);!o.hasClass("resources--cal-unit");)o.hasClass("booking")&&(this.booking=o),e.push(o),o.css("visibility","hidden"),o=$(document.elementFromPoint(this.event.clientX,this.event.clientY));for(i=0,n=e.length;i<n;i++)t=e[i],t.css("visibility","visible");return this.calUnit=o},t}()}.call(this),function(){RG.Utils.BookingService={reset:function(t,e,i,n,o){return t.project_id&&alert(RG.Variables.Validation.Project.Archived),t.client_id&&alert(RG.Variables.Validation.Client.Archived),i.set(n),i.set({saving:!1}),i.durations.reset(o),e.bookings.remove(i,{silent:!0}),e.bookings.add(i)},isolate:function(t,e,i){var n;return n=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1),RG.Utils.DateComparator.equalsYMD(t.getDateRange().startDate,e)?RG.Utils.BookingService.split(t,n,function(t){return"function"==typeof i?i(t[0]):void 0}):RG.Utils.DateComparator.equalsYMD(t.getDateRange().endDate,e)?RG.Utils.BookingService.split(t,e,function(t){return"function"==typeof i?i(t[1]):void 0}):RG.Utils.BookingService.split(t,e,function(t){var e;return e=t[1],RG.Utils.BookingService.split(e,n,function(t){return"function"==typeof i?i(t[0]):void 0})})},split:function(t,e,i){var n;return n={date:RG.Utils.DateFormatter.getISODate(e)},t.set("saving",!0),$.ajax(RG.getApiRoot()+("/bookings/"+t.id+"/split"),{method:"PUT",data:n,dataType:"json",headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")},success:function(e){return function(e){var n;return n=RG.Utils.BookingMerger.merge(t.collection,e),window.requestAnimationFrame(function(){return"function"==typeof i?i(n):void 0})}}(this),error:function(t){return function(t){return alert(t.responseText),"function"==typeof i?i():void 0}}(this)})},setBookingStartDate:function(t,e,i){return RG.Utils.BookingService.setBookingAttributes(t,{start_date:RG.Utils.DateFormatter.getISODate(e)},i)},setBookingEndDate:function(t,e,i){return RG.Utils.BookingService.setBookingAttributes(t,{end_date:RG.Utils.DateFormatter.getISODate(e)},i)},deleteBooking:function(t,e){return t.set("saving",!0),$.ajax(RG.getApiRoot()+("/bookings/"+t.get("id")),{method:"DELETE",headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")},success:function(i){return function(){var i;return i=t.collection,null!=i&&(i.remove(t),i.predictWaitingList(),i.trigger("reset")),"function"==typeof e&&e(t),RG.Popovers.popoverActive=!1,window.update()}}(this)})},deleteSingleDate:function(t,e,i){var n,o;return n=function(t){return"function"==typeof i&&i(t),window.update()},RG.Utils.DateComparator.equalsYMD(t.getDateRange().startDate,e)?(o=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1),RG.Utils.BookingService.setBookingStartDate(t,o,n)):RG.Utils.DateComparator.equalsYMD(t.getDateRange().endDate,e)?(o=new Date(e.getFullYear(),e.getMonth(),e.getDate()-1),RG.Utils.BookingService.setBookingEndDate(t,o,n)):RG.Utils.BookingService.isolate(t,e,function(t){return RG.Utils.BookingService.deleteBooking(t,i)})},setBookingAttributes:function(t,e,i){return t.set("saving",!0),$.ajax(RG.getApiRoot()+("/bookings/"+t.id),{method:"PUT",data:e,dataType:"json",headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")},success:function(e){return function(e){return RG.Utils.BookingMerger.merge(t.collection,[e]),"function"==typeof i?i():void 0}}(this)})}}}.call(this),function(){RG.Utils.CardResizer=function(){function t(){}return t.prototype.resize=function(){var t;t=document.getElementById("calendar"),t&&(null==this.cardsContainer&&(this.cardsContainer=t.querySelector("aside")),null==this.linesContainer&&(this.linesContainer=document.getElementById("resources")),window.requestAnimationFrame(function(t){return function(){var e,i,n,o,r,s;for(s=t.linesContainer.querySelectorAll(".resource-line"),n=0,o=s.length;n<o;n++)r=s[n],e=t.cardsContainer.querySelector(".resource[data-resource-id="+r.attributes["data-resource-id"].value+"]"),i=r.offsetHeight+"px",e&&r&&e.style.height!==i&&(e.style.height=i)}}(this)))},t}()}.call(this),function(){RG.Utils.ColorSource=function(){function t(){_.extend(this,Backbone.Events),this.mode="project"}return t.prototype.colorBy=function(t){return this.mode=t,this.trigger("change:mode")},t.prototype.getColorForBooking=function(t){var e,i,n,o,r,s,a;return i="#BFBFBF","project"===this.mode?i=null!=(n=t.get("project"))?n.get("color"):void 0:"client"===this.mode?i=(null!=(o=t.get("client"))?o.get("color"):void 0)||(null!=(r=t.get("project"))&&null!=(s=r.get("client"))?s.get("color"):void 0):"booker"===this.mode&&(i=null!=(a=t.get("booker"))?a.get("color"):void 0),null!=(e=RG.Variables.colorSets)[i]?e[i]:e[i]=new RG.Utils.Color(i||"#BFBFBF")},t}(),RG.Utils.Color=function(){function t(t){this.hexColor=t}return t.prototype.textLight=35,t.prototype.toString=function(){return tinycolor(this.hexColor).toHexString()},t.prototype.getColor=function(){return tinycolor(this.hexColor).toHexString()},t.prototype.getBackgroundColor=function(){var t;return t=tinycolor(this.hexColor).toHsv(),t.s>.05?(t.s=.5,t.v=1):t.v=.9,tinycolor(t).toHexString()},t.prototype.getBorderColor=function(){var t;return t=tinycolor(this.hexColor).toHsv(),t.s>.05?(t.s=.15,t.v=.9):t.v=.85,tinycolor(t).toHexString()},t.prototype.getTextColor=function(){var t;return t=tinycolor(this.hexColor).toHsl(),t.l=this.textLight,tinycolor(t).toHexString()},t}()}.call(this),function(){RG.Utils.DatePopoverPlacer=function(){function t(t,e,i){this.resource=t,this.date=e,null==i&&(i={}),this.options=i,this.offsetTop=i.offsetTop}return t.prototype.getCalUnit=function(){return this.calUnit||(this.calUnit=this._findCalUnit())},t.prototype.createAnchor=function(t){var e,i;return i=(null!=t?t:{}).className,this.getCalUnit(),e=$(document.createElement("div")).addClass("dropdown-anchor").addClass(i),this.calUnit.append(e),this.offsetTop&&e.offset({top:this.offsetTop}),e},t.prototype._findCalUnit=function(){var t,e,i;return e=window.dateController._startDate(),i=window.dateController._endDate(),this.date.getTime()<e.getTime()?this.date=e:this.date.getTime()>i.getTime()&&(this.date=i),t=RG.Utils.DateFormatter.getISODate(this.date),$(".resource-line[data-resource-id="+this.resource.cid+"]").find(".resources--cal-unit[data-date="+t+"]")},t}()}.call(this),function(){RG.Utils.DayName=function(){function t(t){this.dayNumber=t}var e,i;return e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t.prototype.toString=function(){return e[this.dayNumber]},t.prototype.fullName=function(){return i[this.dayNumber]},t}()}.call(this),function(){RG.Utils.DowntimeCalendarUpdater=function(){function t(t,e,i,n,o){this.currentUserTimeZone=t,this.account=e,this.resources=i,this.timeZones=n,this.affectedResources=o}return t.prototype.update=function(t,e,i){var n;return n=this.account.downtimes.findWhere({id:t.id}),null!=n&&n.set(t.attributes),this._updateCalendar(t,e,i)},t.prototype.add=function(t,e,i){return this.account.downtimes.add(t),this._updateCalendar(t,e,i)},t.prototype._updateCalendar=function(t,e,i){var n,o,r;return n=t.getDurations(),r=n[0].getDate(),o=n[n.length-1].getDate(),RG.renderer.enqueue(new RG.Renderer.ResourcesDateLock(this.resources,r,o),function(t){return function(){return t._updateBookings(e,i)}}(this)),this.updateAffectedResources()},t.prototype._updateBookings=function(t,e){var i,n,o;for(n=0,o=t.length;n<o;n++)i=t[n],e?i.removeAndUpdateBooking():i.set({waiting:!0})},t.prototype.updateAffectedResources=function(){var t,e,i;i=window.resourcePaginator.getVisibleResourceIds(),t=this.affectedResources.filter(function(t){return i.indexOf(t.id)!==-1}),e=t.forEach(function(t){t.refreshDowntimes()})},t}()}.call(this),function(){RG.Utils.DowntimePresenter=function(){function t(t){this.downtime=t,this.from=this.downtime.get("from"),this.to=this.downtime.get("to"),this.startTime=this.downtime.get("startTime"),this.endTime=this.downtime.get("endTime")}return t.prototype.dateTimeString=function(t){var e,i;return i="",this.startTime>0&&(i="("+this._startMinutesToTime()+")"),e="",this.endTime<1440&&(e="("+this._endMinutesToTime()+")"),RG.Utils.DateComparator.equalsYMD(this.from,this.to)?0===this.startTime&&1440===this.endTime?"All day":this._startMinutesToTime()+" - "+this._endMinutesToTime():this._sameYear()?RG.Utils.DateFormatter.getShortDate(this.from)+" "+i+" - "+t(this.to)+" "+e:t(this.from)+" "+i+" - "+t(this.to)+" "+e},t.prototype._startMinutesToTime=function(){return RG.Utils.TimeFormatter.formatFixedTime(this.startTime)},t.prototype._endMinutesToTime=function(){return RG.Utils.TimeFormatter.formatFixedTime(this.endTime)},t.prototype._sameYear=function(){return this.from.getYear()===this.to.getYear()},t}()}.call(this),function(){RG.Utils.EventPopoverPlacer=function(){function t(t,e,i){this.event=t,null==i&&(i={}),this.targetClass=e,this.options=i}return t.prototype.getCalUnit=function(){return this.calUnit||(this.calUnit=this._findCalUnit())},t.prototype.createAnchor=function(t){var e,i,n,o;return i=(null!=t?t:{}).className,this.getCalUnit(),e=$(document.createElement("div")).addClass("dropdown-anchor").addClass(i),this.calUnit.append(e),this.target?(n=this.target.outerHeight(),o=this.target.offset(),e.callback=function(t){return function(i){var r;return i&&(n=0+t.options.topAdjustment),r=(null!=o?o.top:void 0)||0,e.offset({top:r+n})}}(this),e):(e.offset({top:this.calUnit.offset().top+this._relativeY()}),e)},t.prototype._findCalUnit=function(){var t,e,i,n,o,r;if(i=[],r=$(this.event.target),r.hasClass("time-available")||r.closest(".utilisation").length)return this.calUnit=r.closest(".resources--cal-unit"),this.target=this.calUnit.find("."+this.targetClass),this.calUnit;for(t=0;!r.hasClass("resources--cal-unit")&&5!==t;)t+=1,r.hasClass(this.targetClass)&&(this.target=r),i.push(r),r.css("visibility","hidden"),r=$(document.elementFromPoint(this.event.clientX,this.event.clientY));for(n=0,o=i.length;n<o;n++)e=i[n],e.css("visibility","visible");return this.calUnit=r},t.prototype._relativeY=function(){var t,e;return e=this.event.pageY-this.calUnit.offset().top,t=this.calUnit[0].getBoundingClientRect(),(e<0||e>t.height)&&("utilisation"===this.targetClass&&(t=this.calUnit.find(".utilisation")[0].getBoundingClientRect()),e=t.height/2),e},t}()}.call(this),function(){RG.Utils.FilterSource=function(){function t(t,e,i,n){this.resourceTypes=t,this.resources=e,this.projects=i,this.clients=n,_.extend(this,Backbone.Events)}return t.prototype.getCategories=function(){return new RG.Collections.FilterCategories(this.buildCategories())},t.prototype.buildCategories=function(){var t,e,i,n,o,r;for(t=[this._getProjectsFilterCategory(),this._getClientsFilterCategory()],r=this.resourceTypes.sortBy(function(t){var e;return"Person"===t.get("name")?"0":null!=(e=t.get("name"))?e.toLowerCase():void 0}),i=0,n=r.length;i<n;i++)o=r[i],e=new RG.Models.FilterCategory({name:o.getName(),tag:o}),e.optionGroups.reset(this._getOptionGroups(o)),t.push(e);return t},t.prototype._getClientsFilterCategory=function(){var t,e,i;return i=new RG.Models.OptionGroup({name:"Client",multiple:!0}),t=this.clients.filter(function(t){return!t.get("archived")}),i.options.reset(_.map(t,function(t){return new RG.Models.FilterOption({id:t.id,name:t.get("name"),tag:"client",ref:t})})),e=new RG.Models.FilterCategory({name:"Clients"}),e.optionGroups.reset([i]),e},t.prototype._getProjectsFilterCategory=function(){var t,e,i;return e=new RG.Models.OptionGroup({name:"Project",multiple:!0}),i=this.projects.filter(function(t){return!t.get("archived")}),e.options.reset(_.map(i,function(t){return new RG.Models.FilterOption({id:t.id,name:t.get("name"),tag:"project",ref:t})})),t=new RG.Models.FilterCategory({name:"Projects"}),t.optionGroups.reset([e]),t},t.prototype._getOptionGroups=function(t){var e,i,n;return i=t.customFields.map(function(e){
var i,n,o;return i=!("Person"===t.getName()&&"Job Title"===e.get("name")),n=new RG.Models.OptionGroup({name:e.get("name"),multiple:i,tag:e}),o=e.customFieldOptions.map(function(t){return new RG.Models.FilterOption({id:t.id,name:t.get("name"),tag:"custom_field_option",ref:t,customField:e})}),n.options.reset(o),n}),e=new RG.Models.OptionGroup({name:"Name",multiple:!1}),n=this.resources.filter(function(e){return e.get("resourceType")===t&&e.isBookable()}).map(function(t){return new RG.Models.FilterOption({id:t.id,name:t.get("name"),tag:"resource",ref:t})}),e.options.reset(n),i.unshift(e),i},t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};RG.Utils.InfiniteResourceScroller=function(){function e(e,i,n,o,r){this.$window=e,this.$document=i,this.paginator=n,this.resources=o,this.resourceLimit=r,this.reSizeCards=t(this.reSizeCards,this),this.resizing=!1,this.scrolling=!1,this.nextButton=$(".next-resources"),this.prevButton=$(".previous-resources"),this.buttons=[this.nextButton,this.prevButton]}return e.prototype.start=function(){var t;return this.nextButton.on("click",function(t){return function(){return t.showLoadButton(),setTimeout(function(){return t.scrollDown()},50)}}(this)),this.prevButton.on("click",function(t){return function(){return t.showLoadButton(),setTimeout(function(){return t.scrollUp()},50)}}(this)),t=function(t){return function(){if(!RG.Variables.scrollingVertical)return RG.Variables.scrollingVertical=!0,window.requestAnimationFrame(function(){return t.$window.scrollTop()<10&&!t.paginator.isAtTop()?(t.prevButton.fadeIn(),t.nextButton.fadeOut()):t.$window.scrollTop()+t.$window.height()>=$(document).height()&&!t.paginator.isAtBottom()?(t.prevButton.fadeOut(),t.nextButton.fadeIn()):(t.prevButton.fadeOut(),t.nextButton.fadeOut()),RG.Variables.scrollingVertical=!1})}}(this),window.onscroll=t,this.$window.on("touchmove",t)},e.prototype.scrollDown=function(){return this.resource=this.paginator.getPaginatedCollection().last(),setTimeout(function(t){return function(){var e;return e=t.paginator.loadSize,t.paginator.loadSize=10,t.paginator.next(),t.paginator.loadSize=e,t.trimToLimit("down"),t.reSizeCards()}}(this))},e.prototype.scrollUp=function(){return this.resource=this.paginator.getPaginatedCollection().first(),null==this.headersHeight&&(this.headersHeight=$("#header").height()+_.reduce($("header"),function(t,e){return e.scrollHeight+t},0)),setTimeout(function(t){return function(){var e;return e=t.paginator.loadSize,t.paginator.loadSize=10,t.paginator.previous(),t.paginator.loadSize=e,t.trimToLimit("up"),setTimeout(function(){return RG.setCurrentResource(t.resource)}),t.reSizeCards()}}(this))},e.prototype.displayNext=function(){return this.nextButton.show()},e.prototype.displayPrev=function(){return this.prevButton.show()},e.prototype.showLoadButton=function(){return window.requestAnimationFrame(function(t){return function(){return _.each(t.buttons,function(t){return t.addClass("loading")})}}(this))},e.prototype.hideLoadButton=function(){return window.requestAnimationFrame(function(t){return function(){return _.each(t.buttons,function(t){return t.removeClass("loading"),t.hide()})}}(this))},e.prototype.trimToLimit=function(t){var e;return this.paginator.getPaginatedCollection().length>this.resourceLimit&&(e=this.paginator.loadSize,this.paginator.loadSize=this.resourceLimit,"down"===t?this.paginator.trimTop():this.paginator.trimBottom(),this.paginator.loadSize=e),setTimeout(function(t){return function(){return t.hideLoadButton()}}(this),3e3)},e.prototype.reSizeCards=function(){if(!this.resizing)return this.resizing=!0,this.paginator.getPaginatedCollection().trigger("reset"),RG.resizeCards(),setTimeout(function(t){return function(){return RG.resizeCards(),setTimeout(function(){return RG.resizeCards(),setTimeout(function(){return RG.resizeCards(),t.resizing=!1},800)},200)}}(this),50)},e}()}.call(this),function(){RG.Utils.scrollSize=function(){var t;return t=$("#calendar").hasClass("detailed")?2:7,$(".cal-unit").width()*t+t},RG.Utils.firstVisibleDate=function(){return moment(window.dateController._startDate())},RG.Utils.lastVisibleDate=function(){return moment(window.dateController._endDate())},RG.Utils.visibleDateRange=function(){return new RG.Utils.DateRange(window.dateController._startDate(),window.dateController._endDate())},RG.Utils.DayInMilliSeconds=864e5,RG.Utils.numberOfVisibleDays=function(){return RG.Utils.visibleDateRange().getNumberOfDays()},RG.Utils.isMonday=function(t){return 1===t.attributes.date.getDay()},RG.Utils.endTime=function(t){return+window.localStorage.startTime+ +window.localStorage[t]},RG.Utils.generateTimeUnitId=function(t,e){return e=RG.Utils.DateFormatter.getISODate(e),t+"-"+e},RG.Utils.bookingBeingSaved=function(){return _.find(_.flatten(_.collect(window.resources.models,function(t){return t.bookings})),function(t){return _.find(t.models,function(t){return t.get("saving")})})},RG.Utils.enableScrolling=function(t){return null==t&&(t=!0),t?$("body").removeClass("stop-scrolling"):$("body").addClass("stop-scrolling")},RG.Utils.getLastUsedFilters=function(){return localStorage.lastFiltersAst?JSON.parse(localStorage.lastFiltersAst):[]},RG.Utils.delayResizeCards=function(){return null!=RG.Variables.cardSizeTimeout&&clearTimeout(RG.Variables.cardSizeTimeout),RG.Variables.cardSizeTimeout=setTimeout(function(){return RG.resizeCards(),setTimeout(function(){return $(window).trigger("scroll")},2e3)},200)},RG.Utils.getModelAttributes=function(t){return t.map(function(t){return t.attributes})},RG.Utils.getTodayISO=function(){return RG.Utils.DateFormatter.getISODate(new Date)},RG.Utils.renderChecker=function(){return RG.Variables.lastRenderCall=new Date},RG.Utils.unitsRendered=function(){return new Date-RG.Variables.lastRenderCall>50},RG.Utils.isZoomedIn=function(){return"detailed"===window.localStorage.zoomLevel}}.call(this),function(){RG.Utils.Permissions={getAdapter:function(){return new RG.Utils.CalendarPermissionsAdapter(window.currentUserId,window.userPermissions)},canManage:function(t){return this.getAdapter().canManage(t)},canAdd:function(t){return this.canAddBooking()},canAddBooking:function(t){return"manage_all"===window.userPermissions.bookingRights||"manage_own"===window.userPermissions.bookingRights},canAddProject:function(t){return"manage_all"===window.userPermissions.projectRights||"manage_own"===window.userPermissions.projectRights},canAddClient:function(t){return"manage_all"===window.userPermissions.clientRights||"manage_own"===window.userPermissions.clientRights},canManageResource:function(t){return"manage_all"===window.userPermissions.resourceRights||"manage_own"===window.userPermissions.resourceRights&&window.currentResourceInstanceId===t.id},canManageDowntime:function(t){return this.getAdapter().canManageDowntime(t)},canAddDowntime:function(){return this.getAdapter().canAddDowntime()},canMoveClashBookingToWaitingList:function(){var t;return(t=this.getAdapter()).canMoveClashBookingToWaitingList.apply(t,arguments)},canDeleteClashBooking:function(){var t;return(t=this.getAdapter()).canDeleteClashBooking.apply(t,arguments)}}}.call(this),function(){RG.Utils.profile=function(t,e){return null==t&&(t="downtime"),null==e&&(e=3680550),console.profile(t),console.time(t),setTimeout(function(){var i;return i=$(".booking[data-booking-id="+e+"]"),i.length?window.requestAnimationFrame(function(){return console.profileEnd(),console.timeEnd("downtime")}):RG.Utils.profile(t,e)},10)}}.call(this),function(){RG.Utils.ResourceFilter=function(){function t(t){this.resourceTypes=t}return t.prototype.filterBy=function(t,e){return t.select(function(t){return function(i){return t._resourceVisible(i,e)}}(this))},t.prototype._resourceVisible=function(t,e){var i,n,o,r,s,a,l,c,u,h,d,p,f,g;return!!t.isBookable()&&(0===e.length||(l=this._getOptionsFromAst(e),p=_.filter(l,function(t){return"resource"===t.get("tag")}),s=_.filter(l,function(t){return"custom_field_option"===t.get("tag")}),c=_.filter(l,function(t){return"project"===t.get("tag")}),i=_.filter(l,function(t){return"client"===t.get("tag")}),f=_.filter(e,function(t){return"all"===t.matchType&&!t.selectedOptions}),u=!1,c.length>0?(d=_.filter(e,function(t){return t.selectedOptions&&"project"===t.selectedOptions[0].get("tag")})[0],a="any"===d.matchType?_.any:_.all,h=_.map(c,function(t){return t.get("ref")}),u=a(h,function(e){return t.isBookedOnProject(e)})):u=0===i.length,n=!1,i.length>0?(r=_.filter(e,function(t){return t.selectedOptions&&"client"===t.selectedOptions[0].get("tag")})[0],a="any"===r.matchType?_.any:_.all,o=_.map(i,function(t){return t.get("ref")}),n=a(o,function(e){return t.isBookedOnClient(e)})):n=0===c.length,!(!u&&!n)&&(g=[!0],(p.length>0||s.length>0||f.length>0)&&(g=this.resourceTypes.map(function(i){return function(i){var n,o,r,c,u,h,d,g,m;if(u=!1,g=_.filter(p,function(t){return t.get("ref").get("resourceType")===i}),d=_.filter(s,function(t){return t.get("ref").get("resourceType")===i}),m=_.filter(f,function(t){return t.resourceType===i}),m.length>0&&(u=_.any(m,function(e){return e.resourceType===t.get("resourceType")}),!u))return!1;if(g.length>0&&(u=_.include(_.map(g,function(t){return t.get("ref")}),t),!u))return!1;if(d.length>0&&t.get("resourceType")===i){f=_.filter(e,function(t){return t.selectedOptions&&t.selectedOptions[0].get("ref").get("resourceType")===i&&"custom_field_option"===t.selectedOptions[0].get("tag")}),n=_.groupBy(f,function(t){return t.optionGroup.cid}),c=[];for(r in n)h=n[r],l=_.flatten(_.map(h,function(t){return t.selectedOptions})),o=_.map(l,function(t){return t.get("ref")}),a=null,a="any"===h[0].matchType?_.any:_.all,c.push(a(o,function(e){return t.hasCustomFieldOption(e)}));u=_.all(c,function(t){return t===!0})}return u}}(this))),_.any(g,function(t){return t===!0}))))},t.prototype._getOptionsFromAst=function(t){return _.compact(_.flatten(_.map(t,function(t){return t.selectedOptions})))},t.prototype._getCustomFieldOptionsFromTokens=function(t){var e;return e=[],_.each(t,function(t){return _.each(t,function(t,i){return e.push([i,t])})}),_.compact(_.map(e,function(t){return function(e){var i,n,o,r,s,a,l;return r=e[0],l=e[1],a=r.substr(0,r.indexOf(">")-1),o=r.substr(r.indexOf(">")+2),s=t.resourceTypes.findWhere({name:a}),i=s.customFields.findWhere({name:o}),null!=i?n=i.customFieldOptions.findWhere({name:l}):null}}(this)))},t}()}.call(this),function(){RG.Utils.ResourcePaginator=function(){function t(t,e){this.resources=t,this.loadSize=e}return t.prototype.getPaginatedCollection=function(){return this._collection?this._collection:(this._collection=new RG.Collections.ResourceInstances,this.sourceCollection=this.resources,this.resources.on("change:visible",function(t){return function(){return t.resources.any(function(t){return!t.visible})?(t.sourceCollection=new RG.Collections.ResourceInstances(t.resources.filter(function(t){return t.visible})),t._collection.reset(t.sourceCollection.first(t.loadSize))):t.reset(),t._collection.trigger("change:visible")}}(this)),this._collection)},t.prototype.getVisibleResourceIds=function(){return this.getPaginatedCollection().map(function(t){return t.id})},t.prototype.isAtBottom=function(){return this._collection.models[this._collection.length-1]===this.sourceCollection.models[this.sourceCollection.length-1]},t.prototype.isAtTop=function(){return this._collection.models[0]===this.sourceCollection.models[0]},t.prototype.reset=function(){return this.resources.any(function(t){return!t.visible})?(this.sourceCollection=new RG.Collections.ResourceInstances(this.resources.filter(function(t){return t.visible})),this._collection.reset(this.sourceCollection.first(this.loadSize))):this.sourceCollection=this.resources,this._collection.reset(this.sourceCollection.first(this.loadSize))},t.prototype.next=function(){var t,e,i,n,o,r,s,a;if(!this.isAtBottom()){for(o=[],t=this.sourceCollection.indexOf(this._collection.models[this._collection.length-1])+1,a=[],e=i=r=t,s=t+this.loadSize-1;r<=s?i<=s:i>=s;e=r<=s?++i:--i)n=this.sourceCollection.models[e],n?a.push(this._collection.add(n)):a.push(void 0);return a}},t.prototype.previous=function(){var t,e,i,n,o,r,s;if(!this.isAtTop()){for(t=this.sourceCollection.indexOf(this._collection.models[0])-1,s=[],e=i=o=t,r=t-this.loadSize;o<=r?i<=r:i>=r;e=o<=r?++i:--i)n=this.sourceCollection.models[e],n?s.push(this._collection.unshift(n)):s.push(void 0);return s}},t.prototype.overLimitCount=function(){return this._collection.length-+(this.loadSize/2)},t.prototype.trimTop=function(){var t;return t=this.overLimitCount(),_.each(_.range(0,t),function(t){return function(e){return t._collection.remove(t._collection.models[0])}}(this))},t.prototype.trimBottom=function(){var t;return t=this.overLimitCount(),_.each(_.range(0,t),function(t){return function(e){return t._collection.remove(t._collection.models[t._collection.length-1])}}(this))},t.prototype.start=function(){var t;return t=$(window)},t}()}.call(this),function(){SpriteSpinner=function(t,e){var i=t.children[0];return this.interval=e.interval||10,this.diameter=e.diameter||i.width,this.count=0,this.el=t,i.setAttribute("style","position:absolute"),t.style.width=this.diameter+"px",t.style.height=this.diameter+"px",this},SpriteSpinner.prototype.start=function(){var t=this,e=0,i=this.el.children[0];this.el.display="block",t.loop=setInterval(function(){19==e&&(e=0),i.style.top=-t.diameter*e+"px",e++},this.interval)},SpriteSpinner.prototype.stop=function(){clearInterval(this.loop),this.el.style.display="none"},document.SpriteSpinner=SpriteSpinner}(),function(){RG.Utils.SteppedExecutor=function(){function t(){}return t.prototype.stepEach=function(t,e){var i;return null==e&&(e=10),i=_.map(t,function(t,i){var n;return n=e*(i+1),Q.delay(n).then(t).catch(function(t){return console.log(t)})}),Q.allSettled(i)},t}()}.call(this),function(){RG.Utils.TimePeriodsCalculator=function(){function t(t){this.collection=t,this._minutes={},this._dateMinutes={},this.collection.on("add remove reset change:startTime change:endTime maxAvailabilityChanged",function(t){return function(){return t._minutes={},t._dateMinutes={}}}(this))}return t.prototype.sum=function(t){var e,i,n,o,r,s;if(i=t.valueOf().toString(),this._dateMinutes[i])return this._dateMinutes[i];for(o=0,s=this.collection.models,e=0,n=s.length;e<n;e++)r=s[e],r.isValidOn(t)&&(o+=r.getMinutesAvailable());return this._dateMinutes[i]=o},t.prototype.availableMinutes=function(t){var e,i,n,o,r,s,a,l,c,u,h;if(r=t.startDate.valueOf().toString()+":"+t.endDate.valueOf().toString(),this._minutes[r])return this._minutes[r];for(h=t.startDate,a=0,e=new Date(h),i=n=0,c=t.getNumberOfDays()-1;0<=c?n<=c:n>=c;i=0<=c?++n:--n){for(u=this.collection.models,o=0,s=u.length;o<s;o++)l=u[o],l.isValidOn(e)&&(a+=l.getMinutesAvailable());e.setDate(e.getDate()+1)}return this._minutes[r]=a},t}()}.call(this),function(){RG.Utils.VisualSearchFacetAdapter=function(){function t(t,e,i){this.value=t,this.category=e,this.facet=i}return t.prototype.toSearchFacet=function(){var t;return t={category:this.category,label:{toString:function(t){return function(){return t.facet}}(this),trim:function(t){return function(){return{value:t.value,toString:function(){return t.category+" > "+t.facet}}}}(this)}}},t}()}.call(this),function(){RG.Parsers.AvailablePeriodParser=function(){function t(t){this.dateStringProcessor=t}return t.prototype.parse=function(t,e){var i,n,o,r,s,a;for(o=[],a=e.available_periods,r=0,s=a.length;r<s;r++)i=a[r],n=new RG.Models.AvailablePeriod({weekDay:i.week_day,startTime:i.start_time,endTime:i.end_time,validFrom:this.dateStringProcessor(i.valid_from)}),i.valid_until&&n.set({validUntil:this.dateStringProcessor(i.valid_until)}),o.push(n);return t.availablePeriods.setModels(o),o},t}()}.call(this),function(){var t=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};RG.Parsers.BookerParser=function(){function e(t,e,i){this.usersJson=t,this.resourcesJson=e,this.collection=i}return e.prototype.parse=function(){var e,i,n,o,r,s,a,l,c;for(e=this.resourcesJson.filter(function(t){return t.human===!0}),i=e.map(function(t){return t.email}),n=[],s=this.usersJson,o=0,r=s.length;o<r;o++)c=s[o],n.push(new RG.Models.Booker({id:c.id,name:c.first_name+" "+c.last_name,imageUrl:c.image,color:c.color,archived:(a=c.email,t.call(i,a)<0)}));return null!=(l=this.collection)&&l.reset(n),n},e}()}.call(this),function(){RG.Parsers.BookingBuilder=function(){function t(t,e,i,n,o,r,s,a){this.dateStringProcessor=t,this.durationParser=e,this.projects=i,this.clients=n,this.deletedProjects=o,this.deletedClients=r,this.bookers=s,this.deletedBookers=a}return t.prototype.build=function(t){var e,i,n,o,r,s,a,l,c,u,h,d,p,f,g,m,v,y,_,w,b,k,D,C,R,T,x;if(i=new RG.Models.Booking,e={id:t.id,notes:t.notes,startDate:this.dateStringProcessor(t.start_date),endDate:this.dateStringProcessor(t.end_date),createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at),refreshable:t.refreshable},b=!1,s=!1,t.project_id){for(k=this.projects.models,l=0,d=k.length;l<d;l++)if(w=k[l],w.id===t.project_id){e.project=w,b=!0;break}}else if(t.client_id)for(D=this.clients.models,c=0,p=D.length;c<p;c++)if(r=D[c],r.id===t.client_id){e.client=r,s=!0;break}if(!b&&t.project_id){for(C=this.deletedProjects.models,u=0,f=C.length;u<f;u++)if(w=C[u],w.id===t.project_id){e.project=w;break}}else if(!s&&t.client_id)for(R=this.deletedClients.models,h=0,g=R.length;h<g;h++)if(r=R[h],r.id===t.client_id){e.client=r;break}for(o=!1,T=this.bookers.models,y=0,m=T.length;y<m;y++)if(n=T[y],n.id===t.booker.id){e.booker=n,o=!0;break}if(!o)for(x=this.deletedBookers.models,_=0,v=x.length;_<v;_++)if(a=x[_],a.id===t.booker.id){e.booker=a;break}return i.attributes=e,i.id=e.id,this.durationParser.parse(i,t),i},t}()}.call(this),function(){RG.Parsers.BookingParser=function(){function t(t,e){this.bookingsJson=t,this.bookingBuilder=e}return t.prototype.parse=function(t){var e,i,n,o,r,s,a,l;for(n=0,r=t.length;n<r;n++){for(l=t[n],i=[],a=this.bookingsJson,o=0,s=a.length;o<s;o++)e=a[o],e.resource_id===l.id&&i.push(this.bookingBuilder.build(e));l.bookings.setModels(i)}},t}()}.call(this),function(){RG.Parsers.ClientParser=function(){function t(t,e,i){this.clientsJson=t,this.archiveClientsJson=e,this.collection=i}return t.prototype.parse=function(){var t,e,i,n,o,r,s,a,l,c;for(i=[],a=this.clientsJson,n=0,r=a.length;n<r;n++)e=a[n],t=new RG.Models.Client,t.attributes={id:e.id,name:e.name,color:e.color},t.id=e.id,i.push(t);for(l=this.archiveClientsJson,o=0,s=l.length;o<s;o++)e=l[o],t=new RG.Models.Client,t.attributes={id:e.id,name:e.name,color:e.color,archived:!0},t.id=e.id,i.push(t);return null!=(c=this.collection)&&c.reset(i),i},t}()}.call(this),function(){RG.Parsers.CustomAvailablePeriodParser=function(){function t(t){this.dateStringProcessor=t}return t.prototype.parse=function(t,e){var i,n,o,r,s,a;for(o=[],a=e.custom_available_periods,r=0,s=a.length;r<s;r++)i=a[r],n=new RG.Models.CustomAvailablePeriod({date:this.dateStringProcessor(i.date),startTime:i.start_time,endTime:i.end_time}),o.push(n);return t.customAvailablePeriods.setModels(o),o},t}()}.call(this),function(){RG.Parsers.CustomFieldParser=function(){function t(){}return t.prototype.parse=function(t,e,i){var n,o,r,s,a,l,c,u,h,d;for(l=e.selected_custom_field_options,u=[],o=0,s=l.length;o<s;o++){for(h=l[o],c=_.flatten(i.customFields.map(function(t){return t.customFieldOptions.models})),d=null,r=0,a=c.length;r<a;r++)if(n=c[r],h.id===n.id){d=n;break}u.push(t.customFieldOptions.add(d))}return u},t}()}.call(this),function(){RG.Utils.CustomFieldParser=function(){function t(){}return t.prototype.parse=function(t,e,i){var n,o,r,s,a,l,c,u,h,d;for(l=e.selected_custom_field_options,u=[],o=0,s=l.length;o<s;o++){for(h=l[o],c=_.flatten(i.customFields.map(function(t){return t.customFieldOptions.models})),d=null,r=0,a=c.length;r<a;r++)if(n=c[r],h.id===n.id){d=n;break}u.push(t.customFieldOptions.add(d))}return u},t}()}.call(this),function(){RG.Parsers.DeletedBookerParser=function(){function t(t,e){this.deletedBookerJson=t,this.collection=e}return t.prototype.parse=function(){var t,e,i,n,o,r;if(t=[],this.deletedBookerJson){for(n=this.deletedBookerJson,e=0,i=n.length;e<i;e++)r=n[e],t.push(new RG.Models.Booker({id:r.id,name:r.first_name+" "+r.last_name}));null!=(o=this.collection)&&o.reset(t)}return t},t}()}.call(this),function(){RG.Parsers.DeletedClientParser=function(){function t(t,e){this.deletedClientsJson=t,this.collection=e}return t.prototype.parse=function(){var t,e,i,n,o,r;for(e=[],o=this.deletedClientsJson,i=0,n=o.length;i<n;i++)t=o[i],e.push(new RG.Models.Client({id:t.id,name:t.name,color:t.color}));return null!=(r=this.collection)&&r.reset(e),e},t}()}.call(this),function(){RG.Parsers.DeletedProjectParser=function(){function t(t,e,i){this.deletedProjectsJson=t,this.clientModels=e,this.collection=i}return t.prototype.parse=function(){var t,e,i,n,o,r,s;for(o=[],r=this.deletedProjectsJson,t=0,e=r.length;t<e;t++)i=r[t],n=new RG.Models.Project({id:i.id,name:i.name,color:i.color}),i.client_id&&n.set({client:_.find(this.clientModels,function(t){return t.get("id")===i.client_id})}),o.push(n);return null!=(s=this.collection)&&s.reset(o),o},t}()}.call(this),function(){RG.Parsers.DowntimeParser=function(){function t(t,e,i,n,o){this.downtimesJson=t,this.dateStringProcessor=e,this.collection=i,this.timezones=n,this.downtimeTypes=o}return t.prototype.parse=function(){var t,e;return t=this.downtimesJson.map(function(t){return t.id}),e=this.collection.models.filter(function(e){return t.indexOf(e.id)===-1}),e.forEach(function(t){return function(e){var i,n,o,r,s;for(t.collection.remove(e),o=e.get("resourceIds"),r=[],i=0,n=o.length;i<n;i++)s=o[i],r.push(t.collection.trigger("remove:resource_id:"+s,e));return r}}(this)),this.downtimesJson.forEach(function(t){return function(e){var i,n,o,r,s,a;if(i=t.collection.findWhere({id:e.id}),i||(o=!0,i=new RG.Models.Downtime),n=t.dateStringProcessor(e.updated_at),(null!=(s=i.get("updatedAt"))?s.getTime():void 0)!==n)return r={id:e.id,from:t.dateStringProcessor(e.from),to:t.dateStringProcessor(e.to),updatedAt:t.dateStringProcessor(e.updated_at),timeZone:t.timezones.findWhere({name:e.timezone}),startTime:e.start_time,endTime:e.end_time,downtimeTypeId:e.downtime_type_id,details:e.details,state:e.state,creatorId:e.creator_id,leave:e.leave,resourceIds:e.resource_ids,downtimeType:t.downtimeTypes.findWhere({id:e.downtime_type_id})},a=window.resources.filter(function(t){return e.resource_ids.indexOf(t)!==-1}),i.id=r.id,RG.renderer.enqueue(new RG.Renderer.GlobalLock,function(){var n,s,a,l,c;if(o||_.isEqual(r,i.attributes)||i.set(r),o){for(i.attributes=r,t.collection.add(i),a=e.resource_ids,l=[],n=0,s=a.length;n<s;n++)c=a[n],l.push(t.collection.trigger("add:resource_id:"+c,i));return l}})}}(this))},t}()}.call(this),function(){RG.Parsers.DurationParser=function(){function t(t){this.dateStringProcessor=t}return t.prototype.parse=function(t,e){var i,n,o,r,s,a,l,c,u;for(r=[],c=null,u=e.durations,s=0,a=u.length;s<a;s++){if(o=u[s],n=this.dateStringProcessor(o.date),c)for(;new RG.Utils.DateRange(n,c).getNumberOfDays()>1;)i=new RG.Models.Duration,l=new Date(c),l.setDate(l.getDate()+1),i.attributes={date:l,minutes:0,waiting:!1},r.push(i),c=new Date(l);o.start_time||0===o.start_time?(i=new RG.Models.FixedDuration,i.attributes={date:n,startTime:o.start_time,endTime:o.end_time,waiting:o.waiting},r.push(i)):(i=new RG.Models.Duration,i.attributes={date:n,minutes:o.duration,waiting:o.waiting},r.push(i)),c=n}return t.durations.reset(r),r},t}()}.call(this),function(){RG.Parsers.OvertimeParser=function(){function t(t,e){this.overtimesJson=t,this.dateStringProcessor=e}return t.prototype.parse=function(t,e){var i,n,o,r,s,a;if(null==e&&(e={}),o=[],a=this._groupOvertimes()[t.id],!a)return[];for(i=0,n=a.length;i<n;i++)r=a[i],s=new RG.Models.Overtime({id:r.id,resourceInstanceId:r.resource_instance_id,date:this.dateStringProcessor(r.date),duration:r.duration,creatorId:r.creator_id}),o.push(s);return t.overtimes.setModels(o,e),o},t.prototype._groupOvertimes=function(){return this._groupedOvertimes?this._groupedOvertimes:this._groupedOvertimes=_.groupBy(this.overtimesJson,"resource_instance_id")},t}()}.call(this),function(){RG.Parsers.ProjectParser=function(){function t(t,e,i,n){this.projectsJson=t,this.archivedProjectsJson=e,this.clientModels=i,this.collection=n}return t.prototype.parse=function(){var t,e,i,n,o,r,s,a,l,c;for(s=[],a=this.projectsJson,t=0,i=a.length;t<i;t++)o=a[t],r=new RG.Models.Project,r.attributes={id:o.id,name:o.name,color:o.color},o.client_id&&(r.attributes.client=_.find(this.clientModels,function(t){return t.get("id")===o.client_id})),r.id=o.id,s.push(r);for(l=this.archivedProjectsJson,e=0,n=l.length;e<n;e++)o=l[e],r=new RG.Models.Project,r.attributes={id:o.id,name:o.name,color:o.color,archived:!0},o.client_id&&(r.attributes.client=_.find(this.clientModels,function(t){return t.get("id")===o.client_id})),r.id=o.id,s.push(r);return null!=(c=this.collection)&&c.reset(s),s},t}()}.call(this),function(){RG.Parsers.ResourceParser=function(){function t(t,e,i){this.resourcesJson=t,this.collection=e,_.extend(this,i)}return t.prototype.parse=function(){var t,e,i,n,o,r,s,a,l,c,u,h,d,p,f,g;for(g=[],i=this.resourcesJson,t=0,e=i.length;t<e;t++)h=i[t],p=null!=(n=this.resourceTypes)?n.findWhere({id:h.resource_type.id}):void 0,d="Person"===h.resource_type.name?RG.Models.HumanResourceInstance:RG.Models.ResourceInstance,f=new d({account:RG.Utils.getCurrentAccount(),id:h.id,name:h.name,type:h.job_title||h.resource_type.name,resourceType:p,human:h.human,bookable:h.bookable,vacationAllowance:h.vacation_allowance,imageUrl:h.image,timeZone:new RG.Models.TimeZone({name:h.timezone.name,offset:h.timezone.offset}),bookedClients:null!=(o=this.clients)?o.select(function(t){return _.contains(h.booked_client_ids,t.id)}):void 0,bookedProjects:null!=(r=this.projects)?r.select(function(t){return _.contains(h.booked_project_ids,t.id)}):void 0}),f.layerController=new RG.Controllers.TimeAllocationLayers(f.bookings,f.downtimes),null!=(s=this.availablePeriodParser)&&s.parse(f,h),null!=(a=this.customAvailablePeriodParser)&&a.parse(f,h),null!=(l=this.overtimeParser)&&l.parse(f),null!=(c=this.customFieldParser)&&c.parse(f,h,p),g.push(f);return null!=(u=this.bookingParser)&&u.parse(g),window.resources.setModels(g),g},t}()}.call(this),function(){RG.Parsers.ResourceTypeParser=function(){function t(t,e){this.resourceTypesJson=t,this.collection=e}return t.prototype.parse=function(){var t,e,i,n,o,r,s,a,l,c,u,h,d,p,f,g,m;for(f=[],u=this.resourceTypesJson,o=0,a=u.length;o<a;o++){for(g=u[o],m=new RG.Models.ResourceType({id:g.id,name:g.name}),h=g.custom_fields,r=0,l=h.length;r<l;r++){for(t=h[r],e=new RG.Models.CustomField({name:t.name,id:t.id}),d=t.custom_field_options,s=0,c=d.length;s<c;s++)i=d[s],n=new RG.Models.CustomFieldOption({id:i.id,name:i.value,resourceType:m,customField:e}),e.customFieldOptions.add(n);m.customFields.add(e)}f.push(m)}return null!=(p=this.collection)&&p.reset(f),f},t}()}.call(this),function(){RG.Parsers.SavedFilterParser=function(){function t(t,e){this.savedFiltersJson=t,this.collection=e}return t.prototype.parse=function(){var t,e,i,n,o,r;for(o=[],i=this.savedFiltersJson,t=0,e=i.length;t<e;t++)r=i[t],o.push(new RG.Models.SavedFilter({id:r.id,name:r.name,filter_json:r.filter_json}));return null!=(n=this.collection)&&n.reset(o),o},t}()}.call(this),function(){RG.Utils.Range=function(){function t(){}return t.prototype.getStart=function(){throw"Implement `getStart` in subclasses of Range"},t.prototype.getEnd=function(){throw"Implement `getEnd` in subclasses of Range"},t.prototype.contains=function(t){return this.getStart()<=t.getStart()&&this.getEnd()>=t.getEnd()},t.prototype.overlapsWith=function(t){return this.getEnd()>t.getStart()&&this.getStart()<t.getEnd()},t.prototype.isTouching=function(t){return this.getEnd()>=t.getStart()&&this.getStart()<=t.getEnd()},t.prototype.includes=function(t){return t&&this.getStart().valueOf()<=t.valueOf()&&this.getEnd().valueOf()>=t.valueOf()},t}()}.call(this),function(){RG.Utils.getCurrentAccount=function(){return null!=this._currentAccount?this._currentAccount:this._currentAccount=new RG.Models.Account({subdomain:window.location.host.substr(0,window.location.host.indexOf(".")),downtimes:window.downtimes})}}.call(this),function(){RG.Utils.AvailabilityManager=function(){function t(t){_.extend(this,Backbone.Events),this._maxMinutesInUnit={},this.availablePeriods=t.availablePeriods||new RG.Collections.AvailablePeriods,this.customAvailablePeriods=t.customAvailablePeriods||new RG.Collections.CustomAvailablePeriods,this.overtimes=t.overtimes||new RG.Collections.Overtimes,this.downtimes=t.downtimes||new RG.Collections.Downtimes,this.resource=t.resource,this.timeZone=t.timeZone||RG.Models.TimeZone.Current,this._minutesInDateRange={},t.ignoreEvents||(this.availablePeriods.on("add remove reset",function(t){return function(){return t._clearMaxMinutesInUnit(),t.trigger("refreshUtilisation")}}(this)),this.customAvailablePeriods.on("add remove reset",function(t){return function(){return t._clearMaxMinutesInUnit(),t.trigger("refreshUtilisation")}}(this)),this.downtimes.on("add remove change reset",function(t){return function(){return t._clearMaxMinutesInUnit()}}(this)),this.overtimes.on("add remove change reset",function(t){return function(){return t._clearMaxMinutesInUnit(),t.trigger("refreshUtilisation")}}(this)),this.downtimes.on("add",function(t){return function(e){var i;return i=e.inTimeZone(t.resource.get("timeZone")),t.trigger("refresh",new RG.Utils.DateRange(i.get("from"),i.get("to")))}}(this)),this.downtimes.on("remove",function(t){return function(e){var i;return i=e.inTimeZone(t.resource.get("timeZone")),t.trigger("refresh",new RG.Utils.DateRange(i.get("from"),i.get("to")))}}(this)),this.downtimes.on("change",function(t){return function(e){var i,n;return i=e.inTimeZone(t.resource.get("timeZone")),t.trigger("refresh",new RG.Utils.DateRange(i.get("from"),i.get("to"))),n=new RG.Models.Downtime(e.previousAttributes()),i=n.inTimeZone(t.resource.get("timeZone")),t.trigger("refresh",new RG.Utils.DateRange(i.get("from"),i.get("to")))}}(this)),this.on("add remove reset",this._clearMaxMinutesInUnit),this.on("maxAvailabilityChanged",this._flushCache))}return t.prototype.getOvertimeMinutesInDateRange=function(t){return this.overtimes.getMinutesAvailableInDateRange(t)},t.prototype.getMinutesAvailableForDate=function(t,e){var i;return null==e&&(e=null),i=new RG.Utils.DateRange(t,t),this.getMinutesAvailableInDateRange(i,e)},t.prototype.getMinutesAvailableInDateRange=function(t,e){var i,n;return null==e&&(e=null),this._minutesInDateRange[t]?this._minutesInDateRange[t]:(i=0,n=this.resource,this.getDowntimeAndAvailablePeriodAggregateForDateRange(t,e).forEach(function(t){var n,o,r,s,a,l,c,u,h,d;for(o=t.downtimes.map(function(e){return e.getTimeRange(t.date)}),h=t.periods,o.length>1&&(e=o.shift(),o=e.merge.apply(e,o)),h.length>1&&(e=h.shift(),h=e.merge.apply(e,h)),d=[],s=0,l=h.length;s<l;s++)if(u=h[s],o.length){for(r=!1,a=0,c=o.length;a<c;a++)n=o[a],u.overlapsWith(n)&&(i+=u.subtract(n),r=!0);r?d.push(void 0):d.push(i+=0|u.totalTime())}else d.push(i+=0|u.totalTime());return d}),this._minutesInDateRange[t]=i)},t.prototype.getAvailableTimeRangesInDateRange=function(t,e){var i,n,o,r,s,a,l,c,u,h,d,p,f,g,m,v,y,_,w;for(null==e&&(e=null),v=[],w=this.resource,y=this.getDowntimeAndAvailablePeriodAggregateForDateRange(t,e),s=0,c=y.length;s<c;s++)for(i=y[s],o=i.downtimes.map(function(t){return t.getTimeRange(i.date)}),g=i.periods,o.length>1&&(e=o.shift(),o=e.merge.apply(e,o)),g.length>1&&(e=g.shift(),g=e.merge.apply(e,g)),a=0,u=g.length;a<u;a++)if(f=g[a],o.length){for(r=!1,l=0,h=o.length;l<h;l++)if(n=o[l],f.overlapsWith(n)){for(_=f.subtractOne(n),p=0,d=_.length;p<d;p++)m=_[p],v.push(m);r=!0}r||v.push(f)}else v.push(f);return v},t.prototype.hasNoNormalAvailability=function(){return 0===this.availablePeriods.length},t.prototype.getMaxMinutesInUnit=function(t,e){var i,n,o,r,s,a,l,c,u,h,d,p;if(null==e&&(e=!0),
e&&this._maxMinutesInUnit[t.toString()])return this._maxMinutesInUnit[t.toString()];for(l=0,h=t.getDates(),o=0,s=h.length;o<s;o++)n=h[o],i=this.customAvailablePeriods.calculator().sum(n),u=this.availablePeriods.calculator().sum(n),i>u&&(u=i),u>l&&(l=u);if(p=this.availablePeriods.some(function(e){return e.isValidInDateRange(t)}),!p)for(d=this._getBackfilledAvailablePeriods(t.startDate),r=0,a=d.length;r<a;r++)c=d[r],u=c.getMinutesAvailable(),u>l&&(l=u);return this._maxMinutesInUnit[t.toString()]=l},t.prototype.inEarliestNormalAvailability=function(t,e){var i,n,o,r;return null==e&&(e=null),i=t.startDate.getDay(),r=e?this.availablePeriods.select(function(t){return t.getTimeRange().overlapsWith(e)}):this.availablePeriods.models,n=_.min(r,function(t){return t.get("validFrom")}),o=_.find(r,function(t){return t.get("weekDay")===i&&RG.Utils.DateComparator.equalsYMD(t.get("validFrom"),n.get("validFrom"))}),o&&t.startDate<n.get("validFrom")&&!RG.Utils.DateComparator.equalsYMD(t.startDate,n.get("validFrom"))},t.prototype._clearMaxMinutesInUnit=function(){this._maxMinutesInUnit={},this._minutesInDateRange={}},t.prototype._flushCache=function(){this._clearMaxMinutesInUnit(),this.customAvailablePeriods._minutes={}},t.prototype.getOriginalPeriodsForDate=function(t){var e;return e=this.availablePeriods.models.filter(function(e){return e.isValidOn(t)}),e.length?e:this._somePeriodsForDate(t)?[]:this._getBackfilledAvailablePeriods(t)},t.prototype.getCustomPeriodsForDate=function(t){return this.customAvailablePeriods.select(function(e){return e.isValidOn(t)})},t.prototype.getDowntimesForDateAndTimeRange=function(t,e){return this.downtimes.inTimeZone(this.getTimeZone()).forDate(t).filter(function(i){var n;return n=i.getTimeRange(t),e.overlapsWith(n)})},t.prototype.getPeriodTimeRangesForDateAndTimeRange=function(t,e){var i,n,o,r,s;for(s=[],r=this.getPeriodsForDate(t),i=0,n=r.length;i<n;i++)o=r[i],e.overlapsWith(o.getTimeRange())&&s.push(o.getTimeRange());return s},t.prototype.getDowntimeAndAvailablePeriodAggregateForDateRange=function(t,e,i){var n,o,r,s,a,l;for(null==e&&(e=new RG.Utils.TimeRange(0,1440)),null==i&&(i=null),l=t.startDate,n=[],r=s=0,a=t.getNumberOfDays()-1;0<=a?s<=a:s>=a;r=0<=a?++s:--s)o=new Date(l.getFullYear(),l.getMonth(),l.getDate()+r),i?o.getFullYear()===i&&n.push({downtimes:this.getDowntimesForDateAndTimeRange(o,e),periods:this.getPeriodTimeRangesForDateAndTimeRange(o,e),date:o}):n.push({downtimes:this.getDowntimesForDateAndTimeRange(o,e),periods:this.getPeriodTimeRangesForDateAndTimeRange(o,e),date:o});return n},t.prototype.getPeriodsForDate=function(t){var e;return e=this.getCustomPeriodsForDate(t),e.length?e:this.getOriginalPeriodsForDate(t)},t.prototype.getTimeZone=function(){return this.timeZone},t.prototype.getOvertimesForDate=function(t){var e,i,n,o,r;for(o=[],r=this.overtimes.models,e=0,i=r.length;e<i;e++)n=r[e],n.isValidOn(t)&&o.push(n);return o},t.prototype.isAvailableStartAndEndDate=function(t){var e,i;return i=new RG.Utils.DateRange(t.startDate,t.startDate),e=new RG.Utils.DateRange(t.endDate,t.endDate),this.isAvailableIn(i)&&this.isAvailableIn(e)},t.prototype.isAvailableIn=function(t,e){return null==e&&(e=null),this.getMinutesAvailableInDateRange(t,e)>0||this.inEarliestNormalAvailability(t,e)},t.prototype.intersectsWithDowntime=function(t,e){return this.downtimes.any(function(i){return function(n){return n.inTimeZone(i.resource.get("timeZone")).getTimeRange(t).overlapsWith(e)}}(this))},t.prototype._getBackfilledAvailablePeriods=function(t){var e;return e=_.chain(this.availablePeriods.models).filter(function(e){return e.isNewerThan(t)}).sort(function(t){var e;return(null!=(e=t.get("validFrom"))?e.valueOf():void 0)||0}).value(),e.some(function(t){return t.get("validUntil")})?this._getClosestOldestHistoricalPeriods(t):e.filter(function(e){return e.get("weekDay")===t.getDay()})},t.prototype._getClosestOldestHistoricalPeriods=function(t){var e,i;return e=this.availablePeriods.models.filter(function(e){return e.get("validUntil")&&e.get("weekDay")===t.getDay()&&e.isNewerThan(t)}),e=e.sort(function(t,e){return t.get("validFrom").valueOf()<e.get("validFrom").valueOf()?-1:t.get("validFrom").valueOf()===e.get("validFrom").valueOf()?0:1}),i=null,e.filter(function(t){return null==i&&(i=e[0].get("validFrom")),RG.Utils.DateComparator.equalsYMD(t.get("validFrom"),i)})},t.prototype._somePeriodsForDate=function(t){return this.availablePeriods.some(function(e){return e.isCoveringDate(t)})},t}()}.call(this),function(){RG.Utils.CalendarPermissionsAdapter=function(){function t(t,e){this.currentUserId=t,this.userPermissions=null!=e?e:{}}return t.prototype.canManage=function(t){var e;return"manage_all"===window.userPermissions.bookingRights||"manage_own"===window.userPermissions.bookingRights&&(null!=(e=t.getBooker())?e.id:void 0)===window.currentUserId},t.prototype.canAddDowntime=function(){return"manage_all"===this.userPermissions.downtimeRights||"manage_own"===this.userPermissions.downtimeRights},t.prototype.canDeleteClashBooking=function(t){return this.canMoveClashBookingToWaitingList(t)},t.prototype.canManageDowntime=function(t){var e;return"manage_all"===this.userPermissions.downtimeRights||"manage_own"===this.userPermissions.downtimeRights&&(null!=(e=t.getBooker())?e.id:void 0)===this.currentUserId},t.prototype.canMoveClashBookingToWaitingList=function(t){var e;return e=_.map(t,function(t){return function(e){return t.canManage(e)}}(this)),!_.contains(e,!1)&&this.canAddDowntime()},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Utils.DashboardPermissionsAdapter=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.canAddDowntime=function(){return["manage_all","manage_own","view"].indexOf(this.userPermissions.downtimeRights)!==-1},i.prototype.canManageDowntime=function(t){var e;return"manage_all"===this.userPermissions.downtimeRights||this.canAddDowntime()&&(null!=(e=t.getBooker())?e.id:void 0)===this.currentUserId},i.prototype.canMoveClashBookingToWaitingList=function(t){var e;return e=_.map(t,function(t){return function(e){return t.canManage(e)}}(this)),!_.contains(e,!1)&&this.canAddDowntime()},i.prototype.canDeleteClashBooking=function(t){return this.canMoveClashBookingToWaitingList(t)},i}(RG.Utils.CalendarPermissionsAdapter)}.call(this),function(){RG.Utils.DateComparator={getDateParts:function(t){return t&&[t.getFullYear(),t.getMonth(),t.getDate()]},equalsYMD:function(t,e){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}},Date.prototype.cloneYMD=function(){return new Date(this.getFullYear(),this.getMonth(),this.getDate())}}.call(this),function(){RG.Utils.DateFormatter={months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],getShortDate:function(t){return t.getDate()+" "+RG.Utils.DateFormatter.months[t.getMonth()]},getShortDateWithYear:function(t){return t.getDate()+" "+RG.Utils.DateFormatter.months[t.getMonth()]+" "+t.getFullYear()},getLongDateWithYear:function(t){return t.getDate()+" "+RG.Utils.DateFormatter.longMonths[t.getMonth()]+" "+t.getFullYear()},getISODate:function(t){var e,i,n,o;return o=function(t){var e;return e=t.toString(),1===e.length&&(e="0"+e),e},n=t.getFullYear(),i=o(t.getMonth()+1),e=o(t.getDate()),n+"-"+i+"-"+e}},Date.prototype.getISODate=function(){return RG.Utils.DateFormatter.getISODate(this)},Date.prototype.getWeek=function(){var t,e,i;return i=new Date(this.valueOf()),t=(this.getDay()+6)%7,i.setDate(i.getDate()-t+3),e=i.valueOf(),i.setMonth(0,1),4!==i.getDay()&&i.setMonth(0,1+(4-i.getDay()+7)%7),1+Math.ceil((e-i)/6048e5)}}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Utils.DateRange=function(e){function i(t,e){this.startDate=t,this.endDate=e}var n;return t(i,e),n=RG.Utils.DateFormatter.months,i.prototype.getStart=function(){return this.startDate},i.prototype.getEnd=function(){return this.endDate},i.prototype.getNumberOfDays=function(){return Math.round((this.endDate.valueOf()-this.startDate.valueOf())/86400/1e3+1)},i.prototype.getDates=function(){var t,e;for(t=new Date(this.startDate),e=[];t.getTime()<=this.endDate.getTime();)e.push(new Date(t)),t.setDate(t.getDate()+1);return e},i.prototype.overlapsWith=function(t){return this.getEnd()>=t.getStart()&&this.getStart()<=t.getEnd()},i.prototype.toString=function(){var t,e,i,o,r;return RG.Utils.DateComparator.equalsYMD(this.startDate,this.endDate)?this.startDate.getDate()+" "+n[this.startDate.getMonth()]+" "+this.endDate.getFullYear():(i=this.startDate.getMonth()===this.endDate.getMonth(),o=this.startDate.getFullYear()===this.endDate.getFullYear(),t=i&&o?"":n[this.startDate.getMonth()]+" ",e=o?"":this.startDate.getFullYear()+" ",r=n[this.endDate.getMonth()],this.startDate.getDate()+" "+t+e+"- "+this.endDate.getDate()+" "+r+" "+this.endDate.getFullYear())},i.prototype.getYears=function(){var t,e,i;return i=this.startDate.getFullYear(),t=this.endDate.getFullYear(),function(){e=[];for(var n=i;i<=t?n<=t:n>=t;i<=t?n++:n--)e.push(n);return e}.apply(this)},i.prototype.coversYear=function(t){return _.include(this.getYears(),t)},i.prototype.isValid=function(){return!(!this.startDate||!this.endDate)},i}(RG.Utils.Range)}.call(this),function(){RG.Utils.DowntimeService={createDowntime:function(t,e,i){return Q.Promise(function(n,o,r){return RG.Utils.BookingDataParser.expirePolls(),$.ajax(RG.getApiRoot()+"/downtimes",{method:"POST",headers:{"X-CSRF-Token":RG.Utils.getCSRFToken()},data:e,dataType:"json",success:function(e){return function(e){return RG.Utils.BookingDataParser.expirePolls(),t.set({id:e.id}),i.successCallback(t),n("Downtime "+t.id+" created.")}}(this),error:function(t){return function(t){var e;return e=JSON.parse(t.responseText),RG.Utils.BookingDataParser.expirePolls(),i.errorCallback(e),o("Downtime not created.")}}(this)})})},updateDowntime:function(t,e,i){return Q.Promise(function(n,o,r){return RG.Utils.BookingDataParser.expirePolls(),$.ajax(RG.getApiRoot()+"/downtimes/"+t,{method:"PATCH",headers:{"X-CSRF-Token":RG.Utils.getCSRFToken()},data:e,dataType:"json",success:function(e){return function(e){return RG.Utils.BookingDataParser.expirePolls(),i.successCallback(e),n("Downtime "+t+" updated.")}}(this),error:function(e){return function(e){var n;n={};try{return n=JSON.parse(e.responseText)}finally{RG.Utils.BookingDataParser.expirePolls(),i.errorCallback(n),o("Downtime "+t+" not updated.")}}}(this)})})},deleteSingleDate:function(t,e,i){var n,o,r,s,a,l,c,u,h,d;return RG.Utils.DateComparator.equalsYMD(e,t.get("from"))?(r=moment(e).add(1,"days")._d,a=t.get("to")):RG.Utils.DateComparator.equalsYMD(e,t.get("to"))?(r=t.get("from"),a=moment(e).subtract(1,"days")._d):(r=t.get("from"),a=moment(e).subtract(1,"days")._d),s=this._buildDowntimeParams(t,r,a),o=new RG.Models.Downtime(t.attributes),o.set({from:r,to:a,timeZone:t.get("timeZone")}),l=!RG.Utils.DateComparator.equalsYMD(e,t.get("from"))&&!RG.Utils.DateComparator.equalsYMD(e,t.get("to")),l&&(h=moment(e).add(1,"days")._d,u=new RG.Models.Downtime(_.extend(_.clone(t.attributes),{downtimeType:t.downtimeType,id:null,timeZone:t.getTimeZone(),from:h,to:t.get("to")})),d=_.extend(_.clone(s),{id:null,from:RG.Utils.DateFormatter.getISODate(h),to:t.get("to")})),c=this._buildOptions(t,o,u),n=function(t){return function(){return l?RG.Utils.DowntimeService.createDowntime(u,d,c):Q.delay(0)}}(this),RG.Utils.DowntimeService.updateDowntime(t.id,s,c).then(i).then(n).then(window.update)},deleteDowntime:function(t,e){return Q.Promise(function(i,n,o){return $.ajax(RG.getApiRoot()+"/downtimes/"+t,{method:"DELETE",timeout:3e4,headers:{"X-CSRF-Token":RG.Utils.getCSRFToken()},success:function(n){return function(){return"function"==typeof e&&e(),window.update(),i("Downtime "+t+" deleted.")}}(this)})})},split:function(t,e,i){var n,o,r,s,a,l,c;return l=null,c=moment(e).subtract(1,"days")._d,o=this._buildDowntimeParams(t,t.get("from"),c),o.end_time=1440,n=new RG.Models.Downtime(o),n.set({from:t.get("from"),to:c,endTime:1440}),s=new RG.Models.Downtime(_.extend(_.clone(t.attributes),{downtimeType:t.downtimeType,id:null,timeZone:t.get("timeZone"),from:e,to:t.get("to"),startTime:0})),a=_.extend(_.clone(o),{id:null,from:RG.Utils.DateFormatter.getISODate(e),to:RG.Utils.DateFormatter.getISODate(t.get("to")),start_time:0}),r=this._buildOptions(t,n,s),RG.Utils.DowntimeService.updateDowntime(t.id,o,r).then(function(){return RG.Utils.DowntimeService.createDowntime(s,a,r)}).then(i)},updateResources:function(t){return function(t,e,i){var n,o,r,s,a,l;for(window.downtimes.add(i),l=window.downtimes.findWhere({id:t.id}),l.set(e.attributes),n=window.resources.select(function(e){return _.include(t.get("resourceIds"),e.id)}),a=[],o=0,r=n.length;o<r;o++)s=n[o],a.push(s.refreshDowntimes());return a}}(this),_buildDowntimeParams:function(t,e,i){var n,o;return o={resource_ids:t.get("resourceIds"),creator_id:window.currentUserId,from:RG.Utils.DateFormatter.getISODate(e),to:RG.Utils.DateFormatter.getISODate(i),start_time:t.get("startTime"),end_time:t.get("endTime"),details:t.get("details"),leave:t.get("leave"),downtime_type_id:t.get("downtimeTypeId")},n=t.getTimeZoneName(),t.isLocalTimeZone()||window.currentUserTimeZone===n||(o.timezone=n),o},_buildOptions:function(t,e,i){return{successCallback:function(){return RG.Utils.DowntimeService.updateResources(t,e,i)},errorCallback:function(){}}}}}.call(this),function(){RG.Utils.isDifferentTimeZones=function(t,e){var i;return 1!==t.length&&(i=!1,i=_.any(t,function(t){return t.getTimeZoneName()!==e}))}}.call(this),function(){RG.Utils.getDowntimeTypePriority=function(t){var e;return null==(e=RG.Variables).downtimeTypes&&(e.downtimeTypes=_.values(RG.Variables.DowntimeType)),_.indexOf(RG.Variables.downtimeTypes,t)}}.call(this),function(){RG.Utils.select2Close=function(t,e){if($(".filters.active.open").length||e)return window.requestAnimationFrame(function(){var e;if(t&&t.addClass("select2-active-filter-option"),e=$("select.filter-option:not(.select2-active-filter-option)"),e.length&&e.select2("enable",!1).select2("enable",!0),t)return t.removeClass("select2-active-filter-option")})},RG.Utils.getCSRFToken=function(){return $('meta[name="csrf-token"]').attr("content")}}.call(this),function(){RG.Utils.PopoverManager=function(){function t(){this._nestedPopovers=[],this._rendererLocks=[]}return t.prototype.lock=function(){return this.locked=!0},t.prototype.unlock=function(){return this.clear(),this.locked=!1},t.prototype.set=function(t,e){var i;if(null==e&&(e=null),!this.locked)return RG.Utils.enableScrolling(!1),null!=(i=this.popover)&&i.remove(),this.removeCallback=e,this.toggle(t,e),this.popover},t.prototype._lockRenderer=function(){var t;return t=new RG.Renderer.GlobalLock,this._rendererLocks.push(t),RG.renderer.lock(t)},t.prototype._unlockRenderer=function(){var t,e,i,n;for(n=this._rendererLocks,t=0,e=n.length;t<e;t++)i=n[t],RG.renderer.unlock(i);this._rendererLocks=[]},t.prototype.nest=function(t){return this._nestedPopovers.push(t)},t.prototype.clearNest=function(){var t,e,i,n;for(n=this._nestedPopovers,t=0,e=n.length;t<e;t++)i=n[t],i.remove();return this._nestedPopovers=[]},t.prototype.setBody=function(t){return this.popover.setBodyView(t),this.popover.render()},t.prototype.clear=function(){var t;if(!this.locked)return null!=(t=this.popover)&&t.remove(),"function"==typeof this.removeCallback&&this.removeCallback(),this.popover=null,this.removeCallback=null,this._unlockRenderer(),RG.Utils.enableScrolling(!0)},t.prototype.done=function(){return this.popoverActive=!1,this.removeCallback=null,this.clear()},t.prototype.replace=function(t){if(null==t&&(t={}),!this.locked)return this.clear(),this.popoverActive=!1,t.popoverView?this.set(t.popoverView,t.removeCallback):void 0},t.prototype.toggle=function(t,e){return this.popoverActive||this.locked?(this.popoverActive=!1,"function"==typeof e&&e(),this.removeCallback=null,void this.clear()):(this.popoverActive=!0,this.popover=t,this.popover.popup(),this._lockRenderer())},t.prototype.popoverVisible=function(){var t;return!!this.popover&&(t=$(this.popover.el),t.length>0&&t.parent().length>0)},t}()}.call(this),function(){this.segmentAutolinker=function(t){var e,i,n,o,r,s,a;return r=_.unescape(t),o=new Tautologistics.NodeHtmlParser.HtmlBuilder(function(t,e){if(t)return console.log(t)}),s=new Tautologistics.NodeHtmlParser.Parser(o),s.parseComplete(t),e=function(t,e,i){var n,o,r;o=[];for(n in i)r=i[n],e=""!==r&&" "!==r?e.replace("insertallattributes"+n," "+r):e.replace("insertallattributes"+n,""),o.push(e=e.replace("insertinnercontent"+n,a(t.children,"a")||""));return o},n=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e,i;return e=16*Math.random()|0,i=3&e|8,"x"===t&&(i=e),i.toString(16)})},a=function(s,a){var l,c,u,h,d,p,f,g,m,v,y;if(t="",!s)return"";for(p={},u=0,d=s.length;u<d;u++)if(v=s[u],"text"===v.type)"a"===a?t+=_.escape(v.data):(g=_.escape(r),g=g.replace(_.escape(v.data),i(v.data)),t+=g);else if("br"===v.name)t+=_.escape("<br/>");else if("tag"===v.type){"!"===v.raw[0]&&(t+="<"+v.raw.replace(/\</g,"&lt;").replace(/\!/g,"&excl;").replace(/\>/g,"&gt;")),l="",f=v.attributes;for(c in f)y=f[c],null!==y&&(l+=c+"='"+y+"' ");h=n(),p[h]=l,m=new RG.Support.ValidTags,_.contains(m.valid_html_tags(),v.name)&&o.dom.length<2?t+=e(v,_.escape("<"+v.name+"insertallattributes"+h+">insertinnercontent"+h+"</"+v.name+">"),p):t=i(r)}return t},i=function(t){return Autolinker.link(t.replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace(/\!/g,"&excl;").replace("//n","<br/>"))},a(o.dom)}}.call(this),function(){RG.Utils.spinnerOptions={lines:9,length:10,width:5,radius:15,corners:1,rotate:0,speed:1,shadow:!1,hwaccel:!1,left:"50%",bottom:"-50%"}}.call(this),function(){RG.Utils.spinnerOverlay=function(t){var e;return e=new RG.Views.Dialogs.Overlay({attachTo:t,className:"overlay",template:function(){return""}}),new Spinner(RG.Utils.spinnerOptions).spin(e.render().el),e}}.call(this),function(){RG.Utils.TimeFormatter={formatFixedTime:function(t){var e,i,n,o;return e=Math.floor(t/60),o=Math.floor(e/12)%2===0?"am":"pm",i=t%60,n=i.toString(),1===n.length&&(n="0"+n),e>12&&(e%=12),0===e&&(e=12),"00"===n?""+e+o:e+"."+n+o},formatMinutes:function(t){var e,i,n,o,r;return e=Math.floor(t/60),i=t%60,o=0===e&&0===i||e>0,r=i>0,t="",o&&(t+=e+"h "),r&&(n=i+"m",2===n.length&&(n="0"+n),t+=n),t.trim()},formatMinutesOffset:function(t){var e,i,n,o;return i=t<0,e=Math.floor(Math.abs(t)/60),n=Math.abs(t)%60,t=e.toString(),o=n.toString(),n>0&&(o=n.toString(),1===o.length&&(o="0"+o),t=t+":"+o),t=i?"-"+t:"+"+t}}}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty,i=[].slice;RG.Utils.TimeRange=function(e){function n(t,e){this.startTime=t,this.endTime=e}return t(n,e),n.prototype.getStart=function(){return this.startTime},n.prototype.getEnd=function(){return this.endTime},n.prototype.merge=function(){var t,e,n;for(n=1<=arguments.length?i.call(arguments,0):[],n.push(this),n=_.sortBy(n,"endTime"),n=_.sortBy(n,"startTime"),e=[],t=n.shift();n.length;)n[0]&&t.isTouching(n[0])?(t.endTime<n[0].endTime&&(t.endTime=n[0].endTime),n.shift()):(e.push(t),t=n.shift());return e.push(t),e},n.prototype.isEqual=function(t){return this.endTime===t.endTime&&this.startTime===t.startTime},n.prototype.subtract=function(t){var e;return this.overlapsWith(t)?this.contains(t)?this.totalTime()-t.totalTime():t.contains(this)?0:this.overlapsWith(t)?(e=this.subtractOne(t),e.reduce(function(t,e){return t+e.totalTime()},0)):void 0:this.totalTime()},n.prototype.subtractOne=function(t){if(t.startTime<=this.startTime&&t.endTime>=this.endTime)return[];if(t.endTime<=this.startTime||t.startTime>=this.endTime)return[this];if(t.startTime>this.startTime&&t.endTime<this.endTime)return[new RG.Utils.TimeRange(this.startTime,t.startTime),new RG.Utils.TimeRange(t.endTime,this.endTime)];if(t.startTime<=this.startTime&&t.endTime<this.endTime)return[new RG.Utils.TimeRange(t.endTime,this.endTime)];if(t.startTime>this.startTime&&t.endTime>=this.endTime)return[new RG.Utils.TimeRange(this.startTime,t.startTime)];throw"Invalid subtraction"},n.prototype.totalTime=function(){return this.endTime-this.startTime|0},n.prototype.overlapsOneOClock=function(){return this.startTime<780&&this.endTime>780},n.prototype.getAllowancePerDay=function(){return this.overlapsOneOClock()?1:.5},n.prototype.toString=function(){return 1440===this.totalTime()?"All day":this._startMinutesToTime()+" - "+this._endMinutesToTime()},n.prototype._startMinutesToTime=function(){return RG.Utils.TimeFormatter.formatFixedTime(this.startTime)},n.prototype._endMinutesToTime=function(){return RG.Utils.TimeFormatter.formatFixedTime(this.endTime)},n}(RG.Utils.Range),RG.Utils.TimeRange.sum=function(t){return t.reduce(function(t,e){return t+e.totalTime()},0)}}.call(this),function(){RG.Utils.UnitDurationConverter=function(){function t(t){this.unitType=t}return t.prototype.convertArray=function(t,e,i){var n,o,r,s,a,l,c,u;if(0===t.length)return[];if(1===t.length)return o=t[0],l=new this.unitType(o.attributes.date),c=new RG.Models.UnitDuration,c.attributes={minutes:o.getMinutes(),minutesPerLine:l.getMinutesPerUtilisationLine(),date:l.date,waiting:o.isWaiting()||!1},[c];for(s=e||t[0].attributes.date,a=i||t[t.length-1].attributes.date,u=[],n=new this.unitType(s);;)if(r=this._getDurationsInUnit(t,n),o=new RG.Models.UnitDuration,o.attributes={minutes:this.getMinutesInDurations(r),minutesPerLine:n.getMinutesPerUtilisationLine(),date:n.date,waiting:r.some(function(t){return t.isWaiting()})},u.push(o),n=n.nextUnit(),n.date>a)break;return u},t.prototype.convert=function(t,e,i){var n,o;return 0===t.length?new RG.Collections.UnitDurations:(o=this.convertArray(t,e,i),n=new RG.Collections.UnitDurations,n.models=o,n.models.forEach(function(t){return t.collection=n}),n.length=o.length,n)},t.prototype.getDurationMinutesInUnit=function(t,e){var i;return i=this._getDurationsInUnit(t,e),this.getMinutesInDurations(i)},t.prototype.getMinutesInDurations=function(t){var e,i,n,o;for(o=0,i=0,n=t.length;i<n;i++)e=t[i],o+=e.getMinutes();return o},t.prototype._getDurationsInUnit=function(t,e){var i,n,o,r;for(n=[],o=0,r=t.length;o<r;o++)i=t[o],e.containsDate(i.attributes.date)&&n.push(i);return n},t}()}.call(this),function(){Array.prototype.max=function(){return Math.max.apply(null,this)},Array.prototype.min=function(){return Math.min.apply(null,this)}}.call(this),function(){var t,e,i=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty;t=/^(\S+)\s*(.*)$/,e=["model","collection","el","id","className","tagName","events"],RG.Views.BaseView=function(n){function o(t){var i,n,o,r;for(t=t||{},this.cid=_.uniqueId("view"),i=0,o=e.length;i<o;i++)n=e[i],r=t[n],r&&(this[n]=r);this._ensureElement(),this.initialize.apply(this,arguments)}return i(o,n),o.prototype.delegateEvents=function(e){var i,n,o;if(e||(e=this.events),!e)return this;this.undelegateEvents();for(i in e)o=e[i],o=this[o],o&&(n=i.match(t),this.delegate(n[1],n[2],o.bind(this)));return this},o.prototype._removeElement=function(){if(this.el.parentNode)return this.el.parentNode.removeChild(this.el)},o.prototype.remove=function(){return this.off(),o.__super__.remove.apply(this,arguments)},o.prototype.shrinkDropdown=function(t){var e,i;if(i=$(t.currentTarget.parentElement).find(".chzn-drop"),e=parseInt(null!=i?i.css("height"):void 0)+(null!=i?i.offset().top:void 0)-$(window).scrollTop(),this._dropdownOutOfViewport(e))return this._shrinkDropdownAndScrollToSelected(t)},o.prototype._dropdownOutOfViewport=function(t){return t-$(window).height()>0},o.prototype._shrinkDropdownAndScrollToSelected=function(t){var e,i,n,o;if(e=$(t.currentTarget.parentElement).find(".chzn-results"),n=$(window),i=n.height()+n.scrollTop()-e.offset().top-8,e.css("height",_.min([parseInt(e.css("height")),i])),o=e.find(".result-selected"),o.length>0)return e.scrollTo(o,{duration:80})},o}(Backbone.View)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Support.CollectionView=function(e){function i(){if(i.__super__.constructor.apply(this,arguments),null===this.collection)throw"No collection given to CollectionView.";this.listenTo(this.collection,"add",this.addItem),this.listenTo(this.collection,"remove",this.removeItem),this.listenTo(this.collection,"reset",this.render),this.collectionViews={}}return t(i,e),i.prototype.forEach=function(t){var e,i,n;i=this.collectionViews;for(e in i)n=i[e],t(n)},i.prototype.addItem=function(t){var e;return e=this.createItemView({model:t}),this.collectionViews[t.cid]=e,this._insertView(e,t),e},i.prototype._insertView=function(t,e){var i;return i=t.render().el,e===this.collection.models[0]?this.el.insertBefore(i,this.el.firstChild):this.el.appendChild(i)},i.prototype.removeItem=function(t){return this._removeViewByModelCid(t.cid)},i.prototype._postAnimate=function(t){},i.prototype._preAnimate=function(t){},i.prototype._removeViewByModelCid=function(t){return this._removeView(this.collectionViews[t]),delete this.collectionViews[t]},i.prototype._removeView=function(t){return t.remove(),"function"==typeof t.close?t.close():void 0},i.prototype.remove=function(){var t,e,n;e=this.collectionViews;for(t in e)n=e[t],n.remove();return i.__super__.remove.apply(this,arguments)},i.prototype.close=function(){var t,e,i;for(e in this.collectionViews)this._removeViewByModelCid(e);for(i=[];t=this.el.firstChild;)i.push(this.el.removeChild(t));return i},i.prototype.createItemView=function(t){return new this.itemView({model:t.model})},i.prototype.render=function(){return this._render(),this},i.prototype._render=function(){var t,e,i,n;for(this.close(),n=this.collection.models,t=0,e=n.length;t<e;t++)i=n[t],this.addItem(i);return this},i}(RG.Views.BaseView),RG.Support.ArrayView=function(e){function i(){i.__super__.constructor.apply(this,arguments),this.collectionViews={}}return t(i,e),i.prototype.addItem=function(t){var e;return e=this.createItemView({model:t}),this.collectionViews[t.cid]=e,this._insertView(e,t),e},i.prototype._insertView=function(t,e){return this.el.appendChild(t.render().el)},i.prototype.removeItem=function(t){return this._removeViewByModelCid(t.cid)},i.prototype._removeViewByModelCid=function(t){return this._removeView(this.collectionViews[t]),delete this.collectionViews[t]},i.prototype._removeView=function(t){return t.remove()},i.prototype.remove=function(){var t,e,n;e=this.collectionViews;for(t in e)n=e[t],n.remove();return i.__super__.remove.apply(this,arguments)},i.prototype.close=function(){var t,e,i;for(e in this.collectionViews)this._removeViewByModelCid(e);for(i=[];t=this.el.firstChild;)i.push(this.el.removeChild(t));return i},i.prototype.createItemView=function(t){return new this.itemView({model:t.model})},i.prototype.render=function(){return this._render(),this},i.prototype._render=function(){var t,e,i,n;for(this.close(),n=this.collection,t=0,e=n.length;t<e;t++)i=n[t],this.addItem(i);return this},i}(RG.Views.BaseView),RG.Support.SortedCollectionView=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype._insertView=function(t,e){var i,n,o,r;return n=t.render().el,this._preAnimate(n),e===this.collection.first()?this.el.insertBefore(n,this.el.firstChild):e===this.collection.last()?this.el.appendChild(n):(i=this.collection.indexOf(e),o=this.collection.models[i-1],r=this.collectionViews[o.cid],r?this.el.insertBefore(n,r.el.nextElementSibling):this.el.appendChild(n)),this._postAnimate(n),n},i}(RG.Support.CollectionView),RG.Support.CachedCollectionView=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.addItem=function(t){var e;return(e=this.collectionViews[t.cid])?(this.el.appendChild(e.el),e.el.style.display=""):i.__super__.addItem.apply(this,arguments)},i.prototype.clearInvisibleViews=function(){var t,e,i;e=this.collectionViews;for(t in e)i=e[t],"none"===i.el.style.display&&(i.remove(),delete this.collectionViews[t])},i.prototype.close=function(){var t,e;e=[];for(t in this.collectionViews)e.push(this._removeViewByModelCid(t));return e},i.prototype._removeViewByModelCid=function(t){return this._removeView(this.collectionViews[t])},i.prototype._removeView=function(t){return t.el.style.display="none"},i}(RG.Support.SortedCollectionView)}.call(this),function(){RG.Support.ValidTags=function(){function t(){}return t.prototype.valid_html_tags=function(){return["!--","!DOCTYPE","a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","head","header","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"]},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.Base=function(e){function i(t,e){this.cid=_.uniqueId(this.cidPrefix),this.attributes={},e&&(this.collection=e.collection),this.set(t||{}),this.changed={},this.initialize.apply(this,arguments)}return t(i,e),i}(Backbone.Model)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty,n=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};RG.Models.ResourceInstance=function(i){function o(){return this.refreshDowntimes=t(this.refreshDowntimes,this),o.__super__.constructor.apply(this,arguments)}return e(o,i),o.prototype.initialize=function(t){return this.account=null!=t?t.account:void 0,this.bookings=new RG.Collections.Bookings,this.bookings.resource=this,this.availablePeriods=new RG.Collections.AvailablePeriods,this.availablePeriods.resource=this,this.customAvailablePeriods=new RG.Collections.CustomAvailablePeriods,this.customAvailablePeriods.resource=this,this.overtimes=new RG.Collections.Overtimes,this.overtimes.resource=this,this.downtimes=new RG.Collections.Downtimes,this.downtimes.resource=this,window.downtimes.on("add:resource_id:"+this.id,function(t){return function(e){return t.downtimes.push(e.cloneWithBinding())}}(this)),window.downtimes.on("remove:resource_id:"+this.id,function(t){return function(e){var i;return i=t.downtimes.findWhere({id:e.id}),t.downtimes.remove(i)}}(this)),this.downtimes.on("change",function(t){var e;return e=window.downtimes.findWhere({id:t.id}),e.set(t.attributes)}),this.availability=new RG.Factories.AvailabilityManager(this).create(),
this.customFieldOptions=new RG.Collections.CustomFieldOptions,this.customFieldOptions.resource=this,this.visible=this.get("bookable"),o.__super__.initialize.apply(this,arguments)},o.prototype.isAvailableIn=function(t,e){return null==e&&(e=new RG.Utils.TimeRange(0,1440)),this.availability.isAvailableIn(t,e)},o.prototype.getFirstName=function(){var t;return this.get("human")?(t=this.get("name").indexOf(" "),t>=0?this.escape("name").substr(0,t):this.escape("name")):this.getName()},o.prototype.getImage=function(){return this.get("imageUrl")},o.prototype.hasAvatar=function(){return!0},o.prototype.getName=function(){return this.escape("name")},o.prototype.getTimeZoneName=function(){return this.getTimeZone().getName()},o.prototype.getInitials=function(){var t,e;return e=this.get("name").split(" "),t=e[0][0].toUpperCase(),1!==e.length&&e[e.length-1][0]&&(t+=e[e.length-1][0].toUpperCase()),t},o.prototype.getTimeZone=function(){return this.get("timeZone")||new RG.Models.TimeZone({name:"UTC",offset:0})},o.prototype.shouldDisplayTimeZone=function(){return this.getTimeZoneName()!==window.currentUserTimeZone},o.prototype.hasCustomFieldOption=function(t){return this.customFieldOptions.contains(t)},o.prototype.isBookable=function(){return"undefined"==typeof this.get("bookable")||this.get("bookable")},o.prototype.isBookedOnClient=function(t){return _.contains(this.get("bookedClients"),t)},o.prototype.isBookedOnProject=function(t){return _.contains(this.get("bookedProjects"),t)},o.prototype.isHuman=function(){return"undefined"!=typeof this.get("human")&&this.get("human")},o.prototype.predictWaitingList=function(){return this.bookings.predictWaitingList()},o.prototype.typeName=function(){var t;return null!=(t=this.get("resourceType"))?t.get("name"):void 0},o.prototype.refreshDowntimes=function(t){if(null==t&&(t=!1),!this.hasDowntimes)return this.hasDowntimes=!0,this.downtimes.reset(this.account.downtimes.forResource(this).map(function(t){var e;return e=t.clone(),t.on("change",function(){return e.set(t.attributes)}),e}),{silent:t})},o.prototype.isDowntimesStale=function(){var t,e,i,o,r,s,a,l;if(e=this.account.downtimes.forResource(this),this.downtimes.length!==e.length)return!0;for(t=e.map(function(t){return t.id}).concat(this.downtimes.pluck("id")),a=[],i=0,r=t.length;i<r;i++)l=t[i],n.call(a,l)<0&&a.push(l);if(a.length!==this.downtimes.length)return!0;for(t=e.map(function(t){return t.attributes.updatedAt.getTime()}).concat(this.downtimes.models.map(function(t){return t.attributes.updatedAt.getTime()})),a=[],o=0,s=t.length;o<s;o++)l=t[o],n.call(a,l)<0&&a.push(l);return a.length!==this.downtimes.length},o.prototype.getDowntimeText=function(){return"downtime"},o.prototype.getHeadingDowntimeText=function(){return"Downtime"},o.prototype._addDays=function(t,e,i,n){return this.isAvailableIn(t,e)?i+n:i},o}(RG.Models.Base)}.call(this),function(){var t,e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;RG.Models.TimeZone=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.toString=function(){return"(GMT "+RG.Utils.TimeFormatter.formatMinutesOffset(this.get("offset"))+") "+this.get("name")},i.prototype.getFormattedOffset=function(){var t,e,i,n,o;return o=this.get("offset")/60*-1,n=Math.abs(o),e=Math.floor(n),n<=10&&(e="0"+e),i=o%1!==0?e+":30":e+":00",t=o>=0?"+":"-",t+i},i.prototype.getName=function(){return this.get("name")},i.prototype.getParamValue=function(){return this.getName()},i}(RG.Models.Base),RG.Models.TimeZone.UTC=new RG.Models.TimeZone({name:"UTC",offset:0}),t=new Date,RG.Models.TimeZone.Current=new RG.Models.TimeZone({name:"Current",offset:-t.getTimezoneOffset()})}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.AbstractTimeAllocation=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.isDowntime=function(){return!1},i.prototype.getDateRange=function(){return new RG.Utils.DateRange(this.getFirstAllocatedDate(),this.getLastAllocatedDate())},i.prototype.getFirstAllocatedDate=function(){throw"Implement getFirstAllocatedDate in subclasses"},i.prototype.getLastAllocatedDate=function(){throw"Implement getLastAllocatedDate in subclasses"},i.prototype.getTimeRange=function(){throw"Implement getTimeRange in subclasses"},i.prototype.getConfirmedMinutes=function(){return this.getTimeRange().totalTime()},i.prototype.getDurationCaption=function(){return this._getFirstDuration().getCaption()},i.prototype.getDurationRepeatCaption=function(){return this._getFirstDuration().getRepeatCaption()},i.prototype.getDurationLongRepeatCaption=function(){return this._getFirstDuration().getLongRepeatCaption()},i.prototype.getDraggingId=function(){return RG.Utils.DateFormatter.getISODate(this.getFirstAllocatedDate())+"-"+RG.Utils.DateFormatter.getISODate(this.getLastAllocatedDate())+"-dragged-booking"},i.prototype._getFirstDuration=function(){throw"Implement _getFirstDuration in subclasses"},i.prototype._getLastDuration=function(){throw"Implement _getLastDuration in subclasses"},i.prototype.getStartDate=function(){throw"Implement getStartDate in subclasses"},i.prototype.getEndDate=function(){throw"Implement getEndDate in subclasses"},i}(RG.Models.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.Account=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return null==t&&(t={}),this.downtimes=t.downtimes||new RG.Collections.Downtimes},i.prototype.getSubdomain=function(){return this.get("subdomain")},i}(RG.Models.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.AvailablePeriod=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.getMinutesAvailable=function(){return+this.get("endTime")-+this.get("startTime")},i.prototype.isValidOn=function(t){return this.get("weekDay")===t.getDay()&&("undefined"==typeof this.get("validUntil")||this.get("validUntil").getTime()>=t.getTime())&&(this.get("validFrom")<t||RG.Utils.DateComparator.equalsYMD(this.get("validFrom"),t))},i.prototype.isCoveringDate=function(t){var e,i;return i=new RG.Utils.DateRange(this.get("validFrom"),this.get("validUntil")),e=new RG.Utils.DateRange(t,t),i.overlapsWith(e)},i.prototype.isValidInDateRange=function(t){var e,i,n,o,r,s;return n=this.attributes.validFrom,r=this.attributes.validUntil,o=n.valueOf(),s=null!=r?r.valueOf():void 0,i=t.startDate.valueOf(),e=t.endDate.valueOf(),t.includes(n)||o<=i&&!s||o<=i&&s>=e||t.includes(r)},i.prototype.isAllDay=function(){return 1440===this.getMinutesAvailable()},i.prototype.toString=function(){return RG.Utils.TimeFormatter.formatFixedTime(+this.get("startTime"))+" - "+RG.Utils.TimeFormatter.formatFixedTime(+this.get("endTime"))},i.prototype.differentPeriod=function(t){return+this.get("endTime")!==+t.get("endTime")||+this.get("startTime")!==+t.get("startTime")},i.prototype.contains=function(t){return new RG.Utils.TimeRange(this.get("startTime"),this.get("endTime")).contains(t)},i.prototype.getTimeRange=function(){return new RG.Utils.TimeRange(this.get("startTime"),this.get("endTime"))},i.prototype.isNewerThan=function(t){return this.get("validFrom").valueOf()>=t.valueOf()},i}(RG.Models.Base)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;RG.Models.BaseDuration=function(i){function n(){return this.predictWaitingList=t(this.predictWaitingList,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.anyClashes=function(){return!1},n.prototype.getDate=function(){return this.get("date")},n.prototype.getLayer=function(){return this.collection.booking.layer},n.prototype.isConfirmed=function(){return!this.attributes.waiting},n.prototype.isWaiting=function(){return this.attributes.waiting},n.prototype.containsDate=function(t){return RG.Utils.DateComparator.equalsYMD(this.get("date"),t)},n.prototype._isValidInTimeRange=function(t){return!0},n.prototype.predictWaitingList=function(){var t,e,i,n,o,r,s,a,l,c,u,h,d,p;if(d=null!=(l=this.collection)&&null!=(c=l.booking)&&null!=(u=c.collection)?u.resource:void 0,d&&(t=d.availability,i=this.attributes.date,a=t.getMinutesAvailableForDate(i),0!==a)){for(p=0,o=[],h=d.bookings.getDurationsForDate(i),r=0,s=h.length;r<s;r++)n=h[r],n!==this&&n.isConfirmed()&&(o.push(n),p+=n.getMinutes());this.get("waiting")&&(e=!this.anyClashes(o)&&p+this.getMinutes()<=a&&t.getAvailableTimeRangesInDateRange(new RG.Utils.DateRange(i,i)).some(function(t){return function(e){return t._isValidInTimeRange(e)}}(this)),this.set({waiting:!e}))}},n.prototype.removeAndUpdateBooking=function(){var t,e,i,n,o;if(n=this.collection,t=null!=n?n.booking:void 0)return e=t.collection,o=e.resource,i=this.get("date"),n.remove(this,{silent:!0}),0===n.length?void e.remove(t):void(o.availability.getMinutesAvailableForDate(i)>0&&t.split(i))},n}(RG.Models.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.Booker=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i}(RG.Models.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty,i=[].slice;RG.Models.Booking=function(e){function n(){n.__super__.constructor.apply(this,arguments),this.layer=0,this.realBooking=this,this.durations=new RG.Collections.Durations,this.durations.booking=this}return t(n,e),n.prototype.deepEqual=function(t){var e,i,n,o;return e=null!=(n=this.collection)?n.resource:void 0,i=null!=(o=t.collection)?o.resource:void 0,t.constructor===this.constructor&&this.layer===t.layer&&_.isEqual(this.attributes,t.attributes)&&_.isEqual(this.durations.models.map(function(t){return t.attributes}),t.durations.models.map(function(t){return t.attributes}))&&e===i},n.prototype.deepClone=function(){var t,e;return t=this.clone(),e=this.durations.models.map(function(t){var e;return e=new t.constructor,e.attributes=_.clone(t.attributes),e.id=t.id,e}),t.durations=new RG.Collections.Durations,t.durations.models=e,t.durations.length=e.length,t.durations.booking=t,t},n.prototype.getBookingTarget=function(){return this.get("client")||this.get("project")||new RG.Models.NullBookingTarget},n.prototype.getCaption=function(){var t,e,i;return e=this.getDurationCaption(),i="",t=this.getBookingTarget().toString(),this.isSeries()&&(e=e+" "+this.getDurationRepeatCaption()),t.indexOf("|")===-1&&this.escape("notes").trim().length&&(t.length&&(t+=" | "),t+=this.escape("notes").substr(0,35).trim(),this.escape("notes").length>35&&(t+="...")),t.length&&e.length&&(i=" | "),t+i+e},n.prototype.getConfirmedMinutes=function(){var t;return t=this.durations.filter(function(t){return t.isConfirmed()}),t.map(function(t){return t.getMinutes()}).reduce(function(t,e){return t+e},0)},n.prototype.getFirstAllocatedDate=function(){return this._getFirstDuration().get("date")},n.prototype.getLastAllocatedDate=function(){return this._getLastDuration().get("date")},n.prototype.getLongCaption=function(){var t,e,i,n;return n=this.getBookingTarget(),t="",e=this.getDurationCaption(),this.isSeries()&&(e=e+" "+this.getDurationLongRepeatCaption()),t+='<span class="label__time">'+e+"</span>",null!=n&&n.constructor&&(i="<br>"+n.getLongCaption(),t+=n.getLongCaption().length?i:""),this.get("notes")&&n.getLongCaption().indexOf("<br>")===-1&&(t+="<br>"+this.escape("notes")),t},n.prototype.getSavedDateRange=function(){return new RG.Utils.DateRange(this.get("startDate"),this.get("endDate"))},n.prototype.getTitleCaption=function(){var t,e,i,n,o;return n=this.getBookingTarget(),t=[],(o=n.toString())&&t.push(o),this.get("notes")&&this.get("notes").length&&(e=this.get("notes").replace(/\n/g," ").substr(0,300),e=300===e.length?e.substr(0,297)+"...":e,t.push(e)),i=this.getDurationCaption(),this.isSeries&&(i+=" "+this.getDurationRepeatCaption()),t.push(i),t.join(" | ")},n.prototype.getWaitingMinutes=function(){var t;return t=this.durations.filter(function(t){return t.isWaiting()}),_.reduce(_.map(t,function(t){return t.getMinutes()}),function(t,e){return t+e},0)},n.prototype.cloneWithDurations=function(){var t,e,n,o;return e=1<=arguments.length?i.call(arguments,0):[],o=e[0].get("date"),n=_.last(e).get("date"),t=this.clone(),t.set({startDate:o,endDate:n}),t.durations=new RG.Collections.Durations(e),t.collection=this.collection,t.realBooking=this,t},n.prototype.split=function(t){var e,i,n,o;return i=this.durations.select(function(e){return e.get("date").cloneYMD()<t.cloneYMD()}),o=this.durations.select(function(e){return e.get("date").cloneYMD()>t.cloneYMD()}),i.length&&o.length?(this.durations.reset(i),this.set({startDate:i[0].get("date"),endDate:_.last(i).get("date")}),n=this.clone(),n.set({id:null,startDate:o[0].get("date"),endDate:_.last(o).get("date")}),n.collection=this.collection,n.durations=new RG.Collections.Durations(o),n.durations.booking=n,this.collection.add(n)):(e=i.concat(o),this.durations.reset(e),this.set({startDate:e[0].get("date"),endDate:_.last(e).get("date")}))},n.prototype.isExclusivelyOnWaitingList=function(){return this.durations.models.filter(function(t){return t.getMinutes()>0}).every(function(t){return t.isWaiting()})},n.prototype.isSeries=function(){return this.durations.length>1},n.prototype.predictWaitingList=function(){return this.durations.predictWaitingList()},n.prototype.getFirstNonZeroDuration=function(){var t,e,i,n;for(n=this.durations.models,e=0,i=n.length;e<i;e++)if(t=n[e],t.getMinutes()>0)return t;return new RG.Models.NullDuration},n.prototype._getFirstDuration=function(){return this.durations.models[0]||new RG.Models.NullDuration},n.prototype._getLastDuration=function(){return this.durations.models[this.durations.length-1]||new RG.Models.NullDuration},n.prototype.getBooker=function(){return this.get("booker")},n.prototype.getDurations=function(){return this.durations.models},n.prototype.getStartDate=function(){return this._getFirstDuration().getDate()},n.prototype.getEndDate=function(){return this._getLastDuration().getDate()},n.prototype.hasNoDurations=function(){return 0===this.durations.select(function(t){return!t.transient}).length},n}(RG.Models.AbstractTimeAllocation)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.CustomAvailablePeriod=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return i.__super__.initialize.apply(this,arguments)},i.prototype.isValidOn=function(t){return RG.Utils.DateComparator.equalsYMD(this.get("date"),t)},i.prototype.isEditable=function(){return!0},i}(RG.Models.AvailablePeriod)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.CustomField=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(){return this.customFieldOptions=new RG.Collections.CustomFieldOptions,this.customFieldOptions.customField=this},i}(RG.Models.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.CustomFieldOption=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i}(RG.Models.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.Downtime=function(e){function i(){i.__super__.constructor.apply(this,arguments),this.downtimeType=this.getDowntimeType(),this._timeRanges={},this._timeZoneConverted={},this._boundClones=[],this.attributes.updatedAt||(this.attributes.updatedAt=new Date),this.on("change",this._resetCache,this),this.on("change",function(t){return function(){var e,i,n,o,r;for(o=t._boundClones,r=[],i=0,n=o.length;i<n;i++)e=o[i],r.push(e.set(t.attributes));return r}}(this))}return t(i,e),i.prototype.deepEqual=function(t){return this.constructor===t.constructor&&this.layer===t.layer&&_.isEqual(this.attributes,t.attributes)},i.prototype.deepClone=function(){return this.clone()},i.prototype._resetCache=function(){return this._timeRanges={},this._durations=null,this._timeZoneConverted={}},i.prototype.isDowntime=function(){return!0},i.prototype.isSeries=function(){return this.getDateRange().getNumberOfDays()>1},i.prototype.clone=function(){return new this.constructor(this.attributes)},i.prototype.cloneWithBinding=function(){var t;return t=this.clone(),this._boundClones.push(t),t},i.prototype.getDowntimeType=function(){return this.get("downtimeType")},i.prototype.getConfirmedMinutes=function(){var t,e,i,n,o,r,s;if(e=this.getDateRange(),1===e.getNumberOfDays())return s=this.getTimeRange(e.startDate),s.totalTime();for(r=0,o=e.getDates(),i=0,n=o.length;i<n;i++)t=o[i],s=this.getTimeRange(t),r+=s.totalTime();return r},i.prototype.getSavedDateRange=function(){return this.getDateRange()},i.prototype.getFirstAllocatedDate=function(){return this.attributes.from},i.prototype.getLastAllocatedDate=function(){return this.attributes.to},i.prototype.type=function(){var t;return null!=(t=this.getDowntimeType())?t.get("name"):void 0},i.prototype.inYear=function(t){return this.getDateRange().coversYear(t)},i.prototype.isValidOn=function(t){return this.getDateRange().includes(t)},i.prototype.inTimeZoneSimple=function(t){var e,i,n,o,r,s,a,l,c,u;return this.isLocalTimeZone()?(e=this.attributes.from,u=this.attributes.to,{startDate:e,endDate:u,startTime:this.attributes.startTime,endTime:this.attributes.endTime,getDateRange:function(){return new RG.Utils.DateRange(e,u)},getStartDate:function(){return e},getEndDate:function(){return u}}):(i=null!=t?t.get("offset"):void 0,n=-this.get("timeZone").get("offset")+i,e=this.get("from"),u=this.get("to"),c=this.get("startTime")+n,s=this.get("endTime")+n,l=e.getTime(),c<0?l-=864e5:c>1440&&(l+=864e5),r=u.getTime(),s<=0?r-=864e5:s>1440&&(r+=864e5),a=new Date(l),o=new Date(r),{startDate:a,endDate:o,startTime:(c+1440)%1440,endTime:(s+1440)%1440||1440,getDateRange:function(){return new RG.Utils.DateRange(a,o)},getStartDate:function(){return a},getEndDate:function(){return o}})},i.prototype.inTimeZone=function(t){var e,i,n,o,r,s,a,l,c,u,h,d,p;return n=null!=t?t.get("offset"):void 0,this._timeZoneConverted[n]?this._timeZoneConverted[n]:this.isLocalTimeZone()?(o=new RG.Models.Downtime,o.attributes=_.clone(this.attributes),o.id=this.attributes.id,this._timeZoneConverted[n]=o):(r=-this.get("timeZone").get("offset")+n,i=this.get("from"),p=this.get("to"),d=this.get("startTime")+r,c=this.get("endTime")+r,h=i.getTime(),d<0?h-=864e5:d>1440&&(h+=864e5),l=p.getTime(),c<=0?l-=864e5:c>1440&&(l+=864e5),u=new Date(h),a=new Date(l),e={id:this.attributes.id,timeZone:t,downtimeTypeId:this.attributes.downtimeTypeId,details:this.attributes.details,state:this.attributes.state,creatorId:this.attributes.creatorId,leave:this.attributes.leave,resourceIds:this.attributes.resourceIds,downtimeType:this.getDowntimeType(),from:u,to:a,updatedAt:this.attributes.updatedAt,startTime:(d+1440)%1440|0,endTime:(c+1440)%1440|0||1440},s=new RG.Models.Downtime,s.attributes=e,s.id=e.id,s.layer=this.layer,this._timeZoneConverted[t]=s)},i.prototype.getRawTimeRange=function(){return new RG.Utils.TimeRange(this.get("startTime"),this.get("endTime"))},i.prototype.getTimeRange=function(t){var e;return e=t.toString(),this._timeRanges[e]?this._timeRanges[e]:this._timeRanges[e]=RG.Utils.DateComparator.equalsYMD(t,this.get("from"))&&RG.Utils.DateComparator.equalsYMD(t,this.get("to"))?new RG.Utils.TimeRange(this.get("startTime"),this.get("endTime")):RG.Utils.DateComparator.equalsYMD(t,this.get("from"))?new RG.Utils.TimeRange(this.get("startTime"),1440):RG.Utils.DateComparator.equalsYMD(t,this.get("to"))?new RG.Utils.TimeRange(0,this.get("endTime")):this.get("from")>t||this.get("to")<t?new RG.Utils.TimeRange(0,0):new RG.Utils.TimeRange(0,1440)},i.prototype.getType=function(){return this.type()},i.prototype.getTypeIcon=function(){var t;return null!=(t=this.getDowntimeType())?t.typeIcon():void 0},i.prototype.isVacation=function(){var t;return null!=(t=this.getDowntimeType())?t.isVacation():void 0},i.prototype.getAllowancePerDay=function(t){return this.getTimeRange(t).getAllowancePerDay()},i.prototype.getTitleCaption=function(){var t,e;return t=[],this.getType()&&this.getType().length&&t.push(this.type()),this.get("details")&&this.get("details").length&&(e=this.get("details").replace(/\n/g," ").substr(0,300),e=300===e.length?e.substr(0,297)+"...":e,t.push(e)),t.push(this.getDateTimeString()),t.join(" | ")},i.prototype.getTimeZone=function(){return this.get("timeZone")||RG.Models.NullTimeZone.instance},i.prototype.getTimeZoneName=function(){return this.getTimeZone().getName()},i.prototype.getDateTimeString=function(t){return null==t&&(t=RG.Utils.DateFormatter.getShortDate),new RG.Utils.DowntimePresenter(this).dateTimeString(t)},i.prototype._getFirstDuration=function(){return new RG.Models.Duration({date:this.get("from"),minutes:0,waiting:!1})},i.prototype.getFirstNonZeroDuration=function(){return this._getFirstDuration()},i.prototype._getLastDuration=function(){return new RG.Models.Duration({date:this.get("to"),minutes:0,waiting:!1})},i.prototype.isExclusivelyOnWaitingList=function(){return!1},i.prototype.getStartDate=function(){return this.attributes.from},i.prototype.getEndDate=function(){return this.attributes.to},i.prototype.getBooker=function(){return{id:this.get("creatorId")}},i.prototype.getDurations=function(t){var e,i,n,o,r,s,a;if(null==t&&(t=this),this._durations)return this._durations;for(n=[],s=this.getDateRange().getDates(),o=0,r=s.length;o<r;o++)e=s[o],a=this.getTimeRange(e),i=new RG.Models.DowntimeDuration({startTime:a.startTime,endTime:a.endTime,date:e}),i.downtime=t,n.push(i);return this._durations=n},i.prototype.addResource=function(t){var e;if(e=this.get("resourceIds"),!_.include(e,t.id))return e.push(t.id),this.set({resourceIds:e})},i.prototype.removeResource=function(t){var e;return e=this.get("resourceIds"),e=_.reject(e,function(e){return e===t.id}),this.set({resourceIds:e})},i.prototype.isLocalTimeZone=function(){return""===this.getTimeZone().toString()},i}(RG.Models.AbstractTimeAllocation)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.DowntimeType=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.getName=function(){return this.get("name")},i.prototype.isVacation=function(){var t;return t=this.getName(),t===RG.Variables.DowntimeType.vacation||t===RG.Variables.DowntimeType.personalHoliday},i.prototype.isPublicHoliday=function(){return this.getName()===RG.Variables.DowntimeType.publicHoliday},i.prototype.isSick=function(){return this.getName()===RG.Variables.DowntimeType.sick},i.prototype.isMaternity=function(){return this.getName()===RG.Variables.DowntimeType.maternity},i.prototype.isCompassionate=function(){return this.getName()===RG.Variables.DowntimeType.compassionate},i.prototype.typeIcon=function(){return this.isVacation()?"rg-icon--vacation":this.isPublicHoliday()?"rg-icon--happy":this.isSick()?"rg-icon--sick":this.isMaternity()?"rg-icon--maternity":this.isCompassionate()?"rg-icon--compassionate":""},i}(RG.Models.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.Duration=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.getCaption=function(){return RG.Utils.TimeFormatter.formatMinutes(this.realMinutes||this.getMinutes())},i.prototype.getMinutes=function(){return this.get("minutes")},i.prototype.getRepeatCaption=function(){return"p/d"},i.prototype.getLongRepeatCaption=function(){return"per day"},i.prototype.startsAfterTime=function(t){return!1},i.prototype.endsBeforeTime=function(t){return!1},i.prototype.isFixed=function(){return!1},i.prototype.getTimeRange=function(){return new RG.Utils.TimeRange(0,0)},i}(RG.Models.BaseDuration)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.FilterOption=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.getName=function(){return this.escape("name")},i}(RG.Models.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.FixedDuration=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.getCaption=function(){return this._getTimeFor(this.get("startTime"))+" - "+this._getTimeFor(this.get("endTime"))},i.prototype.getMinutes=function(){return this.attributes.endTime-this.attributes.startTime},i.prototype.getRepeatCaption=function(){return"daily"},i.prototype.getLongRepeatCaption=function(){return"every day"},i.prototype._getTimeFor=function(t){return RG.Utils.TimeFormatter.formatFixedTime(t)},i.prototype.isFixed=function(){return!0},i.prototype.startsAfterTime=function(t){return t<=this.get("startTime")},i.prototype.endsBeforeTime=function(t){return t>=this.get("endTime")},i.prototype.anyClashes=function(t){return t.some(function(t){return function(e){return t.clash(e)}}(this))},i.prototype.clash=function(t){return this.getTimeRange().overlapsWith(t.getTimeRange())},i.prototype.within=function(t){return+this.get("startTime")>=+t.get("startTime")&&+this.get("endTime")<=+t.get("endTime")},i.prototype.getTimeRange=function(){return new RG.Utils.TimeRange(this.get("startTime"),this.get("endTime"))},i.prototype._isValidInTimeRange=function(t){return 0===this.getTimeRange().subtractOne(t).length},i}(RG.Models.BaseDuration),RG.Models.DowntimeDuration=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.getLayer=function(){return this.downtime.layer},i}(RG.Models.FixedDuration)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.HumanResourceInstance=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.hasAvatar=function(){var t;return(null!=(t=this.get("imageUrl"))?t.indexOf("fallback"):void 0)===-1},i.prototype.getDowntimeText=function(){return"time off"},i.prototype.getHeadingDowntimeText=function(){return"Time Off"},i}(RG.Models.ResourceInstance)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.NullTimeZone=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.toString=function(){return""},i.prototype.getFormattedOffset=function(){return""},i.prototype.getName=function(){return"NullTimeZone"},i.prototype.getParamValue=function(){return null},i}(RG.Models.TimeZone),RG.Models.NullTimeZone.instance=new RG.Models.NullTimeZone}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.OptionGroup=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return this.options=new RG.Collections.FilterOptions,this.options.optionGroup=this},i.prototype.getName=function(){return this.get("name")},i.prototype.getTagId=function(){var t;return null!=(t=this.get("tag"))?t.id:void 0},i.prototype.getType=function(){var t,e;return null!=(t=this.collection)&&null!=(e=t.category)?e.get("name"):void 0},i}(RG.Models.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.Overtime=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.getMinutesAvailable=function(){return this.get("duration")},i}(RG.Models.CustomAvailablePeriod)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.ResourceType=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(){return this.customFields=new RG.Collections.CustomFields,this.customFields.resourceType=this},i.prototype.getName=function(){return this.attributes.name},i}(RG.Models.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Calendar.Units.Day=function(e){function i(t){i.__super__.constructor.apply(this,arguments),this.date=new Date(t.getFullYear(),t.getMonth(),t.getDate())}return t(i,e),i.prototype.containsDate=function(t){return RG.Utils.DateComparator.equalsYMD(this.date,t)},i.prototype.getDateRange=function(){return new RG.Utils.DateRange(this.date,this.date)},i.prototype.getDaysPerUnit=function(){return 1},i.prototype.getName=function(){return new RG.Utils.DayName(this.date.getDay()).toString()},i.prototype.getFormattedDate=function(){return this.date.getDate().toString()},i.prototype.getMinutesPerUtilisationLine=function(){return 480},i.prototype.isCurrent=function(){return RG.Utils.DateComparator.equalsYMD(this.date,RG.Utils.BookingDataParser.getDateFromStr(window.currentUserDate.date))},i.prototype.nextUnit=function(){var t;return t=new Date(this.date.getFullYear(),this.date.getMonth(),this.date.getDate()+1),new RG.Calendar.Units.Day(t)},i.prototype.previousUnit=function(){var t;return t=new Date(this.date.getFullYear(),this.date.getMonth(),this.date.getDate()-1),new RG.Calendar.Units.Day(t)},i.prototype.getWeek=function(){var t;return null!=(t=this.date)?t.getWeek():void 0;
},i}(RG.Models.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Calendar.Units.DayUnitGrouping=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){this.dateRange=t},i.prototype.getUnits=function(){var t,e,i,n,o,r,s;if(null!=this._units)return this._units;for(this._units=new RG.Collections.Units,s=[],i=n=0,o=this.dateRange.getNumberOfDays()-1;0<=o?n<=o:n>=o;i=0<=o?++n:--n)r=this.dateRange.startDate,t=new Date(r.getFullYear(),r.getMonth(),r.getDate()+i),e=new RG.Calendar.Units.Day(t),s.push(e);return this._units.reset(s),this._units},i.prototype.toString=function(){return this.dateRange.toString()},i}(Backbone.Model)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.UnitDuration=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i}(RG.Models.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.Client=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.getTypeDescription=function(){return"Client"},i.prototype.getLongCaption=function(){return this.getName()},i.prototype.getLongDescription=function(){return this.getName()},i.prototype.getName=function(){return this.escape("name")},i.prototype.toString=function(){return this.getName()},i}(RG.Models.Base)}.call(this),function(){RG.Models.CurrentDate=function(){function t(t){this.date=t,_.extend(this,Backbone.Events)}return t.prototype.set=function(t){var e;e=this.date!==t,this.date=t,e&&this.trigger("change",t)},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.DayAvailabilityAggregation=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return null==t&&(t={}),this.set("availablePeriods",t.availablePeriods||{}),this.set("originalAvailablePeriods",t.originalAvailablePeriods||{}),this.set("durations",t.durations||{}),this.set("overtimes",t.overtimes||{}),this.set("downtimes",t.downtimes||{})},i.prototype.getLowestMinutesAvailable=function(){return this.availabilityCleared?this.getCurrentMinutesAvailable():this.getAvailabilityWithoutDowntime()},i.prototype.getAvailabilityWithoutDowntime=function(){var t,e,i,n,o,r,s,a,l,c,u,h;e=[],u=this.get("availablePeriods");for(o in u)h=u[o],h.length>0&&e.concat(h);for(1===e.length?e=[this.getFirstAvailablePeriods().models]:e.push(this.getFirstAvailablePeriods().models),t=[],i=0,r=e.length;i<r;i++){for(c=e[i],a=0,n=0,s=c.length;n<s;n++)l=c[n],a+=l.getMinutesAvailable();t.push(a)}return t.min()},i.prototype.getCurrentMinutesAvailable=function(){return this.downtimesConsistent()?this._totalMinutesFromPeriodsAndDowntimes(this.getFirstAvailablePeriods().models,this.getFirstDowntimes()):null},i.prototype.getTotalMinutesAvailable=function(){var t,e,i;return this.downtimesConsistent()?(e=_.values(this.get("availablePeriods")),i=this.getFirstDowntimes(),t=_.map(e,function(t){return function(e){return{totalMinutes:t._totalMinutesFromPeriodsAndDowntimes(e,i)}}}(this)),1===_.uniq(_.map(t,function(t){return t.totalMinutes})).length?t[0].totalMinutes:null):null},i.prototype.getDates=function(){var t,e,i,n;i=this.get("availablePeriods"),n=[];for(e in i)t=i[e],n.push(e);return n},i.prototype.getMinutesAvailable=function(){var t,e;return e=_.values(this.get("availablePeriods")),t=_.map(e,function(t){var e;return e=_.reduce(t,function(t,e){return t+e.getMinutesAvailable()},0),{totalMinutes:e,availableTimes:_.map(t,function(t){return[t.get("startTime"),t.get("endTime")]})}}),_.all(_.rest(t),function(e){return _.isEqual(t[0],e)})?t[0].totalMinutes:null},i.prototype.getMinutesBooked=function(){var t,e;return e=_.values(this.get("durations")),t=_.map(e,function(t){return{minutes:_.chain(t).filter(function(t){return t.isConfirmed()}).map(function(t){return t.getMinutes()}).value()}}),_.all(_.rest(t),function(e){return _.isEqual(t[0],e)})?_.chain(e[0]).map(function(t){return t.getMinutes()}).reduce(function(t,e){return t+e},0).value():null},i.prototype.availabilityConsistent=function(){var t;return t=this.getMinutesAvailable(),null!==t&&t>=0},i.prototype.totalAvailabilityConsistent=function(){var t;return t=this.getTotalMinutesAvailable(),null!==t&&t>=0},i.prototype.bookingsConsistent=function(){var t;return t=this.getMinutesBooked(),null!==t&&t>=0},i.prototype.downtimesConsistent=function(){var t,e,i,n,o,r,s,a,l;if(i=_.values(this.get("downtimes")),0===i.length)return!0;t=i[0],s=this.get("downtimes");for(e in s){if(l=s[e],t.length!==l.length)return!1;for(o=n=0,r=t.length;n<r;o=++n)if(a=t[o],!a.isEqual(l[o]))return!1;t=l}return!0},i.prototype.overtimesConsistent=function(){var t,e;return!!this.overtimeSet||(e=_.values(this.get("overtimes")),0===e.length||(t=_.map(e,function(t){return{minutes:_.chain(t).map(function(t){return t.getMinutesAvailable()}).value()}}),_.all(_.rest(t),function(e){return _.isEqual(t[0],e)})))},i.prototype.totalAvailabilityAndBookingsConsistent=function(){return this.totalAvailabilityConsistent()&&this.bookingsConsistent()},i.prototype.totalAvailabilityAndDowntimeConsistent=function(){return this.totalAvailabilityConsistent()&&this.downtimesConsistent()},i.prototype.availabilityAndDowntimeConsistent=function(){return this.availabilityConsistent()&&this.downtimesConsistent()},i.prototype.variesFromNormalAvailability=function(){var t,e;return t=this.getFirstAvailablePeriods().models,e=this.getFirstDefaultPeriods().models,t.length!==e.length||e.some(function(e,i){return!e.getTimeRange().isEqual(t[i].getTimeRange())})},i.prototype.getFirstAvailablePeriods=function(){var t,e,i;if(this._aps)return this._aps;e=this.get("availablePeriods");for(t in e)return i=e[t],this._aps=new RG.Collections.AvailablePeriods(this._deepCloneModels(i,RG.Models.CustomAvailablePeriod)),this._aps.on("add remove reset",function(t){return function(){return t._aps.isDirty=!0}}(this)),this._aps;return new RG.Collections.AvailablePeriods},i.prototype.getFirstDefaultPeriods=function(){var t,e,i;if(this._daps)return this._daps;e=this.get("originalAvailablePeriods");for(t in e)return i=e[t],this._daps=new RG.Collections.AvailablePeriods(this._deepCloneModels(i,RG.Models.CustomAvailablePeriod)),this._daps;return new RG.Collections.AvailablePeriods},i.prototype.getFirstDowntimes=function(){var t,e,i;if(this._downtimes)return this._downtimes;e=this.get("downtimes");for(t in e)return i=e[t],this._downtimes=i,this._downtimes;return this._downtimes=[]},i.prototype.hasAvailabilityChanged=function(){return this.getFirstAvailablePeriods().isDirty},i.prototype.resetAvailability=function(){return this.set("availablePeriods",this.get("originalAvailablePeriods")),this._aps=null,this.hasAvailabilityChanged=function(){return!0}},i.prototype.clearVaryingAvailability=function(){var t,e,i;e=this.get("availablePeriods");for(t in e)i=e[t],this.get("availablePeriods")[t]=[];return this._aps=null,this._overtimes=null,this.availabilityCleared=!0,this.trigger("availabilityReset")},i.prototype.getFirstOvertimes=function(){var t,e,i;if(this._overtimes)return this._overtimes;e=this.get("overtimes");for(t in e)return i=e[t],this._overtimes=new RG.Collections.Overtimes(this._deepCloneModels(i,RG.Models.Overtime)),this._overtimes},i.prototype.overtime=function(){var t,e;return e=this.getFirstOvertimes().length>0?null!=(t=this.getFirstOvertimes().first())?t.get("duration"):void 0:0,[e,this.getCurrentMinutesAvailable()].min()},i.prototype.setOvertime=function(t){return this.overtimeSet=!0,this.getFirstOvertimes().each(function(e){return e.set({duration:t})})},i.prototype.hasOvertimeChanged=function(){var t,e,i,n,o,r,s;i=[],e=function(t){return{duration:t.get("duration")}},o=this.getFirstOvertimes().map(e),s=this.get("overtimes");for(n in s)t=s[n],r=_.map(t,e),i.push(_.isEqual(r,o));return!_.all(i,function(t){return t})},i.prototype.hasNoAvailability=function(){return this.getCurrentMinutesAvailable()<=0},i.prototype.getDateRange=function(){return this.get("dateRange")},i.prototype._deepCloneModels=function(t,e){var i,n,o,r;for(i=[],n=0,o=t.length;n<o;n++)r=t[n],i.push(new e(r.attributes));return i},i.prototype._totalMinutesFromPeriodsAndDowntimes=function(t,e){return 0===e.length?this._totalMinutesFromPeriods(t):_.reduce(t,function(t,i){return t+_.min(_.map(e,function(t){return i.getTimeRange().subtract(t)}))},0)},i.prototype._totalMinutesFromPeriods=function(t){return _.reduce(t,function(t,e){return t+e.getMinutesAvailable()},0)},i}(RG.Models.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.FilterCategory=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return this.optionGroups=new RG.Collections.OptionGroups,this.optionGroups.category=this},i.prototype.getName=function(){return this.get("name")},i}(RG.Models.Base)}.call(this),function(){RG.Models.NullBookingTarget=function(){function t(){}return t.prototype.getTypeDescription=function(){return""},t.prototype.getLongCaption=function(){return""},t.prototype.getLongDescription=function(){return""},t.prototype.getName=function(){return""},t.prototype.toString=function(){return""},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.NullDuration=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.getCaption=function(){return""},i.prototype.getMinutes=function(){return 0},i.prototype.getRepeatCaption=function(){return""},i.prototype.getLongRepeatCaption=function(){return""},i.prototype.isConfirmed=function(){return!0},i}(RG.Models.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.Project=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.getTypeDescription=function(){return"Project"},i.prototype.getLongCaption=function(){var t;return t=""+this.getName(),null!=this.get("client")&&(t=t+"<br>"+this.get("client")),t},i.prototype.getLongDescription=function(){var t;return t=this.getName(),null!=this.get("client")&&(t+=" ("+this.escape("client")+")"),t},i.prototype.getName=function(){return this.escape("name")},i.prototype.toString=function(){return null!=this.get("client")?this.getName()+" | "+this.get("client"):this.getName()},i}(RG.Models.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.SavedFilter=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.urlRoot=function(){return RG.getApiRoot()+"/saved_filters"},i.prototype.getFilter=function(){return JSON.parse(this.get("filter_json"))},i}(Backbone.Model)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Models.VaryingAvailablePeriod=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.toString=function(){return"Availability varies"},i.prototype.isEditable=function(){return!1},i}(Backbone.Model)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.Base=function(e){function i(t,e){e&&(this.model=e.model),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,{silent:!0})}return t(i,e),i.prototype.setModels=function(t){return this.reset(t)},i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.AbstractTimePeriods=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.calculator=function(){return null!=this.calc?this.calc:this.calc=new RG.Utils.TimePeriodsCalculator(this)},i.prototype.getMinutesAvailableInDateRange=function(t){return this.calculator().availableMinutes(t)},i.prototype.removeForDate=function(t){throw"Implement removeForDate in subclasses"},i}(RG.Collections.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.AvailablePeriods=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i}(RG.Collections.AbstractTimePeriods)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.Bookers=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.comparator=function(t){return t.get("name")},i}(Backbone.Collection)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;RG.Collections.Bookings=function(i){function n(){return this.predictWaitingList=t(this.predictWaitingList,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.initialize=function(t){return n.__super__.initialize.apply(this,arguments),this._forDateDurations={},this._overlapsDateBookings={},this.on("add remove reset change",function(t){return function(){return t._forDateDurations={},t._overlapsDateBookings={}}}(this))},n.prototype.forDate=function(t){var e,i,n,o,r,s;for(i=[],s=this.models,o=0,r=s.length;o<r;o++)e=s[o],n=e.getDateRange(),n.isValid()&&n.includes(t)&&i.push(e);return i},n.prototype.startsOnDate=function(t){var e,i,n,o,r;for(i=[],r=this.forDate(t),n=0,o=r.length;n<o;n++)e=r[n],RG.Utils.DateComparator.equalsYMD(t,e.getDateRange().startDate)&&i.push(e);return i},n.prototype.overlapsDate=function(t){var e;return e=t.toString(),this._overlapsDateBookings[e]?this._overlapsDateBookings[e]:this._overlapsDateBookings[e]=this.filter(function(e){var i;return i=e.getDateRange(),i.startDate<t&&i.endDate>=t})},n.prototype.getDurationsForDate=function(t){var e,i,n,o,r,s,a,l,c,u;if(a=t.getTime(),this._forDateDurations[a])return this._forDateDurations[a];for(i=this.forDate(t),o=[],r=0,l=i.length;r<l;r++)for(e=i[r],u=e.durations.models,s=0,c=u.length;s<c;s++)n=u[s],RG.Utils.DateComparator.equalsYMD(n.attributes.date,t)&&o.push(n);return this._forDateDurations[a]=o},n.prototype.predictWaitingList=function(){return this.models.forEach(function(t){return function(e){return RG.renderer.enqueue(new RG.Renderer.ResourceDateLock(t.resource,e.getStartDate(),e.getEndDate()),function(){return e.durations.predictWaitingList()})}}(this)),RG.resizeCards()},n.prototype.getLayerCount=function(){var t;return t=this.map(function(t){return t.layer}).max(),t>=0?t+1:0},n}(RG.Collections.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.CustomAvailablePeriods=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.removeForDate=function(t){var e;return e=this.select(function(e){return function(e){return RG.Utils.DateComparator.equalsYMD(e.get("date"),t)}}(this)),this.remove(e,{silent:!0})},i}(RG.Collections.AbstractTimePeriods)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.CustomFieldOptions=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.CustomFields=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.DowntimeTypes=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.model=RG.Models.DowntimeType,i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.Downtimes=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.model=RG.Models.Downtime,i.prototype.initialize=function(t){return i.__super__.initialize.apply(this,arguments),this._forDateDowntimes={},this._overlapsDateDowntimes={},this._forResourceIndex={},this._forDateInTimeZoneIndex={},this.on("add remove reset change",function(t){return function(){return t._forDateDowntimes={},t._overlapsDateDowntimes={},t._forResourceIndex={},t._forDateInTimeZoneIndex={}}}(this)),this.on("add",function(t){var e,i,n,o,r;if(t&&t.get("resourceIds")){for(n=t.get("resourceIds"),o=[],e=0,i=n.length;e<i;e++)r=n[e],o.push(this.trigger("add:resource_id:"+r,t));return o}}),this.on("remove",function(t){var e,i,n,o,r;if(t&&t.get("resourceIds")){for(n=t.get("resourceIds"),o=[],e=0,i=n.length;e<i;e++)r=n[e],o.push(this.trigger("remove:resource_id:"+r,t));return o}})},i.prototype.forResource=function(t){var e,i;return null!=(e=this._forResourceIndex)[i=t.id]?e[i]:e[i]=this.models.filter(function(e){return e.get("resourceIds").indexOf(t.id)!==-1})},i.prototype.forYear=function(t){return this.models.filter(function(e){return e.inYear(t)})},i.prototype.forDate=function(t){var e;return e=t.toString(),this._forDateDowntimes[e]?this._forDateDowntimes[e]:this._forDateDowntimes[e]=this.models.filter(function(e){return e.isValidOn(t)})},i.prototype.inTimeZone=function(t){var e,i;return i=this.models.map(function(e){return e.inTimeZone(t)}),e=new RG.Collections.Downtimes,e.models=i,e.length=i.length,e},i.prototype.forDateInTimeZone=function(t,e){var i,n,o;return o=(null!=e?e.attributes.offset:void 0)||-1,null!=(i=this._forDateInTimeZoneIndex)[n=[t.valueOf(),o]]?i[n]:i[n]=this.models.filter(function(i){return i.inTimeZone(e).isValidOn(t)})},i.prototype.durationsForDateInTimeZone=function(t,e){var i,n,o,r,s,a,l,c,u;for(o=[],c=this.forDateInTimeZone(t,e),r=0,a=c.length;r<a;r++)for(i=c[r],u=i.inTimeZone(e).getDurations(i),s=0,l=u.length;s<l;s++)n=u[s],n.containsDate(t)&&o.push(n);return o},i.prototype.startsOnDateInTimeZone=function(t,e){var i,n,o,r,s;for(n=[],s=this.forDateInTimeZone(t,e),o=0,r=s.length;o<r;o++)i=s[o],RG.Utils.DateComparator.equalsYMD(t,i.inTimeZone(e).getDateRange().startDate)&&n.push(i);return n},i.prototype.startsOnDate=function(t){var e,i,n,o,r;for(i=[],r=this.forDate(t),n=0,o=r.length;n<o;n++)e=r[n],RG.Utils.DateComparator.equalsYMD(t,e.getDateRange().startDate)&&i.push(e);return i},i.prototype.overlapsDateInTimeZone=function(t,e){var i;return i=t.toString(),this._overlapsDateDowntimes[i]?this._overlapsDateDowntimes[i]:this._overlapsDateDowntimes[i]=this.filter(function(i){var n;return n=i.inTimeZone(e).getDateRange(),n.startDate<t&&n.endDate>=t})},i.prototype.mergedTimeRangesForDate=function(t){var e,i;return i=this.inTimeZone(this.resource.get("timeZone")).forDate(t).map(function(e){return e.getTimeRange(t)}),i.length<2?i:(e=i.pop(),e.merge.apply(e,i))},i}(RG.Collections.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.FilterOptions=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.Overtimes=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.removeForDate=function(t){var e;return e=this.select(function(e){return RG.Utils.DateComparator.equalsYMD(e.get("date"),t)}),this.remove(e,{silent:!0})},i}(RG.Collections.AbstractTimePeriods)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.ResourceInstances=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.model=RG.Models.ResourceInstance,i.prototype.comparator=function(t){var e;return null!=(e=t.getName())?e.toLowerCase():void 0},i.prototype.setVisibleResources=function(t){return this.models.forEach(function(t){return t.visible=!1}),t.forEach(function(t){return t.visible=!0}),this.trigger("change:visible")},i}(RG.Collections.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.ResourceTypes=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.TimeZones=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.model=RG.Models.TimeZone,i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.Clients=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.comparator=function(t){return t.toString().toLowerCase()},i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.DayAvailabilityAggregations=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.comparator=function(t){return t.get("weekDay")||1/0},i}(Backbone.Collection)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;RG.Collections.Durations=function(i){function n(e){this.predictWaitingList=t(this.predictWaitingList,this),n.__super__.constructor.apply(this,arguments),this._betweenDates={},this.on("add remove reset change",function(t){return function(e){var i;e!==!0&&(t._betweenDates={},t.booking&&!t.booking.transient&&null!=(i=t.booking.collection)&&i.trigger("reset"))}}(this))}return e(n,i),n.prototype.betweenDates=function(t,e){var i,n,o,r,s;return n=new RG.Utils.DateRange(t,e).toString(),this._betweenDates[n]?this._betweenDates[n]:(s=!1,r=!1,o=null,i=this.filter(function(i){return o||(o=i.attributes.minutes),s||(s=i.attributes.date<t),r||(r=i.attributes.date>e),i.attributes.date>=t&&i.attributes.date<=e}),0===i.length&&s&&r&&(i=[this._anchorDuration(t,o),this._anchorDuration(e,o)]),this._betweenDates[n]=i)},n.prototype.setColor=function(t){this.each(function(e){return e.set({color:t})})},n.prototype.predictWaitingList=function(){return this.each(function(t){return t.predictWaitingList()}),this.trigger("change",!0)},n.prototype._anchorDuration=function(t,e){var i;return i=new RG.Models.Duration({minutes:0,date:t,waiting:!1}),i.transient=!0,i.realMinutes=e,i.collection=this,i},n}(RG.Collections.Base)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.FilterCategories=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.OptionGroups=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.Projects=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.comparator=function(t){return t.toString().toLowerCase()},i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.ResourceAvailabilityYears=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.model=RG.Models.ResourceAvailabilityYear,i.prototype.totalUsedDays=function(){return _.reduce(this.models,function(t,e){return e.get("numberOfUsedDays")},0)},i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.SavedFilters=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.comparator=function(t){var e;return null!=(e=t.get("name"))?e.toLowerCase():void 0},i.prototype.initialize=function(){i.__super__.initialize.apply(this,arguments),this.on("change:name",function(t){return function(){return t.sort()}}(this))},i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.UnitDurations=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.setColor=function(t){var e,i,n,o;for(n=this.models,e=0,i=n.length;e<i;e++)o=n[e],o.set({color:t})},i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.UnitGroupings=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(){this.on("add",this.addToUnitCollection),this.on("remove",this.removeFromUnitCollection)},i.prototype.comparator=function(t){return t.dateRange.startDate},i.prototype.getUnitCollection=function(){var t,e;return null!=this._units?this._units:(e=new RG.Collections.Units,t=_.flatten(_.map(this.models,function(t){return t.getUnits().models})),e.reset(t),this._units=e)},i.prototype.addToUnitCollection=function(t){var e;return e=t.getUnits(),this.getUnitCollection().models.length&&e.models[0].date<this.getUnitCollection().models[0].date?this._eachUnitReverse(t,function(t){return function(e){return t.getUnitCollection().unshift(e)}}(this)):this._eachUnit(t,function(t){return function(e){return t.getUnitCollection().add(e)}}(this))},i.prototype.removeFromUnitCollection=function(t){this._eachUnit(t,function(t){return function(e){t.getUnitCollection().remove(e)}}(this))},i.prototype._eachUnit=function(t,e){t.getUnits().each(e)},i.prototype._eachUnitReverse=function(t,e){var i,n,o,r;for(r=t.getUnits().models,i=n=o=r.length-1;o<=0?n<=0:n>=0;i=o<=0?++n:--n)e(r[i])},i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Collections.Units=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(){this.on("add",this.notifyAppendOrPrepend)},i.prototype.notifyAppendOrPrepend=function(t,e,i){this.models.length>1&&t===this.models[0]?this.trigger("prepend",t,e,i):this.trigger("append",t,e,i)},i}(Backbone.Collection)}.call(this),function(){RG.Utils.BookingCommandFactory=function(){function t(){}return t.prototype.createDragBookingCommand=function(t,e,i,n,o,r,s,a,l){var c;return e.set({startDate:r[0],endDate:r[r.length-1],saving:!0}),e.durations.reset(o),i.bookings.remove(e),t.bookings.add(e),i.bookings.trigger("add"),c=new RG.Commands.UpdateBookingCommand({booking:e,resource:t,startDate:r[0],endDate:r[r.length-1],bookingDuration:s,successCallback:function(t){return function(t){var i,n,o,r,s;for($(".resources--cal-unit.drag-drop-target").removeClass("drag-drop-target"),e.set({startDate:RG.Utils.BookingMerger.getDateFromStr(t.start_date),endDate:RG.Utils.BookingMerger.getDateFromStr(t.end_date),refreshable:t.refreshable,saving:!1}),r=e.durations.models,n=0,o=r.length;n<o;n++)i=r[n],s=_.find(t.durations,function(t){return t.date===RG.Utils.DateFormatter.getISODate(i.get("date"))}),s&&i.set({waiting:s.waiting});window.update(),RG.renderer.unlock(l)}}(this)}),c.removedDatesCallback=function(e){return function(i,n){var o;return o=new RG.Views.Dialogs.RemovedAvailabilityDates({resource:t,removedAvailabilityDates:i}),e._waitingPopover(t,new Date(i[0]),o,n)}}(this),c.waitingCallback=function(s){return function(u){var h;h=new RG.Views.Dialogs.WaitingListConfirmation({resource:t,waitingDates:u,duration:o[0].getMinutes(),
startTime:o[0].get("startTime"),startDate:r[0],endDate:r[r.length-1],cancelCallback:function(){e.set(a),e.durations.reset(n),t.bookings.remove(e),i.bookings.add(e),t.predictWaitingList(),i!==t&&i.predictWaitingList(),RG.renderer.unlock(l)},callback:function(){var t,i,n,o;for(o=e.durations.models,i=0,n=o.length;i<n;i++)t=o[i],u.indexOf(RG.Utils.DateFormatter.getISODate(t.get("date")))>-1&&t.set({waiting:!0});c.forceWaiting=!0,c.execute()}}),s._waitingPopover(t,new Date(u[0]),h)}}(this),c.archivedCallback=function(o){RG.Utils.BookingService.reset(o,t,e,a,n),t.bookings.remove(e),i.bookings.add(e)},c},t.prototype.createCopyBookingCommand=function(t,e,i,n,o,r,s,a,l){var c,u,h;return h=e.clone(),h.set({id:null,startDate:r[0],endDate:r[r.length-1],saving:!0}),h.durations.reset(o),t.bookings.add(h),u=new RG.Utils.DateRange(r[0],r[r.length-1]),s=new RG.DTO.BookingDuration({startTime:o[0].get("startTime"),duration:o[0].getMinutes()}),c=new RG.Commands.CreateBookingCommand({resource:t,booker:e.get("booker"),dateRange:u,target:e.getBookingTarget(),details:e.get("notes"),bookingDuration:s,successCallback:function(t){return function(t){h.set({id:t.id,saving:!1}),RG.renderer.unlock(l),window.update()}}(this)}),c.removedDatesCallback=function(e){return function(i,n){var o;return o=new RG.Views.Dialogs.RemovedAvailabilityDates({resource:t,removedAvailabilityDates:i}),e._waitingPopover(t,new Date(i[0]),o,n)}}(this),c.waitingCallback=function(e){return function(i){var n;n=new RG.Views.Dialogs.WaitingListConfirmation({resource:t,waitingDates:i,duration:o[0].getMinutes(),startTime:o[0].get("startTime"),startDate:r[0],endDate:r[r.length-1],cancelCallback:function(){t.bookings.remove(h),RG.renderer.unlock(l)},callback:function(){var t,e,n,o;for(o=h.durations.models,e=0,n=o.length;e<n;e++)t=o[e],i.indexOf(RG.Utils.DateFormatter.getISODate(t.get("date")))>-1&&t.set({waiting:!0});c.forceWaiting=!0,c.execute()}}),e._waitingPopover(t,new Date(i[0]),n)}}(this),c.archivedCallback=function(e){RG.Utils.BookingService.reset(e,t,h,a,n),t.bookings.remove(h)},c},t.prototype._waitingPopover=function(t,e,i,n){var o,r;null==n&&(n=i.cancelCallback),o=new RG.Utils.DatePopoverPlacer(t,e),r=new RG.Views.Dialogs.BookingClashPopover({removeAttachTo:!0,attachTo:o.createAnchor({className:"booking-clash-popover-anchor"}),body:i,className:"edit-booking-dropdown booking-clash-management-popover"}),RG.Popovers.replace({popoverView:r,removeCallback:n})},t}()}.call(this),function(){RG.Commands.CreateBookingCommand=function(){function t(t){this.account=t.account||RG.Utils.getCurrentAccount(),this.resource=t.resource,this.booker=t.booker,this.dateRange=t.dateRange,this.target=t.target,this.details=t.details,this.bookingDuration=t.bookingDuration,this.waitingCallback=t.waitingCallback||function(){},this.successCallback=t.successCallback||function(){},this.removedDatesCallback=t.waitingCallback||function(){},this.forceWaiting=t.forceWaiting}return t.prototype.execute=function(){return Q.Promise(function(t){return function(e,i,n){return RG.Utils.BookingDataParser.expirePolls(),$.ajax("/v1/"+t.account.getSubdomain()+"/bookings",{method:"POST",headers:{"X-CSRF-Token":RG.Utils.getCSRFToken()},data:t._getParameters(),dataType:"json",success:function(e){var i;return RG.Popovers.done(),i=function(){if(t.successCallback(e),e.removed_availability_dates.length)return setTimeout(function(){return t.removedDatesCallback(e.removed_availability_dates,e.id)},0)},RG.Utils.BookingDataParser.expirePolls(),RG.renderer.renderAfter([{fn:i,lock:new RG.Renderer.GlobalLock}])},error:function(e){var i;return i=JSON.parse(e.responseText),i.waiting?t.waitingCallback(i.waiting_dates):t.archivedCallback(i),RG.Utils.BookingDataParser.expirePolls()}}),e()}}(this))},t.prototype._getParameters=function(){var t;return t={resource_id:this.resource.id,booker_id:this.booker.id,start_date:RG.Utils.DateFormatter.getISODate(this.dateRange.startDate),end_date:RG.Utils.DateFormatter.getISODate(this.dateRange.endDate),details:this.details,duration:this.bookingDuration.duration,start_time:this.bookingDuration.startTime,allow_waiting:this.forceWaiting},this._assignProjectOrClient(t),t},t.prototype._assignProjectOrClient=function(t){this.target&&(this.target.constructor===RG.Models.Client?t.client_id=this.target.id:this.target.constructor===RG.Models.Project&&(t.project_id=this.target.id))},t}()}.call(this),function(){RG.Commands.CreateDowntimeCommand=function(){function t(t){this.timeZones=t.timeZones,this.account=t.account,this.resources=t.resources,this.booker=t.booker,this.dateTimeRange=t.dateTimeRange,this.timeZone=t.timeZone,this.details=t.details,this.leave=t.leave,this.type=t.type,this.preExecuteCallback=t.preExecuteCallback||function(){},this.successCallback=t.successCallback||function(){},this.errorCallback=t.errorCallback||function(){},this.dataDateRange=RG.Variables.dataDateRange||this.dateTimeRange.dateRange}return t.prototype.execute=function(t){var e,i,n;null==t&&(t={}),n=this._getParameters(),void 0!==t.delete&&(n.delete_invalid_bookings=t.delete),e={successCallback:this.successCallback,errorCallback:this.errorCallback},i=this._buildDowntime(n),this.preExecuteCallback(i,this.getClashingBookings(),n.delete_invalid_bookings),RG.Utils.DowntimeService.createDowntime(i,n,e).catch(function(t){console.log(t.message)})},t.prototype.getClashingBookingsFromServer=function(t){var e,i;return e=this._getParameters(),i=$.ajax("/v1/"+this.account.getSubdomain()+"/downtimes/clashes",{method:"POST",headers:{"X-CSRF-Token":RG.Utils.getCSRFToken()},data:e,dataType:"json",success:function(e){return function(i){var n;parseInt(i.length,10)>0?(n=i.map(function(t){var e;return e=new RG.Models.Duration(t),e.collection={collection:{booking:{getBooker:function(){return window.bookers.findWhere({id:e.attributes.booker_id})}}}}}),e._clashingBookings=n,"function"==typeof t.success&&t.success(n)):"function"==typeof t.fail&&t.fail()}}(this)})},t.prototype.getClashingBookings=function(){var t,e,i,n,o,r,s,a,l,c,u,h,d,p,f,g,m,v,y;for(n=[],m=this.resources,u=0,p=m.length;u<p;u++)for(v=m[u],e=new RG.Utils.AvailabilityManager({resource:v,availablePeriods:v.availablePeriods,customAvailablePeriods:v.customAvailablePeriods,overtimes:v.overtimes,downtimes:new RG.Collections.Downtimes(v.downtimes.map(function(t){return t.clone()})),timeZone:v.getTimeZone(),ignoreEvents:!0}),l=new RG.Models.Downtime({resourcedIds:[v.id],from:this.dateTimeRange.dateRange.startDate,to:this.dateTimeRange.dateRange.endDate,timeZone:window.timeZones.findWhere({name:this.timeZone}),startTime:this.dateTimeRange.timeRange.startTime,endTime:this.dateTimeRange.timeRange.endTime}).inTimeZone(v.getTimeZone()),e.downtimes.add(l),s=l.getDateRange(),a=s.getDates(),h=0,f=a.length;h<f;h++)for(r=a[h],t=v.bookings.getDurationsForDate(r),o=t.filter(function(t){return t.isConfirmed()&&t.getMinutes()>0}).sort(function(t,e){return t.getMinutes()-e.getMinutes()}),i=e.getMinutesAvailableForDate(r),y=0,d=0,g=o.length;d<g;d++)c=o[d],c.isFixed()&&e.intersectsWithDowntime(r,c.getTimeRange())||!this._fitsInFirstOrLastDate(c,s,r,l.startTime,l.endTime,i,y)?n.push(c):y+=c.getMinutes();return this._clashingBookings=n},t.prototype.willTouchBookings=function(t){var e;null==t&&(t={}),this._buildDowntime(this._getParameters()),this.outsideDataDateRange()?this.getClashingBookingsFromServer(t):(e=this.getClashingBookings(),e.length>0?"function"==typeof t.success&&t.success(e):"function"==typeof t.fail&&t.fail())},t.prototype.outsideDataDateRange=function(){return!this.dataDateRange.contains(this.dateTimeRange.dateRange)},t.prototype._buildDowntime=function(t){return null!=this.downtime?this.downtime:this.downtime=new RG.Models.Downtime({resourceIds:t.resource_ids,creatorId:t.creator_id,from:this.dateTimeRange.dateRange.startDate,to:this.dateTimeRange.dateRange.endDate,timeZone:this.timeZones.findWhere({name:t.timezone}),startTime:t.start_time,endTime:t.end_time,details:t.details,leave:t.leave,downtimeType:this.type})},t.prototype._getParameters=function(){return null!=this.params?this.params:this.params={resource_ids:_.map(this.resources,function(t){return t.id}),creator_id:this.booker.id,from:RG.Utils.DateFormatter.getISODate(this.dateTimeRange.dateRange.startDate),to:RG.Utils.DateFormatter.getISODate(this.dateTimeRange.dateRange.endDate),start_time:this.dateTimeRange.timeRange.startTime,end_time:this.dateTimeRange.timeRange.endTime,details:this.details,leave:this.leave,timezone:this.timeZone,downtime_type_id:this.type?this.type.id:null}},t.prototype._fitsInFirstOrLastDate=function(t,e,i,n,o,r,s){return RG.Utils.DateComparator.equalsYMD(i,e.startDate)?t.endsBeforeTime(n)||s+t.getMinutes()<=r:!!RG.Utils.DateComparator.equalsYMD(i,e.endDate)&&(t.startsAfterTime(o)||s+t.getMinutes()<=r)},t}()}.call(this),function(){RG.Utils.DowntimeCommandFactory=function(){function t(){}return t.prototype.createUpdateCommand=function(t,e,i,n,o,r){return new RG.Commands.UpdateDowntimeCommand({downtime:t,account:e,booker:window.bookers.findWhere({id:t.get("creatorId")})||window.deletedBookers.findWhere({id:t.get("creatorId")})||{id:window.currentUserId},resources:i,dateTimeRange:n,details:t.get("details"),timeZones:window.timeZones,timeZone:t.getTimeZone().getParamValue(),type:t.getDowntimeType(),preExecuteCallback:function(t,e,i){RG.Popovers.done(),RG.Popovers.popoverActive=!1,RG.Popovers.locked=!1},successCallback:function(t){return function(t){var e;RG.renderer.unlock(r),e=function(){return o.set({saving:!1}),window.update()},RG.renderer.renderAfter([{fn:e,lock:new RG.Renderer.GlobalLock}])}}(this)})},t.prototype.createCommand=function(t,e,i,n,o){return new RG.Commands.CreateDowntimeCommand({account:t,booker:window.currentUserId,resources:e,dateTimeRange:i,details:n.get("details"),timeZones:window.timeZones,timeZone:n.getTimeZone().getParamValue(),type:n.getDowntimeType(),preExecuteCallback:function(t,e,i){RG.Popovers.locked=!1,RG.Popovers.popoverActive=!1,RG.Popovers.done()},successCallback:function(t){return function(t){n.set({saving:!1,id:t.id}),RG.renderer.unlock(o),window.update(),RG.renderer.unlock(o)}}(this)})},t}()}.call(this),function(){RG.Commands.ResetToNormalAvailabilityCommand=function(){function t(t){this.dates=t.dates,this.resourceInstanceId=t.resourceInstanceId}return t.prototype.execute=function(){return Q.Promise(function(t){return function(e,i,n){return $.ajax(RG.getApiRoot()+"/custom_available_periods/reset",{method:"DELETE",timeout:3e4,headers:{"X-CSRF-Token":RG.Utils.getCSRFToken()},data:{dates:t.dates,resource_instance_id:t.resourceInstanceId},success:function(){return e("Availability reset")}})}}(this))},t}()}.call(this),function(){RG.Commands.UpdateAvailabilityCommand=function(){function t(t){this.account=t.account,this.resource=t.resource,this.changedDays=t.changedDays,this.dateRange=t.dateRange,this.forceWaiting=t.forceWaiting,this.preExecuteCallback=t.preExecuteCallback||function(){},this.successCallback=t.successCallback||function(){},this.dataDateRange=RG.Variables.dataDateRange||this.dateRange}return t.prototype.execute=function(t){var e;return null==t&&(t={}),this.preExecuteCallback(this.getClashingBookings(),t),e=this._getParameters(),void 0!==t.delete&&(e.delete_invalid_bookings=t.delete),$.ajax("/v1/"+this.account.getSubdomain()+"/custom_available_periods",{contentType:"application/json",method:"POST",headers:{"X-CSRF-Token":RG.Utils.getCSRFToken()},data:JSON.stringify(e),dataType:"json",success:function(t){return function(e){return t.successCallback(e)}}(this)})},t.prototype.getClashingBookingsFromServer=function(t){var e;return e=this._getParameters(),$.ajax("/v1/"+this.account.getSubdomain()+"/custom_available_periods/clashes",{contentType:"application/json",method:"POST",headers:{"X-CSRF-Token":RG.Utils.getCSRFToken()},data:JSON.stringify(e),dataType:"json",success:function(e){return function(i){return i.length>0?(e._clashingBookings=[],t.success(i.length)):t.fail()}}(this),error:function(t){return function(t){var e;return e=JSON.parse(t.responseText)}}(this)})},t.prototype.willTouchBookings=function(t){return null==t&&(t={}),this.outsideDataDateRange()?this.getClashingBookingsFromServer(t):this.getClashingBookings().length>0?t.success():t.fail()},t.prototype.outsideDataDateRange=function(){return!this.dataDateRange.contains(this.dateRange)},t.prototype.getClashingBookings=function(){var t,e,i,n,o,r,s,a,l,c,u,h,d,p,f,g;if(this._clashingBookings)return this._clashingBookings;if(0===this.changedDays.length)return[];for(l=_.groupBy(this.changedDays,function(t){return t.get("weekDay")}),n=[],p=this.dateRange.getDates(),a=0,h=p.length;a<h;a++)if(r=p[a],t=null!=(f=l[r.getDay()])?f[0]:void 0)for(i=t.getCurrentMinutesAvailable(),e=this.resource.bookings.getDurationsForDate(r),o=_.filter(e,function(t){return t.isConfirmed()}),g=0,u=0,d=o.length;u<d;u++)s=o[u],c=!1,s.isFixed()&&(c=!t.getFirstAvailablePeriods().any(function(t){return t.contains(s.getTimeRange())})),(c||g+s.getMinutes()>i)&&n.push(s),g+=s.getMinutes();return this._clashingBookings=n},t.prototype._getParameters=function(){var t;return t={custom_available_periods:{resource_instance_id:this.resource.id,start_date:RG.Utils.DateFormatter.getISODate(this.dateRange.startDate),end_date:RG.Utils.DateFormatter.getISODate(this.dateRange.endDate),days:this._getTimeDaysParameters()}}},t.prototype._getTimeDaysParameters=function(){var t,e,i,n,o,r;for(e={},o=this.changedDays,i=0,n=o.length;i<n;i++)t=o[i],r=t.getFirstAvailablePeriods().map(function(t){return{start_time:t.get("startTime"),end_time:t.get("endTime")}}),r=_.select(r,function(t){return t.start_time!==t.end_time}),e[t.get("weekDay").toString()]={time_blocks:r};return e},t}()}.call(this),function(){RG.Commands.UpdateBookingCommand=function(){function t(t){this.account=t.account||RG.Utils.getCurrentAccount(),this.booking=t.booking,this.booker=t.booker,this.startDate=t.startDate,this.endDate=t.endDate,this.resource=t.resource,this.target=t.target,this.clearTarget=t.clearTarget,this.details=t.details,this.bookingDuration=t.bookingDuration,this.forceWaiting=t.forceWaiting,this.waitingCallback=t.waitingCallback||function(){},this.removedDatesCallback=t.waitingCallback||function(){},this.successCallback=t.successCallback||function(){}}return t.prototype.execute=function(){return RG.Utils.BookingDataParser.expirePolls(),$.ajax("/v1/"+this.account.getSubdomain()+"/bookings/"+this.booking.id,{method:"PUT",data:this._getParameters(),dataType:"json",success:function(t){return function(e){return RG.Popovers.locked=!1,RG.Popovers.done(),t.successCallback(e),t.resource.predictWaitingList(),e.removed_availability_dates.length&&setTimeout(function(){return t.removedDatesCallback(e.removed_availability_dates)},0),RG.Utils.BookingDataParser.expirePolls()}}(this),error:function(t){return function(e){var i;return i=JSON.parse(e.responseText),i.waiting?t.waitingCallback(i.waiting_dates):t.archivedCallback(i)}}(this)})},t.prototype._getParameters=function(){var t;return t={},this.startDate&&(t.start_date=RG.Utils.DateFormatter.getISODate(this.startDate)),this.endDate&&(t.end_date=RG.Utils.DateFormatter.getISODate(this.endDate)),this.booker&&(t.booker_id=this.booker.id),this.resource&&(t.resource_id=this.resource.id),this.target&&!this.clearTarget&&(this.target.constructor===RG.Models.Project?t.project_id=this.target.id:this.target.constructor===RG.Models.Client&&(t.client_id=this.target.id)),this.clearTarget&&(t.project_id=null,t.client_id=null),(this.details||""===this.details)&&(t.details=this.details),this.bookingDuration&&(t.duration=this.bookingDuration.duration,0===this.bookingDuration.startTime?t.start_time=0:t.start_time=this.bookingDuration.startTime||null,null!==t.start_time&&(t.start_time=""+t.start_time)),this.forceWaiting&&(t.allow_waiting=!0),t},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Commands.UpdateDowntimeCommand=function(e){function i(t){i.__super__.constructor.apply(this,arguments),this.downtime=t.downtime}return t(i,e),i.prototype.execute=function(t){var e;return null==t&&(t={}),e=this._getParameters(),void 0!==t.delete&&(e.delete_invalid_bookings=t.delete),t={successCallback:this.successCallback,errorCallback:this.errorCallback},this.preExecuteCallback(this._buildDowntime(e),this.getClashingBookings(),e.delete_invalid_bookings),RG.Utils.DowntimeService.updateDowntime(this.downtime.id,e,t)},i.prototype._buildDowntime=function(t){var e;return this.downtime.set({resourceIds:t.resource_ids,creatorId:t.creator_id,from:this.dateTimeRange.dateRange.startDate,to:this.dateTimeRange.dateRange.endDate,timeZone:this.timeZones.findWhere({name:t.timezone}),startTime:t.start_time,endTime:t.end_time,details:t.details,leave:t.leave,downtimeTypeId:null!=(e=this.type)?e.id:void 0,downtimeType:this.type}),this.downtime},i}(RG.Commands.CreateDowntimeCommand)}.call(this),function(){RG.Commands.UpdateNoticeCommand=function(){function t(t){this.data={},this.data[t.dismissedField]=!0}return t.prototype.execute=function(){return $.ajax("/v1/update_notice",{method:"PUT",data:this.data,dataType:"json"})},t}()}.call(this),function(){RG.Commands.UpdateOvertimeCommand=function(){function t(t){this.account=t.account||RG.Utils.getCurrentAccount(),this.resource=t.resource,this.changedDays=t.changedDays,this.dateRange=t.dateRange,this.forceWaiting=t.forceWaiting,this.successCallback=t.successCallback}return t.prototype.execute=function(){return RG.Popovers.done(),$.ajax("/v1/"+this.account.getSubdomain()+"/overtimes",{contentType:"application/json",method:"POST",headers:{"X-CSRF-Token":RG.Utils.getCSRFToken()},data:JSON.stringify(this._getParameters()),dataType:"json",success:function(t){return function(e){return"function"==typeof t.successCallback?t.successCallback(e):void 0}}(this),error:function(t){return function(e){var i;return i=JSON.parse(e.responseText),"function"==typeof t.waitingCallback?t.waitingCallback(i.waiting_dates):void 0}}(this)})},t.prototype._getParameters=function(){var t;return t={overtimes:{resource_instance_id:this.resource.id,start_date:RG.Utils.DateFormatter.getISODate(this.dateRange.startDate),end_date:RG.Utils.DateFormatter.getISODate(this.dateRange.endDate),days:this._getTimeDaysParameters()}}},t.prototype._getTimeDaysParameters=function(){var t,e,i,n,o;for(e={},o=this.changedDays,i=0,n=o.length;i<n;i++)t=o[i],e[t.get("weekDay").toString()]=t.overtime();return e},t}()}.call(this),function(){RG.Controllers.DayUnitGroupings=function(){function t(t){this.periodGroupings=t,_.extend(this,Backbone.Events),this.htmlElement=document.querySelector("html"),this.clientWidth=this.htmlElement.clientWidth,$(window).on("resize",function(t){return function(){return t.clientWidth=t.htmlElement.clientWidth}}(this))}return t.prototype.init=function(t,e){var i,n;this.initialDate=e,i=new Date(t.getFullYear(),t.getMonth(),t.getDate()+6),n=this._createUnitGroupingFromDates(t,i),this.periodGroupings.add(n)},t.prototype.append=function(t){var e,i,n,o,r,s,a;for(null==t&&(t=1),n=o=1,r=t;1<=r?o<=r:o>=r;n=1<=r?++o:--o)e=this._endDate(),s=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1),i=new Date(s.getFullYear(),s.getMonth(),s.getDate()+6),a=this._createUnitGroupingFromDates(s,i),this.periodGroupings.add(a);for(;this.periodGroupings.length>this._screenWidthPeriods();)this.periodGroupings.remove(this.periodGroupings.models[0]);this.updateUI(),this.trigger("append")},t.prototype.prepend=function(t){var e,i,n,o,r,s,a;for(null==t&&(t=1),n=o=1,r=t;1<=r?o<=r:o>=r;n=1<=r?++o:--o)e=this._startDate(),i=new Date(e.getFullYear(),e.getMonth(),e.getDate()-1),s=new Date(i.getFullYear(),i.getMonth(),i.getDate()-6),a=this._createUnitGroupingFromDates(s,i),this.periodGroupings.unshift(a);for(;this.periodGroupings.length>this._screenWidthPeriods();)this.periodGroupings.remove(this.periodGroupings.models[this._screenWidthPeriods()]);this.updateUI(),this.trigger("prepend")},t.prototype.scrollToDate=function(t){var e;return e=RG.getCurrentResource(),e&&(localStorage.lastResourceId=e.id),localStorage.filterBarWasCollapsed=!$("nav ul.filters").hasClass("open"),$("#loader").show(),$("#calendar").hide(),setTimeout(function(){t=RG.Utils.DateFormatter.getISODate(t),window.location.hash=t,window.location.reload()},300),!0},t.prototype.triggerChange=function(){this.periodGroupings.getUnitCollection().each(function(t){t.trigger("change",t)}),this.periodGroupings.getUnitCollection().trigger("change")},t.prototype.updateUI=function(){$("span#active-year").text(this.initialDate.getFullYear().toString()),$("#jump-to-year-options li").removeClass("active"),$("#jump-to-year-options li[data-year="+this.initialDate.getFullYear().toString()+"]").addClass("active")},t.prototype._endDate=function(){return this.periodGroupings.models[this.periodGroupings.models.length-1].dateRange.endDate},t.prototype._startDate=function(){return this.periodGroupings.models[0].dateRange.startDate},t.prototype._screenWidthPeriods=function(){return Math.ceil(this.clientWidth/280)+3|0},t.prototype._createUnitGroupingFromDates=function(t,e){var i;return i=new RG.Utils.DateRange(t,e),new RG.Calendar.Units.DayUnitGrouping(i)},t}()}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};RG.Controllers.TimeAllocationLayers=function(){function i(t,i){this.bookingsCollection=t,this.downtimesCollection=i,this.resetLayers=e(this.resetLayers,this),this._bindEvents()}return i.prototype.layerFor=function(t,e){var i,n,o,r,s,a,l,c,u,h;if(t.original.isExclusivelyOnWaitingList())return null;for(u=t.modified.getDateRange(),l=[],c=u.getDates(),r=0,a=c.length;r<a;r++)i=c[r],n=RG.Utils.DateFormatter.getISODate(i),l=l.concat(this.overlapIndex[n]);for(l=l.filter(function(e){return e!==t}),h=l.map(function(t){return t.original.layer}),o=s=0;s<=1e3;o=++s)if(h.indexOf(o)===-1)return o},i.prototype._indexOverlappingTimeAllocations=function(t){var e,i,n,o,r,s,a,l,c;for(this.overlapIndex={},o=0,s=t.length;o<s;o++)for(c=t[o],l=c.modified.getDateRange().getDates(),r=0,a=l.length;r<a;r++)i=l[r],n=RG.Utils.DateFormatter.getISODate(i),null==(e=this.overlapIndex)[n]&&(e[n]=[]),this.overlapIndex[n].push(c)},i.prototype.resetLayers=function(){RG.backburner.deferOnce("layers",this,this._resetLayers)},i.prototype._resetLayers=function(){var t,e,i,n,o,r;for(this._unbindEvents(),r=this._getTimeAllocations(),r=this._tetrisSort(r),t=0,i=r.length;t<i;t++)o=r[t],o.original.previousLayer=o.original.layer,o.original.layer=null;for(this._indexOverlappingTimeAllocations(r),e=0,n=r.length;e<n;e++)o=r[e],o.original.layer=this.layerFor(o,r),o.original.previousLayer&&o.original.layer!==o.original.previousLayer&&o.original.trigger("change",o.original);return this._bindEvents()},i.prototype._bindEvents=function(){this.bookingsCollection.on("add",this.resetLayers),this.bookingsCollection.on("remove",this.resetLayers),this.bookingsCollection.on("change",this.resetLayers),this.bookingsCollection.on("reset",this.resetLayers),this.downtimesCollection.on("add",this.resetLayers),this.downtimesCollection.on("remove",this.resetLayers),this.downtimesCollection.on("change",this.resetLayers),this.downtimesCollection.on("reset",this.resetLayers)},i.prototype._unbindEvents=function(){this.bookingsCollection.off("add",this.resetLayers),this.bookingsCollection.off("remove",this.resetLayers),this.bookingsCollection.off("change",this.resetLayers),this.bookingsCollection.off("reset",this.resetLayers),this.downtimesCollection.off("add",this.resetLayers),this.downtimesCollection.off("remove",this.resetLayers),this.downtimesCollection.off("change",this.resetLayers),this.downtimesCollection.off("reset",this.resetLayers)},i.prototype.close=function(){this._unbindEvents()},i.prototype._tetrisSort=function(t){return t=_.sortBy(t,function(t){return-t.modified.getEndDate()}),_.sortBy(t,function(t){return t.modified.getStartDate()})},i.prototype._getTimeAllocations=function(){var e,i,n,o;return i=_.sortBy(this.bookingsCollection.models,function(t){return t._getFirstDuration().get("startTime")}),e=[].concat(i.map(function(e){return new t(e,e)})),o=null!=(n=this.downtimesCollection.resource)?n.get("timeZone"):void 0,e=e.concat(this.downtimesCollection.models.map(function(e){return new t(e,e.inTimeZoneSimple(o))}))},i}(),t=function(){function t(t,e){this.original=t,this.modified=e}return t}()}.call(this),function(){RG.FSM.BaseState=function(){function t(t){this.ui=t.ui,this.event=t.event,this.interaction=t.interaction,this.entered=!1,this.exited=!1}return t.prototype.startDrag="startDrag",t.prototype.dragging="dragging",t.prototype.dropped="dropped",t.prototype.handleInput=function(t){throw"Not Implemented"},t.prototype.enter=function(){return this.entered=!0,this.exited=!1},t.prototype.exit=function(){return this.entered=!1,this.exited=!0},t.prototype.update=function(){if(!this.entered)return this.enter()},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.FSM.BookingState=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.handleInput=function(t){if(t===this.startDrag)return new RG.FSM.BookingStartDragState({ui:this.ui,event:this.event,interaction:this.interaction});throw"Input not implemented"},i}(RG.FSM.BaseState)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.FSM.DowntimeState=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.handleInput=function(t){if(t===this.startDrag)return new RG.FSM.DowntimeStartDragState({ui:this.ui,event:this.event,interaction:this.interaction});throw"Input not implemented"},i}(RG.FSM.BaseState)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.FSM.BookingDraggingState=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.handleInput=function(t){if(t===this.dropped)return new RG.FSM.BookingDroppedState({ui:this.ui,event:this.event,interaction:this.interaction});if(t===this.dragging)return this.update(),this;throw"Input not implemented"},i.prototype.enter=function(){return i.__super__.enter.apply(this,arguments),RG.Popovers.clear(),Q.delay(300).then(function(){return RG.Popovers.popoverActive=!1})},i.prototype.update=function(){var t,e,n,o,r,s,a;i.__super__.update.apply(this,arguments),t=this.interaction.bookingView,$(".resources--cal-unit.drag-drop-target").removeClass("drag-drop-target"),window.getSelection().removeAllRanges();try{if(!RG.Utils.Permissions.canManage(t.model)||RG.Popovers.locked)return t._calculator.targetDate=null,t._calculator.resource=null,this.interaction.bookingViewEl.draggable("option","revert",!0),$(".booking.ui-draggable-dragging").addClass("no-drop"),void $("body").css({cursor:"no-drop"});for(t._calculator.targetDate=RG.getDateAtClientX(this.event.clientX),t._calculator.resource=RG.getResourceAtClientY(this.event.clientY),n=t._calculator.getNewDates(),r=0,s=n.length;r<s;r++)e=n[r],a=$("#"+RG.Utils.generateTimeUnitId(t._calculator.resource.cid,e)),a.addClass("drag-drop-target");n.length>0?(this.interaction.bookingViewEl.draggable("option","revert",!1),$(".booking.ui-draggable-dragging").removeClass("no-drop"),$("body").css({cursor:"move"})):(this.interaction.bookingViewEl.draggable("option","revert",!0),$(".booking.ui-draggable-dragging").addClass("no-drop"),$("body").css({cursor:"no-drop"}))}catch(e){return o=e,t._calculator.targetDate=null,t._calculator.resource=null,this.interaction.bookingViewEl.draggable("option","revert",!0),$(".booking.ui-draggable-dragging").addClass("no-drop"),$("body").css({cursor:"no-drop"})}},i}(RG.FSM.BookingState)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.FSM.BookingDroppedState=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.enter=function(){var t,e,i,n,o,r,s,a,l,c,u,h,d,p,f,g,m;i=this.interaction.bookingView,i._stopPropagation(this.event),$(".resources--cal-unit.drag-drop-target").removeClass("drag-drop-target"),$("body").css({cursor:""}),this.interaction.eventsOff();try{if(RG.Utils.BookingDataParser.expirePolls(),m=i._calculator.resource,t=i.model.realBooking,g=i._getBookingResource(),g&&m&&g.get("id")!==m.get("id")&&g.bookings.trigger("remove"),!m||!i._calculator.targetDate||i.model.hasNoDurations()||RG.Utils.DateComparator.equalsYMD(i._calculator.sourceDate,i._calculator.targetDate)&&m===g&&!this.event.shiftKey)return this.interaction.bookingViewEl.css({opacity:""}),this.interaction.relatedBookings.forEach(function(t){return t.style.opacity=""}),void RG.renderer.unlock(this.interaction.rendererLock);if(p={startDate:t.get("startDate"),endDate:t.get("endDate"),saving:!1},f=t.durations.models,r=i._calculator.getNewDates()){if(this._datesUnchanged(r,p,g,m))return this.interaction.bookingViewEl.css({opacity:""}),void this.interaction.relatedBookings.forEach(function(t){return t.style.opacity=""});if(l=t._getFirstDuration(),d=[],e=new RG.DTO.BookingDuration({startTime:l.get("startTime"),duration:l.getMinutes()}),m.isHuman()&&l.constructor!==RG.Models.FixedDuration){if(l.constructor===RG.Models.Duration)for(c=0,h=r.length;c<h;c++)o=r[c],d.push(new RG.Models.Duration({date:o,minutes:e.duration,waiting:!1}))}else for(e.startTime=e.startTime||"0",a=0,u=r.length;a<u;a++)o=r[a],d.push(new RG.Models.FixedDuration({date:o,startTime:e.startTime,endTime:e.startTime+e.duration,waiting:!1}));n=null,m.predictWaitingList(),n=this.event.shiftKey?this.commandFactory.createCopyBookingCommand(m,t,g,f,d,r,e,p,this.interaction.rendererLock):this.commandFactory.createDragBookingCommand(m,t,g,f,d,r,e,p,this.interaction.rendererLock),RG.renderer.unlock(this.interaction.rendererLock),t.trigger("change",t),n.execute()}else this.interaction.bookingViewEl.draggable("option","revert",!0)}catch(t){throw s=t,RG.renderer.unlock(this.interaction.rendererLock),this.interaction.bookingViewEl.draggable("option","revert",!0),s}this.interaction.helperView.remove(),RG.renderer.unlock(this.interaction.rendererLock)},i.prototype._datesUnchanged=function(t,e,i,n){return 0===t.length||!this.event.shiftKey&&i.id===n.id&&(RG.Utils.DateComparator.equalsYMD(t[0],e.startDate)&&RG.Utils.DateComparator.equalsYMD(t[t.length-1],e.endDate))},i}(RG.FSM.BookingState)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.FSM.BookingStartDragState=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.handleInput=function(t){if(t===this.dragging)return new RG.FSM.BookingDraggingState({ui:this.ui,event:this.event,interaction:this.interaction});throw"Input not implemented"},i.prototype.enter=function(){var t,e,n;i.__super__.enter.apply(this,arguments);try{for(window.getSelection().removeAllRanges(),this.event.shiftKey||(this.interaction.bookingViewEl.css({opacity:.5}),this.interaction.relatedBookings.forEach(function(t){return t.style.opacity=.5})),this.interaction.helper=$(document.querySelectorAll(".booking.ui-draggable-dragging")[0]),this.interaction.eventsOn(),this.interaction.keyEvent(this.event),t=this.interaction.bookingView._getDurationAtOffset(this.event.pageX-this.interaction.bookingViewOffsetLeft),n=0;!t;)n+=10,
t=this.interaction.bookingView._getDurationAtOffset(this.event.pageX-this.interaction.bookingViewOffsetLeft-n)||this.interaction.bookingView._getDurationAtOffset(this.event.pageX-this.interaction.bookingViewOffsetLeft+n);this._setBookingCalculator(t)}catch(t){throw e=t,RG.renderer.unlock(this.interaction.rendererLock),e}},i.prototype._setBookingCalculator=function(t){this.interaction.bookingView._calculator=new RG.Interactions.MoveBookingDates({booking:this.interaction.bookingView.model.realBooking,sourceDate:t.get("date")})},i}(RG.FSM.BookingState)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.FSM.DowntimeDraggingState=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.handleInput=function(t){if(t===this.dropped)return new RG.FSM.DowntimeDroppedState({ui:this.ui,event:this.event,interaction:this.interaction});if(t===this.dragging)return this.update(),this;throw"Input not implemented"},i.prototype.enter=function(){return i.__super__.enter.apply(this,arguments),RG.Popovers.clear(),Q.delay(300).then(function(){return RG.Popovers.popoverActive=!1}),this.update()},i.prototype.update=function(){var t,e,n,o,r,s,a;i.__super__.update.apply(this,arguments),t=this.interaction.bookingView,$(".resources--cal-unit.drag-drop-target").removeClass("drag-drop-target"),window.getSelection().removeAllRanges();try{if(!RG.Utils.Permissions.canManageDowntime(t.model)||RG.Popovers.locked)return t._calculator.targetDate=null,t._calculator.resource=null,this.interaction.bookingViewEl.draggable("option","revert",!0),$(".booking.ui-draggable-dragging").addClass("no-drop"),void $("body").css({cursor:"no-drop"});for(t._calculator.targetDate=RG.getDateAtClientX(this.event.clientX),t._calculator.resource=RG.getResourceAtClientY(this.event.clientY),n=t._calculator.getNewDates(),r=0,s=n.length;r<s;r++)e=n[r],a=$("#"+RG.Utils.generateTimeUnitId(t._calculator.resource.cid,e)),a.addClass("drag-drop-target");this.interaction.bookingViewEl.draggable("option","revert",!1),$(".booking.ui-draggable-dragging").removeClass("no-drop"),$("body").css({cursor:"move"})}catch(e){return o=e,t._calculator.targetDate=null,t._calculator.resource=null,this.interaction.bookingViewEl.draggable("option","revert",!0),$(".booking.ui-draggable-dragging").addClass("no-drop"),$("body").css({cursor:"no-drop"})}},i}(RG.FSM.BookingState)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.FSM.DowntimeDroppedState=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.enter=function(){var t,e,i,n,o,r,s,a;t=this.interaction.bookingView,t._stopPropagation(this.event),$(".resources--cal-unit.drag-drop-target").removeClass("drag-drop-target"),$("body").css({cursor:""}),this.interaction.eventsOff();try{if(a=t._calculator.resource,n=t.model.realBooking,s=t._getBookingResource(),!a||!t._calculator.targetDate||RG.Utils.DateComparator.equalsYMD(t._calculator.sourceDate,t._calculator.targetDate)&&a===s&&!this.event.shiftKey)return this.interaction.bookingViewEl.css({opacity:""}),this.interaction.relatedBookings.forEach(function(t){return t.style.opacity=""}),void RG.renderer.unlock(this.interaction.rendererLock);if(r={from:n.get("from"),to:n.get("to"),resourceIds:n.get("resourceIds"),saving:!1},i=t._calculator.getNewDates())return 0===i.length?(this.interaction.bookingViewEl.css({opacity:""}),void this.interaction.relatedBookings.forEach(function(t){return t.style.opacity=""})):(e=null,this.event.shiftKey?void this._copyDowntime(i,n,a,s):void this._dragDowntime(i,n,a,s,r));this.interaction.bookingViewEl.draggable("option","revert",!0),RG.renderer.unlock(this.interaction.rendererLock)}catch(t){throw o=t,RG.renderer.unlock(this.interaction.rendererLock),this.interaction.bookingViewEl.draggable("option","revert",!0),o}this.interaction.helperView.remove(),RG.renderer.unlock(this.interaction.rendererLock)},i.prototype._dragDowntime=function(t,e,i,n,o){var r,s,a,l,c,u,h,d,p;p=t[0],l=t[t.length-1],e.set({from:t[0],to:t[t.length-1],saving:!0}),a={dateRange:e.getDateRange(),timeRange:e.getRawTimeRange()},r=i.account,h=e.get("resourceIds"),h=h.filter(function(t){return t!==n.id}),h.push(i.id),e.set("resourceIds",h),d=window.resources.select(function(t){return _.include(e.get("resourceIds"),t.id)}),c=window.downtimes.findWhere({id:e.id}),c.set(e.attributes),s=this.commandFactory.createUpdateCommand(e,r,d,a,c,this.interaction.rendererLock),u=function(t){return function(){c.set(o),RG.Popovers.locked=!1,RG.renderer.unlock(t.interaction.rendererLock)}}(this),s.willTouchBookings({success:function(t){var e,n,o;e=new RG.Utils.DatePopoverPlacer(i,t[0].attributes.date),o=new RG.Views.Dialogs.BookingClashManagement({command:s,clashBookingsCount:null!=t?t.length:void 0,cancelCallback:u}),n=new RG.Views.Dialogs.BookingClashPopover({attachTo:e.createAnchor({className:"booking-clash-popover-anchor"}),removeAttachTo:!0,body:o,className:"edit-booking-dropdown booking-clash-management-popover"}),o.on("cancelled",function(){u()}),window.setTimeout(function(){return window.requestAnimationFrame(function(){RG.Popovers.replace({popoverView:n,removeCallback:u})})},102)},fail:function(){s.execute()}})},i.prototype._copyDowntime=function(t,e,i,n){var o,r,s,a,l,c,u;return a=e.clone(),a.set({id:null,from:t[0],to:t[t.length-1],saving:!0}),c=a.get("resourceIds"),c=c.filter(function(t){return t!==n.id}),c.push(i.id),a.set("resourceIds",c),s={dateRange:a.getDateRange(),timeRange:a.getRawTimeRange()},o=i.account,u=window.resources.select(function(t){return _.include(a.get("resourceIds"),t.id)}),r=this.commandFactory.createCommand(o,u,s,a,this.interaction.rendererLock),o.downtimes.add(a),a.get("resourceIds").indexOf(n.id)===-1&&(i.bookings.predictWaitingList(),i.refreshDowntimes()),l=function(t){return function(){o.downtimes.remove(a),RG.Popovers.locked=!1,RG.renderer.unlock(t.interaction.rendererLock)}}(this),r.willTouchBookings({success:function(t){var e,n,o;e=new RG.Utils.DatePopoverPlacer(i,t[0].attributes.date),o=new RG.Views.Dialogs.BookingClashManagement({command:r,clashBookingsCount:null!=t?t.length:void 0,cancelCallback:l}),n=new RG.Views.Dialogs.BookingClashPopover({attachTo:e.createAnchor({className:"booking-clash-popover-anchor"}),removeAttachTo:!0,body:o,className:"edit-booking-dropdown booking-clash-management-popover"}),window.setTimeout(function(){return window.requestAnimationFrame(function(){RG.Popovers.replace({popoverView:n,removeCallback:l})})},102)},fail:function(){r.execute()}})},i}(RG.FSM.DowntimeState)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.FSM.DowntimeStartDragState=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.handleInput=function(t){if(t===this.dragging)return new RG.FSM.DowntimeDraggingState({ui:this.ui,event:this.event,interaction:this.interaction});throw"Input not implemented"},i.prototype._setBookingCalculator=function(t){this.interaction.bookingView._calculator=new RG.Interactions.MoveDowntimeDates({booking:this.interaction.bookingView.model.realBooking,sourceDate:t.get("date")})},i}(RG.FSM.BookingStartDragState)}.call(this),function(){RG.FSM.Booking=function(){function t(t){this.state=t}return t.prototype.handleInput=function(t,e){var i,n;null==e&&(e={}),this.state.exit(),this.state=this.state.handleInput(t);for(i in e)n=e[i],this.state[i]=n;return this.state.update()},t}()}.call(this),function(){RG.Interactions.DragDropBooking=function(){function t(t){var e;this.bookingView=t,e=new RG.FSM.BookingState({interaction:this}),this.bookingFSM=new RG.FSM.Booking(e),this.bookingViewEl=this.bookingView.$el,this.commandFactory=new RG.Utils.BookingCommandFactory}return t.prototype.detach=function(){this.eventsOff(),RG.Popovers.locked=!1,RG.renderer.unlock(this.rendererLock)},t.prototype.eventsOff=function(){$(window).off("keydown",this.keyEvent),$(window).off("keyup",this.keyEvent)},t.prototype.eventsOn=function(){$(window).on("keydown",this.keyEvent),$(window).on("keyup",this.keyEvent)},t.prototype.attach=function(){var t;t=null,this.relatedBookings=null,this.helper=null,this.keyEvent=function(t){return function(e){e.shiftKey?(t.bookingViewEl.css({opacity:""}),t.relatedBookings.forEach(function(t){return t.style.opacity=""}),t.helper.addClass("copying")):(t.bookingViewEl.css({opacity:.5}),t.relatedBookings.forEach(function(t){return t.style.opacity=.5}),t.helper.removeClass("copying")),$(window).trigger("mousemove")}}(this),this.bookingViewEl.draggable({addClasses:!1,containment:"#resources",distance:10,helper:function(t){return function(){return t._helper()}}(this),cursor:"no-drop",revert:!0,start:function(t){return function(e,i){t.rendererLock=new RG.Renderer.GlobalLock,RG.renderer.lock(t.rendererLock),t.bookingFSM.handleInput("startDrag",{event:e,ui:i})}}(this),drag:function(t){return function(e,i){t.bookingFSM.handleInput("dragging",{event:e,ui:i})}}(this),stop:function(t){return function(e,i){t.bookingFSM.handleInput("dropped",{event:e,ui:i,commandFactory:t.commandFactory})}}(this)})},t.prototype._helper=function(){var t,e,i,n,o,r;return this.relatedBookings=Array.prototype.slice.call(document.querySelectorAll(".booking[data-booking-id='"+this.bookingView.model.id+"']")),this._buildHelperView(),this.bookingViewOffsetLeft=this.bookingViewEl.offset().left,n=this.bookingViewOffsetLeft-$(this.relatedBookings[0]).offset().left,n>0&&!this.bookingView.model.isDowntime()&&this.bookingViewEl.draggable("option","cursorAt",{left:n}),this.helperView.render(),t=this.bookingView.model.realBooking.getDateRange(),r=t.startDate,e=RG.Utils.firstVisibleDate()._d,i=RG.Utils.lastVisibleDate()._d,o=!1,e>r&&(o=!0,r=e,t=new RG.Utils.DateRange(e,t.endDate),window.requestAnimationFrame(function(t){return function(){$(t.helperView.el).find(".unit span").hide()}}(this))),t.endDate>i&&(o=!0,t=new RG.Utils.DateRange(t.startDate,i),window.requestAnimationFrame(function(t){return function(){$(t.helperView.el).find(".unit span").hide()}}(this))),o&&(this.helperView.el.style.width=RG.getUnitWidth()*t.getNumberOfDays()/this.bookingView.unit.getDaysPerUnit()+1+"px"),this.helperView.el},t.prototype._buildHelperView=function(){this.helperView=new RG.Views.Resource.Booking({dateController:window.dateController,bookingFormFactory:{currentUserId:window.currentUserId},model:this.bookingView.model.realBooking,unit:this.bookingView.unit,availability:this.bookingView.availability,colorSource:this.bookingView._colorSource})},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Interactions.DragDropDowntime=function(e){function i(t){var e;this.bookingView=t,e=new RG.FSM.DowntimeState({interaction:this}),this.bookingFSM=new RG.FSM.Booking(e),this.bookingViewEl=this.bookingView.$el,this.commandFactory=new RG.Utils.DowntimeCommandFactory}return t(i,e),i.prototype._buildHelperView=function(){this.helperView=new RG.Views.Resource.Downtime({dateController:window.dateController,downtimeFormFactory:{currentUserId:window.currentUserId},model:this.bookingView.model.realBooking,unit:this.bookingView.unit,availability:this.bookingView.availability,colorSource:this.bookingView._colorSource})},i}(RG.Interactions.DragDropBooking)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};RG.Interactions.DragToCreate=function(){function e(e){this.line=e,this._triggerDialog=t(this._triggerDialog,this),this._setEndDate=t(this._setEndDate,this),this._setStartDate=t(this._setStartDate,this)}return e.prototype.attach=function(){this.line.$el.on("mousedown",this._setStartDate),$(window).on("mousemove",this._setEndDate),$(window).on("mouseup",this._triggerDialog)},e.prototype.detach=function(){this.line.$el.off("mousedown",this._setStartDate),$(window).off("mousemove",this._setEndDate),$(window).off("mouseup",this._triggerDialog)},e.prototype._addDragMarkers=function(t){var e,i,n,o;for(null==t&&(t=null),o=this._getDates(t),i=0,n=o.length;i<n;i++)e=o[i],this.lastUnit=$("#"+RG.Utils.generateTimeUnitId(this.line.model.cid,e),this.line.$el).addClass("drag-drop-target")},e.prototype._getDateRange=function(){var t;return t=_.sortBy([this._startDate,this._endDate],function(t){return t}),new RG.Utils.DateRange(t[0],t[1])},e.prototype._getDates=function(t){var e,i,n,o,r,s;if(null==t&&(t=null),t)return t.getDates();if(!this._hasValidDateRange())return[];for(o=new RG.Utils.DateRange(this._startDate,this._endDate).getNumberOfDays(),i=[],n=r=0,s=o-1;0<=s?r<=s:r>=s;n=0<=s?++r:--r)e=new Date(this._startDate),e.setDate(e.getDate()+n),i.push(e);return i},e.prototype._hasValidDateRange=function(){return this._startDate&&this._endDate},e.prototype._setStartDate=function(t){var e,i;return e=$(t.target),i=t.target.className.indexOf(RG.Views.Resource.TimeUnit.prototype.className)>=0||t.target.className.indexOf("bookings")>=0&&t.target.className.indexOf("js-delete-bookings")<=0,i&&1===t.which&&RG.Utils.Permissions.canAdd(this.line.model)?RG.Popovers.locked?(this._removeDragMarkers(),this._reset()):(RG.Popovers.clear(),this._isDragging=!0,this._startDate=RG.getDateAtClientX(t.clientX),void(this._endDate=RG.getDateAtClientX(t.clientX))):void(RG.Utils.Permissions.canAdd(this.line.model)||0!==$(t.target).closest(".f-dropdown, .overlay").length||RG.Popovers.clear())},e.prototype._setEndDate=function(t){if(this._isDragging){if(RG.Popovers.locked)return this._removeDragMarkers(),this._reset();RG.Popovers.clear(),RG.Popovers.popoverActive=!1,window.getSelection().removeAllRanges(),this._resetDragMarkers(),this._endDate=RG.getDateAtClientX(t.clientX)}},e.prototype._removeDragMarkers=function(){$(".resources--cal-unit.drag-drop-target",this.line.$el).removeClass("drag-drop-target")},e.prototype._changeDragMarkers=function(t){this._removeDragMarkers(),this._addDragMarkers(t)},e.prototype._reset=function(){this._startDate=null,this._endDate=null},e.prototype._resetDragMarkers=function(){this._removeDragMarkers(),this._addDragMarkers()},e.prototype._triggerDialog=function(t){var e,i,n,o;if(this._isDragging=!1,this._hasValidDateRange()){if(!$("#resources").find(t.target).length)return void this._removeDragMarkers();this._addDragMarkers(),i=this._getDateRange(),i.getNumberOfDays()>1&&(t.target=this.lastUnit),n=new RG.Utils.EventPopoverPlacer(t,"booking"),e=n.createAnchor({className:"new-booking-downtime"}),o=this.line._bookingFormDialogFactory.create({dateRange:i,resource:this.line.model,attachTo:e,removeCallback:this._removeDragMarkers.bind(this),changeCallback:this._changeDragMarkers.bind(this)}),RG.Popovers.set(o,this._removeDragMarkers.bind(this)),this._reset()}},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;RG.Interactions.DragToCreateCustomAvailability=function(i){function n(){return this._triggerDialog=t(this._triggerDialog,this),this._setStartDate=t(this._setStartDate,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype._addDragMarkers=function(t){var e,i,n,o;for(null==t&&(t=null),o=this._getDates(t),i=0,n=o.length;i<n;i++)e=o[i],this.lastUnit=$("#"+RG.Utils.generateTimeUnitId(this.line.model.cid,e)+" .utilisation",this.line.$el).addClass("drag-drop-target")},n.prototype._setStartDate=function(t){var e,i;if(e=$(t.target),i=e.closest(".utilisation").length>0&&this._isNotActivePopover(t),i&&1===t.which){if(RG.Popovers.locked)return this._removeDragMarkers(),this._reset;RG.Popovers.clear(),this._isDragging=!0,this._startDate=RG.getDateAtClientX(t.clientX),this._endDate=RG.getDateAtClientX(t.clientX)}},n.prototype._removeDragMarkers=function(){$(".resources--cal-unit .js-custom-availability").remove(),$(".resources--cal-unit .utilisation.drag-drop-target",this.line.$el).removeClass("drag-drop-target")},n.prototype._isNotActivePopover=function(t){return 0===$(t.target).closest(".js-availability-popover-parent").length},n.prototype._triggerDialog=function(t){var e,i,n;this._isDragging&&this._isNotActivePopover(t)&&(this._isDragging=!1,this._hasValidDateRange()&&(this._addDragMarkers(),e=this._getDateRange(),e.getNumberOfDays()>1&&(t.target=this.lastUnit),i=new RG.Utils.EventPopoverPlacer(t,"utilisation",{topAdjustment:-6}),n=new RG.Views.Dialogs.CustomAvailabilityPopover({attachTo:i.createAnchor({className:"custom-availability"}),removeAttachTo:!0,callback:this._removeDragMarkers.bind(this),changeCallback:this._changeDragMarkers.bind(this),line:this.line,dateRange:e,resource:this.line.model}),RG.Popovers.set(n,this._removeDragMarkers.bind(this)),this._reset()))},n}(RG.Interactions.DragToCreate)}.call(this),function(){RG.Interactions.MoveBookingDates=function(){function t(t){this._booking=t.booking,this.resource=t.resource,this.sourceDate=t.sourceDate,this.targetDate=t.targetDate,this.cachedResults={}}return t.prototype.getNewDates=function(){var t,e;return t={source:this.sourceDate,target:this.targetDate,resource:this.resource},e=this.cachedResults[JSON.stringify(t)],e?e:this.newDates(t,this._booking.getDurations())},t.prototype.newDates=function(t,e){var i,n,o;if(i=this.resource.availability,n=new Date(this.targetDate.getFullYear(),this.targetDate.getMonth(),this.targetDate.getDate()),o={date:n,dates:[],durations:e.filter(function(t){return t.getMinutes()>0}),durationIndex:0,availability:i,noNormalAvailability:i.hasNoNormalAvailability(),lastCap:i.customAvailablePeriods.last(),firstCap:i.customAvailablePeriods.first()},o.noNormalAvailability){if(o.availability.customAvailablePeriods.length<o.durations.length)return[];o.date.valueOf()>=o.lastCap.get("date").valueOf()?o.durationIndex=o.durations.length-1:o=this._setDurationIndex(o)}else o=this._setDurationIndex(o);return o=this._moveLeft(o),o.date=new Date(this.targetDate.getFullYear(),this.targetDate.getMonth(),this.targetDate.getDate()+1),o=this._moveRight(o),o=this._trimDates(o),o=this._ensureCapMatch(o),this.cachedResults[JSON.stringify(t)]=o.dates},t.prototype._moveLeft=function(t){var e,i,n;if(t.noNormalAvailability&&t.firstCap.get("date").valueOf()>=t.date.valueOf())return t;for(i=new RG.Utils.DateRange(t.date,t.date),e=0;t.dates.length<=t.durationIndex;){if(t.availability.isAvailableIn(i)&&(n=new Date(t.date.getFullYear(),t.date.getMonth(),t.date.getDate()),t.dates.unshift(n)),e+=1,e>1e3)return t.dates=[],t;t.date.setDate(t.date.getDate()-1)}return t},t.prototype._moveRight=function(t){var e,i,n;for(i=new RG.Utils.DateRange(t.date,t.date),e=0;t.dates.length<t.durations.length;){if((t.availability.isAvailableIn(i)||t.noNormalAvailability&&t.lastCap.get("date").valueOf()<=t.date.valueOf())&&(n=new Date(t.date.getFullYear(),t.date.getMonth(),t.date.getDate()),t.dates.push(n)),e+=1,e>1e3)return t.dates=[],t;t.date.setDate(t.date.getDate()+1)}return t},t.prototype._trimDates=function(t){for(;t.dates.length>t.durations.length;)t.dates.pop();return t},t.prototype._setDurationIndex=function(t){var e;return e=_.find(t.durations,function(t){return function(e){return RG.Utils.DateComparator.equalsYMD(t.sourceDate,e.get("date"))}}(this)),t.durationIndex=_.indexOf(t.durations,e),t},t.prototype._ensureCapMatch=function(t){var e;return t.noNormalAvailability&&(e=t.availability.customAvailablePeriods.filter(function(e){return t.dates.some(function(t){return t.valueOf()===e.get("date").valueOf()})}),e.length!==t.dates.length&&(t.dates=[])),t},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Interactions.MoveDowntimeDates=function(e){function i(t){i.__super__.constructor.apply(this,arguments),this.offsetIndex=t.offsetIndex}return t(i,e),i.prototype.newDates=function(t,e){var i,n,o,r,s,a,l;for(s=_.find(e,function(t){return function(e){return RG.Utils.DateComparator.equalsYMD(t.sourceDate,e.get("date"))}}(this)),a=_.indexOf(e,s),a===-1&&(a=0),r=[],i=new Date(this.targetDate.getFullYear(),this.targetDate.getMonth(),this.targetDate.getDate()),n=new RG.Utils.DateRange(i,i);r.length<=a;)l=new Date(i.getFullYear(),i.getMonth(),i.getDate()),r.unshift(l),i.setDate(i.getDate()-1);for(i=new Date(this.targetDate.getFullYear(),this.targetDate.getMonth(),this.targetDate.getDate()+1),n=new RG.Utils.DateRange(i,i);r.length<e.length;)o=new Date(i.getFullYear(),i.getMonth(),i.getDate()),r.push(o),i.setDate(i.getDate()+1);for(;r.length>e.length;)r.pop();return this.cachedResults[JSON.stringify(t)]=r},i}(RG.Interactions.MoveBookingDates)}.call(this),function(){RG.Interactions.ResizeBooking=function(){function t(t){this.bookingView=t}return t.prototype.detach=function(){return RG.Popovers.locked=!1,RG.renderer.unlock(this.rendererLock)},t.prototype.attach=function(){var t;return t={leftAdjustmentDays:null,rightAdjustmentDays:null,startDate:null,endDate:null},this.bookingView.$el.resizable({handles:"e, w",start:function(e){return function(){return RG.Popovers.locked=!1,RG.Popovers.clear(),e._start(t)}}(this),resize:function(e){return function(i,n){return e._resize(t,i,n)}}(this),stop:function(e){return function(i,n){return e._stop(t,i,n)}}(this)})},t.prototype._start=function(t){return this.bookingView.$el.find(".unit").hide(),this.bookingView.$el.resizable("option","minWidth",RG.getUnitWidth()-2),this.offsetTop=this.bookingView.$el.offset().top+40,this.bookingView.isInInteraction=!0,t.booking=this.bookingView.model.realBooking,t.resource=this.bookingView._getBookingResource(),this.rendererLock=new RG.Renderer.ResourceDateLock(t.resource,new Date(t.booking.getFirstAllocatedDate()),new Date(t.booking.getLastAllocatedDate())),RG.renderer.lock(this.rendererLock),RG.Popovers.lock()},t.prototype._resize=function(t,e,i){var n,o,r,s,a,l,c,u,h,d,p;for(d=$(i.element).width(),h=RG.getUnitWidth(),a=i.position.left-i.originalPosition.left,u=i.size.width-i.originalSize.width+a,t.leftAdjustmentDays=Math.floor(a/RG.getUnitWidth()),t.rightAdjustmentDays=Math.ceil(u/RG.getUnitWidth()),t.startDate=new Date(t.booking.getFirstAllocatedDate()),t.endDate=new Date(t.booking.getLastAllocatedDate()),t.startDate.setDate(t.startDate.getDate()+t.leftAdjustmentDays),t.endDate.setDate(t.endDate.getDate()+t.rightAdjustmentDays),r=new RG.Utils.DateRange(t.startDate,t.endDate).getNumberOfDays()-1,p=t.startDate,RG.Utils.firstVisibleDate()._d>p&&(p=RG.Utils.firstVisibleDate()._d),d=new RG.Utils.DateRange(p,t.endDate).getNumberOfDays()-1,$(i.element).width((d+1)*RG.getUnitWidth()-1),$(i.element).css({left:RG.getUnitWidth()*t.leftAdjustmentDays-1}),t.dates=[],o=s=l=t.startDate.getDate(),c=t.startDate.getDate()+r;l<=c?s<=c:s>=c;o=l<=c?++s:--s)n=new Date(t.startDate),n.setDate(o),this._isAvailableIn(t.resource,n)&&t.dates.push(n);return _.any(t.dates,function(e){return RG.Utils.DateComparator.equalsYMD(e,t.startDate)})&&_.any(t.dates,function(e){return RG.Utils.DateComparator.equalsYMD(e,t.endDate)})?$(i.element).removeClass("no-drop"):$(i.element).addClass("no-drop")},t.prototype._stop=function(t,e,i){var n,o,r,s,a,l,c,u,h,d,p,f,g,m,v,y,w,b,k,D;for(D=t.resource,n=t.booking,g=n.getDateRange().getDates(),o=t.dates.length!==g.length,Q.delay(10).then(function(){return RG.Popovers.locked=!1}),b=t.dates,c=l=0,d=b.length;l<d;c=++l)s=b[c],o||(m=g[c],o=!m||!RG.Utils.DateComparator.equalsYMD(s,m));if(0===t.leftAdjustmentDays&&0===t.rightAdjustmentDays||!o)return D.bookings.remove(n),D.bookings.add(n),void RG.renderer.unlock(this.rendererLock);for(v=n.attributes,y=n.durations.models,u=y[0],f=[],k=t.dates,h=0,p=k.length;h<p;h++)s=k[h],a=u.clone(),a.set({date:s,waiting:_.select(n.durations.where({waiting:!0}),function(t){return RG.Utils.DateComparator.equalsYMD(t.get("date"),s)}).length>0}),f.push(a);return RG.renderer.enqueue(new RG.Renderer.ResourceDateLock(D,t.startDate,t.endDate),function(){return n.set({saving:!0,startDate:t.startDate,endDate:t.endDate}),n.durations.reset(f),D.bookings.remove(n),D.bookings.add(n)}),w=D,this.bookingView.$el.find(".unit").hide(),this.bookingView.isInInteraction=!1,RG.renderer.unlock(this.rendererLock),r=new RG.Commands.UpdateBookingCommand({booking:n,resource:D,startDate:t.dates[0],endDate:t.dates[t.dates.length-1],successCallback:function(e){return RG.renderer.enqueue(new RG.Renderer.ResourceDateLock(D,t.startDate,t.endDate),function(){var t,i,o,r;for(n.set({startDate:RG.Utils.BookingMerger.getDateFromStr(e.start_date),endDate:RG.Utils.BookingMerger.getDateFromStr(e.end_date),refreshable:e.refreshable,saving:!1}),o=n.durations.models,t=0,i=o.length;t<i;t++)a=o[t],r=_.find(e.durations,function(t){return t.date===RG.Utils.DateFormatter.getISODate(a.get("date"))}),r&&a.set({waiting:r.waiting});return window.update()})}}),r.removedDatesCallback=function(t){return function(e){var i,n,o;return o=new RG.Views.Dialogs.RemovedAvailabilityDates({resource:D,removedAvailabilityDates:e}),i=new RG.Utils.DatePopoverPlacer(D,new Date(e[0]),{offsetTop:t.offsetTop}),n=new RG.Views.Dialogs.BookingClashPopover({removeAttachTo:!0,attachTo:i.createAnchor({className:"booking-clash-popover-anchor"}),body:o,className:"edit-booking-dropdown"}),RG.Popovers.replace({popoverView:n,removeCallback:function(){}})}}(this),r.waitingCallback=function(e){return function(i){var o;return RG.Popovers.unlock(),o=new RG.Views.Dialogs.WaitingListConfirmation({resource:D,waitingDates:i,duration:f[0].getMinutes(),startDate:t.dates[0],endDate:t.dates[t.dates.length-1],cancelCallback:function(){return RG.renderer.enqueue(new RG.Renderer.ResourceDateLock(D,t.startDate,t.endDate),function(){return n.set(v),n.set({saving:!1}),n.durations.reset(y),D.bookings.remove(n,{silent:!0}),D.bookings.add(n)})},callback:function(){return RG.renderer.enqueue(new RG.Renderer.ResourceDateLock(D,t.startDate,t.endDate),function(){var t,e,o;for(n.set({saving:!1}),o=n.durations.models,t=0,e=o.length;t<e;t++)a=o[t],i.indexOf(RG.Utils.DateFormatter.getISODate(a.get("date")))>-1&&a.set({waiting:!0});return r.forceWaiting=!0,r.execute()})}}),e._waitingPopover(D,new Date(i[0]),o),o.on("addWaiting",function(){return RG.Popovers.done()})}}(this),r.archivedCallback=function(t){return RG.Utils.BookingService.reset(t,D,n,v,y)},r.execute().then(function(){return RG.Popovers.unlock()})},t.prototype._isAvailableIn=function(t,e){return null==this.availability&&(this.availability=t.availability),this.availability.isAvailableIn(new RG.Utils.DateRange(e,e))},t.prototype._waitingPopover=function(t,e,i,n){var o;return null==n&&(n=i.cancelCallback),o=new RG.Utils.DatePopoverPlacer(t,e,{offsetTop:this.offsetTop}),this.popover=new RG.Views.Dialogs.BookingClashPopover({removeAttachTo:!0,attachTo:o.createAnchor({className:"booking-clash-popover-anchor"}),body:i,className:"edit-booking-dropdown"}),RG.Popovers.replace({popoverView:this.popover,removeCallback:n})},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Interactions.ResizeDowntime=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype._start=function(t){return this.bookingView.$el.resizable("option","minWidth",RG.getUnitWidth()-2),this.offsetTop=this.bookingView.$el.offset().top+40,t.resource=this.bookingView._getBookingResource(),t.booking=this.bookingView.model.realBooking.inTimeZone(t.resource.getTimeZone()),t.initialTimeZone=this.bookingView.model.realBooking.getTimeZone(),this.rendererLock=new RG.Renderer.ResourceDateLock(t.resource,new Date(t.booking.getFirstAllocatedDate()),new Date(t.booking.getLastAllocatedDate())),RG.renderer.lock(this.rendererLock),RG.Popovers.lock()},i.prototype._stop=function(t,e,i){var n,o,r,s,a,l,c,u,h,d,p,f;return p=t.booking,a=window.downtimes.findWhere({id:t.booking.id}),d=t.resource,n=d.account,t.startDate<a.get("from")&&(h=!0),l={from:a.get("from"),to:a.get("to"),saving:!1},a.set({saving:!0,from:t.startDate,to:t.endDate}),s={dateRange:a.getDateRange(),timeRange:a.getRawTimeRange()},c=d,u=a,f=window.resources.select(function(t){return a.get("resourceIds").indexOf(t.id)!==-1}),o=new RG.Utils.DowntimeCalendarUpdater(window.currentUserId,n,window.resources,window.timeZones,f),RG.renderer.enqueue(new RG.Renderer.ResourceDateLock(d,t.startDate,t.endDate),function(){return a.set({saving:!0,from:t.startDate,to:t.endDate}),a=a.inTimeZone(t.initialTimeZone),p.set(a.attributes)}),RG.renderer.unlock(this.rendererLock),r=new RG.Commands.UpdateDowntimeCommand({downtime:a,account:n,booker:window.bookers.findWhere({id:a.get("creatorId")}),resources:f,dateTimeRange:s,details:a.get("details"),timeZones:window.timeZones,timeZone:a.getTimeZone().getParamValue(),type:a.getDowntimeType(),preExecuteCallback:function(t,e,i){return Q.delay(100).then(function(){return RG.Popovers.unlock(),RG.Popovers.done()}),o.update(a,e,i)},successCallback:function(t){return u.set({saving:!1}),window.update()}}),r.willTouchBookings({success:function(t){return function(e){var i,n,a;return RG.Popovers.locked=!1,a=!0,n=new RG.Views.Dialogs.BookingClashManagement({command:r,clashBookingsCount:e.length,successCallback:function(){return a=!1},cancelCallback:function(){if(RG.Popovers.locked=!1,a)return u.set(l),o.updateAffectedResources()}}),i=s.dateRange.endDate,h&&(i=s.dateRange.startDate),setTimeout(function(){return t._waitingPopover(d,i,n)},0)}}(this),fail:function(){return r.execute(),Q.delay(10).then(function(){return RG.Popovers.locked=!1})}})},i.prototype._isAvailableIn=function(t,e){return!0},i.prototype._getTimeAllocationAfterResize=function(t){return t.booking.inTimeZone(t.initialTimeZone)},i}(RG.Interactions.ResizeBooking)}.call(this),function(){RG.Interactions.RightClickDragToScroll=function(){function t(t){this.el=t,this.isDragging=!1,this._lastOffset={},this.jEl=$(this.el)}return t.prototype.attach=function(){var t,e,i;return i=this._getNormalizedUserAgentString(),t=i.indexOf("safari")!==-1&&i.indexOf("chrome")===-1&&this.getSafariVersion()<7,e=!0,$(this.el).on("contextmenu",function(t){return function(e){return t._elementAllowsRightClick(e.target)}}(this)),$(this.el).on("mousedown",function(t){return function(e){if(3===e.which)return!!t._elementAllowsRightClick(e.target)||(t.isDragging=!0,t._lastOffset={x:e.clientX,y:e.clientY},!1)}}(this)),$(this.el).on("mouseup",function(t){return function(e){if(3===e.which)return t.isDragging=!1}}(this)),$(this.el).on("mousemove",function(i){return function(n){var o,r;if(i.isDragging&&!i.animationQueued)return RG.Popovers.locked?void(i.isDragging=!1):(i.animationQueued=!0,o=n.clientX-i._lastOffset.x,r=n.clientY-i._lastOffset.y,t?(e?(i._lastOffset.x=n.clientX,i.jEl.scrollLeft(i.jEl.scrollLeft()-o)):(i._lastOffset.y=n.clientY,i.jEl.scrollTop(i.jEl.scrollTop()-r)),e=!e):(i._lastOffset={x:n.clientX,y:n.clientY},i.jEl.scrollLeft(i.jEl.scrollLeft()-o),i.jEl.scrollTop(i.jEl.scrollTop()-r)),i.animationQueued=!1)}}(this))},t.prototype._getNormalizedUserAgentString=function(){return navigator.userAgent.toLowerCase()},t.prototype._elementAllowsRightClick=function(t){var e;return e=$(t),0===e.closest("#resources").length||0!==e.closest(".f-dropdown").length},t.prototype.getSafariVersion=function(){var t,e,i;return e=this._getNormalizedUserAgentString(),i=/version\/(\d+)\.(\d+)/i,t=i.exec(e),
t?parseFloat(t[1]+"."+t[2]):0},t}()}.call(this),function(){RG.DTO.BookingDuration=function(){function t(t){this.duration=t.duration,this.startTime=t.startTime}return t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Routers.Calendar=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return this.root=t.root,this.rendered=!1,this.dateController=null},i.prototype.routes={"":"index",":year-:month-:day":"scrollDate"},i.prototype.index=function(){return this.rendered||this._render(),this.openAtUnit(".cal-unit.current")},i.prototype.openAtUnit=function(t){return this.scrollToUnit(t).then(function(){return $("#loader").hide()})},i.prototype.scrollToUnit=function(t){var e,i;return e=$("aside").width()-1,i=function(n){var o;return o=$(t),o.length>0&&RG.Utils.unitsRendered()?window.setTimeout(function(){return"undefined"!=typeof newrelic&&null!==newrelic&&newrelic.finished(),window.requestAnimationFrame(function(){return $("html, body").animate({scrollLeft:o.first().offset().left-e}),n()})},50):setTimeout(function(){return i(n)},100)},Q.promise(i)},i.prototype.scrollDate=function(t,e,i){var n,o,r,s,a,l;return!!this.rendered||(l=parseInt(t,10),a=parseInt(e,10),o=parseInt(i,10),r=new Date(l,a-1,o),this.rendered?this.dateController.scrollToDate(r):(this._render(r),n=$("html").attr("class"),s=".cal-unit",n.indexOf("ff")===-1&&n.indexOf("safari")===-1||(s=".resources--cal-unit"),this.openAtUnit(s+"[data-date="+RG.Utils.DateFormatter.getISODate(r)+"]:visible")))},i.prototype._render=function(t){var e,i,n,o,r,s,a;return i=$(window),e=$(document),window.colorSource=new RG.Utils.ColorSource,localStorage.colorBookingsBy&&window.colorSource.colorBy(localStorage.colorBookingsBy),window.ugc=new RG.Collections.UnitGroupings,window.dateController=new RG.Controllers.DayUnitGroupings(ugc),n=t||new Date,a=$(window).width()/280,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()-n.getDay()+1),dateController.init(r,n),dateController.prepend(2),dateController.append(a),this.dateController=dateController,null==window.clients&&(window.clients=new RG.Collections.Clients),null==window.projects&&(window.projects=new RG.Collections.Projects),null==window.resources&&(window.resources=new RG.Collections.ResourceInstances),null==window.resourceTypes&&(window.resourceTypes=new RG.Collections.ResourceTypes),null==window.bookers&&(window.bookers=new RG.Collections.Bookers),null==window.savedFilters&&(window.savedFilters=new RG.Collections.SavedFilters),null==window.currentUserDate&&(window.currentUserDate=new RG.Models.CurrentDate(RG.Utils.getTodayISO())),o=new RG.Utils.FilterSource(window.resourceTypes,window.resources,window.projects,window.clients),s=new RG.Views.Calendar.Layout({dateController:this.dateController,initialDate:t,periodGroupings:window.ugc,resources:window.resources,savedFilters:window.savedFilters,filterSource:o,colorSource:window.colorSource,currentUserId:window.currentUserId,clients:window.clients,deletedClients:window.deletedClients,projects:window.projects,deletedProjects:window.deletedProjects,bookers:window.bookers,deletedBookers:window.deletedBookers,downtimeTypes:window.downtimeTypes,timeZones:window.timeZones,currentUserTimeZone:window.currentUserTimeZone,currentDate:window.currentUserDate}),s.render(),"detailed"===localStorage.zoomLevel?s.el.className="daily detailed":s.el.className="daily",s.el.style.display="none",this.root.replaceWith(s.el),s._resize(),this.dateController.updateUI(),s.setInitialFilters(),s.setInitialResource(),this.rendered=!0},i}(Backbone.Router)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Renderer.ResourceDateLock=function(){function t(t,e,i){this.resource=t,this.dateRange=new RG.Utils.DateRange(e,i)}return t.prototype.isLockedBy=function(t){return t.constructor===RG.Renderer.GlobalLock||this.dateRange.overlapsWith(t.dateRange)&&this.resource===t.resource},t}(),RG.Renderer.ResourcesDateLock=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.isLockedBy=function(t){return t.constructor===RG.Renderer.GlobalLock||this.dateRange.overlapsWith(t.dateRange)&&this.resources&&this.resources.indexOf(t.resource)!==-1},i}(RG.Renderer.ResourceDateLock),RG.Renderer.GlobalLock=function(){function t(){setTimeout(function(t){return function(){if(RG.renderer.locks.indexOf(t)!==-1)return RG.renderer.unlock(t)}}(this),2e4)}return t.prototype.isLockedBy=function(t){return!0},t}()}.call(this),function(){RG.Renderer.Renderer=function(){function t(){this.queue=[],this.locks=[]}return t.prototype.enqueue=function(t,e){return this.queue.push({lock:t,fn:e}),this.render()},t.prototype.lock=function(t){return this.locks.push(t)},t.prototype.unlock=function(t){var e;return e=this.locks.indexOf(t),e>-1&&this.locks.splice(e,1),this.render()},t.prototype.isLocked=function(t){var e,i,n,o;for(o=this.locks,e=0,i=o.length;e<i;e++)if(n=o[e],t.lock.isLockedBy(n))return!0;return!1},t.prototype.render=function(t){var e,i,n,o,r,s,a,l;if(null==t&&(t=this.queue),!this.paused){for(a=[],n=i=0,r=t.length;i<r;n=++i)e=t[n],this.isLocked(e)||(e.fn(),a.unshift(n));for(l=[],o=0,s=a.length;o<s;o++)n=a[o],l.push(this.queue.splice(n,1));return l}},t.prototype.renderAfter=function(t){return t.some(function(t){return function(e){return t.isLocked(e)}}(this))?setTimeout(function(e){return function(){return e.renderAfter(t)}}(this),50):this.render(t)},t.prototype.pause=function(){return this.paused=!0},t.prototype.unpause=function(){return this.paused=!1,this.render()},t.prototype.unlockAll=function(){var t,e,i,n;for(n=this.queue,e=0,i=n.length;e<i;e++)t=n[e],t.fn();return this.queue=[],this.locks=[]},t}()}.call(this),function(){var t=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;RG.Views.Dialogs.NewDowntime=function(i){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,i),n.prototype.template=templates.find("dialogs/new_downtime"),n.prototype.headerTemplate=templates.find("dialogs/new_downtime_header"),n.prototype.initialize=function(t){return this.currentUserId=t.currentUserId,this.resourceSelector=t.resourceSelector,this.resources=t.resources,this.resource=t.resource,this.interactedResource=t.resource,this.selectedResources=[this.resource],this.account=this.resource.account,this.bookers=t.bookers,this.dateRange=t.dateRange,this.timeRange=t.timeRange||new RG.Utils.TimeRange(0,1440),this.downtimeTypes=t.downtimeTypes,this.timeZones=t.timeZones,this.currentUserTimeZone=t.currentUserTimeZone,this.successCallback=t.successCallback,this.renderHeader=t.renderHeader,this.spinnerAttachToEl=t.spinnerAttachToEl},n.prototype.close=function(){return"undefined"!=typeof e&&null!==e&&e.stopPropagation(),this.trigger("close")},n.prototype.remove=function(){var t,e,i,o;return null!=(t=this.resourceSelector)&&t.remove(),null!=(e=this.dateTimeRangeSelector)&&e.remove(),null!=(i=this.downtimeTypeSelector)&&i.remove(),null!=(o=this.vacationAllowance)&&o.remove(),n.__super__.remove.apply(this,arguments)},n.prototype.render=function(){var t;return t=[],this.renderHeader&&t.push(this.headerTemplate()),t.push(this.template()),this.$el.html(t.join("")),this._fillValues(),this._bindEvents(),this},n.prototype._bindEvents=function(){return this.$el.on("click",".chzn-single",function(t){return function(e){return t.trigger("shrinkDropdown",e)}}(this)),this.$el.on("click",function(t){return function(e){var i;if(!$(e.target).hasClass("js-tooltip"))return null!=(i=t.vacationAllowance)?i.closeAllPopovers():void 0}}(this)),this.$el.on("click","#cancel",function(t){return function(e){return e.preventDefault(),e.stopPropagation(),t.close()}}(this)),this.$el.on("click","#add-downtime",function(t){return function(e){return t.resourceSelector.searchBlur(),Q.delay(15).then(function(){return e.preventDefault(),e.stopPropagation(),t.createDowntime()})}}(this)),this.$el.on("click",function(t){return function(){return t.$(".js-menu-options").hide(),RG.Utils.select2Close($(".select2-drop"),!0),t.resourceSelector.searchBlur()}}(this)),this.resourceSelector.on("change:filter",function(t){return function(){return t.selectedResources=t._getResources(),t.resource=t.selectedResources[0],t._composeTimezoneSelector()}}(this)),this.dateTimeRangeSelector.on("change",function(t){return function(e,i){return t.dateRange=e,t.timeRange=i,t.trigger("change",e)}}(this))},n.prototype.validate=function(){var t;return t=!0,t=this.timeZoneSelector?this.dateTimeRangeSelector.validate()&this.timeZoneSelector.validate()&this.resourceSelector.validate():this.dateTimeRangeSelector.validate()&this.resourceSelector.validate(),this.trigger("validate"),t},n.prototype._adjustOverlayForDashboard=function(t){var e;return t.$el.css({left:"-488px",top:"14px"}),e=t.$el.find(".spinner"),e.css({top:"50%",left:"50%"})},n.prototype.createDowntime=function(){var t,e;return e=$(this.spinnerAttachToEl)[0]||$(this.el).closest(".js-booking-downtime-new")[0],t=RG.Utils.spinnerOverlay(e),this.spinnerAttachToEl&&this._adjustOverlayForDashboard(t),Q.delay(20).then(function(e){return function(){var i,n,o;return n=e.dateTimeRangeSelector.getValues(),o=e._getResources(),_.any(o,function(t){return e.interactedResource.id===t.id})||(e.interactedResource=e.resource),e.validate()?(e.rendererLock=new RG.Renderer.GlobalLock,RG.renderer.lock(e.rendererLock),i=new RG.Commands.CreateDowntimeCommand({account:e.resource.account,resources:e._getResources(),booker:e._getBooker(),dateTimeRange:n,details:e._getDetails(),timeZones:e.timeZones,timeZone:e._getTimeZone(),type:e._getType(),preExecuteCallback:function(t,i,n){return RG.renderer.unlock(e.rendererLock)},successCallback:function(t){return RG.renderer.unlock(e.rendererLock),window.update().then(function(){return RG.Popovers.popoverActive=!1,RG.Popovers.done()}),"function"==typeof e.successCallback?e.successCallback():void 0},errorCallback:function(i){return RG.renderer.unlock(e.rendererLock),t.close(),e.optionView=new RG.Views.Dialogs.ErrorList({errors:i}),e.trigger("changeOverlay",e.optionView,{className:"overlay availability-waiting"})}}),Q.delay(50).then(function(){return i.willTouchBookings({success:function(n){var o;return o=function(){return RG.renderer.unlock(e.rendererLock),RG.Popovers.removeCallback=null,e.account.downtimes.remove(i.downtime)},e.optionView=new RG.Views.Dialogs.BookingClashManagement({command:i,clashBookingsCount:n,cancelCallback:o,successCallback:function(){return RG.renderer.unlock(e.rendererLock),RG.Popovers.removeCallback=null},userPermissions:RG.Utils.Permissions}),t.close(),e.trigger("changeOverlay",e.optionView,{className:"overlay availability-waiting"}),RG.Popovers.removeCallback=o},fail:function(){return RG.renderer.unlock(e.rendererLock),i.execute()}})})):t.close()}}(this))},n.prototype._getResourceIds=function(){return this.resourceSelector.getResourceIds()},n.prototype._getResources=function(){var t;return t=this.resourceSelector.getResourceIds(),this.resources.models.filter(function(e){return t.indexOf(e.id)!==-1})},n.prototype._getBooker=function(){return this.bookerSelector.getBooker()},n.prototype._getDetails=function(){return this.$("#downtime-details-value").val()},n.prototype._getLeave=function(){var t;return t={},_.each(this.$(".js-vacation-allowance input"),function(e){return t[$(e).attr("data-attribute-year")]=$(e).val()}),t},n.prototype._getTimeZone=function(){var t,e;return e=null!=(t=this.timeZoneSelector)?t.getTimeZone():void 0,"NullTimeZone"===e&&(e=""),e},n.prototype._getType=function(){var t;return t=this.$("#downtime-type-options select").val(),t=void 0!==t&&t.length&&+t||null,this.downtimeTypes.findWhere({id:t})},n.prototype._fillValues=function(){var t,e,i;return this._composeResourceSelector(),this._composeDateRangeSelector(),this._composeDownTimeTypes(),this._composeTimezoneSelector(),t=this.bookers.find({id:null!=(i=this.downtime)?i.getBooker().id:void 0}),this.bookerSelector=new RG.Views.Selectors.Booker({currentUserId:(null!=t?t.id:void 0)||this.currentUserId,bookers:this.bookers,booker:t}),this.$("dd.js-booker").html(this.bookerSelector.render().el),this.$(this.bookerSelector.el).find("select").chosen(),this.$(this.downtimeTypeSelector.el).chosen(),e=this.dateTimeRangeSelector.getValues(),this.timeRange=e.timeRange,this.dateRange=e.dateRange,this.$("#add-downtime").text("Add "+this.resource.getHeadingDowntimeText())},n.prototype._composeResourceSelector=function(){return this.$(".js-resource-selector").html(this.resourceSelector.render().el),this.resourceSelector.setFilters([{categoryName:"Person",options:[{matchType:"any",name:"Name",selectedOptions:[this.resource.id]}]}])},n.prototype._composeDateRangeSelector=function(){var t;return this.dateTimeRangeSelector=new RG.Views.Selectors.DateTimeRange({resource:this.resource,dateRange:this.dateRange,timeRange:this.timeRange,customValidations:(new RG.Validators.DowntimeLengthValidator).validate}),this.dateTimeRangeSelector.on("validate",function(t){return function(){return t.trigger("validate")}}(this)),t=this.$(".downtime-date"),t.html(this.dateTimeRangeSelector.render().el)},n.prototype._composeDownTimeTypes=function(){return this.downtimeTypeSelector=new RG.Views.Selectors.DowntimeTypeSelector({downtimeTypes:this.downtimeTypes}),this.$("#downtime-type-options").append(this.downtimeTypeSelector.render().el)},n.prototype._composeTimezoneSelector=function(){var t;return null!=(t=this.timeZoneSelector)&&t.remove(),this.timeZoneSelector=null,this._isDifferentTimeZones()?(this.$("dd.js-timezone-selector").show(),this.$(".js-timezone-heading").text("Timezone").show(),this.timeZoneSelector=new RG.Views.Selectors.TimeZoneSelector({currentUserTimeZone:this.currentUserTimeZone,selectedOption:this.selectedTimeZoneOption,timeZones:this.timeZones}),this.$("dd.js-timezone-selector").html(this.timeZoneSelector.render().el),this.$(this.timeZoneSelector.el).find("select").chosen({width:"100%"})):(this.$("dd.js-timezone-selector").hide(),this.$(".js-timezone-heading").empty().hide())},n.prototype._selectedDowntimeType=function(){var t;return null!=(t=this.downtimeTypes.findWhere({id:+this.downtimeTypeSelector.$el.val()}))?t.get("name"):void 0},n.prototype._isDifferentTimeZones=function(){return RG.Utils.isDifferentTimeZones(this.selectedResources,this.currentUserTimeZone)},n}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.Popover=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.baseTemplate=templates.find("dialogs/popover"),i.prototype.spinnerOptions=RG.Utils.spinnerOptions,i.prototype.initialize=function(t){return this.$el.on("click",function(t){return function(e){return t._closeOpenDropdowns(e),RG.Popovers.clearNest(),e.stopPropagation()}}(this)),this.attachTo=t.attachTo,this.bodyView=t.body,this.callback=t.callback,this.cssClass=t.cssClass||this.cssClass||this.cid,this.$el.addClass(t.className),this.removeAttachTo=t.removeAttachTo,this._debouncedSetPosition=_.debounce(function(t){return function(){return t.setPosition({animate:!1})}}(this),50)},i.prototype.render=function(){return this.$el.html(this.baseTemplate({cssClass:this.cssClass})),this._fillValues(),this},i.prototype._closeOpenDropdowns=function(t){var e;return null!=(e=this.$el.find(".open"))?e.removeClass("open"):void 0},i.prototype.remove=function(){var t,e;return $(window).off("resize",this._debouncedSetPosition),this.removeAttachTo&&$(this.attachTo).remove(),null!=(t=this.overlay)&&t.remove(),null!=(e=this.bodyView)&&e.remove(),"function"==typeof this.callback&&this.callback(),0===$(".dropdown-content").length&&RG.Utils.enableScrolling(!0),i.__super__.remove.apply(this,arguments)},i.prototype.popup=function(){var t;return RG.closeAllSelections(),this.render(),t=$(this.attachTo),t.append(this.el),this.setPosition(),$(window).on("resize",this._debouncedSetPosition),RG.Popovers.locked=!1},i.prototype.setBodyView=function(t,e){var i;for(null==e&&(e={render:!0}),null==this.removeFunc&&(this.removeFunc=function(t){return function(){return t.remove(),RG.Popovers.popoverActive=!1}}(this)),this.bodyView&&this.bodyView.remove(),this.bodyView=t,i=this._getContentPanel();null!=i?i.firstChild:void 0;)i.removeChild(i.firstChild);return e.className&&this.$el.addClass(e.className),e.render&&this.bodyView.render(),i?i.appendChild(this.bodyView.el):this.render(),this.bodyView.on("shrinkDropdown",function(t){return function(e){return t.shrinkDropdown(e)}}(this)),this.bodyView.on("hide",function(t){return function(){return t.$el.hide()}}(this)),this.bodyView.on("show",function(t){return function(){return t.$el.show()}}(this)),this.bodyView.on("close",this.removeFunc),this.bodyView.on("changeView",this.setBodyView,this,e),this.bodyView.on("changeOverlay",this.setOverlay,this),this.bodyView.on("changeView",this.setPosition,this),this.bodyView.on("updatePosition",this._updateAndReposition,this)},i.prototype._updateAndReposition=function(){return window.requestAnimationFrame(function(t){return function(){return t.setPosition(),$(window).trigger("scroll")}}(this))},i.prototype._getContentPanel=function(){return this.el.querySelector(".dropdown-content")},i.prototype.setPosition=function(t){var e,i,n,o,r,s,a,l,c;e=(null!=t?t:{animate:!0}).animate,this.$el.css("visibility","visible"),this.$(".shadow-arrow").css({top:""}),this.$el.css({top:"",left:""}),this.$(".f-dropdown").removeClass("cdrop-left").removeClass("cdrop-right"),this.$(".f-dropdown .dropdown-content").css({"max-height":$(window).height()}),this.$(".f-dropdown .dropdown-content main").css({"max-height":$(window).height()-this.$(".f-dropdown .dropdown-content header, .f-dropdown .dropdown-content .tabs").height()-130}),this._setOpenDirection(),i=-20,r=this.$el.offset(),c=$(window).scrollTop()+$(window).height(),a=parseInt(this.$(".shadow-arrow").css("margin-top"),10),r.top+a>c-40&&$(window).scrollTop($(window).scrollTop()+40+a+r.top-c),c=$(window).scrollTop()+$(window).height(),n=this.$el.children(0).outerHeight(),i=c-n-$(window).scrollTop()-20<0?-r.top+$(window).scrollTop()+60:_.min([-20,-(r.top+n-c)+20]),l=-i+10,this.$(".shadow-arrow").css({top:l}),this.$el.css({position:"absolute",top:i}),this._scrollIntoHorizontalView(e),o=this.el.querySelector(".f-dropdown .dropdown-content main"),s=!!(o&&o.scrollHeight>o.offsetHeight)&&0===o.querySelectorAll(".chzn-drop").length,this.$el.toggleClass("is-scrollable",s)},i.prototype.setOverlay=function(t,e){var i,n,o;return null==e&&(e={className:"overlay"}),o=function(t){return function(){return t.$el.removeClass("has-overlay")}}(this),n=function(){return o(),"function"==typeof e.removeCallback?e.removeCallback():void 0},null!=(i=this.overlay)&&i.remove(),this.overlay=new RG.Views.Dialogs.Overlay({attachTo:this.el,template:function(){return t.render().el},className:e.className,removeCallback:n,bodyView:t}),this.overlay.render(),this.$el.addClass("has-overlay")},i.prototype._fillValues=function(){if(this.bodyView)return this.setBodyView(this.bodyView)},i.prototype._setOpenDirection=function(){var t,e;return t="left"===this._getOpenDirection(),t?this._setOpenLeft():this._setOpenRight(),null!=(e=this.attachTo)&&"function"==typeof e.callback?e.callback(!1):void 0},i.prototype._getOpenDirection=function(){var t,e,i,n;return t=$(window),n=t.scrollLeft()+t.width(),e=this.$el.offset(),i=$(this.el.firstChild).outerWidth(),"left"===this.openDirection||n<=e.left+i+RG.getUnitWidth()+14?"left":"right"},i.prototype._setOpenTop=function(){var t;return this.verticalDirection="top",t=$(this.el.firstChild).outerHeight(),this.$el.css({top:-t}),this.$(".f-dropdown").addClass("cdrop-top")},i.prototype._setOpenLeft=function(){var t;return t=$(this.el.firstChild).outerWidth(),this.$el.css({left:-t-40}),this.$(".f-dropdown").addClass("cdrop-left"),this.$(".f-dropdown").removeClass("cdrop-right")},i.prototype._setOpenRight=function(){return this.$(".f-dropdown").addClass("cdrop-right"),this.$(".f-dropdown").removeClass("cdrop-left"),this.$el.css({left:27})},i.prototype._scrollIntoVerticalView=function(){var t,e,i;if(i=this.$el.offset(),e=this.el.getBoundingClientRect(),e.top<0&&$("html, body").animate({scrollTop:i.top-10},300),t=this.el.querySelector(".f-dropdown").getBoundingClientRect(),t.bottom>$(window).height())return $("html, body").animate({scrollTop:i.top+2*this.$(".f-dropdown").height()-$(window).height()},300)},i.prototype._scrollIntoHorizontalView=function(t){var e,i,n,o,r;null==t&&(t=!0),o=function(e){return t?$("html, body").animate({scrollLeft:e},300):$(window).scrollLeft(e)},i=this.$el.offset();try{n=this.el.querySelector(".f-dropdown").getBoundingClientRect()}catch(t){return}if(e=$("#calendar > aside").outerWidth(),(n.left<e||n.right>$(window).width())&&($(".f-dropdown").hasClass("cdrop-right")&&n.left-e<0&&o(i.left-e-40),n.left<0&&(this._setOpenRight(),i=this.$el.offset(),n=this.el.querySelector(".f-dropdown").getBoundingClientRect()),n.right>$(window).width()))return r=i.left+n.width-$(window).width()+RG.getUnitWidth()+40,r+$(window).width()>$("#resources").width()+e&&(this._setOpenLeft(),i=this.$el.offset(),r=i.left-10),o(r)},i.prototype._resetPosition=function(){if("top"===this.verticalDirection)return this._setOpenTop()},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.BookingClashManagement=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("dialogs/booking_clash_management"),i.prototype.initialize=function(t){var e,i;return this.command=t.command,this.clashBookingsCount=(null!=(e=t.clashBookingsCount)?e.length:void 0)||(null!=(i=this.command)?i.getClashingBookings().length:void 0),this.cancelCallback=t.cancelCallback,this.successCallback=t.successCallback,this.userPermissions=t.userPermissions||RG.Utils.Permissions},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this._removeDisallowedActions(),this._bindEvents(),this},i.prototype.addToWaitingList=function(t){var e;return t.preventDefault(),e=this._spinner(),Q.delay(50).then(function(t){return function(){return"function"==typeof t.successCallback&&t.successCallback(),t.command.execute({delete:!1}).then(function(){return e.close(),t.trigger("close"),RG.Popovers.done()})}}(this))},i.prototype.deleteBookings=function(t){var e;return t.preventDefault(),e=this._spinner(),Q.delay(50).then(function(t){return function(){return"function"==typeof t.successCallback&&t.successCallback(),t.command.execute({delete:!0}).then(function(){return e.close(),t.trigger("close"),RG.Popovers.done()})}}(this))},i.prototype.cancel=function(t){return t.preventDefault(),"function"==typeof this.cancelCallback&&this.cancelCallback(),this.trigger("close"),t.stopPropagation()},i.prototype._spinner=function(){var t,e;return e=this.$el.closest(".dropdown-anchor").children(),t=RG.Utils.spinnerOverlay(e[0]),this._isRenderedAsOverlay(e)?this.$el.hide():($(t.el).find(".dropdown-overlay-backdrop").css("height",e.find(".f-dropdown").outerHeight()),$(t.el).find(".spinner").css("margin-top","-20px")),t},i.prototype._isRenderedAsOverlay=function(t){return t.find(".dropdown-overlay-backdrop").length>1},i.prototype._fillValues=function(){return this.$(".js-booking-count").text(this.clashBookingsCount+" booking"+(this.clashBookingsCount>1?"s":"")),this.$(".js-fit-text").text("fit"+(this.clashBookingsCount>1?"":"s"))},i.prototype._bindEvents=function(){return this.$el.on("click",".js-add-waiting",this.addToWaitingList.bind(this)),this.$el.on("click",".js-delete-bookings",this.deleteBookings.bind(this)),this.$el.on("click",".js-cancel",this.cancel.bind(this))},i.prototype._removeDisallowedActions=function(){var t;if(t=this.command._clashingBookings.map(function(t){return t.collection.booking}),this.userPermissions.canDeleteClashBooking(t)||this.$(".js-delete-bookings").remove(),!this.userPermissions.canMoveClashBookingToWaitingList(t))return this.$(".js-add-waiting").remove(),this.$(".js-fit-text").remove(),this.$(".js-booking-count").remove(),this.$(".js-booking-clash-text").text("Some bookings within the date range clash with your time off. Please select dates when time is available instead."),this.$(".js-cancel").text("OK")},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.Overlay=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.events={"click .js-close":"close",click:"_stopPropagation"},i.prototype.initialize=function(t){return this.template=t.template,this.attachTo=t.attachTo,this.removeCallback=t.removeCallback,this.bodyView=t.bodyView},i.prototype.render=function(){var t;return this.$el.css("position","absolute"),this.attachTo&&(this.$el.width($(this.attachTo.firstChild).outerWidth()-2),this.$el.height($(this.attachTo.firstChild).outerHeight()-2),t=$(this.attachTo.firstChild).offset()),this.$el.append(this._renderBackdrop()),this.$el.append(this._renderModal().addClass("dropdown-overlay")),this._bindBodyClose(),$(this.attachTo).append(this.el),this.attachTo&&this.$el.offset({top:t.top+1,left:t.left+1}),this},i.prototype.close=function(){return"function"==typeof this.removeCallback&&this.removeCallback(),this.remove()},i.prototype._renderBackdrop=function(){var t;return t=$(document.createElement("div")),t.width("100%"),t.height("100%"),t.addClass("dropdown-overlay-backdrop"),t},i.prototype._bindBodyClose=function(){if(this.bodyView)return this.bodyView.on("close",function(t){return function(){return t.bodyView.off(),t.bodyView.remove(),t.close()}}(this))},i.prototype._renderModal=function(){return $(this.template())},i.prototype._stopPropagation=function(t){return t.stopPropagation()},i}(RG.Views.BaseView)}.call(this),function(){RG.Views.Factories.NameSearch=function(){function t(t){this.resources=t}return t.prototype.create=function(t){var e,i,n,o,r,s;return null==t&&(t={}),r=new RG.Models.OptionGroup,s=this.resources.filter(function(t){return t.visible}),i=this._getFilterableResources(this.resources.models),e=this._mapResources(i),n=this._mapResources(s),r.options.reset(e),t.showMenu?(o=new RG.Views.Filters.QuickSearchMenu({optionGroup:r,filteredOptions:n,allResourceOptions:e,savedFilters:RG.Utils.getLastUsedFilters()}),new RG.Views.Filters.QuickSearchWithMenu({menu:o,optionGroup:r,cssClass:t.cssClass,resourceSelector:t.resourceSelector})):new RG.Views.Filters.QuickSearch({optionGroup:r,cssClass:t.cssClass,resourceSelector:t.resourceSelector})},t.prototype._getFilterableResources=function(t){return t.filter(function(t){return t.isBookable()})},t.prototype._mapResources=function(t){return t.map(function(t){return new RG.Models.FilterOption({id:t.id,name:t.get("name"),tag:"quick_search",ref:t,type:t.get("resourceType").getName()})})},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Filters.OptionGroup=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("filters/option_group"),i.prototype.matchTypeTemplate=templates.find("filters/match_type"),i.prototype.className="filter__options-container",i.prototype.events={"change select":"triggerChangeFilter","select2-open select.filter-option":"focus","select2-open select.match-type-select":"focusMatchType"},i.prototype.clearSelection=function(){return this.getFilterOptionSelect().val([]),this.getFilterOptionSelect().trigger("change"),this.$(".filter-option .select2-search-field .select2-input").width("290px"),this.trigger("change:filter")},i.prototype.getFilterOptionSelect=function(){return this.$("select.filter-option")},i.prototype.getMatchType=function(){return this.optionGroup.get("multiple")?this.$("select.match-type-select").val():"any"},i.prototype.focus=function(t){return $("select.match-type-select").select2("close"),$("select.filter-option").not(this.$("select.filter-option")).select2("close")},i.prototype.focusMatchType=function(){return $("select.match-type-select").not(this.$("select.match-type-select")).select2("close"),$("select.filter-option").select2("close")},i.prototype.getOptions=function(){return{name:this.optionGroup.getName(),id:this.optionGroup.getTagId(),matchType:this.getMatchType(),selectedOptions:this.getFilterOptionSelect().val(),type:this.optionGroup.getType()}},i.prototype.getSelectedOptions=function(){var t,e;return(e=this.getFilterOptionSelect().val())?(t=e.map(function(t){return function(e){return t.optionGroup.options.findWhere({id:parseInt(e,10)})}}(this)),{optionGroup:this.optionGroup,selectedOptions:t,matchType:this.getMatchType()}):null},i.prototype.initialize=function(t){return this.optionGroup=t.optionGroup},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this.$(".match-type-select").select2({minimumResultsForSearch:10}),this},i.prototype.setFilters=function(t){var e,i,n,o,r,s;for(e=this.optionGroup.collection.category,s=[],n=0,o=t.length;n<o;n++)i=t[n],e.get("name")===i.categoryName&&s.push(function(){var t,e,n,o;for(n=i.options,o=[],t=0,e=n.length;t<e;t++)r=n[t],(r.id&&r.id===this.optionGroup.getTagId()||null==r.id&&r.name===this.optionGroup.getName())&&o.push(this.getFilterOptionSelect().val(r.selectedOptions).trigger("change"));return o}.call(this));return s},i.prototype.triggerChangeFilter=function(){return this.trigger("change:filter",this.optionGroup,this.getSelectedOptions())},i.prototype._createMatchAllOrAny=function(){return this.optionGroup.get("multiple")?this.$(".match-type").html(this.matchTypeTemplate()):this.$(".match-type").text("match any")},i.prototype._fillValues=function(){return this.getFilterOptionSelect().html(this._getSelectOptions()),this.getFilterOptionSelect().select2({placeholder:this._getPlaceholderText(),allowClear:!0}),this._createMatchAllOrAny()},i.prototype._getPlaceholderText=function(){return this.optionGroup.getName()+" - select one or more"},i.prototype._getSelectOptions=function(){var t,e,i,n,o;for(t=[],o=this.optionGroup.options.models,e=0,i=o.length;e<i;e++)n=o[e],t.push('<option value="'+n.id+'">'+n.getName()+"</option>");return t.join("")},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;RG.Views.Filters.QuickSearch=function(i){function n(){return this.searchBlur=t(this.searchBlur,this),this.searchFocused=t(this.searchFocused,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.resourceSelectorTemplate=templates.find("downtimes/resource_selector"),n.prototype.events={"change select":"triggerChangeFilter","focus .select2-input":"searchFocused","blur .select2-input":"searchBlur"},n.prototype.initialize=function(t){var e;return n.__super__.initialize.apply(this,arguments),
this.controls=t.controls,this.cssClass=t.cssClass,this.callback=t.callback,this.resourceSelector=t.resourceSelector,e=this,$("#root nav").on("click",function(t){return e.closeQuickSearch()})},n.prototype._fillValues=function(){return this._renderOptions()},n.prototype._renderOptions=function(){return this.getFilterOptionSelect().html(this._getSelectOptions()),this.getFilterOptionSelect().select2({placeholder:this._getPlaceholderText()})},n.prototype._getPlaceholderText=function(){return"Name Search"},n.prototype.triggerChangeFilter=function(t){return this.focused=!1,t.removed&&null===this.getSelectedOptions()?(RG.spin(this.$(".select2-container")[0]),window.requestAnimationFrame(function(t){return function(){return t.bubbleChanges()}}(this))):this.bubbleChanges()},n.prototype.bubbleChanges=function(){if(this.validate(),this.trigger("change:filter",this.optionGroup,this.getSelectedOptions()),this.$(".select2-container-disabled").length)return this.searchBlur()},n.prototype.searchFocused=function(t){return window.requestAnimationFrame(function(t){return function(){if(RG.Popovers.clear(),!t._isSearchFocused())return Q.delay(150).then(function(){return t.$(".select2-input").focus(),t.$(".select2-choices").click(),RG.spin()})}}(this))},n.prototype.toggle=function(t){return t?$("#select2-drop-mask").trigger("click"):(this.$("select.filter-option").select2("enable",!0),this.searchBlur())},n.prototype.searchBlur=function(t){return window.requestAnimationFrame(function(t){return function(){return 0===$("li."+t.cssClass).length&&(t.focused=!1,t.togglePlaceholder(!1),t.isMultiple()&&($(t.el).removeClass("search-hover"),t.addAllPill())),t.$(".select2-input").trigger("blur")}}(this))},n.prototype.isMultiple=function(){return this.$(".select2-choices").find("li.select2-search-choice").length>1},n.prototype.togglePlaceholder=function(t){var e,i,n;if((null!=(i=$("html"))&&null!=(n=i.attr("class"))?n.indexOf("ie"):void 0)===-1)return e=this.$(".select2-input"),this.getFilterOptionSelect().val()?e.attr("placeholder",""):t?e.attr("placeholder","Select one or more"):e.attr("placeholder",this._getPlaceholderText())},n.prototype.addAllPill=function(){var t,e,i,n;if(0===this.$(".all-pill").length)return e=[],t=this.$(".select2-choices"),n=t.find("li.select2-search-choice").length,i="resources",n<2&&(i="resource"),e.push("<li class='all-pill select2-search-choice'>"),e.push("<div>"+n+" "+i+" selected</div>"),e.push('<a href="#" class="all-pill-remove select2-search-choice-close" tabindex="-1"></a>'),e.push("</li>"),t.prepend(e.join("")),this.bindAllPill()},n.prototype.bindAllPill=function(){return this.allPillBound||(this.$(".select2-choices").on("click",".all-pill-remove",function(t){return function(){return t.clearAll()}}(this)),this.allPillBound=!0),this.$(".all-pill").off(),this.$(".all-pill").on("click",function(t){return function(e){return t.$(".select2-input").click()}}(this))},n.prototype.clearAll=function(){return localStorage.lastActiveFilterId=null,RG.spin(this.$(".select2-container")[0]),this.removeAllPill(),this.$(".select2-choices li.select2-search-choice").hide(),this.clearSelection()},n.prototype.clearSelection=function(){return setTimeout(function(t){return function(){return t.getFilterOptionSelect().val([]).trigger("change"),RG.spin(t.$(".select2-container")[0])}}(this),16)},n.prototype.removeAllPill=function(){return this.$(".all-pill").remove()},n.prototype.getResourceIds=function(){var t,e;return e=null!=(t=this.getSelectedOptions())?t.selectedOptions:void 0,e?_.collect(e,function(t){return t.id}):[]},n.prototype._getOptions=function(){return _.groupBy(this.optionGroup.options.models,function(t){return t.get("type")})},n.prototype._getSelectOptions=function(){var t,e,i,n,o,r,s;t=this._getOptions(),i=[];for(e in t)if(s=t[e],s.length){for(i.push("<optgroup class='"+this.cssClass+"' label=\""+e+'">'),n=0,o=s.length;n<o;n++)r=s[n],i.push('<option value="'+r.id+'">'+r.getName().substring(0,20)+"</option>");i.push("</optgroup>")}return i.join("")},n.prototype.setFilters=function(t){var e,i,n,o,r,s,a,l;for(l=[],i=0,o=t.length;i<o;i++)for(e=t[i],a=e.options,n=0,r=a.length;n<r;n++)s=a[n],"Name"===s.name&&l.push(s.selectedOptions);return this.getFilterOptionSelect().val(_.flatten(_.compact(l))).trigger("change")},n.prototype.setSearchHeigth=function(t){var e,i;return e=this.searchGroup.getSelectedOptions(),this.quickSearchCount=null!=e&&null!=(i=e.selectedOptions)?i.length:void 0,this.$("#quick-search").addClass("search-hover")},n.prototype.setDropMaskOffset=function(){var t;return t=60+20*this.getFilterOptionSelect().val().length,$("#select2-drop-mask").offset({top:""+t})},n.prototype.closeQuickSearch=function(){return RG.closeAllSelections(),this.focused=!1,this.togglePlaceholder(!1),this.isMultiple()&&this.addAllPill(),$(this.el).removeClass("search-hover")},n.prototype.remove=function(){return n.__super__.remove.apply(this,arguments)},n.prototype.render=function(){return this.$el.html(this._template()),this._fillValues(),this.$(".match-type-select").select2({minimumResultsForSearch:10}),setTimeout(function(t){return function(){return t.searchBlur()}}(this),1e3),this},n.prototype.validate=function(){return this.getResourceIds().length>0?(this.$el.find(".error").hide(),!0):(this.$el.find(".error").show(),!1)},n.prototype._template=function(){return this.resourceSelector?this.resourceSelectorTemplate:this.template},n.prototype._isSearchFocused=function(){var t,e;return"function"==typeof this.callback&&this.callback(),RG.closeAllDropdowns(),!!this.focused||(this.removeAllPill(),this.$el.addClass("search-hover"),this.togglePlaceholder(!0),this._scroll(),this._bindDropMask(),null!=(t=$(".match-type-select.select2-container-active"))&&null!=(e=t.data("select2"))&&e.close(),this.focused=!0,!1)},n.prototype._bindDropMask=function(){return $("#select2-drop-mask").on("mousedown touchstart click",function(t){return function(e){return t.searchBlur(e)}}(this))},n.prototype._scroll=function(){return $(document).trigger("scroll")},n}(RG.Views.Filters.OptionGroup)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Filters.QuickSearchMenu=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("filters/quick_search_menu"),i.prototype.initialize=function(t){return this.optionGroup=t.optionGroup,this.filteredOptions=t.filteredOptions,this.allResourceOptions=t.allResourceOptions},i.prototype.render=function(){return this.$el.html(this.template()),this._bindEvents(),this},i.prototype._bindEvents=function(){return this.$el.on("click","i",function(t){return function(e){return t._toggleMenu(e)}}(this)),this.$el.on("click",".js-clear-resources",function(t){return function(){return t._clearAllSelectedOptions()}}(this)),this.$el.on("click",".js-currently-filtered",function(t){return function(){return t._setToCurrentlyFilteredResources()}}(this)),this.$el.on("click",".js-all-people",function(t){return function(){return t._setToAllPeople()}}(this)),this.$el.on("click",".js-all-resources",function(t){return function(){return t._setToAllResources()}}(this))},i.prototype._toggleMenu=function(t){return t.preventDefault(),t.stopPropagation(),this.trigger("menuClicked"),this.$(".js-menu-options").toggle()},i.prototype.hide=function(){return this.$(".js-menu-options").hide()},i.prototype._clearAllSelectedOptions=function(){return this.trigger("change",[])},i.prototype._setToAllPeople=function(){var t,e;return this.optionGroup.options.reset(this.allResourceOptions),e=_.chain(this.optionGroup.options.models).select(function(t){return"Person"===t.get("type")}).collect(function(t){return t.id}).value(),t=[{categoryName:"Person",options:[{matchType:"any",name:"Name",selectedOptions:e}]}],this.trigger("change",t)},i.prototype._setToCurrentlyFilteredResources=function(){return this.optionGroup.options.reset(this.filteredOptions),this._triggerChange()},i.prototype._setToAllResources=function(){return this.optionGroup.options.reset(this.allResourceOptions),this._triggerChange()},i.prototype._triggerChange=function(){var t,e;return e=this.optionGroup.options.collect(function(t){return t.id}),t=[{categoryName:"Person",options:[{matchType:"any",name:"Name",selectedOptions:e}]}],this.trigger("change",t)},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;RG.Views.Filters.QuickSearchWithMenu=function(i){function n(){return this.searchFocused=t(this.searchFocused,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.resourceSelectorTemplate=templates.find("downtimes/resource_selector"),n.prototype.initialize=function(t){return n.__super__.initialize.apply(this,arguments),this.menu=t.menu},n.prototype._fillValues=function(){return this.$(".filter__options-control").append(this.menu.render().el),this.menu.on("change",function(t){return function(e,i){return null==i&&(i=!1),t.trigger("displaySpinner"),Q.delay(10).then(function(){var i;return t._renderOptions(),t.setFilters(e),null!=(i=t.overlay)?i.remove():void 0})}}(this)),this.menu.on("menuClicked",function(t){return function(){return t.$el.click()}}(this)),n.__super__._fillValues.apply(this,arguments)},n.prototype._renderOptions=function(){var t;return t=this.getFilterOptionSelect(),t.html(this._getSelectOptions()),window.view=this,t.select2({placeholder:this._getPlaceholderText(),closeOnSelect:!1}),this.$(".select2-input").on("keyup",function(e){return function(i){var n,o,r;if(13===i.keyCode)return r=$($("div.select2-result-label")[1]).text(),o=e.optionGroup.options.findWhere({name:r}),n=e.getResourceIds(),n.push(o.id),t.val(n).trigger("change"),Q.delay(20).then(function(){return e.$(".select2-input").focus(),e.$(".select2-choices").click()})}}(this))},n.prototype.setDropMaskOffset=function(){var t;return t=60+20*this.getFilterOptionSelect().val().length,$("#select2-drop-mask").offset({top:""+t})},n.prototype.remove=function(){return RG.clearStaleDropdowns(),this.menu.remove(),n.__super__.remove.apply(this,arguments)},n.prototype.searchFocused=function(t){return this.menu.hide()},n.prototype.searchBlur=function(t){},n.prototype.addAllPill=function(){},n.prototype.bindAllPill=function(){},n.prototype.removeAllPill=function(){},n.prototype._bindDropMask=function(){},n}(RG.Views.Filters.QuickSearch)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Selectors.Booker=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){var e;return this.bookers=t.bookers,this.booking=t.booking,this.currentUserId=t.currentUserId,this.booker=t.booker||(null!=(e=this.booking)?e.get("booker"):void 0)},i.prototype.render=function(){var t;return null!=(t=this.selectBox)&&t.remove(),this.selectBox=$("<select style='width: 288px'></select>").addClass("chzn-select"),this._fillValues(),this.$el.html(this.selectBox),this.setSelectedValue(this.getCurrentUserBooker().cid),this},i.prototype._fillValues=function(){var t,e,i,n,o;for(e=this.bookers.select(function(t){return function(e){var i;return!e.get("archived")||e.cid===(null!=(i=t.booker)?i.cid:void 0)}}(this)),o=[],i=0,n=e.length;i<n;i++)t=e[i],o.push(this.selectBox.append($("<option></option").val(t.cid).text(t.get("name"))));return o},i.prototype.getBooker=function(){var t;return t=this.selectBox.trigger("liszt:updated").val(),this.bookers.find(function(e){return e.cid===t})},i.prototype.getCurrentUserBooker=function(){return this.bookers.findWhere({id:this.currentUserId})},i.prototype.setSelectedValue=function(t){return this.selectBox.val(t).trigger("liszt:updated")},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Selectors.DateRange=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.dateFormat="d M yy",i.prototype.template=templates.find("selectors/date_range"),i.prototype.initialize=function(t){return this.dateRange=t.dateRange,this.resource=t.resource,this.customTemplate=t.customTemplate,this.customValidations=t.customValidations||function(t){return!0}},i.prototype.getDateRange=function(){var t;return t=new RG.Utils.DateRange(this._parseDateString(this._getStartDateEl().val())||this.dateRange.startDate,this._parseDateString(this._getEndDateEl().val())||this.dateRange.endDate)},i.prototype._bindEvents=function(){return this.$el.on("change","input#booking-start-date",function(t){return function(){return t._setMinDate()}}(this)),this.$el.on("change","input#booking-end-date",function(t){return function(){return t._setMaxDate()}}(this)),this.$el.on("change","input.js-date-range-input",function(t){return function(){return t.triggerValidate()}}(this)),this.$el.on("change","input.js-date-range-input",function(t){return function(){return t.triggerChange()}}(this))},i.prototype.render=function(){var t;return this.customTemplate||this.$el.html(this.template()),this._fillValues(),this._getStartDateEl().datepicker({dateFormat:this.dateFormat,firstDay:1}),t=this._getStartDateEl().datepicker("widget"),t.off(),t.on("mousedown mouseup click",function(t){return t.stopPropagation()}),t.hasStopPropagation=!0,this._getEndDateEl().datepicker({minDate:this.dateRange.startDate,dateFormat:this.dateFormat,firstDay:1}),this._bindEvents(),this},i.prototype.stopPropagation=function(t){return t.stopPropagation()},i.prototype.toggleError=function(t){return this.$(".help-inline").toggle(t)},i.prototype.triggerChange=function(){return this.trigger("change",this.getDateRange())},i.prototype.triggerValidate=function(){return this.validate(!0),!0},i.prototype.validate=function(t){return this.customValidations(this)&&this._validate(t)},i.prototype._validate=function(t){var e,i,n,o;e=null,n=!1;try{e=new RG.Utils.DateRange(this._parseDateString(this._getStartDateEl().val())||this.dateRange.endDate,this._parseDateString(this._getEndDateEl().val())||this.dateRange.endDate)}catch(t){i=t,n=!0}return this._isDateRangeValid(e)&&this._isResourceAvailable(e)?n=!1:(n=!0,o=[],this._isDateRangeValid(e)?this._isResourceAvailable(e)||o.push("Sorry, you can't start or end a booking on a non-working day. Please change your dates."):o.push("Please select a start and end date."),this._setErrorText(o.join("<br>"))),this.toggleError(n),t&&this.trigger("validate"),!n},i.prototype._fillValues=function(){return this._getStartDateEl().val(this._getDateString(this.dateRange.startDate)),this._getEndDateEl().val(this._getDateString(this.dateRange.endDate)),this.validate()},i.prototype._getDateString=function(t){return $.datepicker.formatDate(this.dateFormat,t)},i.prototype._getEndDateEl=function(){return this.$("#booking-end-date")},i.prototype._getStartDateEl=function(){return this.$("#booking-start-date")},i.prototype._isDateRangeValid=function(t){return t&&t.startDate&&t.endDate},i.prototype._isResourceAvailable=function(t){return this.resource.availability.isAvailableStartAndEndDate(t)},i.prototype._parseDateString=function(t){try{return $.datepicker.parseDate(this.dateFormat,t)}catch(t){return null}},i.prototype._setErrorText=function(t){return this.$(".help-inline").text(t)},i.prototype._setMinDate=function(){var t;if(t=this.getDateRange(),this._getEndDateEl().datepicker("destroy"),this._getEndDateEl().datepicker({dateFormat:this.dateFormat,minDate:t.startDate,firstDay:1}),t.getNumberOfDays()<1)return this._getEndDateEl().val(this._getDateString(t.startDate))},i.prototype._setMaxDate=function(){var t;if(t=this.getDateRange(),t.getNumberOfDays()<1)return this._getStartDateEl().val(this._getDateString(t.endDate))},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Selectors.DateTimeRange=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("selectors/date_time_range"),i.prototype.initialize=function(t){return this.timeRange=t.timeRange,this.dateRange=t.dateRange,this.resource=t.resource,this.customValidations=t.customValidations||function(t){return!0}},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this},i.prototype.getValues=function(){return{dateRange:this.dateRangeSelector.getDateRange(),timeRange:this.timeRangeSelector.getTimeRange()}},i.prototype.validate=function(){var t;return t=this.customValidations(this)&&this.dateRangeSelector.validate()&&this.timeRangeSelector.validate(),this.trigger("validate"),t},i.prototype._fillValues=function(){return this._composeDateRangeSelector(),this.dateRangeSelector.render(),this._composeTimeRangeSelector(),this._composeValidations(),this.timeRangeSelector.render()},i.prototype._composeDateRangeSelector=function(){return this.dateRangeSelector=new RG.Views.Selectors.DateRange({customTemplate:!0,dateRange:this.dateRange,resource:this.resource,el:this.el}),this.dateRangeSelector._isResourceAvailable=function(t){return!0},this.dateRangeSelector.on("change",function(t){return function(e){return t.dateRange=e,t.trigger("change",e,t.timeRangeSelector.getTimeRange()),t.validate()}}(this))},i.prototype._composeTimeRangeSelector=function(){return this.timeRangeSelector=new RG.Views.Selectors.TimeRange({customTemplate:!0,startTime:this.timeRange.startTime,endTime:this.timeRange.endTime,typeName:this.resource.typeName(),el:this.el}),this._overWriteTimeRangeValues(),this.timeRangeSelector.on("change",function(t){return function(e){return t.trigger("change",t.dateRangeSelector.getDateRange(),e),t.validate()}}(this))},i.prototype._composeValidations=function(){var t;return t=this.timeRangeSelector.validate.bind(this.timeRangeSelector),this.timeRangeSelector.validate=function(e){return function(){return 1!==e.dateRangeSelector.getDateRange().getNumberOfDays()||t(!0)}}(this)},i.prototype._overWriteTimeRangeValues=function(){if(this.dateRange.getNumberOfDays()>1)return this.timeRangeSelector._fillValues=function(t){return function(){var e;return e=t.timeRangeSelector.$("#booking-start-time"),e.calendricalTime(),t.timeRangeSelector.$("#booking-end-time").calendricalTime({maxTime:{hour:24,minute:0},startDate:t.dateRangeSelector.$("input#booking-start-date"),endDate:t.dateRangeSelector.$("input#booking-end-date")}),t.timeRangeSelector.$("#booking-start-time").val(t.timeRangeSelector._minutesToTime(t.timeRange.startTime)),t.timeRangeSelector.$("#booking-end-time").val(t.timeRangeSelector._minutesToTime(t.timeRange.endTime))}}(this)},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Selectors.DowntimeTypeSelector=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="select",i.prototype.initialize=function(t){return null==t&&(t={}),this.downtimeTypes=t.downtimeTypes,this.selectedOption=t.selectedOption},i.prototype.render=function(){for(var t;t=this.el.firstChild;)this.el.removeChild(t);return this._fillValues(),this._bindEvents(),this},i.prototype.getSelectedDowntimeType=function(){return this.downtimeTypes.findWhere({id:+this.$el.val()})},i.prototype._bindEvents=function(){return this.$el.on("change",function(t){return function(){return t.trigger("change",t.getSelectedDowntimeType())}}(this))},i.prototype._fillValues=function(){return this.$el.css("width","288px"),this._createDowntimeTypes()},i.prototype._createDowntimeTypes=function(){var t,e,i,n,o;for(this.$el.append('<option selected="selected" value="">&nbsp;</option>'),n=this.downtimeTypes.models,o=[],e=0,i=n.length;e<i;e++)t=n[e],o.push(this._createOption(t));return o},i.prototype._createOption=function(t){var e,i;return e=$(document.createElement("option")).val(t.get("id")).text(t.get("name")),t.cid===(null!=(i=this.selectedOption)?i.cid:void 0)&&e.attr("selected","selected"),this.$el.append(e)},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Selectors.TimeRange=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="specific-time",i.prototype.template=templates.find("selectors/time_range"),i.prototype.togglable=!0,i.prototype.initialize=function(t){return"undefined"==typeof t.startTime?this.startTime=540:this.startTime=t.startTime,this.endTime=t.endTime||1020,void 0!==t.togglable&&(this.togglable=t.togglable),this.storageTypeName=t.typeName,this.customTemplate=t.customTemplate},i.prototype.remove=function(){return i.__super__.remove.apply(this,arguments)},i.prototype.closeSelector=function(){return this.$("#booking-start-time, #booking-end-time").blur()},i.prototype.getBookingDurationDTO=function(){return new RG.DTO.BookingDuration({duration:this.getEndTime()-this.getStartTime(),startTime:this.getStartTime()})},i.prototype.getEndTime=function(){var t;return"Start of day"===this.getEndTimeStr()?0:this.isEndOfDay()?1440:(t=this._timeToMinutes(this.getEndTimeStr()),t||1440)},i.prototype.isEndOfDay=function(){return"End of day"===this.getEndTimeStr()},i.prototype.getEndTimeStr=function(){return this.$("#booking-end-time").val()},i.prototype.getStartTime=function(){return this.isStartOfDay()?0:this._timeToMinutes(this.getStartTimeStr())},i.prototype.getTimeRange=function(){return new RG.Utils.TimeRange(this.getStartTime(),this.getEndTime())},i.prototype.isStartOfDay=function(){return"Start of day"===this.getStartTimeStr()},i.prototype.getStartTimeStr=function(){return this.$("#booking-start-time").val()},i.prototype._bindEvents=function(){return this.$el.on("change","input.js-time-range-input",function(t){return function(){return t.triggerValidate()}}(this))},i.prototype.render=function(){return this.customTemplate||(this.$el.html(this.template()),this.$(".alt-toggle").toggle(this.togglable)),this._fillValues(),this._bindEvents(),this.validate(),this},i.prototype.setEndTime=function(t){return this.endTime=t,this._fillValues()},i.prototype.setStartTime=function(t){return this.startTime=t,this._fillValues()},i.prototype.toggleError=function(t){return this.$(".help-inline").toggle(t)},i.prototype.triggerValidate=function(){return isNaN(+this.getEndTime())||(window.localStorage["TimeRange:EndTime:"+this.storageTypeName]=+this.getEndTime()),isNaN(+this.getStartTime())||(window.localStorage["TimeRange:StartTime:"+this.storageTypeName]=+this.getStartTime()),this.validate(!0),this.trigger("change",this.getTimeRange()),!0},i.prototype.validate=function(t){var e;return e=!1,e=!this._validated(),this.toggleError(e),t&&this.trigger("validate",!e),!e},i.prototype._validated=function(){var t;return this.$el.find(".error").text("Please select a valid start and end time."),t=this.getStartTime()>=0&&this.getEndTime()<=1440,t=t&&(!isNaN(this._timeToMinutes(this.$("#booking-end-time").val()))||this.isEndOfDay()),t=t&&this.getEndTime()>this.getStartTime(),t||this.$el.find(".error").text("Start time must be before end time"),t&&this._validateTimeStringRange(this.getStartTimeStr(),!1)&&this._validateTimeStringRange(this.getEndTimeStr(),!0)},i.prototype._fillValues=function(){return this._calendrical||(this._calendrical=this.$("#booking-start-time, #booking-end-time").calendricalTimeRange()),this.$("#booking-start-time").val(this._minutesToTime(this.startTime)),this.$("#booking-end-time").val(this._minutesToTime(this.endTime))},i.prototype._minutesToTime=function(t){var e,i,n;return i=Math.floor(t/60),t%=60,e=i>=12&&24!==i?"pm":"am",n=t.toString(),1===n.length&&(n="0"+n),0===i&&0===t?"Start of day":24===i&&0===t?"End of day":(i>12&&(i-=12),0===i&&(i=12),i+":"+n+e)},i.prototype._timeToMinutes=function(t){var e,i,n,o;return n=t.substr(0,t.indexOf(":")),i=parseInt(n,10),o=parseInt(t.substr(n.length+1,2),10),e=t.substr(t.length-2,2),i>=12&&(i-=12),"am"!==e.toLowerCase()&&(i+=12),60*i+o},i.prototype._validateTimeStringRange=function(t,e){var i,n,o,r,s;return o=t.substr(0,t.indexOf(":")),n=parseInt(o,10),r=parseInt(t.substr(o.length+1,2),10),"Start of day"===t&&(r=0,n=0),"End of day"===t&&(r=0,n=24),i="Start of day"===t?"AM":"End of day"===t?"PM":t.substr(t.length-2,2),("am"===i.toLowerCase()||"pm"===i.toLowerCase())&&(!(r>=60||r<0)&&(!("am"===i.toLowerCase()&&!e&&n>=13)&&(!("am"===i.toLowerCase()&&e&&n>=13)&&(n>=12&&(n-=12),"am"!==i.toLowerCase()&&(n+=12),s=60*n+r,!("am"===i.toLowerCase()&&e&&s>1440)&&(!("am"===i.toLowerCase()&&!e&&(s<0||s>=720))&&("pm"!==i.toLowerCase()||!e||!(s>1440||s<720)))))))},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Selectors.TimeZoneSelector=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return this.timeZones=t.timeZones,this.selectedOption=t.selectedOption,this.resourceLocalTime=t.resourceLocalTime,this.currentUserTimeZone=t.currentUserTimeZone},i.prototype.render=function(){return this.$el.append(),this._fillValues(),this.setTimeZone(),this},i.prototype._fillValues=function(){var t,e,i,n,o;return i=$(document.createElement("span")).addClass("help-inline error").text("Please select a timezone - selected resources are in different zones").hide(),o=$(document.createElement("select")),t=$(document.createElement("optgroup")),t.append($(document.createElement("option")).text("Select an option").attr("selected",!this.selectedOption).val("none")),t.append($(document.createElement("option")).text("Resource's local time").attr("selected",this._isLocalTimeZone()).val("NullTimeZone")),e=[_.unescape(this.selectedOption),_.unescape(this.currentUserTimeZone),_.unescape(this.resourceLocalTime)],n=$(document.createElement("optgroup")).attr("label","--------------"),this.timeZones.each(function(i){return function(o){var r;return r=$(document.createElement("option")),r.text(o.toString()).val(o.getName()),_.include(e,o.getName())?(i.selectedOption===o.getName()&&r.attr("selected","selected"),t.append(r)):n.append(r)}}(this)),o.append(t),o.append(n),this.$el.append(o),this.$el.append(i),this.$el.on("change","select",function(t){return function(){return t.validate()}}(this))},i.prototype.getTimeZone=function(){return this.$("select").val()},i.prototype.setTimeZone=function(){if(this.selectedOption)return this.$("select").val(this.selectedOption)},i.prototype.validate=function(){return"none"===this.getTimeZone()?(this.$el.find(".error").show(),!1):(this.$el.find(".error").hide(),!0)},i.prototype._isLocalTimeZone=function(){return this.selectedOption===(new RG.Models.NullTimeZone).getName()},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Calendar.ColorControl=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="li",i.prototype.className="color-by dropdown is-header-dropdown has-chevron",i.prototype.template=templates.find("calendar/color_control"),i.prototype.events={"click #color-by-project":"colorByProject","click #color-by-client":"colorByClient","click #color-by-booker":"colorByBooker","click #color-by-trigger":"clearAllSelections"},i.prototype.initialize=function(t){return this.colorSource=t.colorSource,this.listenTo(this.colorSource,"change:mode",this._setActiveLink)},i.prototype.clearAllSelections=function(){return RG.closeAllSelections()},i.prototype.colorByClient=function(t){return t.preventDefault(),this._colorBy("client")},i.prototype.colorByProject=function(t){return t.preventDefault(),this._colorBy("project")},i.prototype.colorByBooker=function(t){return t.preventDefault(),this._colorBy("booker")},i.prototype.render=function(){return this.$el.html(this.template()),this._setActiveLink(),this},i.prototype._colorBy=function(t){return localStorage.colorBookingsBy=t,this.colorSource.colorBy(t)},i.prototype._setActiveLink=function(){return window.requestAnimationFrame(function(t){return function(){var e;return t.$("li").removeClass("active"),t.$("a#color-by-"+t.colorSource.mode).closest("li").addClass("active"),e=t.colorSource.mode.charAt(0).toUpperCase()+t.colorSource.mode.slice(1),t.$("#active-coloring").text("Color by "+e)}}(this))},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;RG.Views.Calendar.Controls=function(i){function n(){return this.searchChange=t(this.searchChange,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.template=templates.find("calendar/controls"),n.prototype.tagName="header",n.prototype.events={"click .filters a":"toggleFilterBar","click .js-toggle-availability":"toggleAvailability","click .js-zoom-toggle":"toggleZoom","click nav":"closeQuickSearch"},n.prototype.closeQuickSearch=function(t){return $("#select2-drop-mask").trigger("click")},n.prototype.initialize=function(t){return this.dateControl=t.dateControl,this.colorControl=t.colorControl,this.filterBar=t.filterBar,this.searchGroup=t.searchGroup,this.searchGroup.on("change:filter",this.searchChange),this.filterBar.on("change:filter",function(t){return function(e){return t.searchGroup.off("change:filter"),t.searchGroup.setFilters(t.filterBar.getFilters()),t.searchGroup.on("change:filter",t.searchChange),t.emptySearchStyle(),t.searchGroup.searchBlur()}}(this)),this.listenTo(this.filterBar,"change:filter",this._setFilterActive)},n.prototype.render=function(){return this.$el.html(this.template()),this._toggleAvailabilityButton(),this._renderDateControl(),this._renderColorControl(),this._renderFilterBar(),this._quickSearch(),this._setZoomToolipTitles(),this._initTooltips(),this},n.prototype.toggleFilterBar=function(t){return this.filterBar.resetFlyouts()},n.prototype.toggleAvailability=function(t){var e;return t.preventDefault(),e=RG.getCurrentResource(),this.availabilityToggle.toggle(),this._toggleAvailabilityButton(),this._setCurrentResource(e),!1},n.prototype._setCurrentResource=function(t){return setTimeout(function(e){return function(){if(t)return setTimeout(function(){return RG.Utils.unitsRendered()?RG.setCurrentResource(t):e._setCurrentResource(t)},10)}}(this),5)},n.prototype.setZoomDaily=function(){return window.localStorage.zoomLevel="daily",this.setZoom(function(){return $("#calendar").removeClass("detailed")}),!1},n.prototype.setZoomDetailed=function(){return window.localStorage.zoomLevel="detailed",this.setZoom(function(){return $("#calendar").addClass("detailed")}),!1},n.prototype.toggleZoom=function(t){return"detailed"===window.localStorage.zoomLevel?this.setZoomDaily():this.setZoomDetailed(),this._setZoomToolipTitles();
},n.prototype.setResourceCardSelectors=function(){return window.resources.collect(function(t){return{card:$("aside .resource[data-resource-id="+t.cid+"]"),line:$(".resource-line:not([style$='display: none;'])[data-resource-id="+t.cid+"]")}})},n.prototype.setZoom=function(t){var e,i,n;return n=this._getLeftRatio(),i=RG.getCurrentResource(),RG.Popovers.popoverActive=!1,RG.Popovers.clear(),e=this.setResourceCardSelectors(),t(),RG.resizeBookingWidths(),e.forEach(function(t){return t.card.outerHeight(t.line.outerHeight())}),this._scrollLeftRatio(n),$(window).scrollLeft()+$(window).width()-$("#calendar > aside").width()>$("#resources").width()&&($(window).scrollLeft(0),$(window).scrollLeft($("#resources").width()-$(window).width()+$("#calendar > aside").width())),i&&RG.setCurrentResource(i),!1},n.prototype._toggleAvailabilityButton=function(){var t;return t=this.$el.find(".js-toggle-availability"),t.tooltip("destroy").tooltip({title:this.availabilityToggle.title}),t.toggleClass("active",this.availabilityToggle.shouldRenderUtilisation())},n.prototype._getLeftRatio=function(){return $(window).scrollLeft()/$("#resources .resource-line:visible").width()},n.prototype._getTopRatio=function(){return $(window).scrollTop()/$("#resources .resource-line:visible").height()},n.prototype._scrollLeftRatio=function(t){return $(window).scrollLeft($("#resources .resource-line:visible").width()*t)},n.prototype._scrollTopRatio=function(t){return $(window).scrollTop($("#resources .resource-line:visible").height()*t)},n.prototype._renderColorControl=function(){return this.$("#color-control").replaceWith(this.colorControl.render().el)},n.prototype._renderFilterBar=function(){return this.$("#filter-bar").replaceWith(this.filterBar.render().el)},n.prototype._setZoomToolipTitles=function(){var t,e;return t=this.$(".zoom-toggle"),e=window.localStorage.zoomLevel,e?"daily"===e?t.tooltip("destroy").tooltip({title:"Zoom in"}):"detailed"===e?t.tooltip("destroy").tooltip({title:"Zoom out"}):void 0:t.tooltip("destroy").tooltip({title:"Zoom in"})},n.prototype._setFilterActive=function(t){return this.$(".filters").toggleClass("active",t.length>0)},n.prototype._quickSearch=function(){return this.$("#quick-search").html(this.searchGroup.render().el),this.emptySearchStyle()},n.prototype._initTooltips=function(){return this.$el.find(".availability-toggle li").tooltip(),this.$el.find(".zoom-toggle").tooltip()},n.prototype._renderDateControl=function(){return this.$("nav").prepend(this.dateControl.render().el)},n.prototype.searchChange=function(){var t,e,i,n,o,r,s,a,l,c,u,h;for(n=this.filterBar.getFilters(),t=_.collect(n,function(t){return t.categoryName}),o=0,a=t.length;o<a;o++)if(e=t[o],h=this.searchGroup.getSelectedOptions(),i=_.find(n,function(t){return t.categoryName===e}),r=[],h&&(r=_.compact(_.map(h.selectedOptions,function(t){return t.get("type")===e?t.id:null}))),i)for(u=_.where(i.options,{name:"Name",id:void 0}),s=0,l=u.length;s<l;s++)c=u[s],c.selectedOptions=r;return this.filterBar.setFilters(n),this.emptySearchStyle(),this.refocusQuickSearch()},n.prototype.emptySearchStyle=function(){return null===this.searchGroup.getSelectedOptions()?this.$("#quick-search .select2-choices").addClass("no-choices"):this.$("#quick-search .select2-choices").removeClass("no-choices")},n.prototype.refocusQuickSearch=function(){return this.searchGroup.searchFocused(),this.$("#quick-search .select2-choices").trigger("click")},n}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Calendar.DateControl=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="ul",i.prototype.className="left-menu date-controls",i.prototype.template=templates.find("calendar/date_control"),i.prototype.startYearPeriod=2011,i.prototype.endYearPeriod=function(){return(new Date).getFullYear()+7},i.prototype.events={"click .js-current":"goToCurrent","click .js-previous":"scrollLeft","click .js-next":"scrollRight","click .months li":"selectMonth","click #jump-to-year-options li":"selectYear","click .year-scroller .js-scroll-year":"scrollYear"},i.prototype.initialize=function(t){return this.initialDate=t.initialDate||new Date},i.prototype.goToCurrent=function(t){return t.preventDefault(),window.dateController.scrollToDate(RG.Utils.BookingDataParser.getDateFromStr(window.currentUserDate.date))},i.prototype.scrollLeft=function(t){t.preventDefault(),$("html, body").animate({scrollLeft:$(window).scrollLeft()-RG.Utils.scrollSize()},500),$(window).scrollLeft()<200&&(RG.Variables.currentResource=RG.getCurrentResource(),$(".large-controls .previous-timeperiods").addClass("loading"),this.loadMoreBookings(this.scrollLeftCallback,"left"))},i.prototype.scrollLeftCallback=function(){var t,e;e=$(document.elementFromPoint(295,240)).closest(".resources--cal-unit"),window.dateController.prepend(4),RG.updateLongBookings(),$("#time-periods, #resources").css({width:window.ugc.getUnitCollection().length*RG.getUnitWidth()}),$(".large-controls .previous-timeperiods").fadeOut().removeClass("loading"),$(".booking-anchor.waitlist .waiting-list").removeClass("waiting-list"),e&&(t=e.offset())&&($(window).scrollLeft(t.left-249-e.width()),$("html, body").animate({scrollLeft:$(window).scrollLeft()-RG.Utils.scrollSize()})),RG.Variables.currentResource&&RG.setCurrentResource(RG.Variables.currentResource),RG.Variables.currentResource=void 0},i.prototype.scrollRight=function(t){t.preventDefault(),-1*($(window).scrollLeft()-$(document).width()+$(window).width())<200?(RG.Variables.currentResource=RG.getCurrentResource(),$(".large-controls .next-timeperiods").addClass("loading"),this.loadMoreBookings(this.scrollRightCallback,"right")):$("html, body").animate({scrollLeft:$(window).scrollLeft()+RG.Utils.scrollSize()},500)},i.prototype.scrollRightCallback=function(){var t,e;e=$(document.elementFromPoint(251,240)).closest(".resources--cal-unit"),window.dateController.append(4),$("#time-periods, #resources").css({width:window.ugc.getUnitCollection().length*RG.getUnitWidth()}),$(".large-controls .next-timeperiods").fadeOut().removeClass("loading"),$(".booking-anchor.waitlist .waiting-list").removeClass("waiting-list"),e&&(t=e.offset())&&($(window).scrollLeft(e.offset().left-249),$("html, body").animate({scrollLeft:$(window).scrollLeft()+RG.Utils.scrollSize()})),RG.Variables.currentResource&&RG.setCurrentResource(RG.Variables.currentResource),RG.Variables.currentResource=void 0},i.prototype.loadMoreBookings=function(t,e){var i,n,o,r,s,a,l;n={calendar:1},"left"===e?(r=RG.Utils.firstVisibleDate(),o=r.clone(),r=r.subtract(56,"days"),n.start_date=encodeURIComponent(r.format("YYYY-MM-DD")),n.end_date=encodeURIComponent(o.format("YYYY-MM-DD")),l=r,a=RG.Utils.lastVisibleDate()):(r=RG.Utils.lastVisibleDate().clone(),o=r.clone().add(56,"days"),n.start_date=encodeURIComponent(r.format("YYYY-MM-DD")),n.end_date=encodeURIComponent(o.format("YYYY-MM-DD")),l=RG.Utils.firstVisibleDate(),a=o),i=Q.Promise(function(t){return $.ajax("/v1/"+RG.Utils.BookingDataParser.host+"/bookings",{data:n,timeout:3e4,success:function(e,i,o){var r,s;s=new Date(n.start_date),r=new Date(n.end_date),s<RG.Variables.dataDateRange.startDate&&(RG.Variables.dataDateRange.startDate=s),r>RG.Variables.dataDateRange.endDate&&(RG.Variables.dataDateRange.endDate=r),RG.Utils.BookingDataParser.processRawBookingData(e),t()}})}),s=Q.Promise(function(t){var e;return e=new RG.Utils.DateRange(l,a),RG.Utils.BookingDataParser.downtimesPoll(function(){return!1},e).then(function(){return t()})}),Q.all([i,s]).then(Q.delay(500)).then(function(){return t()})},i.prototype.selectMonth=function(t){var e,i,n,o,r,s;return o=this.$(t.target),o.closest(".months-dropdown").length>0?(n=o.closest(".months-dropdown"),s=n.find(".year-scroller .current"),r=parseInt(s.text()),i=parseInt(o.closest("li").data("month"))):(r=parseInt(this.$("span#active-year").text(),10),i=parseInt(o.closest("li").data("month"),10)),e=new Date(r,i-1,1),window.dateController.scrollToDate(e)},i.prototype.selectYear=function(t){var e;return this.$("#jump-to-year-options li").removeClass("active"),$(t.currentTarget).addClass("active"),this.$("span#active-year").text($(t.currentTarget).text()),e=RG.Utils.firstVisibleDate()._d,e=new Date(parseInt($(t.currentTarget).text(),10),e.getMonth(),e.getDate()-1),window.dateController.scrollToDate(e)},i.prototype.scrollYear=function(t){var e,i,n;return t.preventDefault(),t.stopPropagation(),i=this.$(t.target),e=this.$(".year-scroller .current"),n=parseInt(e.text()),i.hasClass("next")?n++:i.hasClass("previous")&&n--,e.text(n)},i.prototype.getYearRange=function(){var t,e;return function(){e=[];for(var i=t=this.startYearPeriod,n=this.endYearPeriod();t<=n?i<=n:i>=n;t<=n?i++:i--)e.push(i);return e}.apply(this).map(function(t){return t})},i.prototype.render=function(){var t;return t=this.getYearRange(),this.$el.html(this.template({years:t,activeYear:this.initialDate.getFullYear()})),this.$(".large-controls .next-timeperiods").click(function(t){return function(e){return t.scrollRight(e)}}(this)),this.$(".large-controls .previous-timeperiods").click(function(t){return function(e){return t.scrollLeft(e)}}(this)),this},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Calendar.FilterPanel=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("calendar/filter_panel"),i.prototype.id="filter-bar",i.prototype.className="dropdown-menu",i.prototype.events={"click .filter__save":"_collapsePopups",click:"_cancelBubble"},i.prototype.activateFilter=function(t){return this.savedFilterView.activateFilter(t)},i.prototype.clearSelection=function(){return this.filterCategoriesView.clearSelection()},i.prototype.getFilters=function(){return this.filterCategoriesView.getFilters()},i.prototype.getSelectedOptions=function(){return this.filterCategoriesView.getSelectedOptions()},i.prototype.initialize=function(t){return this.filterCategories=t.filterCategories,this.savedFilters=t.savedFilters},i.prototype.cleanup=function(){var t,e;return null!=(t=this.savedFilterView)&&t.remove(),null!=(e=this.filterCategoriesView)?e.remove():void 0},i.prototype.render=function(){return this.cleanup(),this.$el.html(this.template()),this._fillValues(),this},i.prototype.resetFlyouts=function(){return this.filterCategoriesView.resetFlyouts()},i.prototype.setFilters=function(t){return this.filterCategoriesView.off("change:filter"),this.filterCategoriesView.setFilters(t),this._setFilterCategoriesEvent(),this.triggerFilterChange()},i.prototype.triggerFilterChange=function(){return this.savedFilterView.watchFilterChanges(this.getSelectedOptions()),this.trigger("change:filter",this.getSelectedOptions())},i.prototype._cancelBubble=function(t){return t.cancelBubble=!0,t.stopPropagation()},i.prototype._collapsePopups=function(){return this.filterCategoriesView.resetFlyouts()},i.prototype._fillValues=function(){var t;return this.filterCategoriesView=new RG.Views.Filters.Categories({collection:this.filterCategories}),this._setFilterCategoriesEvent(),this._getFilterCategoriesContainer().replaceWith(this.filterCategoriesView.render().el),t=function(t){return function(){return t.getFilters()}}(this),this.savedFilterView=new RG.Views.Filters.SavedFilterPanel({savedFilters:this.savedFilters,valueSource:t}),this.savedFilterView.on("activate:filter",function(t){return function(e){return t.setFilters(e.getFilter()),localStorage.lastActiveFilterId=e.id}}(this)),this._getSaveFiltersContainer().replaceWith(this.savedFilterView.render().el),this.savedFilterView.watchFilterChanges(this.getSelectedOptions())},i.prototype._getFilterCategoriesContainer=function(){return this.$(".filter-categories")},i.prototype._getSaveFiltersContainer=function(){return this.$(".filter__save")},i.prototype._setFilterCategoriesEvent=function(){return this.filterCategoriesView.on("change:filter",function(t){return function(){return t.triggerFilterChange(),delete localStorage.lastActiveFilterId}}(this))},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Calendar.Header=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="header",i.prototype.template=templates.find("calendar/header"),i.prototype.className="cal-unit-grouping-header",i.prototype.assignRegions=function(){return this.timePeriods=this.$("#time-periods")},i.prototype.render=function(){return this.$el.html(this.template()),this.assignRegions(),this},i.prototype.setTimePeriods=function(t){return this.timePeriods.replaceWith(t)},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Calendar.Layout=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.id="calendar",i.prototype.template=templates.find("calendar/layout"),i.prototype.initialize=function(t){$(document).on("click",function(t){return function(e){t._closeFilterPanelAndPopovers(e)}}(this)),this.dateController=t.dateController,this.initialDate=t.initialDate||new Date,this.periodGroupings=t.periodGroupings,this.resources=t.resources,this.savedFilters=t.savedFilters,this.filterSource=t.filterSource,this.colorSource=t.colorSource,this.currentUserId=t.currentUserId,this.clients=t.clients||new RG.Collections.Clients,this.deletedClients=t.deletedClients||new RG.Collections.Clients,this.projects=t.projects||new RG.Collections.Projects,this.deletedProjects=t.deletedProjects||new RG.Collections.Projects,this.bookers=t.bookers||new RG.Collections.Bookers,this.deletedBookers=t.deletedBookers||new RG.Collections.Bookers,this.downtimeTypes=t.downtimeTypes||new RG.Collections.DowntimeTypes,this.timeZones=t.timeZones,this.currentUserTimeZone=t.currentUserTimeZone,this.currentDate=t.currentDate,this.listenTo(this.periodGroupings,"add",this._resize),this.listenTo(this.periodGroupings,"remove",this._resize),this.listenTo(this.periodGroupings.getUnitCollection(),"change",this._resize)},i.prototype.getInitialLoadLimit=function(){var t,e;e=40,t=$("html").attr("class");try{t.indexOf("ff")===-1&&t.indexOf("ie")===-1&&t.indexOf("safari")===-1||(0===t.indexOf("ie")&&(RG.Variables.slowBrowser=!0),e=30)}catch(t){e=30}return e},i.prototype.render=function(){var t,e,i;return this.$el.html(this.template()),t=null,t=new RG.Utils.ResourcePaginator(this.resources,this.getInitialLoadLimit()),window.resourcePaginator=t,this.pagedResources=t.getPaginatedCollection(),this.resourceFilter=new RG.Utils.ResourceFilter(this.filterSource.resourceTypes),this._cardsView=new RG.Views.Resource.Cards({collection:this.pagedResources}),this._controlsView=this._createControlsView(),this._headerView=(new RG.Views.Calendar.Header).render(),e=new RG.Views.Calendar.UnitGroupings({collection:this.periodGroupings,currentDate:this.currentDate}),this._headerView.setTimePeriods(e.render().el),i=new RG.Views.Resource.Lines({dateController:this.dateController,collection:this.pagedResources,timeUnits:this.periodGroupings.getUnitCollection(),currentDate:this.currentDate,colorSource:this.colorSource,bookingFormDialogFactory:this._createBookingFormDialogFactory(),downtimeFormDialogFactory:this._createDowntimeFormDialogFactory()}),this._controlsView.availabilityToggle=i.availabilityToggle,this.$("header").replaceWith(this._controlsView.render().el),this.$("aside").replaceWith(this._cardsView.render().el),this.$("section").append(this._headerView.el),this.$("section").append(i.render().el),this.resources.setVisibleResources(this.resourceFilter.filterBy(this.resources,[])),this._moveLargeControls(),this._attachEvents(),this._attachRightClickDrag(),this._resize(),this},i.prototype._adjustHeaderAndCards=function(){this.scrolling||(this.scrolling=!0,window.requestAnimationFrame(function(t){return function(){t._cardsView.$el.css({top:-window.pageYOffset+t._headerView.$el.position().top}),t._headerView.$el.scrollLeft(window.pageXOffset),t.scrolling=!1}}(this)))},i.prototype._attachEvents=function(){$(window).scroll(function(t){return function(){return t._adjustHeaderAndCards()}}(this))},i.prototype._attachRightClickDrag=function(){var t;t=new RG.Interactions.RightClickDragToScroll(window),t.attach()},i.prototype._closeFilterPanelAndPopovers=function(t){var e;e=$(t.target),e.closest("#"+RG.Views.Resource.Lines.prototype.id).length||RG.Popovers.replace()},i.prototype._createControlsView=function(){var t,e,i,n;return window.categories=this.filterSource.getCategories(),this.filterBar=new RG.Views.Calendar.FilterPanel({filterCategories:window.categories,savedFilters:this.savedFilters}),this.filterBar.on("change:filter",function(t){return function(e,i){null==i&&(i=!0),localStorage.lastFiltersAst=JSON.stringify(t.filterBar.getFilters()),i&&t.resources.setVisibleResources(t.resourceFilter.filterBy(t.resources,e)),RG.resizeCards()}}(this)),window.resources.on("change:booked",function(t){return function(){return RG.backburner.deferOnce("render",t,t._triggerFilterChange)}}(this)),e=new RG.Views.Calendar.DateControl({initialDate:this.initialDate}),t=new RG.Views.Calendar.ColorControl({colorSource:this.colorSource}),i=new RG.Views.Factories.NameSearch(this.resources).create({cssClass:"quick-search-group"}),n=new RG.Views.Calendar.Controls({dateControl:e,colorControl:t,filterBar:this.filterBar,searchGroup:i})},i.prototype._triggerFilterChange=function(){return RG.renderer.enqueue(new RG.Renderer.GlobalLock,function(t){return function(){return t.filterBar.trigger("change:filter",t.filterBar.getSelectedOptions(),!1)}}(this))},i.prototype._createBookingFormDialogFactory=function(){return new RG.Views.Dialogs.BookingFormFactory({clients:this.clients,deletedClients:this.deletedClients,projects:this.projects,deletedProjects:this.deletedProjects,resources:this.resources,bookers:this.bookers,deletedBookers:this.deletedBookers,downtimeTypes:this.downtimeTypes,currentUserId:this.currentUserId,timeZones:this.timeZones,currentUserTimeZone:this.currentUserTimeZone})},i.prototype._createDowntimeFormDialogFactory=function(){return new RG.Views.Dialogs.DowntimeFormFactory({resources:this.resources,bookers:this.bookers,deletedBookers:this.deletedBookers,downtimeTypes:this.downtimeTypes,currentUserId:this.currentUserId,timeZones:this.timeZones,currentUserTimeZone:this.currentUserTimeZone})},i.prototype._moveLargeControls=function(){var t;t=this.$(".large-controls").detach(),this.$el.prepend(t)},i.prototype._resize=function(){this.$("#time-periods, #resources").css({width:this.periodGroupings.getUnitCollection().models.length*RG.getUnitWidth()})},i.prototype.setInitialFilters=function(){var t,e;try{localStorage.lastActiveFilterId?(e=this.savedFilters.findWhere({id:parseInt(localStorage.lastActiveFilterId,10)}),this.filterBar.activateFilter(e)):localStorage.lastFiltersAst&&this.filterBar.setFilters(JSON.parse(localStorage.lastFiltersAst))}catch(e){return t=e,delete localStorage.lastFilters,delete localStorage.lastFilterString,delete localStorage.lastActiveFilterId,delete localStorage.lastFiltersAst,delete localStorage.filterBarWasCollapsed}},i.prototype.setInitialResource=function(){Q.delay(100).then(function(t){return function(){var e,i;if(localStorage.lastResourceId){if(e=window.resources.findWhere({id:parseInt(localStorage.lastResourceId,10)}),i=$(".resource[data-resource-id="+e.cid+"]"),!i.length)return void t.setInitialResource();Q.delay(100).then(function(){delete localStorage.lastResourceId,RG.setCurrentResource(e)})}}}(this))},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Filters.SaveFilterForm=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("filters/save_filter_form"),i.prototype.className="filter__save-form",i.prototype.events={"click .btn.save":"saveFilter","keyup input":"_validate","keydown input":"_submitSaveOnEnter"},i.prototype.initialize=function(t){return this.valueSource=t.valueSource},i.prototype.focusInput=function(){return this.$("input[name=name]").focus()},i.prototype.render=function(){return this.$el.html(this.template()),this._validate(),this},i.prototype.resetForm=function(){return this._enableForm(),this.$("input").val("").focus()},i.prototype.saveFilter=function(){var t,e,i,n;if(!this.$(".btn.save").hasClass("disabled")){if(t=window.savedFilters.find(function(t){return function(e){var i;return(null!=(i=e.get("name"))?i.toLowerCase():void 0)===t._getName().toLowerCase()}}(this)),e=t||new RG.Models.SavedFilter,n=null,t){if(i=confirm("That name already exists. Do you want to replace the existing filter?"),!i)return;e.set({name:this._getName(),filter_json:JSON.stringify(this._getCurrentFilters())}),n=e.save()}else e.set({name:this._getName(),filter_json:JSON.stringify(this._getCurrentFilters())}),n=e.save();return n.success(function(t){return function(i,n,o){return t.resetForm(),t.trigger("save:filter",e)}}(this)),this._disableForm()}},i.prototype._disableForm=function(){return this.$(".btn.save").addClass("disabled")},i.prototype._enableForm=function(){return this.$(".btn").removeClass("disabled")},i.prototype._getName=function(){return this.$("input[name=name]").val()},i.prototype._getCurrentFilters=function(){return this.valueSource()},i.prototype._submitSaveOnEnter=function(t){if(13===t.keyCode)return this.saveFilter()},i.prototype._validate=function(){return 0===this._getName().length?this._disableForm():this._enableForm()},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Filters.SavedFilterPanel=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("filters/saved_filter_panel"),i.prototype.className="filter__save",i.prototype.events={"click .filter__save-link":"toggleSaveForm","click .btn.cancel":"_cancelSaveForm"},i.prototype.initialize=function(t){return this.savedFilters=t.savedFilters,this.valueSource=t.valueSource,this.listenTo(this.savedFilters,"add remove",this._setSavedFilterVisibility)},i.prototype.activateFilter=function(t){return this.savedFilterListView.activateFilter(t)},i.prototype.isSaveFormOpen=function(){return"block"===this._getSaveFilterFormContainer().css("display")},i.prototype.render=function(){return this.$el.html(this.template()),this.saveFilterFormView=new RG.Views.Filters.SaveFilterForm({valueSource:this.valueSource}),this.saveFilterFormView.on("save:filter",function(t){return function(e){return t.savedFilters.add(e),t.savedFilterListView.activateFilter(e),t.toggleSaveForm()}}(this)),this._getSaveFilterFormContainer().replaceWith(this.saveFilterFormView.render().el),this.savedFilterListView=new RG.Views.Filters.SavedFilters({collection:this.savedFilters}),this.savedFilterListView.on("activate:filter",function(t){return function(e){return t.trigger("activate:filter",e)}}(this)),this._getSaveFilterListContainer().replaceWith(this.savedFilterListView.render().el),this._setSavedFilterVisibility(),this.$(".filter__info-tooltip").tooltip(),this.$(".filter__save-link").tooltip(),this},i.prototype.toggleSaveForm=function(){if(!this.$(".filter__save-link").hasClass("is-disabled"))return this._getSaveFilterFormContainer().slideToggle("fast"),this.saveFilterFormView.focusInput()},i.prototype.watchFilterChanges=function(t){var e;return this.savedFilterListView.removeActiveState(),e=this.$(".filter__save-link"),0!==t.length?e.removeClass("is-disabled").tooltip("destroy"):(e.addClass("is-disabled").tooltip(),this.isSaveFormOpen()?this.toggleSaveForm():void 0)},i.prototype._cancelSaveForm=function(){return this._getSaveFilterFormContainer().slideToggle(!1),this.saveFilterFormView.resetForm()},i.prototype._getSaveFilterFormContainer=function(){return this.$(".filter__save-form")},i.prototype._getSaveFilterListContainer=function(){return this.$(".filter__saved-filter-list")},i.prototype._setSavedFilterVisibility=function(){var t;return t=this.savedFilters.length>0,this.$(".filter__saved-filter-list").toggle(t),this.$("h3").toggle(t)},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Calendar.Unit=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="cal-unit",i.prototype.template=templates.find("calendar/unit"),i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this},i.prototype._fillValues=function(){this.$("span.name").text(this.model.getName()),this.$("span.date").text(this.model.getFormattedDate()),this.$el.attr("data-date",RG.Utils.DateFormatter.getISODate(this.model.date)),this._setCurrent()},i.prototype._setCurrent=function(){this.$el.toggleClass("current",this.model.isCurrent())},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Calendar.UnitGrouping=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("calendar/unit_grouping"),i.prototype.className="unit-group",i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this},i.prototype._fillValues=function(){var t,e;t=this.model.getUnits(),e=new RG.Views.Calendar.Units({collection:t}),this.$(".units").replaceWith(e.render().el),this.$(".date-period").text(this.model.toString()),this._fillWeek(t)},i.prototype._fillWeek=function(t){var e;return e=t.first(),this.$(".week-period").text("W "+e.getWeek())},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Calendar.UnitGroupings=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.id="time-periods",i.prototype.itemView=RG.Views.Calendar.UnitGrouping,i.prototype.initialize=function(t){return i.__super__.initialize.apply(this,arguments),this.currentDate=t.currentDate,this.listenTo(this.currentDate,"change",function(t){return function(){return t.render()}}(this))},i.prototype.addItem=function(t){var e,i;return i=this.createItemView({model:t}),this.collectionViews[t.cid]=i,e=this.collectionTarget?this.$(this.collectionTarget):this.$el,this.collection.models[0]===t?e.prepend(i.render().el):e.append(i.render().el)},i}(RG.Support.CollectionView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Calendar.Units=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="units",i.prototype.itemView=RG.Views.Calendar.Unit,i}(RG.Support.CollectionView)}.call(this),function(){var t=[].slice;RG.Views.Calendar.UtilisationBarFactory={create:function(){var e,i,n,o,r,s,a,l;for(l=arguments[0],e=arguments[1],r=3<=arguments.length?t.call(arguments,2):[],a=document.createElement("div"),a.style.width=100*l+"%",a.className=e||"unit",i=0,n=r.length;i<n;i++)o=r[i],s=document.createElement(o.element||"span"),s.style.width=100*o.width+"%",s.style.backgroundColor=o.color||"#333",o.title&&s.setAttribute("title",o.title),s.className=o.className,a.appendChild(s);return a}}}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.TimeBlock=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="span",i.prototype.className="availability-info__timeblock js-timeblock",i.prototype.render=function(){return this.$el.html(this.model.toString()),this},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.TimeBlocks=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.itemView=RG.Views.CustomAvailability.TimeBlock,i.prototype.className="js-time-blocks availability-info__time",i.prototype.initialize=function(t){return i.__super__.initialize.apply(this,arguments),this.variesFromDefault=t.varies},i.prototype.render=function(){return i.__super__.render.apply(this,arguments),this._renderIcon(),this},i.prototype.addItem=function(t){var e,n,o,r,s,a,l;if(t.get("startTime")!==t.get("endTime"))for(i.__super__.addItem.apply(this,arguments),this.$(".text--small").remove(),o=this.$el.find(".js-timeblock"),a=o.slice(1,+(o.length-1)+1||9e9),r=0,s=a.length;r<s;r++)n=a[r],l=$(document.createElement("span")),l.addClass("text--small availability-info__time-break").text("Break"),e=l[0],this.el.insertBefore(e,n)},i.prototype._removeViewByModelCid=function(){var t,e,n,o,r,s,a;for(i.__super__._removeViewByModelCid.apply(this,arguments),this.$(".text--small").remove(),n=this.$el.find(".js-timeblock"),s=n.slice(1,+(n.length-1)+1||9e9),o=0,r=s.length;o<r;o++)e=s[o],a=$(document.createElement("span")),a.addClass("text--small").text("Break"),t=a[0],this.el.insertBefore(t,e)},i.prototype._renderIcon=function(){var t;if(this.variesFromDefault)return t=$(document.createElement("span")),t.attr({"data-toggle":"tooltip","data-html":"true","data-placement":"left","data-original-title":"The availability here differs from the <b>Normal Availability</b> assigned to this resource. You can reset it back to <b>Normal Availability</b> if you choose."}),t.addClass("filter__info-tooltip").tooltip(),this.$el.append(t)},i}(RG.Support.CollectionView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.AddTimeBlock=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("availability/add_timeblock"),i.prototype.initialize=function(t){return this.newTimeBlockStartTime=t.newTimeBlockStartTime||540,this.newTimeBlockEndTime=_.min([this.newTimeBlockStartTime+60,1440])},i.prototype.render=function(){return this.$el.html(this.template()),this.$(".js-add-button").on("click",function(t){return function(e){return t.addTimeBlock(e)}}(this)),this.$(".js-cancel-button").on("click",function(t){return function(e){return t.triggerClose(e)}}(this)),this.timeRangeSelector=new RG.Views.Selectors.TimeRange({startTime:this.newTimeBlockStartTime,
endTime:this.newTimeBlockEndTime,storageTypeName:"AddTimeBlock",togglable:!1}),this.$el.on("click","input.js-time-range-input",function(t){return t.stopPropagation()}),this.timeRangeSelector.on("validate",function(t){return function(e){return e?t.$(".js-add-button").attr("disabled",null):t.$(".js-add-button").attr("disabled","disabled")}}(this)),this.$(".js-time-range").append(this.timeRangeSelector.render().el),this.timeRangeSelector.triggerValidate(),this},i.prototype._getAvailablePeriod=function(){return new RG.Models.CustomAvailablePeriod({startTime:this.timeRangeSelector.getStartTime(),endTime:this.timeRangeSelector.getEndTime()})},i.prototype._originalPeriod=function(){return new RG.Models.CustomAvailablePeriod({startTime:this.newTimeBlockStartTime,endTime:this.newTimeBlockEndTime})},i.prototype.addTimeBlock=function(t){return this.trigger("remove",this._originalPeriod()),this.trigger("add",this._getAvailablePeriod()),this.triggerClose()},i.prototype.closeSelector=function(){return this.timeRangeSelector.closeSelector()},i.prototype.remove=function(){var t;return this.$(".js-add-button").off(),this.$(".js-cancel-button").off(),null!=(t=this.timeRangeSelector)&&t.remove(),i.__super__.remove.apply(this,arguments)},i.prototype.triggerClose=function(t){return this.trigger("close")},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty,i=[].slice;RG.Views.CustomAvailability.AvailabilityBreakdown=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(t){return this.bookedMinutes=t.bookedMinutes,this.availableMinutes=t.availableMinutes,this.overtimeMinutes=t.overtimeMinutes},n.prototype.render=function(){return this.availableMinutes>0&&(this.$el.append(this._renderAvailabilityBar()),this.$el.append(this._renderAvailabilityHours())),this},n.prototype._renderAvailabilityBar=function(){var t,e,n,o,r,s;return t=this.overtimeMinutes>0&&this.availableMinutes-this.bookedMinutes<this.overtimeMinutes?Math.abs(this.availableMinutes-this.bookedMinutes-this.overtimeMinutes):0,s=this.bookedMinutes-t,o=RG.Utils.TimeFormatter.formatMinutes(s)+" booked",e=[{width:s/this.availableMinutes,color:"#9F9F9F",className:"progress-bar__bar",title:o}],this.overtimeMinutes?this.availableMinutes-this.overtimeMinutes<this.bookedMinutes?(o=RG.Utils.TimeFormatter.formatMinutes(t)+" overtime booked",e.push({width:t/this.availableMinutes,color:"#B47972",className:"progress-bar__bar",title:o}),this.bookedMinutes<this.availableMinutes&&(o=RG.Utils.TimeFormatter.formatMinutes(this.availableMinutes-this.bookedMinutes)+" overtime unused",e.push({width:(this.availableMinutes-this.bookedMinutes)/this.availableMinutes,color:"#F7BCB5",className:"progress-bar__bar",title:o}))):(r=this.availableMinutes-this.overtimeMinutes-this.bookedMinutes,o=RG.Utils.TimeFormatter.formatMinutes(r)+" free",e.push({width:r/this.availableMinutes,color:"#FFF",className:"progress-bar__bar",title:o}),this.bookedMinutes<this.availableMinutes&&(o=RG.Utils.TimeFormatter.formatMinutes(this.overtimeMinutes)+" overtime unused",e.push({width:this.overtimeMinutes/this.availableMinutes,color:"#F7BCB5",className:"progress-bar__bar",title:o}))):(r=this._getFreeMinutes(),o=RG.Utils.TimeFormatter.formatMinutes(r)+" free",e.push({width:r/this.availableMinutes,color:"#FFF",className:"progress-bar__bar",title:o})),(n=RG.Views.Calendar.UtilisationBarFactory).create.apply(n,[1,"progress-bar"].concat(i.call(e)))},n.prototype._renderAvailabilityHours=function(){var t;return t=$("<div></div>").addClass("availability-info__hours"),t.append($("<span></span>").addClass("pull--left").text(RG.Utils.TimeFormatter.formatMinutes(this.bookedMinutes)+" booked")),t.append($("<span></span>").addClass("pull--right").text(RG.Utils.TimeFormatter.formatMinutes(this._getFreeMinutes())+" free")),t},n.prototype._getFreeMinutes=function(){return Math.max(this.availableMinutes-this.bookedMinutes,0)},n}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.DateRange=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("availability/date_range"),i.prototype.className="js-date-range-component",i.prototype.initialize=function(t){return this.weekDay=t.weekDay,i.__super__.initialize.apply(this,arguments)},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this},i.prototype._fillValues=function(){return this.$(".js-day-name").text(new RG.Utils.DayName(this.weekDay).toString()),this._setDateText()},i.prototype._setDateText=function(){var t;return this._hasMultipleDays()?(this.$(".js-date-range").text(this.model),this._setMultipleDays()):(t=_.find(this.model.getDates(),function(t){return function(e){return e.getDay()===t.weekDay}}(this)),this.$(".js-date-range").text(new RG.Utils.DateRange(t,t).toString()),this._setSingleDay())},i.prototype._hasMultipleDays=function(){return _.select(this.model.getDates(),function(t){return function(e){return e.getDay()===t.weekDay}}(this)).length>1},i.prototype._setMultipleDays=function(){return this.$(".js-multiple-days-every").text("Every "),this.$(".js-multiple-days-from").text("from ")},i.prototype._setSingleDay=function(){return this.$(".js-multiple-days-every").text(""),this.$(".js-multiple-days-from").text("")},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.Day=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("availability/day"),i.prototype.tagName="li",i.prototype.className="custom-availability-day",i.prototype.initialize=function(t){return this.dateRange=t.dateRange,this.date=this.collection.day.date,this.collection.dayOverlap?this.hours="varies":this.hours=this.collection.getMinutesAvailableForDate(this.date)/60},i.prototype.render=function(){var t;return this.$el.html(this.template({day:this.collection.day,hours:this.hours,cid:this.cid,overtime:5})),t=new RG.Views.CustomAvailability.TimeBlocks({collection:this.collection}),this.$el.find(".js-day-details").replaceWith(t.el),this.removeBody(),this},i.prototype.renderBody=function(){var t,e,i,n,o;for(this.$el.addClass("active"),o=this.collection.models,e=0,i=o.length;e<i;e++)n=o[e],this.addItem(n);if(t=this.$el.find(".js-custom-availability-day-body"),this.$el.find(".js-availability-overview").show(),this.$el.find(".js-custom-availability-helper-text").show(),this.collection.dayOverlap)return this.$el.find(".js-availability-varies-text").show()},i.prototype.removeBody=function(){return this.$el.removeClass("active"),this.$el.find(".js-day-details").html(""),this.$el.find(".js-availability-overview").hide(),this.$el.find(".js-custom-availability-helper-text").hide(),this.$el.find(".js-availability-varies-text").hide()},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.DayDetail=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("availability/day_detail"),i.prototype.className="availability-info",i.prototype.initialize=function(t){return this.timeOffText=t.timeOffText,this.listenTo(this.model.getFirstAvailablePeriods(),"remove reset",this.render)},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this},i.prototype.remove=function(){var t,e,n,o;return this.model.getFirstAvailablePeriods().off("remove reset",this.render),null!=(t=this.breakdown)&&t.remove(),null!=(e=this.dateRangeView)&&e.remove(),null!=(n=this.timeBlocks)&&n.remove(),null!=(o=this.totalAvailabilityView)&&o.remove(),i.__super__.remove.apply(this,arguments)},i.prototype._fillValues=function(){return this._renderDateRange(),this._renderTimeBlocks(),this._renderAvailabilityText(),this._renderBreakdownBar()},i.prototype._renderDateRange=function(){var t,e;if(t=this.model.getDateRange(),t.getNumberOfDays()>1)return e=new RG.Utils.DayName(this.model.get("weekDay")),this.dateRangeView=new RG.Views.CustomAvailability.DateRange({weekDay:this.model.get("weekDay"),model:t}),this.$(".js-date-range-component").replaceWith(this.dateRangeView.render().el)},i.prototype._renderTimeBlocks=function(){var t;return this.model.availabilityConsistent()?(t=this.model.getFirstAvailablePeriods(),this.timeBlocks=new RG.Views.CustomAvailability.TimeBlocks({collection:t,varies:this.model.variesFromNormalAvailability()}),this.$(".js-time-blocks").replaceWith(this.timeBlocks.render().el)):this.$(".js-time-blocks").remove()},i.prototype._renderAvailabilityText=function(){if(this.model.availabilityAndDowntimeConsistent())return this.totalAvailabilityView=new RG.Views.CustomAvailability.TotalAvailabilityText({availabilityConsistent:this.model.totalAvailabilityAndDowntimeConsistent(),availableMinutes:this.model.getCurrentMinutesAvailable(),overtimeMinutes:this._getOvertimeMinutes(),downtimes:this.model.getFirstDowntimes(),timeOffText:this.timeOffText}),this.$(".js-availability-text").replaceWith(this.totalAvailabilityView.render().el)},i.prototype._renderBreakdownBar=function(){return this.model.totalAvailabilityAndBookingsConsistent()?(this.breakdown=new RG.Views.CustomAvailability.AvailabilityBreakdown({availableMinutes:this.model.getTotalMinutesAvailable(),bookedMinutes:_.reduce(this._getFirstDurations(),function(t,e){return t+e.getMinutes()},0),overtimeMinutes:this._getOvertimeMinutes()}),this.$el.append(this.breakdown.render().el)):this.$el.append($(document.createElement("em")).text("Availability and booked/free time vary over this time period.").addClass("availability-info__info"))},i.prototype._getFirstDurations=function(){var t,e,i;e=this.model.get("durations");for(t in e)return i=e[t],_.filter(i,function(t){return t.isConfirmed()})},i.prototype._getOvertimeMinutes=function(){return this.model.overtimesConsistent()?this.model.overtime():null},i.prototype._getDowntimeMinutes=function(){return this.model.downtime()},i.prototype._setVarianceText=function(t){return this.$(".js-variance-text").text(t)},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.DayDetailForm=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="js-day-detail availability-info",i.prototype.events={"click .js-text--edit-overtime":"popupOvertime"},i.prototype.initialize=function(){return this.model.on("availabilityReset",this._rebindAps,this),i.__super__.initialize.apply(this,arguments)},i.prototype._bindAps=function(){return this.model.getFirstAvailablePeriods().on("remove reset",this.render,this)},i.prototype._rebindAps=function(){return this.model.getFirstAvailablePeriods().off("remove reset",this.render),this._bindAps()},i.prototype.remove=function(){var t;return this.model.off("availabilityReset",this._rebindAps,this),this.closePopovers(),null!=(t=this.timeBlock)&&t.remove(),this._removeOvertimePopover(),i.__super__.remove.apply(this,arguments)},i.prototype._renderBreakdownBar=function(){},i.prototype._renderTimeBlocks=function(){var t,e;return this.model.availabilityConsistent()?(t=this.model.getFirstAvailablePeriods(),this.timeBlocks=new RG.Views.CustomAvailability.RemovableTimeBlocks({collection:t}),this.timeBlocks.on("updatePosition",function(t){return function(){return t.trigger("updatePosition")}}(this)),this.$(".js-time-blocks").replaceWith(this.timeBlocks.render().el)):(this.timeBlock=new RG.Views.CustomAvailability.RemovableTimeBlock({model:new RG.Models.VaryingAvailablePeriod}),this.timeBlock.on("remove",this.clearVaryingAvailability,this),e=new RG.Utils.DayName(this.model.get("weekDay")),this.$(".js-time-blocks").append($(document.createElement("p")).text("Availability varies within this date range. To change that, you can specify times below to apply to every "+e.fullName()+" within the date range. If you make no changes, it will remain varied on "+e.fullName()+"s.")),this.$(".js-time-blocks").append(this.timeBlock.render().el)),this._bindEvents()},i.prototype._bindEvents=function(){return this.on("openDropdown",function(t){return function(){var e;return null!=(e=t.timeBlocks)?e.trigger("openDropdown"):void 0}}(this))},i.prototype._renderAvailabilityText=function(){var t,e,i;return null!=(i=this.totalAvailabilityView)&&i.remove(),e=this._getOvertimeMinutes(),t=this.model.getCurrentMinutesAvailable(),e>t&&(e=0),this.totalAvailabilityView=new RG.Views.CustomAvailability.TotalAvailabilityText({availabilityConsistent:this.model.totalAvailabilityConsistent(),availableMinutes:t,overtimeConsistent:this.model.overtimesConsistent(),overtimeMinutes:e,downtimes:this.model.getFirstDowntimes(),timeOffText:this.timeOffText,alwaysShowOvertime:!0,className:"availability-info__edit",overtimeClassName:"text--edit-overtime js-text--edit-overtime"}),this.$el.append(this.totalAvailabilityView.render().el)},i.prototype.closePopovers=function(){var t,e,i,n,o,r,s;return null!=(t=this.overTimePopover)&&t.remove(),null!=(e=this.timeBlocks)&&null!=(i=e.addTimeBlockView)&&i.remove(),null!=(n=this.timeBlocks)&&null!=(o=n.editTimeBlockView)&&o.remove(),null!=(r=this.timeBlocks)&&(r.addTimeBlockView=null),null!=(s=this.timeBlocks)?s.editTimeBlockView=null:void 0},i.prototype.popupOvertime=function(t){return t.stopPropagation(),this.trigger("editing:overtime"),$(".dropdown").removeClass("open"),this._removeOvertimePopover(),this.overTimePopover=new RG.Views.Dialogs.EditOvertimePopover({availabilityConsistent:this.model.totalAvailabilityConsistent(),availableMinutes:this.model.getCurrentMinutesAvailable(),overtimeMinutes:this._getOvertimeMinutes(),attachTo:this.$(".js-availability-text-container")}),this.overTimePopover.on("editing:overtime:done",function(t){return function(){return t.trigger("editing:overtime:done")}}(this)),this.overTimePopover.on("change",function(t){return function(e){return+e>0&&0===t.model.getFirstOvertimes().models.length?t.model.getFirstOvertimes().add(new RG.Models.Overtime({resourceInstanceId:t.model.collection.resourceId,duration:e})):t.model.setOvertime(e),t.overTimePopover=null,t._renderAvailabilityText()}}(this)),this.overTimePopover.popup()},i.prototype._removeOvertimePopover=function(){var t,e,i;return null!=(t=this.overTimePopover)&&t.off("change"),null!=(e=this.overTimePopover)&&e.off("editing:overtime:done"),null!=(i=this.overTimePopover)&&i.remove(),this.trigger("overtime:popover:removed")},i.prototype.clearVaryingAvailability=function(){return this.model.clearVaryingAvailability(),this.trigger("availabilityCleared",this.model),this.model.getFirstAvailablePeriods().trigger("reset")},i}(RG.Views.CustomAvailability.DayDetail)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.DayRange=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="availability-tabs",i.prototype.events={"click .js-edit-availability":"triggerEdit"},i.prototype.initialize=function(t){return this.selectedDay=t.selectedDay||this.collection.models[0],this.resource=t.resource},i.prototype.remove=function(){var t,e;return null!=(t=this.dayDetailView)&&t.remove(),null!=(e=this.tabsView)&&e.remove(),i.__super__.remove.apply(this,arguments)},i.prototype.render=function(){return this.$el.empty(),this._renderTabs(),RG.Utils.Permissions.canManageResource(this.resource)&&this.$el.append('<a class="availability-tabs__edit js-edit-availability">Edit</a>'),this._renderDetail(this.selectedDay),this},i.prototype.triggerEdit=function(){return this.trigger("edit")},i.prototype._getTabs=function(){return this.collection},i.prototype._buildDayDetailView=function(t){return this.dayDetailView=new RG.Views.CustomAvailability.DayDetail({model:t,timeOffText:this.resource.getDowntimeText()})},i.prototype._renderDetail=function(t){var e,i;return null!=(e=this.dayDetailView)&&e.remove(),this._buildDayDetailView(t),this.$el.append(this.dayDetailView.render().el),this.selectedDay=t,this.trigger("change",t),null!=(i=this.tabsView)?i.setTab(t):void 0},i.prototype._renderTabs=function(){if(this.collection.length>1)return this.tabsView=new RG.Views.CustomAvailability.DayTabs({collection:this._getTabs()}),this.tabsView.on("change",function(t){return function(e){return t._renderDetail(e)}}(this)),this.$el.append(this.tabsView.render().el)},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.DayRangeForm=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.render=function(){return this.$el.empty(),this._renderTabs(),this._renderDetail(this.selectedDay),this._bindEvents(),this},i.prototype.closePopovers=function(){return this.dayDetailView.closePopovers()},i.prototype._bindEvents=function(){return this.on("openDropdown",function(t){return function(){var e;return null!=(e=t.dayDetailView)?e.trigger("openDropdown"):void 0}}(this))},i.prototype._buildDayDetailView=function(t){return this.dayDetailView=new RG.Views.CustomAvailability.DayDetailForm({model:t,timeOffText:this.resource.getDowntimeText()}),this.dayDetailView.on("availabilityCleared",function(t){return function(e){return t.trigger("change",e)}}(this),this),this.dayDetailView.on("updatePosition",function(t){return function(){return t.trigger("updatePosition")}}(this)),this._bindOvertime(),this.dayDetailView},i.prototype._rebindEditingOvertime=function(){return this.dayDetailView.off("editing:overtime"),this.dayDetailView.off("editing:overtime:done"),this._bindOvertime()},i.prototype._bindOvertime=function(){return this.dayDetailView.on("editing:overtime",function(t){return function(){return t.trigger("editing:overtime")}}(this)),this.dayDetailView.on("editing:overtime:done",function(t){return function(){return t.trigger("editing:overtime:done")}}(this)),this.dayDetailView.on("overtime:popover:removed",this._rebindEditingOvertime,this)},i}(RG.Views.CustomAvailability.DayRange)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.DayTab=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="li",i.prototype.className="availability-tabs__title tab-title",i.prototype.events={click:"triggerChange"},i.prototype.initialize=function(){return this._bindAps(),this.model.on("availabilityReset",this.rebindAps,this)},i.prototype.remove=function(){return this.model.off("availabilityReset",this.rebindAps,this),this.aps.off("add remove reset",this.render,this),i.__super__.remove.apply(this,arguments)},i.prototype.rebindAps=function(){return this.aps.off("add remove reset",this.render,this),this._bindAps()},i.prototype._bindAps=function(){return this.aps=this.model.getFirstAvailablePeriods(),this.aps.on("add remove reset",this.render,this)},i.prototype.render=function(){var t;return t=new RG.Utils.DayName(this.model.get("weekDay")),this.$el.html("<a>"+t+" <span>"+this._getTimeString()+"</span></a>"),this},i.prototype.activate=function(){return this.$el.addClass("active")},i.prototype.deactivate=function(){return this.$el.removeClass("active")},i.prototype.triggerChange=function(){return this.trigger("change",this.model)},i.prototype._getTimeString=function(){var t;return t=this.model.getAvailabilityWithoutDowntime(),this.model.availabilityConsistent()?RG.Utils.TimeFormatter.formatMinutes(t):"Varied"},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.DayTabs=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="ul",i.prototype.className="tabs",i.prototype.itemView=RG.Views.CustomAvailability.DayTab,i.prototype.render=function(){var t,e;return i.__super__.render.apply(this,arguments),t=(null!=(e=this.currentTab)?e.model:void 0)||this.collection.models[0],t&&this.setTab(t),this},i.prototype.remove=function(){var t;return null!=(t=this.currentTab)&&t.remove(),this.currentTab=null,i.__super__.remove.apply(this,arguments)},i.prototype.setTab=function(t){var e,i;return null!=(e=this.currentTab)&&e.deactivate(),this.currentTab=this.collectionViews[t.cid],null!=(i=this.currentTab)?i.activate():void 0},i.prototype._insertView=function(t){return i.__super__._insertView.apply(this,arguments),t.on("change",function(e){return function(i){return e.trigger("change",i),e.setTab(t.model)}}(this))},i.prototype._removeView=function(t){return i.__super__._removeView.apply(this,arguments),t.off("change")},i}(RG.Support.SortedCollectionView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.EditTimeBlock=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("availability/add_timeblock"),i.prototype.initialize=function(t){return this.newTimeBlockStartTime=t.newTimeBlockStartTime,this.newTimeBlockEndTime=t.newTimeBlockEndTime},i.prototype.render=function(){return i.__super__.render.apply(this,arguments),this.$(".js-add-button").text("Update"),this.$(".js-cancel-button").on("click",function(t){return function(e){return e.stopPropagation(),t.triggerClose(e)}}(this)),this.$("h3").text("Edit Time Block"),this},i}(RG.Views.CustomAvailability.AddTimeBlock)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.RemovableTimeBlock=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="span",i.prototype.className="availability-info__timeblock-edit js-timeblock",i.prototype.events={"click .js-close":"removeTimeBlock",click:"editTimeBlock"},i.prototype.remove=function(){return this.off(),this.$el.off(),i.__super__.remove.apply(this,arguments)},i.prototype.render=function(){return this.model.isEditable()?this.$el.append($(document.createElement("a")).text(this.model.toString()).addClass("js-edit time-link")):this.$el.html(this.model.toString()),this.$el.append('<span type="button" class="close js-close" aria-hidden="true"></span>'),this.$el.on("click",function(t){return function(e){return t.editTimeBlock(e)}}(this)),this},i.prototype.editTimeBlock=function(t){return this.trigger("edit",this),t.stopPropagation()},i.prototype.removeTimeBlock=function(t){return this.trigger("remove",this.model),t.stopPropagation()},i}(RG.Views.CustomAvailability.TimeBlock)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.RemovableTimeBlocks=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.itemView=RG.Views.CustomAvailability.RemovableTimeBlock,i.prototype.className="availability-info__time",i.prototype.events={"click .js-add-timeblock":"addTimeBlock"},i.prototype.remove=function(){var t,e;return this.off(),this.$el.off(),null!=(t=this.addTimeBlockView)&&t.remove(),null!=(e=this.editTimeBlockView)&&e.remove(),i.__super__.remove.apply(this,arguments)},i.prototype.render=function(){var t,e;return i.__super__.render.apply(this,arguments),e=this.collection.models[0],e&&e.isAllDay()||(t=$(document.createElement("div")).addClass("availability-info__timeblock-add js-add-timeblock").append("<a class='time-link'>Add time block</a>"),this.$el.append(t)),this._bindEvents(),this._addLastTimeBlockClass(),this},i.prototype._bindEvents=function(){return this.on("openDropdown",function(t){return function(){var e,i;return null!=(e=t.addTimeBlockView)&&e.remove(),null!=(i=t.editTimeBlockView)?i.remove():void 0}}(this))},i.prototype._insertView=function(t,e){return i.__super__._insertView.apply(this,arguments),t.on("remove",function(t){return function(e){return t.collection.remove(e)}}(this)),t.on("edit",function(t){return function(e){return t.editTimeBlock(e)}}(this)),t},i.prototype._removeView=function(t){return this.trigger("updatePosition"),t.off("remove"),i.__super__._removeView.apply(this,arguments)},i.prototype.editTimeBlock=function(t){var e,i,n,o;return $(".dropdown").removeClass("open"),null!=(i=this.addTimeBlockView)&&i.remove(),null!=(n=this.editTimeBlockView)&&n.remove(),e=null!=(o=this.collection.last())?o.attributes.endTime:void 0,this.editTimeBlockView=new RG.Views.Dialogs.EditTimeBlockDropdown({attachTo:t.$el,newTimeBlockStartTime:t.model.get("startTime"),newTimeBlockEndTime:t.model.get("endTime")}),this.editTimeBlockView.popup(),this.editTimeBlockView.on("update",function(t){return function(e){return t._update(e)}}(this)),this.editTimeBlockView.on("remove",function(t){return function(e){return t._remove(e)}}(this))},i.prototype.addTimeBlock=function(t){var e,i,n,o;return $(".dropdown").removeClass("open"),null!=(i=this.addTimeBlockView)&&i.remove(),null!=(n=this.editTimeBlockView)&&n.remove(),e=null!=(o=this.collection.last())?o.attributes.endTime:void 0,this.addTimeBlockView=new RG.Views.Dialogs.AddTimeBlockPopover({attachTo:this.$(".js-add-timeblock"),newTimeBlockStartTime:e}),this.addTimeBlockView.popup(),this.addTimeBlockView.on("add",function(t){return function(e){return t._update(e)}}(this)),t.stopPropagation()},i.prototype._convertToCustomAvailablePeriods=function(){var t;return t=this.collection.map(function(t){return new RG.Models.CustomAvailablePeriod({startTime:t.get("startTime"),endTime:t.get("endTime"),pending:!0})}),this.collection.reset(t,{silent:!0})},i.prototype._mergeOverlaps=function(){var t,e,i;if(this.collection.length)return e=this.collection.map(function(t){return new RG.Utils.TimeRange(t.get("startTime"),t.get("endTime"))}),i=e.shift(),e=i.merge.apply(i,e),t=_.map(e,function(t){return new RG.Models.CustomAvailablePeriod({startTime:t.startTime,endTime:t.endTime})}),this.collection.reset(t)},i.prototype._update=function(t){return this._convertToCustomAvailablePeriods(),this.collection.add(t),this._mergeOverlaps(),this._addLastTimeBlockClass(),this.trigger("updatePosition"),this.addTimeBlockView=null,this.editTimeBlockView=null},i.prototype._addLastTimeBlockClass=function(){return this.$(".js-timeblock:last").addClass("last-timeblock")},i.prototype._remove=function(t){var e;return e=this.collection.findWhere({startTime:t.get("startTime"),endTime:t.get("endTime")}),this.collection.remove(e,{silent:!0})},i}(RG.Views.CustomAvailability.TimeBlocks)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.TimeBlocksMenu=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="js-timeblocks-menu",i.prototype.render=function(){return this},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.CustomAvailability.TotalAvailabilityText=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.alwaysShowOvertime=!1,i.prototype.overtimeClassName="text--warning",i.prototype.initialize=function(t){return this.timeOffText=t.timeOffText,this.availabilityConsistent=t.availabilityConsistent,this.availableMinutes=t.availableMinutes,this.overtimeConsistent=t.overtimeConsistent,this.overtimeMinutes=t.overtimeMinutes,void 0!==t.alwaysShowOvertime&&(this.alwaysShowOvertime=t.alwaysShowOvertime),t.overtimeClassName&&(this.overtimeClassName=t.overtimeClassName),this.downtimes=t.downtimes},i.prototype.render=function(){for(var t;t=this.el.firstChild;)this.el.removeChild(t);return this.availabilityEl=$(document.createElement("p")).addClass("js-availability-text-container"),this.overtimeEl=$(document.createElement("em")).addClass("text--small"),this._renderDeductions(),this._renderAvailabilityBreakdown(),this._renderInconsistentAvailability(),this.availabilityEl.append(this.overtimeEl),this._renderNoLink(),this.$el.append(this.availabilityEl),this},i.prototype._renderDeductions=function(){var t,e,i,n,o,r,s;if(this.downtimes.length>0){for(o=this.downtimes,r=[],i=0,n=o.length;i<n;i++)s=o[i],t=$(document.createElement("p")).addClass("js-availability-deduction"),e=$(document.createElement("span")).addClass("downtime-less").text("Less"),t.text(" "+this.timeOffText+" - "+s.toString()),t.prepend(e),r.push(this.$el.append(t));return r}},i.prototype._renderAvailabilityBreakdown=function(){var t,e;if(this.availabilityConsistent){if(this.availabilityEl.text("Total availability - "),e=$(document.createElement("strong")).text(RG.Utils.TimeFormatter.formatMinutes(this.availableMinutes)),this.availabilityEl.append(e),this.overtimeMinutes>0||this.alwaysShowOvertime&&0===this.overtimeMinutes)return t=$(document.createElement("strong")).addClass(this.overtimeClassName).text(RG.Utils.TimeFormatter.formatMinutes(this.overtimeMinutes)+" overtime"),this.overtimeEl.append(" (including "),this.overtimeEl.append(t),this.overtimeEl.append(")");if(null===this.overtimeMinutes)return this.overtimeEl.append($(document.createElement("span")).addClass(this.overtimeClassName).text(" (overtime varies)"))}},i.prototype._renderInconsistentAvailability=function(){var t;if(!this.availabilityConsistent)return this.availabilityEl.text("Availability varies"),t=$(document.createElement("strong")).addClass(this.overtimeClassName),this._renderOvertime(t),this.overtimeEl.append(" (including "),this.overtimeEl.append(t),this.overtimeEl.append(")")},i.prototype._renderOvertime=function(t){return this.overtimeConsistent?t.text(RG.Utils.TimeFormatter.formatMinutes(this.overtimeMinutes)+" overtime"):t.text("varied overtime")},i.prototype._renderNoLink=function(){var t,e;if(!(this.availableMinutes>0))return t=$(this.availabilityEl).find("."+this.overtimeClassName.split(" ")[0]),e=_.select(this.overtimeClassName.split(" "),function(t){return t.match(/js-/)}).join(" "),t.removeClass(e),t.addClass("no-link")},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t;
}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.Dialog=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("dialogs/dialog"),i.prototype.initialize=function(t){return null==t&&(t={}),this.headerView=t.header,this.bodyView=t.body,this.footerView=t.footer},i.prototype.closeOpenOptions=function(){return this.$(".btn-group.open").toggleClass("open")},i.prototype.render=function(){var t,e,i,n,o,r,s;for(this.$el.html(this.template()),this.$("header").replaceWith(null!=(i=this.headerView)?i.render().el:void 0),this.$("main").replaceWith(null!=(n=this.bodyView)?n.render().el:void 0),this.$("footer").replaceWith(null!=(o=this.footerView)?o.render().el:void 0),r=[this.headerView,this.bodyView,this.footerView],t=0,e=r.length;t<e;t++)s=r[t],null!=s&&s.on("all",function(t){return function(){return t.trigger.apply(t,arguments)}}(this));return this.$el.on("click",function(t){return function(){return t.closeOpenOptions()}}(this)),this},i.prototype.remove=function(){var t,e,n,o;return null!=(t=this.footerView)&&t.remove(),null!=(e=this.headerView)&&e.remove(),null!=(n=this.headerView)&&n.off(),null!=(o=this.bodyView)&&o.off(),i.__super__.remove.apply(this,arguments)},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;RG.Views.Dialogs.NewBooking=function(i){function n(){return this._selectedResourceChanged=t(this._selectedResourceChanged,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.template=templates.find("dialogs/new_booking"),n.prototype.initialize=function(t){if(this.currentUserId=t.currentUserId,this.dateRange=t.dateRange,this.originalDate=this.dateRange.startDate,this.projects=t.projects,this.deletedProjects=t.deletedProjects,this.clients=t.clients,this.deletedClients=t.deletedClients,this.resources=t.resources,this.resource=t.resource,this.bookers=t.bookers,this.selectingDuration=t.selectDuration,"undefined"==typeof this.selectingDuration)return this.setSelectingDuration(!0)},n.prototype.clearInteraction=function(){return this.undelegateEvents()},n.prototype.render=function(){return this._clearOldViews(),this.$el.html(this.template()),this._composeViews(),this._setDurationTypeVisibility(),this.validate(),this.$(".chzn-select").chosen(),this.$("#booking-start-date, #booking-end-date").datepicker({dateFormat:"d M yy",firstDay:1}),this._bindEvents(),this},n.prototype._bindEvents=function(){if(!this._eventsBound)return this._eventsBound=!0,this.$el.on("click",".chzn-single",function(t){return function(e){return t.trigger("shrinkDropdown",e)}}(this)),this.$el.on("click","#add-booking",function(t){return function(){return t.saveBooking()}}(this)),this.$el.on("click","#cancel.btn",function(t){return function(){return t.cancel()}}(this)),this.$el.on("click",".booking-time .alt-toggle a",function(t){return function(){return t.toggleDurationTypes()}}(this)),this.$el.on("click",function(t){return function(e){return t._stopPropagation(e)}}(this))},n.prototype.cancel=function(){return this.trigger("close")},n.prototype.close=function(){return this._clearOldViews()},n.prototype.clearClientOrProject=function(){return this.clientProjectSelector.setSelectedValue(null)},n.prototype.getBookingDurationDTO=function(){var t;return t=this.selectingDuration?this.durationSelector:this.timeRangeSelector,t.getBookingDurationDTO()},n.prototype.saveBooking=function(){var t;if("disabled"!==this.$("#add-booking").attr("disabled"))return t=this.resourceSelector.getSelectedResource(),this._saveBookingToApi(t,this.bookerSelector.getBooker(),this.dateRangeSelector.getDateRange(),this.clientProjectSelector.getSelectedOption(),this.$("#booking-details").val(),this.getBookingDurationDTO()),!1},n.prototype._saveBookingToApi=function(t,e,i,n,o,r){var s,a;return a=RG.Utils.spinnerOverlay($(this.el).closest(".js-booking-downtime-new")[0]),s=new RG.Commands.CreateBookingCommand({resource:t,booker:e,dateRange:i,target:n,details:o,bookingDuration:r,successCallback:function(e){return function(i){return RG.renderer.unlockAll(),RG.backburner.run(function(){return RG.Utils.BookingMerger.merge(t.bookings,[i]),a.close(),e.trigger("close"),t.bookings.predictWaitingList()}),window.update()}}(this)}),s.removedDatesCallback=function(e){return function(i,n){var o,r,s,a;return a=new RG.Views.Dialogs.RemovedAvailabilityDates({resource:t,removedAvailabilityDates:i}),o=new RG.Utils.DatePopoverPlacer(t,e.originalDate,{offsetTop:(null!=(s=$(".booking[data-booking-id="+n+"]").offset())?s.top:void 0)+40}),r=new RG.Views.Dialogs.BookingClashPopover({removeAttachTo:!0,attachTo:o.createAnchor({className:"booking-clash-popover-anchor"}),body:a,className:"edit-booking-dropdown"}),RG.Popovers.replace({popoverView:r,removeCallback:function(){}})}}(this),s.waitingCallback=function(e){return function(i){return e.waitingConfirmation=new RG.Views.Dialogs.WaitingListConfirmation({resource:t,waitingDates:i,duration:s.bookingDuration.duration,startTime:s.bookingDuration.startTime,startDate:s.dateRange.startDate,endDate:s.dateRange.endDate,origin:e,callback:function(){return RG.Utils.BookingDataParser.expirePolls(),s.forceWaiting=!0,s.execute()}}),a.close(),e.waitingConfirmation.on("addWaiting",function(){return e.trigger("close")},e),e.trigger("changeOverlay",e.waitingConfirmation,{className:"overlay booking-waiting"})}}(this),RG.Utils.BookingDataParser.expirePolls(),s.execute(),!1},n.prototype.toggleDurationTypes=function(){return this.selectingDuration=!this.selectingDuration,this._setDurationTypeVisibility(),this.validate()},n.prototype.setSelectingDuration=function(t){return this.selectingDuration=t,this._setDurationTypeVisibility()},n.prototype.validate=function(){var t,e;return t=this.selectingDuration?this.durationSelector:this.timeRangeSelector,e=t.validate()&&this.dateRangeSelector.validate(),e?this.$("#add-booking").attr("disabled",null):this.$("#add-booking").attr("disabled","disabled"),this.trigger("updatePosition"),e},n.prototype._setDurationTypeVisibility=function(){return this.resource.isHuman()||(this.selectingDuration=!1,this.$(".booking-time .alt-toggle").hide()),this.$(".hours-per-day").toggle(this.selectingDuration),this.$(".specific-time").toggle(!this.selectingDuration),this.selectingDuration?this.$(".booking-time-field").text("Hours per day"):this.$(".booking-time-field").text("Time per day")},n.prototype._stopPropagation=function(t){return t.stopPropagation(),!1},n.prototype._composeViews=function(){return this.resourceSelector=new RG.Views.Selectors.Resource({resources:this.resources,selected:this.resource}),this.$("dd.resource-instance-value").html(this.resourceSelector.render().el),this.resourceSelector.on("change",this._selectedResourceChanged),this.dateRangeSelector=new RG.Views.Selectors.DateRange({dateRange:this.dateRange,resource:this.resource}),this.$("dd.booking-date").html(this.dateRangeSelector.render().el),this.dateRangeSelector.on("validate",this.validate,this),this.dateRangeSelector.on("change",function(t){return function(e){return t.dateRange=e,t.trigger("change",e)}}(this)),this.durationSelector=new RG.Views.Selectors.Duration({duration:window.localStorage["Duration:"+this.resource.typeName()],typeName:this.resource.typeName()}),this.$("dd.booking-time").html(this.durationSelector.render().el),this.durationSelector.on("validate",this.validate,this),this.timeRangeSelector=new RG.Views.Selectors.TimeRange({startTime:window.localStorage["TimeRange:StartTime:"+this.resource.typeName()],endTime:window.localStorage["TimeRange:EndTime:"+this.resource.typeName()],typeName:this.resource.typeName()}),this.$("dd.booking-time").append(this.timeRangeSelector.render().el),this.timeRangeSelector.on("validate",this.validate,this),this.resource.shouldDisplayTimeZone()&&this.$("dd.booking-time").append($('<div class="timezone"></div>').text(this.resource.getTimeZone().toString())),this.clientProjectSelector=new RG.Views.Selectors.ClientProject({clients:this.clients,projects:this.projects,selectedValue:this.initialClientOrProject,container:this,responseWithPermissions:window.responseWithPermissions,colorPicker:new RG.Views.Selectors.ColorPicker}),this.clientProjectSelector.on("changeOverlay",function(t){return function(e,i){return t.trigger("changeOverlay",e,i)}}(this)),this.clientProjectSelector.on("cancelled",function(t){return function(){return t.clearClientOrProject()}}(this)),this._sortProjectsAndClientsAlphabetically(),this.$("dd.project-client").html(this.clientProjectSelector.render().el),this.bookerSelector=new RG.Views.Selectors.Booker({currentUserId:this.currentUserId,bookers:this.bookers,booking:this.booking}),this.$("dd.booker").html(this.bookerSelector.render().el)},n.prototype._clearOldViews=function(){var t,e,i,n,o,r,s,a,l,c,u;return null!=(t=this.waitingConfirmation)&&t.remove(),null!=(e=this.resourceSelector)&&e.off(),null!=(n=this.dateRangeSelector)&&n.off(),null!=(o=this.timeRangeSelector)&&o.off(),null!=(r=this.durationSelector)&&r.off(),null!=(s=this.resourceSelector)&&s.remove(),null!=(a=this.dateRangeSelector)&&a.remove(),null!=(l=this.durationSelector)&&l.remove(),null!=(c=this.timeRangeSelector)&&c.remove(),null!=(u=this.clientProjectSelector)&&u.remove(),null!=(i=this.bookerSelector)?i.remove():void 0},n.prototype._sortProjectsAndClientsAlphabetically=function(){return this.clientProjectSelector.clients.sort(),this.clientProjectSelector.projects.sort()},n.prototype._selectedResourceChanged=function(t){var e,i,n;return this.resource=t,t&&!t.isHuman()&&(e=this.booking.durations.models[0],n=e.get("startTime")||540,i=n+e.getMinutes(),this.timeRangeSelector.setStartTime(n),this.timeRangeSelector.setEndTime(i)),this.render()},n}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.AddTimeBlockPopover=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.cssClass="add-timeblock-dropdown",i.prototype.events={"click .js-cancel-button":"close",click:"closeSelector"},i.prototype.initialize=function(t){return this.newTimeBlockStartTime=t.newTimeBlockStartTime,i.__super__.initialize.apply(this,arguments)},i.prototype.close=function(){return this.trigger("close")},i.prototype.remove=function(){return this.attachTo=null,i.__super__.remove.apply(this,arguments)},i.prototype.setBodyView=function(){return i.__super__.setBodyView.apply(this,arguments),this.bodyView.on("add",function(t){return function(e){return t.trigger("add",e)}}(this))},i.prototype.closeSelector=function(t){if(this.bodyView.closeSelector(),t)return t.stopPropagation()},i.prototype.popup=function(){return $(".js-text--edit-overtime").on("click",function(t){return function(){return t.remove()}}(this)),this.setBodyView(new RG.Views.CustomAvailability.AddTimeBlock({newTimeBlockStartTime:this.newTimeBlockStartTime})),i.__super__.popup.apply(this,arguments)},i}(RG.Views.Dialogs.Popover)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.AllowanceBreakdown=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("dialogs/allowance_breakdown"),i.prototype.tagName="span",i.prototype.initialize=function(t){return this.model=t.model},i.prototype.render=function(){return this.$el.html(this.template({model:this.model})),this._fillValues(),this},i.prototype._fillValues=function(){return this._renderResourceContext(),this._renderNumberOfDays(),this._renderNonWorkingDays(),this._renderHolidays()},i.prototype._renderResourceContext=function(){var t;if(this.model.get("resourceName"))return t=$(document.createElement("span")).addClass("downtime-multiple-resource-explanation").text(" (based on "+this.model.get("resourceName")+"'s availability)"),this.$(".automated-calculation-heading").append(t)},i.prototype._renderNumberOfDays=function(){return this.$el.append($(document.createElement("p")).text("Days in timeframe: "+this.model.get("numberOfDaysBreakdown").length))},i.prototype._renderHolidays=function(){var t,e,i,n;if(i=this.model.getHolidays(),0!==i.length){n=[];for(e in i)t=i[e],n.push(this.$el.append($(document.createElement("p")).text("less "+t+" "+e+" "+this._pluralize(t)+".")));return n}},i.prototype._renderNonWorkingDays=function(){var t;if(t=this.model.numberOfNonWorkingDays(),0!==t.length)return this.$el.append($(document.createElement("p")).text("less "+t+" non working-"+this._pluralize(t)+"."))},i.prototype._pluralize=function(t){return t>1?"days":"day"},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.BookingClashPopover=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.popup=function(){var t;return t=i.__super__.popup.apply(this,arguments),RG.Popovers.locked=!0,setTimeout(function(t){return function(){return t._scrollIntoHorizontalView()}}(this),100),setTimeout(function(t){return function(){return t._scrollIntoVerticalView()}}(this),120),t},i}(RG.Views.Dialogs.Popover)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.BookingDetailsBody=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("dialogs/booking_details_body"),i.prototype.tagName="main",i.prototype.initialize=function(t){return this.booking=t.booking,this.actions=t.actions},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this},i.prototype.remove=function(){var t;return null!=(t=this.actions)&&t.remove(),i.__super__.remove.apply(this,arguments)},i.prototype.off=function(){var t;return null!=(t=this.actions)&&t.off(),i.__super__.off.apply(this,arguments)},i.prototype._fillValues=function(){var t,e;if(this._renderActions(),this._renderResources(),this._renderBookingTarget(),this.$(".js-booker-img").attr("src",null!=(t=this.booking.get("booker"))?t.get("imageUrl"):void 0),this.$(".js-booker-name").text(null!=(e=this.booking.get("booker"))?e.get("name"):void 0),this.$("#confirmed-hours").text(RG.Utils.TimeFormatter.formatMinutes(this.booking.getConfirmedMinutes())+" confirmed"),this.booking.get("notes")&&this.booking.get("notes").length>0?(this.$("#details-field").show(),this.$("#details").show(),this.$("#details").html(window.segmentAutolinker(this.booking.get("notes")).replace(/\n/g,"<br />"))):(this.$("#details-field").hide(),this.$("#details").hide()),this.booking.getWaitingMinutes()>0?(this.$("#waiting-list-hours").text("+ "+RG.Utils.TimeFormatter.formatMinutes(this.booking.getWaitingMinutes())+" on waiting list"),this.$("#waiting-list-hours").show()):(this.$("#waiting-list-hours").text(""),this.$("#waiting-list-hours").hide()),this.booking.get("refreshable"))return this.$(".availability-changed").show()},i.prototype._renderActions=function(){var t,e;return this.$(".js-actions-container").append(null!=(t=this.actions)?t.render().el:void 0),null!=(e=this.actions)?e.on("all",function(t){return function(){return t.trigger.apply(t,arguments)}}(this)):void 0},i.prototype._renderResources=function(){var t,e;return this.booking.collection.resource.hasAvatar()&&(t=new RG.Views.Resource.Avatar({resource:this.booking.collection.resource}),this.$("#booking-resources").append(t.render().el)),e=$(document.createElement("span")).addClass("resource-name"),this.$("#booking-resources").append(e.text(this.booking.collection.resource.getName()))},i.prototype._renderBookingTarget=function(){var t,e;return t=this.booking.getBookingTarget().getTypeDescription(),e=_.unescape(_.unescape(this.booking.getBookingTarget().getLongDescription())),t.length?this.$("#booking-target-field").text(t).show():this.$("#booking-target-field").hide(),e.length?this.$("#booking-target").text(e).show():this.$("#booking-target").hide()},i}(RG.Views.BaseView)}.call(this),function(){RG.Views.Dialogs.BookingDetailsFactory=function(){function t(t){this.bookingFormFactory=t.bookingFormFactory}return t.prototype.create=function(t){var e,i,n,o,r;return r=new RG.Views.Dialogs.BookingDetailsHeader({booking:t.booking}),RG.Utils.Permissions.canManage(t.booking)&&(e=t.booking.isSeries()&&t.duration?new RG.Views.Dialogs.BookingSeriesDetailsActions({duration:t.duration,booking:t.booking,bookingFormFactory:this.bookingFormFactory}):new RG.Views.Dialogs.SingleBookingDetailsActions({duration:t.duration,booking:t.booking,bookingFormFactory:this.bookingFormFactory})),i=new RG.Views.Dialogs.BookingDetailsBody({booking:t.booking}),o=new RG.Views.Dialogs.TagWrapper({view:e,tagName:"footer"}),n=new RG.Views.Dialogs.Dialog({header:r,body:i,footer:o,className:"booking-details-dialog"}),new RG.Views.Dialogs.Popover({removeAttachTo:t.removeAttachTo,attachTo:t.attachTo,body:n,className:"edit-booking-dropdown js-edit-booking-popover"})},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.BookingDetailsHeader=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("dialogs/booking_details_header"),i.prototype.tagName="header",i.prototype.initialize=function(t){return this.booking=t.booking},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this},i.prototype._fillValues=function(){if(this.$("#booking-duration").text(this.booking.getDurationCaption()+" "),this.booking.isSeries()&&this.$("#booking-duration").append($("<span></span>").text(this.booking.getDurationLongRepeatCaption())),this.$("#booking-date").text(this.booking.getSavedDateRange().toString()+" "),this.booking.collection.resource.getTimeZone().get("name")!==window.currentUserTimeZone)return this.$("#booking-date").append($("<span></span>").text(this.booking.collection.resource.getTimeZone()))},i}(RG.Views.BaseView)}.call(this),function(){RG.Views.Dialogs.BookingPopoverFactory=function(){function t(t){this.booking=t.booking,this.duration=t.duration,this.bookingAnchor=t.bookingAnchor,this.popoverType=t.popoverType,"undefined"==typeof t.removeAttachTo&&(this.removeAttachTo=!0),this.bookingFormFactory=t.bookingFormFactory}return t.prototype.popover=function(){var t,e;return"details"===this.popoverType?this._getDetailsDialogFactory().create({removeAttachTo:this.removeAttachTo,booking:this.booking,attachTo:this.bookingAnchor,duration:this.duration,editSeries:function(){return this.bookingFormFactory.createEdit({booking:this.booking})}}):"edit"===this.popoverType?(e=this.bookingFormFactory.createEdit({booking:this.booking}),t=new RG.Views.Dialogs.Popover({attachTo:this.bookingAnchor,body:e,removeAttachTo:this.removeAttachTo,className:"edit-booking-dropdown"})):void 0},t.prototype._getDetailsDialogFactory=function(){return new RG.Views.Dialogs.BookingDetailsFactory({bookingFormFactory:this.bookingFormFactory})},t}()}.call(this),function(){RG.Views.Dialogs.BookingFormFactory=function(){function t(t){this.currentUserId=t.currentUserId,this.resources=t.resources,this.projects=t.projects,this.deletedProjects=t.deletedProjects,this.clients=t.clients,this.deletedClients=t.deletedClients,this.bookers=t.bookers,this.downtimeTypes=t.downtimeTypes,this.deletedBookers=t.deletedBookers,this.timeZones=t.timeZones,this.currentUserTimeZone=t.currentUserTimeZone}return t.prototype.create=function(t){return new RG.Views.Dialogs.NewBookingDowntimePopover({currentUserId:this.currentUserId,resources:this.resources,projects:this.projects,deletedProjects:this.deletedProjects,clients:this.clients,deletedClients:this.deletedClients,bookers:this.bookers,downtimeTypes:this.downtimeTypes,deletedBookers:this.deletedBookers,dateRange:t.dateRange,resource:t.resource,attachTo:t.attachTo,removeCallback:t.removeCallback,changeCallback:t.changeCallback,timeZones:this.timeZones,currentUserTimeZone:this.currentUserTimeZone})},t.prototype.createEdit=function(t){return new RG.Views.Dialogs.EditBooking({currentUserId:this.currentUserId,resources:this.resources,projects:this.projects,deletedProjects:this.deletedProjects,clients:this.clients,deletedClients:this.deletedClients,bookers:this.bookers,deletedBookers:this.deletedBookers,booking:t.booking,callback:t.callback})},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.BookingSeriesDetailsActions=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="ul",i.prototype.className="booking-actions",i.prototype.template=templates.find("dialogs/booking_series_details_actions"),i.prototype.initialize=function(t){return this.duration=t.duration,this.booking=t.booking,this.bookingFormFactory=t.bookingFormFactory},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this.$(".dropdown-toggle").dropdown(),this.$(".dropdown-toggle").on("click",function(t){return function(){return t.$(".downtime-btn-group").toggleClass("dropup",t._menuOpensUpwards())}}(this)),this._bindEvents(),this},i.prototype._bindEvents=function(){return this.$el.on("click","#delete-single-booking",function(t){return function(){return t.deleteDuration()}}(this)),this.$el.on("click","#delete-series",function(t){return function(){return t.deleteBooking()}}(this)),this.$el.on("click","#edit-series",function(t){return function(){return t.editBooking()}}(this)),this.$el.on("click","#edit-single-booking",function(t){return function(){return t.editDuration()}}(this)),this.$el.on("click","#split-series",function(t){return function(){return t.splitBooking()}}(this))},i.prototype.deleteDuration=function(){var t,e;return!(!this.onEdgeDay()&&!(e=confirm("This will break this booking series into two blocks.")))&&(RG.Popovers.clear(),t=this.booking.collection,RG.Utils.BookingService.deleteSingleDate(this.booking,this.duration.get("date"),function(e){return function(){return e.remove(),t.predictWaitingList()}}(this)),!0)},i.prototype.onEdgeDay=function(){var t;return t=this.booking.durations.models,this.duration===t[0]||this.duration===t[t.length-1]},i.prototype.deleteBooking=function(){return RG.Popovers.clear(),RG.Utils.BookingService.deleteBooking(this.booking,function(t){return function(){return t.remove()}}(this)),!0},i.prototype.editBooking=function(){var t;return t=this.bookingFormFactory.createEdit({booking:this.booking}),this.trigger("changeView",t),!0},i.prototype.editDuration=function(){var t,e;if(t=this.booking.cloneWithDurations(this.duration),e=confirm("This will break this booking series into multiple blocks."))return this.trigger("hide"),RG.Utils.BookingService.isolate(t.realBooking,t.get("startDate"),function(t){return function(e){var i;return i=t.bookingFormFactory.createEdit({booking:e}),t.trigger("show"),t.trigger("changeView",i)}}(this)),!0},i.prototype.splitBooking=function(){var t;return!!this._canSplit()&&(t=new RG.Views.Dialogs.SplitBooking({booking:this.booking,splitDate:this.duration.get("date")}),this.trigger("changeView",t,{className:"split-booking-popover",render:!0}),!1)},i.prototype._fillValues=function(){var t,e;if(t=this.duration.get("date"),this.$("#edit-single-booking").text("Edit "+RG.Utils.DateFormatter.getShortDate(t)+" only"),this.$("#delete-single-booking").text("Delete "+RG.Utils.DateFormatter.getShortDate(t)+" only"),!this._canSplit())return e="You can't split a booking on the start date. Please select another date.",this.$("#split-series").attr({disabled:"disabled",title:e}).addClass("is-disabled")},i.prototype._menuOpensUpwards=function(){return this.$el.offset().top-$(window).height()-$(window).scrollTop()>-130},i.prototype._canSplit=function(){return!(this.duration.get("date")===this.booking.getDateRange().startDate)},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.CopyAvailabilityPopover=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.cssClass="js-copy-availability-dropdown",i.prototype.className="copy-availability-dropdown-container",i.prototype.initialize=function(t){return this.dailyAggregation=t.dailyAggregation,this.currentDay=t.currentDay,this.$el.on("click",".js-cancel",function(t){return function(e){return e.preventDefault(),e.stopPropagation(),t.$el.closest(".dropdown").removeClass("open"),t.remove()}}(this)),this.$el.on("click",".js-copy",function(t){return function(e){return e.preventDefault(),e.stopPropagation(),t.bodyView.copyAvailability(),t.$el.closest(".dropdown").removeClass("open"),t.remove()}}(this))},i.prototype.render=function(){return i.__super__.render.apply(this,arguments),this.$el.find("button.close").remove(),this.$(".shadow-arrow").remove(),this.$el.prepend($(document.createElement("span")).addClass("shadow-arrow")),this.$el.find(".f-dropdown").removeClass("f-dropdown"),this},i.prototype.setPosition=function(){this.$(".shadow-arrow").css({top:""}),this.$el.css({top:"",left:""}),this.$(".f-dropdown").removeClass("cdrop-left").removeClass("cdrop-right"),this.$(".f-dropdown .dropdown-content").css({"max-height":$(window).height()}),this.$(".f-dropdown .dropdown-content main").css({"max-height":$(window).height()-this.$(".f-dropdown .dropdown-content header, .f-dropdown .dropdown-content .tabs").height()-70}),this._setOpenDirection(),this.width=47*this.dailyAggregation.length,this.width=_.max([this.width,200]),this.$(".shadow-arrow").css({top:26,left:this.width-13}),this.$el.css({position:"absolute",top:22,width:this.width})},i.prototype._setOpenDirection=function(){this._setOpenRight()},i.prototype._setOpenRight=function(){this.$(".f-dropdown").addClass("cdrop-right"),this.$el.css({left:2*this.width})},i.prototype.popup=function(){return this.setBodyView(new RG.Views.CustomAvailability.CopyAvailability({dailyAggregation:this.dailyAggregation,currentDay:this.currentDay})),this.bodyView.$el.width(this.width),i.__super__.popup.apply(this,arguments)},i}(RG.Views.Dialogs.Popover),RG.Views.CustomAvailability.CopyAvailability=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("availability/copy_availability"),i.prototype.className="copy-availability",i.prototype.initialize=function(t){return this.dailyAggregation=t.dailyAggregation,this.currentDay=t.currentDay},i.prototype.remove=function(){return this._cleanup(),i.__super__.remove.apply(this,arguments)},i.prototype._cleanup=function(){var t;return null!=(t=this.dayssSelector)?t.remove():void 0},i.prototype.render=function(){var t;return this._cleanup(),this.$el.html(this.template()),t=this.dailyAggregation.map(function(t){return t.get("weekDay")}),t=_.reject(t,function(t){return function(e){return e===t.currentDay.get("weekDay")}}(this)),this.daysSelector=new RG.Views.CustomAvailability.DaysSelector({days:t,selectedDays:[1,2,3,4,5]}),this.daysSelector.on("change",function(t){return function(){return t.validate()}}(this)),this.$(".js-day-selection").replaceWith(this.daysSelector.render().el),this},i.prototype.validate=function(){return this.$(".js-copy").attr("disabled",0===this.daysSelector.getSelectedDays().length?"disabled":null)},i.prototype.copyAvailability=function(){var t,e,i,n,o,r;for(r=this.daysSelector.getSelectedDays(),e=this.dailyAggregation.select(function(t){return r.indexOf(t.get("weekDay"))!==-1}),o=this.currentDay.getFirstAvailablePeriods().models,i=0,n=e.length;i<n;i++)t=e[i],t.clearVaryingAvailability(),t.getFirstAvailablePeriods().reset(o)},i}(RG.Views.BaseView),RG.Views.CustomAvailability.DaysSelector=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="ul",i.prototype.initialize=function(t){return this.days=t.days,this.selectedDays=t.selectedDays},i.prototype.remove=function(){return this.off(),this.$el.off(),this._cleanup(),i.__super__.remove.apply(this,arguments)},i.prototype._cleanup=function(){var t,e,i,n,o;if(this.selectors&&this.selectors.length){for(i=this.selectors,n=[],t=0,e=i.length;t<e;t++)o=i[t],n.push(o.remove());return n}},i.prototype.render=function(){var t,e,i,n,o;for(this._cleanup(),this.selectors=[],o=this.days,i=0,n=o.length;i<n;i++)t=o[i],e=new RG.Utils.DayName(t),t=new RG.Views.CustomAvailability.DaySelector({dayName:e,isSelected:this.selectedDays.indexOf(t)!==-1}),t.on("change",function(t){return function(){return t.trigger("change")}}(this)),this.$el.append(t.render().el),this.selectors.push(t);return this},i.prototype.getSelectedDays=function(){return _.chain(this.selectors).select(function(t){return t.isChecked()}).map(function(t){return t.dayName.dayNumber}).value()},i}(RG.Views.BaseView),RG.Views.CustomAvailability.DaySelector=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="li",i.prototype.events={"click input":"_stopPropagation",click:"toggle"},i.prototype.initialize=function(t){return this.dayName=t.dayName,this.isSelected=t.isSelected},i.prototype.remove=function(){return this.off(),this.$el.off(),i.__super__.remove.apply(this,arguments)},i.prototype.render=function(){return this.$el.append('<input type="checkbox">'),this.$el.append("<span>"+this.dayName+"</span>"),this.$("input").prop("checked",this.isSelected),this},i.prototype.toggle=function(t){return null!=t&&t.stopPropagation(),this.$("input").prop("checked",!this.isChecked()),this.trigger("change")},i.prototype._stopPropagation=function(t){return t.stopPropagation(),this.trigger("change")},i.prototype.isChecked=function(){return this.$("input").prop("checked")},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.CustomAvailability=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("dialogs/custom_availability"),i.prototype.className="js-custom-availability",i.prototype.initialize=function(t){return this.resource=t.resource,this.dateRange=t.dateRange,this.line=t.line,this.dailyAggregation=t.dailyAggregation},i.prototype.render=function(){return this.$el.html(this.template({dateRange:this.dateRange,resource:this.resource})),this.resource.shouldDisplayTimeZone()||this.$(".js-timezone").hide(),this._renderDays(),this._renderAvatar(),this},i.prototype.remove=function(){return this.days&&this.days.remove(),i.__super__.remove.apply(this,arguments)},i.prototype.getSelectedDay=function(){return this._selectedDay},i.prototype._renderAvatar=function(){var t;if(this.resource.hasAvatar())return t=new RG.Views.Resource.Avatar({resource:this.resource
}),this.$(".js-resource-avatar").replaceWith(t.render().el)},i.prototype._renderDays=function(){return this.days=new RG.Views.CustomAvailability.DayRange({collection:this.dailyAggregation,resource:this.resource}),this.days.on("edit",function(t){return function(){return t.trigger("edit")}}(this)),this.days.on("change",function(t){return function(e){return t._selectedDay=e}}(this)),this.$el.find(".availability-tabs").replaceWith(this.days.render().el)},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.CustomAvailabilityForm=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("dialogs/custom_availability_form"),i.prototype.menuTemplate=templates.find("availability/popover_menu"),i.prototype.className="js-custom-availability",i.prototype.events={"click .dropdown-toggle":"togglePopover","click .js-update":"updateAvailability","click .js-cancel":"close",click:"_closePopover","click .js-reset-availability":"resetAvailability","click .js-copy-availability":"copyAvailability"},i.prototype.initialize=function(t){return this.dateRange=t.dateRange,this.selectedDay=t.selectedDay,this.dailyAggregation=t.dailyAggregation,this.resource=t.resource,this.popover=t.popover},i.prototype.remove=function(){return this._cleanup(),i.__super__.remove.apply(this,arguments)},i.prototype._cleanup=function(){var t,e,i,n;return this.off(),this.$el.off(),null!=(t=this.days)&&t.remove(),null!=(e=this.dateRangeSelector)&&e.remove(),null!=(i=this.optionView)&&i.remove(),null!=(n=this.copyAvailabilityPopup)&&n.remove(),this.days=null},i.prototype._renderDays=function(){return this.days=new RG.Views.CustomAvailability.DayRangeForm({collection:this.dailyAggregation,selectedDay:this.selectedDay,resource:this.resource}),this.days.on("edit",function(t){return function(){return t.trigger("edit")}}(this)),this.days.on("change",function(t){return function(e){return t.selectedDay=e,t.toggleCopyAvailability()}}(this)),this.days.on("updatePosition",function(t){return function(){return t.trigger("updatePosition")}}(this)),this.days.render(),this._renderAvailabilityMenu(),this.days.$el},i.prototype._renderDateRangeSelector=function(){return this.dateRangeSelector=new RG.Views.Selectors.DateRange({dateRange:new RG.Utils.DateRange(new Date(this.dateRange.startDate),new Date(this.dateRange.endDate)),customValidations:(new RG.Validators.CustomAvailabilityLengthValidator).validate,tagName:"span"}),this.dateRangeSelector._isResourceAvailable=function(){return!0},this.dateRangeSelector.on("change",function(t){return function(e){if(t.dateRangeSelector.customValidations(t.dateRangeSelector)&&e.getNumberOfDays()>0)return t.dateRange=e,t.trigger("change:dateRange",e)}}(this)),this.$(".js-daterange").append(this.dateRangeSelector.render().el),this.dateRangeSelector.toggleError(!1),this.dateRangeSelector.validate()},i.prototype._renderAvailabilityMenu=function(){return $(this.menuTemplate()).insertBefore(this.days.$(".js-day-detail"))},i.prototype.toggleCopyAvailability=function(){return 1!==this.dailyAggregation.length&&this.selectedDay.availabilityConsistent()?this.$(".js-copy-availability").show():this.$(".js-copy-availability").hide()},i.prototype.render=function(){var t;return this.$el.html(this.template()),this.$(".filter__availability-form").tooltip(),this._renderDateRangeSelector(),t=this._renderDays(),this.$el.append(t),this.$el.append(this._renderFooter()),this.toggleCopyAvailability(),this},i.prototype.copyAvailability=function(t){var e;return null!=t&&t.stopPropagation(),null!=(e=this.copyAvailabilityPopup)&&e.remove(),this.copyAvailabilityPopup=new RG.Views.Dialogs.CopyAvailabilityPopover({attachTo:this.$(".js-copy-availability"),dailyAggregation:this.dailyAggregation,currentDay:this.selectedDay}),this.copyAvailabilityPopup.popup(),this.$(".js-copy-availability").append(this.copyAvailabilityPopup.$el)},i.prototype.resetAvailability=function(){return this.selectedDay.resetAvailability(),this.days.render(),this._renderAvailabilityMenu(),this.toggleCopyAvailability()},i.prototype.togglePopover=function(t){var e;return null!=(e=this.days)&&e.trigger("openDropdown"),$(t.target).closest(".dropdown").toggleClass("open"),t.stopPropagation()},i.prototype.updateAvailability=function(t){var e,i,n,o,r,s,a;if(t.preventDefault(),this.dateRangeSelector.validate())return e=this.dailyAggregation.select(function(t){return t.hasAvailabilityChanged()&&t.variesFromNormalAvailability()}),r=this.dailyAggregation.select(function(t){return t.hasAvailabilityChanged()&&!t.variesFromNormalAvailability()}),n=this.dailyAggregation.select(function(t){return t.hasOvertimeChanged()}),i=this.dailyAggregation.select(function(t){return t.hasAvailabilityChanged()||t.hasOvertimeChanged()}),s=this._resetServerAvailability(r),a=Q.promise(function(t){return function(i){var n;return 0===e.length?Q.delay(0).then(i):(n=new RG.Commands.UpdateAvailabilityCommand({account:t.resource.account,dateRange:t.dateRange,resource:t.resource,changedDays:e,successCallback:function(){return i()}}),n.willTouchBookings({success:function(e){return t.optionView=new RG.Views.Dialogs.BookingClashManagement({command:n,clashBookingsCount:e}),t.trigger("changeOverlay",t.optionView,{className:"overlay availability-waiting"})},fail:function(){return t.trigger("updating"),window.setTimeout(function(){return n.execute()},50)}}))}}(this)),o=new RG.Commands.UpdateOvertimeCommand({dateRange:this.dateRange,resource:this.resource,changedDays:n,successCallback:function(t){return function(){return t.resource.availability.trigger("maxAvailabilityChanged"),window.update()}}(this)}),a.then(s).then(function(t){return function(){return t.close(),o.execute()}}(this))},i.prototype._resetServerAvailability=function(t){var e,i;return i=_.flatten(t.map(function(t){return t.getDates()})),0===i.length?Q.delay(0):(e=new RG.Commands.ResetToNormalAvailabilityCommand({resourceInstanceId:this.resource.id,dates:i}),e.execute.bind(e))},i.prototype.close=function(t){return null!=t&&t.stopPropagation(),this.trigger("close")},i.prototype._closePopover=function(t){var e,i;return $(t.target).hasClass("hasDatepicker")||this.dateRangeSelector.$("input").trigger("blur"),null!=(e=this.days)&&e.closePopovers(),null!=(i=this.copyAvailabilityPopup)&&i.remove(),this.$(".dropdown").removeClass("open")},i.prototype._disableControls=function(){return this.$el.find(".js-update, .js-cancel").attr("disabled","disabled"),this.$el.find(".js-daterange input").attr("disabled","disabled"),this.$el.find(".js-reset-availability").hide(),this.$el.find(".js-add-timeblock").hide(),this.$el.find(".js-timeblock span").hide(),this.$el.find(".js-edit-timeblock").hide(),this.$el.find(".availability-tabs__menu").hide()},i.prototype._enableControls=function(){return this.$el.find(".js-update, .js-cancel").attr("disabled",null),this.$el.find(".js-daterange input").attr("disabled",null),this.$el.find(".js-reset-availability").show(),this.$el.find(".js-add-timeblock").show(),this.$el.find(".js-timeblock span").show(),this.$el.find(".js-edit-timeblock").show(),this.$el.find(".availability-tabs__menu").show()},i.prototype._renderFooter=function(){var t;return t=$(document.createElement("footer")),t.append($(document.createElement("button")).addClass("btn btn-guru js-update").text("Update")),t.append("\n"),t.append($(document.createElement("button")).addClass("btn js-cancel").text("Cancel")),t},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.CustomAvailabilityPopover=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="availability js-availability-dropdown-parent",i.prototype.cssClass="custom-availability-dropdown",i.prototype.onboardTemplate=templates.find("availability/onboard"),i.prototype.initialize=function(t){return i.__super__.initialize.apply(this,arguments),this.line=t.line,this.dateRange=t.dateRange,this.resource=t.resource,this.changeCallback=t.changeCallback},i.prototype._closeOpenPopovers=function(t){if(i.__super__._closeOpenPopovers.apply(this,arguments),!$(t.target).hasClass("hasDatepicker"))return this.$("input").trigger("blur")},i.prototype.popup=function(){var t,e;return t=this._getDailyAggregation(),e=new RG.Views.Dialogs.CustomAvailability({line:this.line,dateRange:this.dateRange,resource:this.resource,dailyAggregation:t}),this.setBodyView(e),i.__super__.popup.apply(this,arguments),e.on("edit",function(t){return function(){return t.setBodyView(t._createFormView(e.getSelectedDay())),t.setPosition()}}(this)),this._displayOnboardingOverlay()},i.prototype.remove=function(){var t,e;return null!=(t=this.editView)&&t.remove(),null!=(e=this.overlay)&&e.remove(),i.__super__.remove.apply(this,arguments)},i.prototype._createFormView=function(t){var e,i,n,o,r,s,a,l,c;for(e=this._getDailyAggregation(),s=e.models,n=0,o=s.length;n<o;n++)i=s[n],i.getFirstAvailablePeriods().on("reset",function(t){return function(){return t._resetPosition()}}(this));return r=e.findWhere({weekDay:t.get("weekDay")}),null!=(a=this.editView)&&a.remove(),$("#ui-datepicker-div").remove(),this.editView=new RG.Views.Dialogs.CustomAvailabilityForm({dateRange:this.dateRange,selectedDay:r,dailyAggregation:e,resource:this.resource,popover:this}),this.editView.on("change:dateRange",function(t){return function(e){return t.trigger("changeOverlay",t._spinnerView(e),{className:"overlay availability-waiting"}),window.setTimeout(function(){return window.requestAnimationFrame(function(){return t.setPosition()})},10)}}(this)),this.editView.on("updating",function(t){return function(){return t.trigger("changeOverlay",t._spinnerView(),{className:"overlay availability-waiting"})}}(this)),null!=(l=this.spinner)&&l.stop(),null!=(c=this.overlay)&&c.remove(),this.editView.render()},i.prototype._getDailyAggregation=function(){var t,e,i,n,o,r,s,a;for(t={},s=this.dateRange.getDates(),n=0,o=s.length;n<o;n++)i=s[n],a=null!=t[r=i.getDay()]?t[r]:t[r]=new RG.Models.DayAvailabilityAggregation({weekDay:i.getDay(),dateRange:this.dateRange}),a.get("availablePeriods")[i.getISODate()]=this.resource.availability.getPeriodsForDate(i),a.get("overtimes")[i.getISODate()]=this.resource.availability.getOvertimesForDate(i),a.get("durations")[i.getISODate()]=this.resource.bookings.getDurationsForDate(i),a.get("downtimes")[i.getISODate()]=this.resource.downtimes.mergedTimeRangesForDate(i),a.get("originalAvailablePeriods")[i.getISODate()]=this.resource.availability.getOriginalPeriodsForDate(i);return e=new RG.Collections.DayAvailabilityAggregations(_.values(t)),e.resourceId=this.resource.id,e},i.prototype._spinnerView=function(t){if($("#ui-datepicker-div").hide(),this.overlay=new RG.Views.Dialogs.Overlay({attachTo:this.el,className:"overlay",template:function(){return""}}),this.overlay.render(),this.spinner=new Spinner(this.spinnerOptions).spin(this.overlay.el),t)return window.setTimeout(function(e){return function(){return window.requestAnimationFrame(function(){return e.dateRange=t,"function"==typeof e.changeCallback&&e.changeCallback(t),e.setBodyView(e._createFormView(e.editView.selectedDay)),$("#ui-datepicker-div").hide()})}}(this),8)},i.prototype._displayOnboardingOverlay=function(){var t;if(!window.onboardingNotice.dismissed_custom_availability)return t=this.bodyView.getSelectedDay(),this.$el.addClass("onboarding-notice-open"),this.overlay=new RG.Views.Dialogs.Overlay({attachTo:this.el,template:this.onboardTemplate,className:"overlay",removeCallback:function(t){return function(){var e;return t.$el.removeClass("onboarding-notice-open"),window.onboardingNotice.dismissed_custom_availability=!0,e=new RG.Commands.UpdateNoticeCommand({dismissedField:"dismissed_custom_availability"}),e.execute()}}(this)}),this.overlay.render()},i}(RG.Views.Dialogs.Popover)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.DowntimeDetailsActions=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="ul",i.prototype.className="booking-actions",i.prototype.template=templates.find("dialogs/downtime_details_actions"),i.prototype.deleteTemplate=templates.find("dialogs/downtime_details_actions_delete_single"),i.prototype.deleteMenuTemplate=templates.find("dialogs/downtime_details_actions_delete_series"),i.prototype.initialize=function(t){return this.account=t.account,this.resources=t.resources,this.duration=t.duration,this.downtime=t.downtime,this.downtimeFormFactory=t.downtimeFormFactory},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this._bindEvents(),this},i.prototype._bindEvents=function(){return this.$el.on("click","#delete-duration",function(t){return function(e){return t.deleteDuration(e)}}(this)),this.$el.on("click","#delete-downtime",function(t){return function(e){return t.deleteDowntime(e)}}(this)),this.$el.on("click","#edit-downtime",function(t){return function(e){return t.editDowntime(e)}}(this)),this.$el.on("click","#split-downtime",function(t){return function(e){return t.splitDowntime(e)}}(this))},i.prototype._onEdgeDay=function(){return RG.Utils.DateComparator.equalsYMD(this.duration.get("date"),this.downtime.get("to"))||RG.Utils.DateComparator.equalsYMD(this.duration.get("date"),this.downtime.get("from"))},i.prototype.deleteDuration=function(t){var e,i;return null!=t&&t.preventDefault(),!(!this._onEdgeDay()&&!(i=confirm("This will break this series of events into two blocks.")))&&(e=RG.Utils.spinnerOverlay($(this.el).closest(".js-edit-downtime-popover")[0]),Q.delay(10).then(function(t){return function(){return RG.Utils.DowntimeService.deleteSingleDate(t.downtime,t.duration.get("date"),function(){return RG.Popovers.clear(),RG.Popovers.popoverActive=!1,t.remove()}),!0}}(this)))},i.prototype.deleteDowntime=function(t){var e;return null!=t&&t.preventDefault(),e=RG.Utils.spinnerOverlay($(this.el).closest(".js-edit-downtime-popover")[0]),Q.delay(10).then(function(t){return function(){var e;return e=t.account.downtimes.findWhere({id:t.downtime.id}),t.account.downtimes.remove(e.id),RG.Popovers.clear(),RG.Popovers.popoverActive=!1,t.remove(),RG.Utils.DowntimeService.deleteDowntime(e.id),!0}}(this))},i.prototype.editDowntime=function(t){var e;return null!=t&&t.preventDefault(),e=this.downtimeFormFactory.createEdit({downtime:this.downtime}),this.trigger("changeView",e),!0},i.prototype.splitDowntime=function(t){var e;return null!=t&&t.preventDefault(),!!this._canSplit()&&(e=new RG.Views.Dialogs.SplitDowntime({account:this.account,resources:this.resources,downtime:this.downtime,splitDate:this.duration.get("date")}),this.trigger("changeView",e,{className:"split-booking-popover",render:!0}),!1)},i.prototype._fillValues=function(){var t;if(this.downtime.isSeries()&&!this.downtime.isVacation()&&this.duration?(this.$(".js-delete-button").html(this.deleteMenuTemplate()),this.$(".dropdown-toggle").dropdown(),this.$(".dropdown-toggle").on("click",function(t){return function(){return t.$(".downtime-btn-group").toggleClass("dropup",t._menuOpensUpwards())}}(this)),t=this.duration.get("date"),this.$("#delete-duration").text("Delete "+RG.Utils.DateFormatter.getShortDate(t)+" only")):this.$(".js-delete-button").html(this.deleteTemplate()),!this._canSplit())return this._hideOrGreySplitIcon()},i.prototype._hideOrGreySplitIcon=function(){return this.downtime.isSeries()?this.$(".js-split-button a").attr({disabled:"disabled",title:this._cantSplitTitle()}).addClass("is-disabled"):this.$(".js-split-button").hide()},i.prototype._menuOpensUpwards=function(){return this.$el.offset().top-$(window).height()-$(window).scrollTop()>-130},i.prototype._canSplit=function(){return!this.downtime.isVacation()&&this.duration&&this.downtime.getDateRange().getNumberOfDays()>1&&!RG.Utils.DateComparator.equalsYMD(this.duration.get("date"),this.downtime.getDateRange().startDate)},i.prototype._cantSplitTitle=function(){return this.downtime.isVacation()?"You can't split a vacation Time Off.":"Sorry, you can't split this item on the start date. Please select another date."},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.DowntimeDetailsBody=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("dialogs/downtime_details_body"),i.prototype.initialize=function(t){return this.downtime=t.downtime,this.actions=t.actions,this.booker=t.booker,this.resources=t.resources},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this},i.prototype.remove=function(){var t;return null!=(t=this.actions)&&t.remove(),i.__super__.remove.apply(this,arguments)},i.prototype.off=function(){var t;return null!=(t=this.actions)&&t.off(),i.__super__.off.apply(this,arguments)},i.prototype._fillValues=function(){var t;return this._renderActions(),this._renderResources(),(t=this.downtime.getType())?(this.$("#booking-target-field").show(),this.$("#booking-target").show(),this.$("#booking-target").text(t)):(this.$("#booking-target-field").hide(),this.$("#booking-target").hide()),this.$(".js-booker-img").attr("src",this.booker.get("imageUrl")),this.$(".js-booker-name").text(this.booker.get("name")),this.$("#confirmed-hours").text(RG.Utils.TimeFormatter.formatMinutes(this.downtime.getConfirmedMinutes())+" confirmed"),this.downtime.get("details")&&this.downtime.get("details").length>0?(this.$("#details-field").show(),this.$("#details").show(),this.$("#details").html(window.segmentAutolinker(this.downtime.get("details")).replace(/\n/g,"<br />"))):(this.$("#details-field").hide(),this.$("#details").hide())},i.prototype._renderActions=function(){var t,e;return this.$(".js-actions-container").append(null!=(t=this.actions)?t.render().el:void 0),null!=(e=this.actions)?e.on("all",function(t){return function(){return t.trigger.apply(t,arguments)}}(this)):void 0},i.prototype._renderResources=function(){return 1===this.resources.length&&this.$("#booking-resources-field").text("Resource"),this.resourcesView=new RG.Views.Downtimes.Resources({resources:this.resources}),this.$("#booking-resources").html(this.resourcesView.render().el)},i}(RG.Views.BaseView)}.call(this),function(){RG.Views.Dialogs.DowntimeDetailsFactory=function(){function t(t){this.downtimeFormFactory=t.downtimeFormFactory}return t.prototype.create=function(t){var e,i,n,o,r,s,a,l;return o=window.bookers.findWhere({id:t.downtime.get("creatorId")}),o||(o=window.deletedBookers.findWhere({id:t.downtime.get("creatorId")})),l="Downtime",a=window.resources.select(function(e){return _.include(t.downtime.get("resourceIds"),e.id)}),_.any(a,function(t){return t.constructor===RG.Models.HumanResourceInstance})&&(l="Time Off"),s=new RG.Views.Dialogs.DowntimeDetailsHeader({timeOffText:l,downtime:t.downtime,duration:t.duration,currentUserTimeZone:window.currentUserTimeZone,resources:a}),RG.Utils.Permissions.canManageDowntime(t.downtime)&&(e=new RG.Views.Dialogs.DowntimeDetailsActions({account:RG.Utils.getCurrentAccount(),resources:a,duration:t.duration,downtime:t.downtime,downtimeFormFactory:this.downtimeFormFactory})),i=new RG.Views.Dialogs.DowntimeDetailsBody({downtime:t.downtime,booker:o,resources:a}),r=new RG.Views.Dialogs.TagWrapper({view:e,tagName:"footer"}),n=new RG.Views.Dialogs.Dialog({header:s,body:i,footer:r,className:"downtime-details-dialog"}),new RG.Views.Dialogs.Popover({removeAttachTo:t.removeAttachTo,attachTo:t.attachTo,body:n,className:"edit-booking-dropdown js-edit-downtime-popover"})},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.DowntimeDetailsHeader=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("dialogs/downtime_details_header"),i.prototype.tagName="header",i.prototype.initialize=function(t){return this.timeOffText=t.timeOffText,this.downtime=t.downtime,this.duration=t.duration,this.currentUserTimeZone=t.currentUserTimeZone,this.resources=t.resources},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this},i.prototype._fillValues=function(){var t,e,i,n,o;if(t=this.downtime.getDateRange(),o=this.downtime.getTimeZone(),e=$(document.createElement("i")).addClass(this.downtime.getTypeIcon()),this.$("#popover-header").text(this.timeOffText).prepend(e),this.downtime.get("resourceIds").length>1&&(i=$(document.createElement("i")).addClass("rg-icon--contacts"),this.$("#popover-header").prepend(i)),n=this.$("#downtime-duration"),t.getNumberOfDays()>1?(this.$(".downtime-details-date").remove(),n.text(this.downtime.getDateTimeString(RG.Utils.DateFormatter.getShortDateWithYear)),n.addClass("downtime-details-date")):(this.$("#downtime-duration").text(this.downtime.getDateTimeString()),n=this.$(".downtime-details-date"),n.text(t.toString())),this._isTimeZoneDifferent())return n.append(" "),n.append($("<span></span>").text(o))},i.prototype._isTimeZoneDifferent=function(){return RG.Utils.isDifferentTimeZones(this.resources,this.currentUserTimeZone)},i}(RG.Views.BaseView)}.call(this),function(){RG.Views.Dialogs.DowntimeFormFactory=function(){function t(t){this.currentUserId=t.currentUserId,this.resources=t.resources,this.bookers=t.bookers,this.downtimeTypes=t.downtimeTypes,this.deletedBookers=t.deletedBookers,this.currentUserTimeZone=t.currentUserTimeZone,this.timeZones=t.timeZones}return t.prototype.createEdit=function(t){var e,i;return i=this.resources.select(function(e){return function(e){return _.include(t.downtime.get("resourceIds"),e.id)}}(this)),e=new RG.Views.Factories.NameSearch(this.resources).create({showMenu:!0,cssClass:"js-downtime-resource-selector",resourceSelector:!0}),new RG.Views.Dialogs.EditDowntime({downtime:t.downtime,currentUserId:this.currentUserId,currentUserTimeZone:window.currentUserTimeZone,resources:this.resources,selectedResources:i,resourceSelector:e,bookers:this.bookers,downtimeTypes:this.downtimeTypes,currentUserTimeZone:this.currentUserTimeZone,timeZones:this.timeZones})},t}()}.call(this),function(){RG.Views.Dialogs.DowntimePopoverFactory=function(){function t(t){this.downtime=t.downtime,this.duration=t.duration,this.downtimeAnchor=t.downtimeAnchor,this.popoverType=t.popoverType,"undefined"==typeof t.removeAttachTo&&(this.removeAttachTo=!0),this.downtimeFormFactory=t.downtimeFormFactory}return t.prototype.popover=function(){var t;return"details"===this.popoverType?this._getDetailsDialogFactory().create({removeAttachTo:this.removeAttachTo,downtime:this.downtime,attachTo:this.downtimeAnchor,duration:this.duration,editSeries:function(){return this.downtimeFormFactory.createEdit({downtime:this.downtime})}}):"edit"===this.popoverType?(t=this.downtimeFormFactory.createEdit({downtime:this.downtime}),new RG.Views.Dialogs.Popover({attachTo:this.downtimeAnchor,body:t,removeAttachTo:this.removeAttachTo,className:"edit-booking-dropdown"})):void 0},t.prototype._getDetailsDialogFactory=function(){return new RG.Views.Dialogs.DowntimeDetailsFactory({downtimeFormFactory:this.downtimeFormFactory})},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.EditBooking=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.headerTemplate=templates.find("dialogs/edit_booking_header"),i.prototype.initialize=function(t){if(this.currentUserId=t.currentUserId,this.resources=t.resources,this.projects=t.projects,this.deletedProjects=t.deletedProjects,this.deletedClients=t.deletedClients,this.clients=t.clients,this.bookers=t.bookers,this.deletedBookers=t.deletedBookers,this.booking=t.booking,t.el&&(this.el=t.el),this.dateRange=this.booking.getDateRange(),this.originalDate=this.dateRange.startDate,this.resource=this.booking.collection.resource,this.projectExists=!1,this.clientExists=!1,this.booking.attributes.project&&(this.projectExists=this.projects.findWhere({id:this.booking.attributes.project.attributes.id})),this.booking.attributes.client&&(this.clientExists=this.clients.findWhere({id:this.booking.attributes.client.attributes.id})),this.booking.attributes.project&&(this.deletedProjectExists=this.deletedProjects.findWhere({id:this.booking.attributes.project.attributes.id})),this.booking.attributes.client&&(this.deletedClientExists=this.deletedClients.findWhere({id:this.booking.attributes.client.attributes.id})),this.booker_exists=this.bookers.findWhere({id:this.booking.attributes.booker.attributes.id}),!this.booker_exists)return this.bookers.unshift(this.booking.attributes.booker),this.bookers.sort(function(t){return t.get("name")})},i.prototype.render=function(){return i.__super__.render.apply(this,arguments),this.$el.prepend(this.headerTemplate()),this},i.prototype.clearClientOrProject=function(){return this.bookerSelector.setSelectedValue(this.bookerSelector.getCurrentUserBooker().cid),this.clientProjectSelector.setSelectedValue(this.clientProjectSelector._originalValue)},i.prototype.toggleDurationTypes=function(){var t,e,n;if(i.__super__.toggleDurationTypes.apply(this,arguments),!this.selectingDuration){if(t=this.booking.durations.models[0].get("minutes"),n=540,e=+t+n,e<=1440)return this.timeRangeSelector.setStartTime(n),this.timeRangeSelector.setEndTime(e);if(e<=1380)return this.timeRangeSelector.setStartTime(60),this.timeRangeSelector.setEndTime(e-480)}},i.prototype._disableButtons=function(){return $("footer a").attr("disabled","disabled"),$("footer #add-booking").text("Busy, please wait...")},i.prototype._composeViews=function(){var t,e,n;return this.initialClientOrProject=null!=(t=this.booking)?t.getBookingTarget().cid:void 0,this.booking&&(this.booking.attributes.project?this.projects.push(null!=(e=this.booking)?e.getBookingTarget():void 0):this.booking.attributes.client&&this.clients.push(null!=(n=this.booking)?n.getBookingTarget():void 0)),i.__super__._composeViews.apply(this,arguments),this.$("header h3").text("Edit Booking"),this.$("#add-booking").text("Update Booking"),this.durationSelector.setDuration(this.booking.durations.models[0].getMinutes()),this.booking.durations.models[0].get("startTime")||0===this.booking.durations.models[0].get("startTime")?(this.setSelectingDuration(!1),this.timeRangeSelector.setStartTime(this.booking.durations.models[0].get("startTime")),this.timeRangeSelector.setEndTime(this.booking.durations.models[0].get("endTime"))):(this.timeRangeSelector.setStartTime("0"),this.timeRangeSelector.setEndTime(""+this.booking.durations.models[0].get("minutes")),this.setSelectingDuration(!0)),this.clientProjectSelector.setSelectedValue(this.clientProjectSelector._originalValue),this.$("#booking-details").val(this.booking.get("notes")),this._sortProjectsAndClientsAlphabetically(),this.bookerSelector.setSelectedValue(this.booking.get("booker").cid)},i.prototype._sortProjectsAndClientsAlphabetically=function(){return this.clientProjectSelector.clients.sort(),this.clientProjectSelector.projects.sort()},i.prototype._setBookingTarget=function(){return this.projectExists?this.booking.attributes.project.cid:this.clientExists?this.booking.attributes.client.cid:this.deletedProjectExists?this.deletedProjects.findWhere({id:this.booking.attributes.project.attributes.id}).cid:this.deletedClientExists?this.deletedClients.findWhere({id:this.booking.attributes.client.attributes.id}).cid:void 0},i.prototype.remove=function(){return this.undelegateEvents(),!this.projectExists&&this.booking.attributes.project&&this.projects.remove(this.deletedProjects.findWhere({id:this.booking.attributes.project.id})),!this.clientExists&&this.booking.attributes.client&&this.clients.remove(this.deletedClients.findWhere({id:this.booking.attributes.client.id})),this.booker_exists||this.bookers.remove(this.booking.attributes.booker),i.__super__.remove.apply(this,arguments)},i.prototype._saveBookingToApi=function(t,e,i,n,o,r){var s,a;return a=RG.Utils.spinnerOverlay($(this.el).closest(".js-edit-booking-popover")[0]),s=new RG.Commands.UpdateBookingCommand({resource:t,booking:this.booking,booker:e,startDate:i.startDate,endDate:i.endDate,target:n,clearTarget:!n,details:o,bookingDuration:r,successCallback:function(e){return function(i){return e.booking&&t.id!==e.booking.collection.resource.id&&e.booking.collection.remove(e.booking),RG.Utils.BookingMerger.merge(t.bookings,[i]),window.update(),a.close(),e.trigger("close"),Q.delay(500).then(function(){return RG.Popovers.popoverActive=!1}),t.bookings.predictWaitingList()}}(this)}),s.removedDatesCallback=function(e){return function(i){var n,o,r,s;return s=new RG.Views.Dialogs.RemovedAvailabilityDates({resource:t,removedAvailabilityDates:i}),n=new RG.Utils.DatePopoverPlacer(t,e.originalDate,{offsetTop:(null!=(r=$(".booking[data-booking-id="+e.booking.id+"]").offset())?r.top:void 0)+40}),o=new RG.Views.Dialogs.BookingClashPopover({removeAttachTo:!0,attachTo:n.createAnchor({className:"booking-clash-popover-anchor"}),body:s,className:"edit-booking-dropdown"}),RG.Popovers.replace({popoverView:o,removeCallback:function(){}})}}(this),s.waitingCallback=function(e){return function(n){var o;return o=new RG.Views.Dialogs.WaitingListConfirmation({resource:t,waitingDates:n,duration:s.bookingDuration.duration,startTime:s.bookingDuration.startTime,startDate:i.startDate,endDate:i.endDate,origin:e,callback:function(){return s.forceWaiting=!0,s.execute()}}),a.close(),o.on("addWaiting",function(){return o.remove(),a=RG.Utils.spinnerOverlay(e.$el.closest(".js-edit-booking-popover")[0])}),e.trigger("changeOverlay",o,{className:"overlay booking-waiting"})}}(this),s.archivedCallback=function(t){return function(e){var i;return e.project_id&&(i=RG.Variables.Validation.Project.Archived),e.client_id&&(i=RG.Variables.Validation.Client.Archived),t.$el.find(".js-booking-date .help-inline.error").text(i).show(),a.close()}}(this),s.execute(),!1},i}(RG.Views.Dialogs.NewBooking)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.EditDowntime=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return this.downtime=t.downtime,this.currentUserId=t.currentUserId,this.resourceSelector=t.resourceSelector,this.resources=t.resources,this.resource=t.selectedResources[0],this.account=this.resource.account,this.selectedResources=t.selectedResources,this.selectedResourceIds=_.map(this.selectedResources,function(t){return t.id}),this.originalResourceIds=_.clone(this.selectedResourceIds),this.bookers=t.bookers,this.selectedTimeZoneOption=this.downtime.getTimeZoneName(),this.dateRange=this.downtime.getDateRange(),this.timeRange=this.downtime.getRawTimeRange(),this.downtimeTypes=t.downtimeTypes,this.timeZones=t.timeZones,this.currentUserTimeZone=t.currentUserTimeZone,this.renderHeader=!0,this.resourceSelector.on("displaySpinner",function(t){return function(){return t.resourceSelector.overlay=RG.Utils.spinnerOverlay($(t.el).closest(".js-edit-downtime-popover")[0]);
}}(this))},i.prototype.createDowntime=function(){var t;return t=RG.Utils.spinnerOverlay($(this.el).closest(".js-edit-downtime-popover")[0]),Q.delay(20).then(function(e){return function(){var i,n,o,r;return n=e.dateTimeRangeSelector.getValues(),e.validate()?(e.rendererLock=new RG.Renderer.GlobalLock,RG.renderer.lock(e.rendererLock),r=e.account.downtimes.findWhere({id:e.downtime.id}),o=_.clone(r.attributes),r.set({saving:!0}),i=new RG.Commands.UpdateDowntimeCommand({downtime:e.downtime,account:e.resource.account,resources:e._getResources(),booker:e._getBooker(),dateTimeRange:n,details:e._getDetails(),timeZones:e.timeZones,timeZone:e._getTimeZone(),type:e._getType(),preExecuteCallback:function(t,i,n){return RG.renderer.unlock(e.rendererLock)},successCallback:function(t){return RG.renderer.unlock(e.rendererLock),r.set({saving:!1}),window.update().then(function(){return RG.Popovers.done(),Q.delay(500).then(function(){return RG.Popovers.popoverActive=!1})})},errorCallback:function(i){return RG.renderer.unlock(e.rendererLock),t.close(),r.set({saving:!1}),e.optionView=new RG.Views.Dialogs.ErrorList({errors:i}),e.trigger("changeOverlay",e.optionView,{className:"overlay availability-waiting"})}}),Q.delay(50).then(function(){return i.willTouchBookings({success:function(n){var s;return s=function(){return RG.renderer.unlock(e.rendererLock),RG.Popovers.removeCallback=null,r.set(o),r.set({saving:!1})},e.optionView=new RG.Views.Dialogs.BookingClashManagement({command:i,clashBookingsCount:n,cancelCallback:s,successCallback:function(){return RG.renderer.unlock(e.rendererLock),RG.Popovers.removeCallback=null,r.set({saving:!1}),window.update()}}),t.close(),e.trigger("changeOverlay",e.optionView,{className:"overlay availability-waiting"}),RG.Popovers.removeCallback=s},fail:function(){return RG.renderer.unlock(e.rendererLock),i.execute()}}),r.set(i.downtime.attributes)})):t.close()}}(this))},i.prototype._fillValues=function(){return i.__super__._fillValues.apply(this,arguments),this.$(".js-downtime-icon").removeClass("rg-icon--vacation").addClass(this.downtime.getTypeIcon()),this.$(".js-time-off-header-text").text("Edit "+this.resource.getHeadingDowntimeText()),this.$("#downtime-details-value").val(this.downtime.get("details")),this.$("#add-downtime").text("Update "+this.resource.getHeadingDowntimeText())},i.prototype._composeDownTimeTypes=function(){return this.downtimeTypeSelector=new RG.Views.Selectors.DowntimeTypeSelector({downtimeTypes:this.downtimeTypes,selectedOption:this.downtime.getDowntimeType()}),this.downtimeTypeSelector.on("change",function(t){return function(e){return t._updateTypeIcon(e)}}(this)),this.$("#downtime-type-options").append(this.downtimeTypeSelector.render().el)},i.prototype._updateTypeIcon=function(t){return this.$(".js-downtime-icon").attr("class","js-downtime-icon "+((null!=t?t.typeIcon():void 0)||"rg-icon--vacation"))},i.prototype._affectedResources=function(){var t;return this.selectedResourceIds=_.map(this.selectedResources,function(t){return t.id}),t=_.uniq(this.originalResourceIds.concat(this.selectedResourceIds)),this.resources.select(function(e){return _.include(t,e.id)})},i.prototype._composeResourceSelector=function(){return this.$(".js-resource-selector").html(this.resourceSelector.render().el),this.resourceSelector.setFilters([{categoryName:"Person",options:[{matchType:"any",name:"Name",selectedOptions:this.selectedResourceIds}]}]),this.resourceSelector.on("change:filter",function(t){return function(){return t.trigger("updatePosition")}}(this))},i}(RG.Views.Dialogs.NewDowntime)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.EditOvertimePopover=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="edit-overtime-dropdown",i.prototype.cssClass="js-edit-overtime-dropdown",i.prototype.events={click:"_stopPropagation"},i.prototype.initialize=function(t){return i.__super__.initialize.apply(this,arguments),this.availabilityConsistent=t.availabilityConsistent,this.availableMinutes=t.availableMinutes,this.overtimeMinutes=t.overtimeMinutes},i.prototype.render=function(){return this.setupEvents(),i.__super__.render.apply(this,arguments)},i.prototype.remove=function(){return this.triggerDone(),i.__super__.remove.apply(this,arguments)},i.prototype.setPosition=function(){var t,e,i;return i=this.attachTo.find(".js-text--edit-overtime"),e=i.position().top,t=i.position().left,this.$(".shadow-arrow").css({top:this.$(".f-dropdown").height()-12,left:t-32}),this.$el.css({position:"absolute",top:e-194,left:t-242})},i.prototype.setupEvents=function(){return this.$el.on("click",".js-cancel",function(t){return function(e){return e.preventDefault(),e.stopPropagation(),t.remove()}}(this)),this.$el.on("click",".js-update",function(t){return function(e){return e.preventDefault(),e.stopPropagation(),t.updateOvertime()}}(this)),this.$el.on("click",".js-edit-overtime",function(t){return function(e){return e.preventDefault(),e.stopPropagation(),t.flagOvertime()}}(this))},i.prototype.triggerDone=function(){return this.trigger("editing:overtime:done")},i.prototype.popup=function(){return null===this.overtimeMinutes?this.setupEditOvertimeView():this.setupFlagOvertimeView(),i.__super__.popup.apply(this,arguments)},i.prototype.setupFlagOvertimeView=function(){var t;return null!=(t=this.bodyView)&&t.remove(),this.setBodyView(new RG.Views.CustomAvailability.FlagOvertimeForm({availabilityConsistent:this.availabilityConsistent,availableMinutes:this.availableMinutes,overtimeMinutes:this.overtimeMinutes}))},i.prototype.setupEditOvertimeView=function(){var t;return null!=(t=this.bodyView)&&t.remove(),this.setBodyView(new RG.Views.CustomAvailability.EditOvertimeForm)},i.prototype.flagOvertime=function(){return this.setupFlagOvertimeView(),this.render()},i.prototype.updateOvertime=function(){return this.trigger("change",this.bodyView.overtimeMinutes),this.remove()},i.prototype._setOpenDirection=function(){return i.__super__._setOpenDirection.apply(this,arguments),this.$el.css({left:""})},i.prototype._stopPropagation=function(t){return t.stopPropagation()},i}(RG.Views.Dialogs.Popover),RG.Views.CustomAvailability.EditOvertimeForm=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="varying-overtime-dropdown",i.prototype.render=function(){return this.$el.empty(),this.$el.append($(document.createElement("p")).text("Overtime varies in this date range.\n Do you want to edit it?")),this.$el.append(this._renderFooter()),this},i.prototype.remove=function(){return this.off(),this.$el.off(),i.__super__.remove.apply(this,arguments)},i.prototype._renderFooter=function(){return this.footer=$(document.createElement("footer")),this.footer.append($(document.createElement("button")).addClass("btn btn-guru js-edit-overtime").text("Edit Overtime")),this.footer.append($(document.createElement("button")).addClass("btn js-cancel").text("Cancel")),this.footer},i}(RG.Views.BaseView),RG.Views.CustomAvailability.FlagOvertimeForm=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="overtime-slider",i.prototype.initialize=function(t){return this.availabilityConsistent=t.availabilityConsistent,this.availableMinutes=t.availableMinutes,this.overtimeMinutes=t.overtimeMinutes},i.prototype.remove=function(){var t;return null!=(t=this.overtimeTextEl)&&t.off(),this.durationSelector&&(this.durationSelector.validate=null,this.durationSelector.remove()),this.overtimeSlider.off(),this._removeEventBindings(),i.__super__.remove.apply(this,arguments)},i.prototype.render=function(){var t,e,i,n;return this.$el.empty(),null!=(i=this.durationSelector)&&i.remove(),this.durationSelector=null,t=$(document.createElement("p")).text,this.$el.append(this._renderOvertimeSlider()),e=+this.availableMinutes,n=e-+this.overtimeMinutes,this.overtimeSlider.noUiSlider({start:[n],range:{min:0,max:e},step:30}).on({change:function(t){return function(){var e;return t._updateOvertimeMinutes(),null!=(e=t.durationSelector)?e.setDuration(t.overtimeMinutes):void 0}}(this),set:function(t){return function(){return t._updateOvertimeMinutes()}}(this),slide:function(t){return function(){return t._updateOvertimeMinutes()}}(this)}),this.availabilityConsistent?this.$el.append(this._renderAvailability()):this.overtimeSlider.hide(),this.$el.append(this._renderFooter()),this.availabilityConsistent||this.toggleManualSet(),this._bindEvents(),this},i.prototype._bindEvents=function(){return $(".availability-tabs__menu a.dropdown-toggle").on("click",function(t){return t.preventDefault(),t.stopPropagation()}),$(".js-edit, .js-add-timeblock").on("click",function(t){return function(e){return t.trigger("close")}}(this))},i.prototype._removeEventBindings=function(){return $(".availability-tabs__menu a.dropdown-toggle").off("click"),$(".js-edit").off("click")},i.prototype.toggleManualSet=function(t){var e,i;return t&&(t.preventDefault(),t.stopPropagation()),this.durationSelector?(this.overtimeSlider.noUiSlider({step:30},!0),this.durationSelector.remove(),this.durationSelector=null,this.$el.find(".js-manual-set-controls").remove(),null):(this.overtimeSlider.noUiSlider({step:1},!0),i=$(document.createElement("div")).addClass("overtime-fine-controls js-manual-set-controls"),this.durationSelector=new RG.Views.Selectors.Duration({duration:this.overtimeMinutes,typeName:"Overtime",inlineHelpText:"Cannot assign more overtime than available time."}),this.durationSelector.validate=this.validate.bind(this),this.durationSelector.validate(),e=$(this.durationSelector.render().el),e.find(".alt-toggle").remove(),i.append(e),this.footer.prepend(i))},i.prototype.validate=function(){var t;return t=!1,this.overtimeSlider.val(this.availableMinutes-this.durationSelector.getDuration()),this.overtimeMinutes=this.durationSelector.getDuration(),this.overtimeMinutes>0&&(this.overtimeMinutes>this.availableMinutes?(t=!0,this.$(".help-inline.error").text("Hours must fall within the available time")):t=!1),this.durationSelector.toggleError(t),this.$(".js-update").attr("disabled",t?"disabled":null),!t},i.prototype._renderOvertimeSlider=function(){return this.overtimeSlider=$(document.createElement("div")),this.overtimeSlider},i.prototype._renderAvailability=function(){return null==this.overtimeTextEl&&(this.overtimeTextEl=$(document.createElement("strong")).addClass("text--edit-overtime")),this.overtimeTextEl.on("click",this.toggleManualSet.bind(this)),null==this.availabilityTextEl&&(this.availabilityTextEl=$(document.createElement("span"))),null==this.availabilityEl&&(this.availabilityEl=$(document.createElement("p"))),this.availabilityTextEl.text(RG.Utils.TimeFormatter.formatMinutes(this.availableMinutes)+" availability, of which "),this._changeOverTimeText(),this.availabilityEl.append(this.availabilityTextEl),this.availabilityEl.append(this.overtimeTextEl)},i.prototype._changeOverTimeText=function(){if(this.availabilityConsistent)return this.overtimeTextEl.text(RG.Utils.TimeFormatter.formatMinutes(this.overtimeMinutes)+" is overtime")},i.prototype._updateOvertimeMinutes=function(){return this.overtimeMinutes=+this.availableMinutes-+this.overtimeSlider.val(),this._changeOverTimeText()},i.prototype._renderFooter=function(){return this.footer=$(document.createElement("footer")),this.footer.append($(document.createElement("button")).addClass("btn btn-guru btn--small js-update").text("Flag Overtime")),this.footer.append("\n"),this.footer.append($(document.createElement("button")).addClass("btn btn--small js-cancel").text("Cancel")),this.footer},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.EditTimeBlockDropdown=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.cssClass="add-timeblock-dropdown",i.prototype.events={"click .js-cancel-button":"close",click:"closeSelector"},i.prototype.initialize=function(t){return this.newTimeBlockStartTime=t.newTimeBlockStartTime,this.newTimeBlockEndTime=t.newTimeBlockEndTime,i.__super__.initialize.apply(this,arguments)},i.prototype.close=function(){return this.trigger("close")},i.prototype.remove=function(){return this.attachTo=null,i.__super__.remove.apply(this,arguments)},i.prototype.setBodyView=function(){return i.__super__.setBodyView.apply(this,arguments),this.bodyView.on("add",function(t){return function(e){return t.trigger("update",e)}}(this)),this.bodyView.on("remove",function(t){return function(e){return t.trigger("remove",e)}}(this))},i.prototype.closeSelector=function(t){if(this.bodyView.closeSelector(),t)return t.stopPropagation()},i.prototype.popup=function(){return this.setBodyView(new RG.Views.CustomAvailability.EditTimeBlock({newTimeBlockStartTime:this.newTimeBlockStartTime,newTimeBlockEndTime:this.newTimeBlockEndTime})),i.__super__.popup.apply(this,arguments)},i}(RG.Views.Dialogs.Popover)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.ErrorList=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("dialogs/error_list"),i.prototype.initialize=function(t){return null==t&&(t={}),this.errors=t.errors},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this._bindEvents(),this},i.prototype.cancel=function(t){return t.preventDefault(),this.trigger("close"),t.stopPropagation()},i.prototype._fillValues=function(){var t,e,i,n,o,r,s,a;e=this.$(".js-alert-error"),a=[],s=this.errors;for(t in s){for(n=s[t],a.push("<p>"+t+":</p>"),a.push("<ul>"),o=0,r=n.length;o<r;o++)i=n[o],a.push("<li>"+i+"</li>");a.push("</ul>")}return this.$(".js-alert-error").html(a.join(""))},i.prototype._bindEvents=function(){return this.$el.on("click",".js-ok",function(t){return function(){return t.trigger("close")}}(this))},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.NewBookingDowntimePopover=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("dialogs/new_booking_downtime_popover"),i.prototype.className="booking-dropdown js-booking-downtime-new",i.prototype.events={"click #new-booking":"newBooking","click #new-downtime":"newDowntime"},i.prototype.initialize=function(t){return this.newBookingOptions=t,this.cssClass="new-booking-time-off",this.permissions=t.permissions||RG.Utils.Permissions,i.__super__.initialize.apply(this,arguments)},i.prototype.render=function(){return this.$el.html(this.template()),window.rgFeatures.TimeOff&&this.toggleActiveTab("booking"),this._fillValues(),this._applyPermissions(),this},i.prototype._fillValues=function(){var t;if(i.__super__._fillValues.apply(this,arguments),!(null!=(t=this.newBookingOptions.resource)?t.isHuman():void 0))return this.$(".js-time-off-text").text("Downtime")},i.prototype._bindEvents=function(){return this.bodyView.on("change",function(t){return function(e){if(e&&e.startDate&&e.endDate)return t.newBookingOptions.dateRange=e,t.newBookingOptions.changeCallback(e)}}(this))},i.prototype.remove=function(){var t;return this.newBookingOptions.attachTo.remove(),"function"==typeof(t=this.newBookingOptions).removeCallback&&t.removeCallback(),i.__super__.remove.apply(this,arguments)},i.prototype.popup=function(){return this.bodyView=new RG.Views.Dialogs.NewBooking(this.newBookingOptions),i.__super__.popup.apply(this,arguments)},i.prototype._getContentPanel=function(){return this.el.querySelector(".tabs-content")},i.prototype.setBodyView=function(t,e){return null==e&&(e={render:!0}),i.__super__.setBodyView.apply(this,arguments),this._bindEvents()},i.prototype.newBooking=function(t){return t.preventDefault(),this.setBodyView(new RG.Views.Dialogs.NewBooking(this.newBookingOptions)),this.toggleActiveTab("booking")},i.prototype.newDowntime=function(t){var e,i,n,o;return t.preventDefault(),o=new RG.Views.Factories.NameSearch(this.newBookingOptions.resources).create({showMenu:!0,cssClass:"js-downtime-resource-selector",resourceSelector:!0}),o.on("displaySpinner",function(t){return function(){var e;return o.overlay=new RG.Views.Dialogs.Overlay({attachTo:t.el,className:"overlay",template:function(){return""}}),o.overlay.render(),e=new Spinner(t.spinnerOptions).spin(o.overlay.el)}}(this)),n=function(t){return function(){return window.requestAnimationFrame(function(){return t.setPosition(),$(window).trigger("scroll")})}}(this),o.on("change:filter",n),i=_.extend({resourceSelector:o},this.newBookingOptions),i.timeRange=new RG.Utils.TimeRange(0,1440),e=new RG.Views.Dialogs.NewDowntime(i),e.on("validate",n),this.setBodyView(e),this.toggleActiveTab("downtime")},i.prototype.toggleActiveTab=function(t){return this.$(".tab-title").removeClass("active"),this.$("."+t+"-tab").addClass("active"),this.setPosition()},i.prototype._applyPermissions=function(){if(this.permissions.canAddDowntime()||this.$(".downtime-tab").remove(),!this.permissions.canAddBooking())return window.requestAnimationFrame(function(t){return function(){return t.$(" #new-downtime").click(),t.$(".booking-tab").remove()}}(this))},i}(RG.Views.Dialogs.Popover)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.NewClient=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("dialogs/new_client"),i.prototype.events={"submit form":"triggerAddClient","click .add-client":"addClient","click .cancel":"cancel"},i.prototype.initialize=function(t){return null==t&&(t={}),this.colorPicker=t.colorPicker||new RG.Views.Selectors.ColorPicker},i.prototype.render=function(){return this.$el.html(this.template()),this.$("dl").append(this.colorPicker.render().el),this},i.prototype.addClient=function(){var t;if(this._validate())return t={name:this.$("input.client-name").val().trim(),color:this.$(".color").val()},this.disableButtons(),$.ajax(RG.getApiRoot()+"/clients",{method:"POST",data:t,dataType:"json",headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")},success:function(t){return function(e){var i;return i=new RG.Models.Client({id:e.id,color:e.color,name:e.name,archived:e.archived,notes:e.notes}),window.clients.add(i),t.trigger("close",i)}}(this),error:function(e){return function(i){return e.enableButtons(),e.addErrorMessageByStatusCode(i.status,t.name),e.$("input.client-name").focus()}}(this)})},i.prototype.addErrorMessageByStatusCode=function(t,e){return 403===parseInt(t,10)?this.$(".help-inline").addClass("error").text("Sorry, you don't have permission to do that.").removeClass("hide"):this.$(".help-inline").addClass("error").text("Sorry, a client with that name already exists.").removeClass("hide")},i.prototype.cancel=function(t){return t.cancelBubble=!0,t.stopPropagation(),this.trigger("cancelled"),this.trigger("close")},i.prototype.remove=function(){return this.off(),this.$el.off(),i.__super__.remove.apply(this,arguments)},i.prototype.disableButtons=function(){return this.$("footer button").attr("disabled","disabled"),this.$("footer .js-add-client").text("Busy, please wait...")},i.prototype.enableButtons=function(){return this.$("footer .js-add-client").text("Add Client"),this.$("footer button").attr("disabled",null)},i.prototype.triggerAddClient=function(){return this.addClient(),!1},i.prototype._validate=function(){return 0===this.$("input.client-name").val().trim().length?(this.$("span.help-inline").addClass("error").text("Please enter a name").removeClass("hide"),this.$("input.client-name").addClass("error"),!1):(this.$("span.help-inline").text("").addClass("hide"),this.$("input.client-name").removeClass("error"),!0)},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.NewProject=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("dialogs/new_project"),i.prototype.events={"submit form":"triggerAddProject","click .add-project":"addProject","click .cancel":"cancel","click .chzn-single":"shrinkDropdown"},i.prototype.initialize=function(t){return null==t&&(t={}),this.clients=t.clients,this.listenTo(this.clients,"add",this._createClientsSelect),this.listenTo(this.clients,"remove",this._createClientsSelect),this.listenTo(this.clients,"add",this._selectClient),this.selectedClient=t.selectedClient,this.colorPicker=t.colorPicker||new RG.Views.Selectors.ColorPicker},i.prototype.render=function(){return this.$el.html(this.template()),this._createClientsSelect(),this.selectedClient&&(this._selectClient(this.selectedClient),this.selectedClient=null),this.$("dl").append(this.colorPicker.render().el),this},i.prototype.addProject=function(){var t,e;if(this._validate())return t=this.clients.find(function(t){return function(e){return e.cid===t.selectBox.val()}}(this)),e={name:this.$("input.project-name").val().trim(),color:this.$(".color").val(),client_id:null!=t?t.id:void 0},this.disableButtons(),$.ajax(RG.getApiRoot()+"/projects",{method:"POST",data:e,dataType:"json",headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")},success:function(e){return function(i){var n;return n=new RG.Models.Project({id:i.id,name:i.name,archived:i.archived,notes:i.notes,client:t}),i.color&&n.set("color","#"+i.color),window.projects.add(n),e.trigger("close")}}(this),error:function(t){return function(i){return t.enableButtons(),t.addErrorMessageByStatusCode(i.status,e.name),t.$("input.project-name").focus()}}(this)})},i.prototype.addErrorMessageByStatusCode=function(t,e){if(403===parseInt(t,10))return this.$(".help-inline").addClass("error").text("Sorry, you don't have permission to do that.").removeClass("hide")},i.prototype.cancel=function(t){return t.cancelBubble=!0,t.stopPropagation(),this.trigger("cancelled"),this.trigger("close")},i.prototype.clearClientOrProject=function(){return this.selectBox.val("").trigger("liszt:updated")},i.prototype.disableButtons=function(){return this.$("footer button").attr("disabled","disabled"),this.$("footer .js-add-project").text("Busy, please wait...")},i.prototype.enableButtons=function(){return this.$("footer .js-add-project").text("Add Project"),this.$("footer button").attr("disabled",null)},i.prototype.triggerAddProject=function(){return this.addProject(),!1},i.prototype.remove=function(){var t;return this.off(),this.$el.off(),null!=(t=this.modal)&&t.remove(),i.__super__.remove.apply(this,arguments)},i.prototype._createClientsSelect=function(){return this.selectBox=$('<select data-optional="true" data-placeholder="Please select (optional)" style=\'width: 234px\'><option></option></select>'),this.selectBox.change(function(t){return function(){return t._clientChanged()}}(this)),this._fillClientSelect(),this.$(".client-select-field").html(this.selectBox),this.selectBox.chosen({allow_single_deselect:!0})},i.prototype._fillClientSelect=function(){var t,e,i,n;for(this.selectBox.html('<option></option><option value="new-client">New client...</option>'),n=this.clients.models,e=0,i=n.length;e<i;e++)t=n[e],t.get("archived")||this.selectBox.append('<option value="'+t.cid+'">'+t.getName()+"</option>");return this.selectBox.trigger("liszt:updated")},i.prototype._clientChanged=function(){if("new-client"===this.selectBox.val())return localStorage.newProject=JSON.stringify({name:this.$(".project-name").val(),color:this.$(".color").val()}),this.modal=new RG.Views.Dialogs.NewClient,this.modal.on("close",function(t){return function(e){return t.trigger("changeOverlay",t,{className:"overlay client",client:e}),t._fillInPreviousValues()}}(this),this),this.trigger("changeOverlay",this.modal,{className:"overlay client",newClient:!0})},i.prototype._fillInPreviousValues=function(){var t;if(localStorage.newProject)return t=$.parseJSON(localStorage.newProject),$(".project-name").val(t.name),$(".color").val(t.color),$(".selected-color").css("background-color","#"+t.color),localStorage.removeItem("newProject")},i.prototype._validate=function(){return 0===this.$("input.project-name").val().trim().length?(this.$("span.help-inline").addClass("error").text("Please enter a name").removeClass("hide"),this.$("input.project-name").addClass("error"),!1):(this.$("span.help-inline").text("").addClass("hide"),this.$("input.project-name").removeClass("error"),!0)},i.prototype._selectClient=function(t){return this.selectBox.val(t.cid).trigger("liszt:updated")},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.RemovedAvailabilityDates=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("dialogs/removed_availability_dates"),i.prototype.initialize=function(t){return null==t&&(t={}),this.resource=t.resource,this.removedAvailabilityDates=t.removedAvailabilityDates},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this._bindEvents(),this},i.prototype.close=function(t){return RG.Popovers.locked=!1,this.trigger("close")},i.prototype._bindEvents=function(){return this.$el.on("click",".js-ok",function(t){return function(){return t.close()}}(this))},i.prototype._fillValues=function(){var t;return t=[],this.resource.isHuman()?this.$(".js-warning-title").text("Non-working "+this._pluralizeDays()+" Skipped"):this.$(".js-warning-title").text("Downtime "+this._pluralizeDays()+" Skipped"),t.push("<p>Just a heads up, "),t.push("<strong class='booking-clash-resource-name'>"+this.resource.escape("name")+"</strong> has "+this._timeOffOrDowntime()+" on "+this._pluralizeDates()),t.push("</p>"),this.removedAvailabilityDates.length>5?t.push("<p class='has-margin-left'>... and "+(this.removedAvailabilityDates.length-5)+" "+this._pluralizeOther()+"</p>"):t.push("</p>"),this.$(".js-booking-non-working-dates-details").html(t.join(""))},i.prototype._pluralizeDays=function(){return this.removedAvailabilityDates.length>1?"Days":"Day"},i.prototype._pluralizeDates=function(){var t;return t=RG.Utils.BookingDataParser.getDateFromStr(this.removedAvailabilityDates[0]),this.removedAvailabilityDates.length>1?"the following dates so they were skipped: <ul>"+this._getRemovedAvailabilityDatesListItems()+"</ul>":RG.Utils.DateFormatter.getLongDateWithYear(t)+"."},i.prototype._pluralizeOther=function(){return this.removedAvailabilityDates.length-5>1?"others":"other"},i.prototype._timeOffOrDowntime=function(){return this.resource.isHuman()?"time off":"downtime"},i.prototype._getRemovedAvailabilityDates=function(){return _.map(this.removedAvailabilityDates,function(t){return RG.Utils.DateFormatter.getLongDateWithYear(RG.Utils.BookingMerger.getDateFromStr(t))})},i.prototype._getRemovedAvailabilityDatesListItems=function(){var t,e,i;return e=this._getRemovedAvailabilityDates(),i=_.first(e,5),t=_.map(i,function(t){return"<li>"+t+"</li>"}),t.join("")},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.ResourceListPopover=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="resources-list-dropdown",i.prototype._setOpenRight=function(){return i.__super__._setOpenRight.apply(this,arguments),this.$el.css({left:360})},i.prototype._setOpenLeft=function(){return i.__super__._setOpenLeft.apply(this,arguments),this.$el.css({left:100})},i.prototype._getOpenDirection=function(){var t,e,i,n;return t=$(window),n=t.scrollLeft()+t.width(),e=this.$el.offset(),i=$(this.el.firstChild).outerWidth(),"left"===this.openDirection||n<=e.left+i+52+360?"left":"right"},i.prototype.setPosition=function(){var t;return i.__super__.setPosition.apply(this,arguments),t=this.$(".shadow-arrow"),t.css({top:t.position().top-15})},i}(RG.Views.Dialogs.Popover),RG.Views.Dialogs.ResourceList=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="main",i.prototype.render=function(){for(var t,e,i,n;this.el.firstChild;)this.el.removeChild(this.el.firstChild);for(i=this.collection.models,t=0,e=i.length;t<e;t++)n=i[t],this._renderResource(n);return this},i.prototype._renderResource=function(t){var e,i;return i=new RG.Views.Resource.Avatar({resource:t}),e=$(document.createElement("div")).addClass("resources-list__resource"),e.append(i.render().el),e.append($(document.createElement("span")).addClass("resources-list__resource-name").text(t.getName())),this.$el.append(e)},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.SingleBookingDetailsActions=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="ul",i.prototype.className="booking-actions",i.prototype.template=templates.find("dialogs/booking_details_single_actions"),i.prototype.initialize=function(t){return this.booking=t.booking,this.bookingFormFactory=t.bookingFormFactory},i.prototype.deleteBooking=function(){return RG.Popovers.clear(),RG.Utils.BookingService.deleteBooking(this.booking,function(t){return function(){return t.trigger("close")}}(this)),!1},i.prototype.editBooking=function(){var t;return t=this.bookingFormFactory.createEdit({booking:this.booking}),this.trigger("changeView",t),!1},i.prototype.render=function(){return this.$el.html(this.template()),this._bindEvents(),this},i.prototype._bindEvents=function(){return this.$el.on("click","a#edit-booking",function(t){return function(){return t.editBooking()}}(this)),this.$el.on("click","a#delete-booking",function(t){return function(){return t.deleteBooking()}}(this))},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.SplitBooking=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="calendar-split",i.prototype.template=templates.find("dialogs/split_booking"),i.prototype.events={"click #split-booking":"splitBooking","click #cancel":"cancel"},i.prototype.initialize=function(t){return this.booking=t.booking,this.splitDate=t.splitDate},i.prototype.cancel=function(){return this.trigger("close")},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this},i.prototype.popup=function(){return this.render(),this.$el.modal()},i.prototype.splitBooking=function(){var t;return this._disableButtons(),t=RG.Utils.spinnerOverlay($(this.el).closest(".js-edit-booking-popover")[0]),RG.Utils.BookingService.split(this.booking,this.splitDate),
t.remove(),this.trigger("close"),!1},i.prototype._disableButtons=function(){return $("footer button").attr("disabled","disabled"),$("footer #split-booking").text("Busy, please wait...")},i.prototype._fillValues=function(){var t,e,i,n;return t=this.booking.getDateRange(),i=new Date(this.splitDate.getFullYear(),this.splitDate.getMonth(),this.splitDate.getDate()-1),e=new RG.Utils.DateRange(t.startDate,i),n=new RG.Utils.DateRange(this.splitDate,t.endDate),this.$(".split.block1").text(e.toString()),this.$(".split.block2").text(n.toString())},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.SplitDowntime=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="calendar-split",i.prototype.template=templates.find("dialogs/split_downtime"),i.prototype.events={"click #split-downtime":"splitDowntime","click #cancel":"cancel"},i.prototype.initialize=function(t){return this.account=t.account,this.resources=t.resources,this.downtime=t.downtime,this.splitDate=t.splitDate},i.prototype.cancel=function(){return this.trigger("close")},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this},i.prototype.popup=function(){return this.render(),this.$el.modal()},i.prototype.splitDowntime=function(){var t;return this._disableButtons(),t=RG.Utils.spinnerOverlay($(this.el).closest(".js-edit-downtime-popover")[0]),RG.Utils.DowntimeService.split(this.downtime,this.splitDate),t.remove(),this.trigger("close"),!1},i.prototype._disableButtons=function(){return $("footer button").attr("disabled","disabled"),$("footer #split-booking").text("Busy, please wait...")},i.prototype._fillValues=function(){var t,e,i,n;if(t=this.downtime.getDateRange(),i=new Date(this.splitDate.getFullYear(),this.splitDate.getMonth(),this.splitDate.getDate()-1),e=new RG.Utils.DateRange(t.startDate,i),n=new RG.Utils.DateRange(this.splitDate,t.endDate),this.$(".split.block1").text(e.toString()),this.$(".split.block2").text(n.toString()),this._hasHumanResources())return this.$(".js-title-downtime-type").text("Split this series of events into two blocks?"),this.$(".js-button-downtime-type").text("Time Off")},i.prototype._hasHumanResources=function(){return this.resources.some(function(t){return t.isHuman()})},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.TagWrapper=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){if(this.view=t.view,this.tagName=t.tagName,this.view)return this.view.on("all",function(t){return function(){return t.trigger.apply(t,arguments)}}(this)),this.el.appendChild(this.view.el)},i.prototype.render=function(){var t;return null!=(t=this.view)&&t.render(),this},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Dialogs.WaitingListConfirmation=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("dialogs/waiting_list_confirmation"),i.prototype.initialize=function(t){return null==t&&(t={}),this.resource=t.resource,this.waitingDates=t.waitingDates,this.bookingDuration=t.duration,this.bookingStartTime=t.startTime,this.bookingStartDate=t.startDate,this.bookingEndDate=t.endDate,this.callback=t.callback,this.cancelCallback=t.cancelCallback},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this._bindEvents(),this},i.prototype.addWaiting=function(){return RG.Popovers.locked=!1,this.callback(),this.cancelCallback=null,this.trigger("addWaiting")},i.prototype.cancel=function(t){return RG.Popovers.locked=!1,this.cancelCallback&&this.cancelCallback(),this.trigger("close")},i.prototype._fillValues=function(){var t;return t=[],t.push("<p>Sorry, "),t.push("<strong class='booking-clash-resource-name'>"+this.resource.escape("name")+"</strong> is not available for that amount of time on "+this._pluralizeSelectedDates()+"."),RG.Utils.DateComparator.equalsYMD(this.bookingStartDate,this.bookingEndDate)?(t.push(this._goAhead()),t.push("</p>")):(t.push(" Clashes include:"),t.push("</p>"),t.push("<ul>"+this._getWaitingDatesListItems()+"</ul>"),this.waitingDates.length>5&&t.push("<p class='has-margin-left'>... and "+(this.waitingDates.length-5)+" "+this._pluralizeOther()+"</p>"),t.push(this._goAhead()),$(".add-waiting").text("Add To Waiting List Where Time Unavailable")),this.$(".js-booking-clash-details").html(t.join(""))},i.prototype._pluralizeSelectedDates=function(){return RG.Utils.DateComparator.equalsYMD(this.bookingStartDate,this.bookingEndDate)?""+RG.Utils.DateFormatter.getLongDateWithYear(this.bookingStartDate):"all the dates selected"},i.prototype._pluralizeOther=function(){return this._shouldPluralize()?"others":"other"},i.prototype._pluralizeClashes=function(){return this.waitingDates.length>1?"any clashes":"the clash"},i.prototype._shouldPluralize=function(){return this.waitingDates.length-5>1},i.prototype._goAhead=function(){return"<p class='has-margin-top'>You can still go ahead with your booking and add "+this._pluralizeClashes()+" to the waiting list.</p>"},i.prototype._bindEvents=function(){return this.$el.on("click",".cancel",function(t){return function(){return t.cancel()}}(this)),this.$el.on("click",".add-waiting",function(t){return function(){return t.addWaiting()}}(this))},i.prototype._getBookingDateRange=function(){return RG.Utils.DateFormatter.getLongDateWithYear(this.bookingStartDate)+" and "+RG.Utils.DateFormatter.getLongDateWithYear(this.bookingEndDate)},i.prototype._getWaitingDates=function(){return _.map(this.waitingDates,function(t){return RG.Utils.DateFormatter.getLongDateWithYear(RG.Utils.BookingMerger.getDateFromStr(t))})},i.prototype._getWaitingDatesListItems=function(){var t,e,i;return e=this._getWaitingDates(),i=_.first(e,5),t=_.map(i,function(t){return"<li>"+t+"</li>"}),t.join("")},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Downtimes.Resources=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="span",i.prototype.className="downtime-resource",i.prototype.events={"click .js-expand-resources":"expandTruncatedResources"},i.prototype.initialize=function(t){return this.resources=t.resources,this.truncate=void 0===t.truncate||t.truncate},i.prototype.render=function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild);return this._renderResources(),this},i.prototype.expandTruncatedResources=function(t){return null==this.resourcesPopover&&(this.resourcesPopover=new RG.Views.Dialogs.ResourceListPopover({attachTo:this.$(".js-expand-resources")})),this.resourcesPopover.setBodyView(new RG.Views.Dialogs.ResourceList({collection:new RG.Collections.ResourceInstances(this.resources)})),RG.Popovers.nest(this.resourcesPopover),this.resourcesPopover.popup(),t.stopPropagation()},i.prototype._renderResources=function(){var t,e,i,n,o,r,s,a,l;if(this.resources.length>8&&this.truncate){for(o=this.resources.slice(0,9),t=0,i=o.length;t<i;t++)s=o[t],this._renderResource(s);return this._renderTruncatedResourceText()}if(1===this.resources.length)return this.resources[0].hasAvatar()&&this._renderResource(this.resources[0]),a=$(document.createElement("span")).addClass("resource-name"),this.$el.append(a.text(this.resources[0].getName()));for(r=this.resources,l=[],e=0,n=r.length;e<n;e++)s=r[e],l.push(this._renderResource(s));return l},i.prototype._renderResource=function(t){var e;return e=new RG.Views.Resource.Avatar({resource:t}),this.$el.append(e.render().el)},i.prototype._renderTruncatedResourceText=function(){if(this.resources.length>9)return this.$el.append('<a class="js-expand-resources expand-resources-link">and '+(this.resources.length-9)+" more</a>")},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Filters.Categories=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="filter__categories",i.prototype.events={"click .filter__category":"toggleCategory"},i.prototype.addItem=function(t){var e;return e=i.__super__.addItem.apply(this,arguments),e.on("change:filter",function(t){return function(){return t.trigger("change:filter",t.getSelectedOptions())}}(this))},i.prototype.clearSelection=function(){var t,e,i,n;e=this.collectionViews,i=[];for(t in e)n=e[t],i.push(n.clearSelection());return i},i.prototype.createItemView=function(t){return new RG.Views.Filters.Category({category:t.model})},i.prototype.getFilters=function(){return _.flatten(_.map(this.collectionViews,function(t){return t.getFilters()}))},i.prototype.getSelectedOptions=function(){return _.flatten(_.map(this.collectionViews,function(t){return t.getSelectedOptions()}))},i.prototype.resetFlyouts=function(){return this.$(".filter__category").removeClass("is-active")},i.prototype.setFilters=function(t){var e,i,n,o;this.clearSelection(),i=this.collectionViews,n=[];for(e in i)o=i[e],n.push(o.setFilters(t));return n},i.prototype.toggleCategory=function(t){var e,i,n,o,r;if(RG.closeSelectedOptions(),o=this.$(t.currentTarget),n=this.$(t.target),!(n.closest(".filter__category__filters").length>0))return r=o.hasClass("is-active"),this.resetFlyouts(),o.toggleClass("is-active",!r),i=o.find(".filter__category__filters"),i.css({width:""}),e=i.find("> div"),e.css({"overflow-y":"",height:"",width:""}),$(window).height()<e.offset().top+e.height()-$(window).scrollTop()&&(e.outerHeight($(window).height()-e.offset().top-25+$(window).scrollTop()).css({"overflow-y":"scroll"}),e.width(e.width()+10),i.width(i.width()+10)),this.$(".filter__options-control .select2-search-field:first-child input.select2-input").width("295px"),!1},i}(RG.Support.CollectionView)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;RG.Views.Filters.Category=function(i){function n(){return this._triggerChange=t(this._triggerChange,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.template=templates.find("filters/category"),n.prototype.className="filter__category",n.prototype.events={"click .filter__clear":"clearSelection","click .filter__category__filters":"clearInputs"},n.prototype.clearSelection=function(){var t,e;return null!=(t=$(".match-type-select.select2-container-active"))&&null!=(e=t.data("select2"))&&e.close(),this.filterCategoryOptionsView.off("change:filter",this._triggerChange),this.filterCategoryOptionsView.clearSelection(),this.filterCategoryOptionsView.on("change:filter",this._triggerChange),this.trigger("change:filter"),!1},n.prototype.clearInputs=function(t){return RG.Utils.select2Close()},n.prototype.getFilters=function(){return this.filterCategoryOptionsView.getFilters()},n.prototype.getSelectedOptions=function(){var t;return(null!=(t=this.filterCategoryOptionsView)?t.getSelectedOptions():void 0)||[]},n.prototype.initialize=function(t){return this.category=t.category,this.on("change:filter",this.refreshSelectedOptionsView,this)},n.prototype.refreshSelectedOptionsView=function(){var t;return t=this.getSelectedOptions(),this.selectedOptionsView.setSelectedOptions(t),this.$(".filter__clear").toggle(t.length>0)},n.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this},n.prototype.setFilters=function(t){return this.filterCategoryOptionsView.setFilters(t)},n.prototype.showOptionsFlyout=function(){return this.$el.addClass("is-active")},n.prototype.hideOptionsFlyout=function(){return this.$el.removeClass("is-active")},n.prototype._getFilterCategoryOptionsElement=function(){return this.$(".filter__category__filters")},n.prototype._getSelectedOptionsElement=function(){return this.$(".filter__category--selected-options")},n.prototype._fillValues=function(){return this.$(".filter__category--name").html(this.category.getName()),this.filterCategoryOptionsView=new RG.Views.Filters.CategoryOptions({category:this.category}),this.filterCategoryOptionsView.on("change:filter",this._triggerChange),this.selectedOptionsView=new RG.Views.Filters.SelectedOptions,this._getSelectedOptionsElement().replaceWith(this.selectedOptionsView.render().el),this.refreshSelectedOptionsView(),this._getFilterCategoryOptionsElement().replaceWith(this.filterCategoryOptionsView.render().el)},n.prototype._triggerChange=function(){return this.trigger("change:filter",this.getSelectedOptions())},n}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Filters.CategoryOptions=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("filters/category_options"),i.prototype.className="filter__category__filters",i.prototype.events={"click .filter__options--all":"toggleSelectAll"},i.prototype.clearSelection=function(){if(this.filterOptionGroupsView.clearSelection(),this._selectAllOption)return this.toggleSelectAll()},i.prototype.getFilters=function(){var t;return t=_.map(this.filterOptionGroupsView.collectionViews,function(t){return t.getOptions()}),this._selectAllOption?{categoryName:this.category.getName(),mode:"all",options:t}:{categoryName:this.category.getName(),options:t}},i.prototype.getSelectedOptions=function(){var t;return this._selectAllOption?[{matchType:"all",resourceType:this.category.get("tag")}]:null!=(t=this.filterOptionGroupsView)?t.getSelectedOptions():void 0},i.prototype.initialize=function(t){return this._selectAllOption=!1,this.category=t.category},i.prototype.render=function(){return this.$el.html(this.template({tooltip:this._mustRenderTooltip()})),this._fillValues(),this.$(".filter__info-tooltip").tooltip(),this},i.prototype.setFilters=function(t){var e,i,n,o,r,s;for(r=[],n=0,o=t.length;n<o;n++)i=t[n],this.category.get("name")===i.categoryName&&("all"===i.mode?(this._selectAllOption=!1,r.push(this.toggleSelectAll())):(this._selectAllOption&&this.toggleSelectAll(),r.push(function(){var i,n;i=this.filterOptionGroupsView.collectionViews,n=[];for(e in i)s=i[e],n.push(s.setFilters(t));return n}.call(this))));return r},i.prototype.toggleSelectAll=function(t){return this._selectAllOption=!this._selectAllOption,this.filterOptionGroupsView.$el.toggle(!this._selectAllOption),this._getResetSpan().toggle(this._selectAllOption),this._getSelectAllSpan().toggle(!this._selectAllOption),this.$el.toggleClass("is-select-all",this._selectAllOption),this.trigger("change:filter",this.getSelectedOptions())},i.prototype._fillValues=function(){return this.$("h3").text(this.category.getName()),this.filterOptionGroupsView=new RG.Views.Filters.OptionGroups({category_type:this.category.getName(),collection:this.category.optionGroups}),this.filterOptionGroupsView.on("change:filter",function(t){return function(e){return t.trigger("change:filter",t.getSelectedOptions())}}(this)),this._getFilterOptionsElement().replaceWith(this.filterOptionGroupsView.render().el),this.$(".filter__options--all").toggle(this._mustRenderAllToggle())},i.prototype._getFilterOptionsElement=function(){return this.$(".filter__options")},i.prototype._getResetSpan=function(){return this.$(".reset-select-all-filters")},i.prototype._getSelectAllSpan=function(){return this.$(".select-all-filters")},i.prototype._mustRenderAllToggle=function(){return["Projects","Clients"].indexOf(this.category.getName())===-1},i.prototype._mustRenderTooltip=function(){return["Projects","Clients"].indexOf(this.category.getName())===-1},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Filters.OptionGroups=function(e){function i(t){i.__super__.constructor.apply(this,arguments),this.category_type=t.category_type}return t(i,e),i.prototype.createItemView=function(t){return new RG.Views.Filters.OptionGroup({optionGroup:t.model})},i.prototype.addItem=function(t){var e;return e=i.__super__.addItem.apply(this,arguments),e.on("change:filter",function(t){return function(e){return t.trigger("change:filter",t.getSelectedOptions())}}(this))},i.prototype.clearSelection=function(){var t,e,i,n;e=this.collectionViews,i=[];for(t in e)n=e[t],i.push(n.clearSelection());return i},i.prototype.getSelectedOptions=function(){return _.compact(_.flatten(_.map(this.collectionViews,function(t){return t.getSelectedOptions()})))},i}(RG.Support.CollectionView)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;RG.Views.Filters.SavedFilter=function(i){function n(){return this._handleInputKeyDown=t(this._handleInputKeyDown,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.template=templates.find("filters/saved_filter"),n.prototype.className="filter__saved-filter",n.prototype.events={click:"activateFilter","click .delete-filter":"deleteFilter","click .rename-filter":"enableRename","click .save-rename-filter":"_saveRename","blur .filter__saved-filter-input":"_saveRename",keypress:"_handleInputKeyDown"},n.prototype.initialize=function(t){return this.savedFilter=t.savedFilter,this.listenTo(this.savedFilter,"change",this.render)},n.prototype.activateFilter=function(t){var e,i;return null!=(e=$(".match-type-select.select2-container-active"))&&null!=(i=e.data("select2"))&&i.close(),this.trigger("activate:filter",this.savedFilter),!1},n.prototype.addActiveState=function(){return this.$el.addClass("is-active")},n.prototype.deleteFilter=function(t){var e,i;return null!=(e=$(".match-type-select.select2-container-active"))&&null!=(i=e.data("select2"))&&i.close(),this.savedFilter.destroy(),!1},n.prototype.disableRename=function(){return setTimeout(function(t){return function(){return $(document).off("keyup",t._handleInputKeyDown)}}(this),100),this.$(".filter__saved-filter-name").show(),this.$(".filter__saved-filter-input").hide(),this.$(".save-rename-filter").hide(),this.$(".rename-filter").show(),this.$el.removeClass("is-editing")},n.prototype.enableRename=function(){var t,e;return $(document).on("keyup",this._handleInputKeyDown),null!=(t=$(".match-type-select.select2-container-active"))&&null!=(e=t.data("select2"))&&e.close(),this.$(".filter__saved-filter-input").show().focus().select(),this.$(".filter__saved-filter-name").hide(),this.$(".save-rename-filter").show(),this.$(".rename-filter").hide(),this.$el.addClass("is-editing")},n.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this},n.prototype._fillValues=function(){return this.$(".filter__saved-filter-name").text(this.savedFilter.get("name")),this.$(".filter__saved-filter-input").val(this.savedFilter.get("name"))},n.prototype._getName=function(){return this.$(".filter__saved-filter-input").val()},n.prototype._handleInputKeyDown=function(t){return 13===t.keyCode?this._saveRename():27===t.keyCode?this._cancelRename():void 0},n.prototype._saveRename=function(){return setTimeout(function(t){return function(){var e;return e=window.savedFilters.any(function(e){var i;return(null!=(i=e.get("name"))?i.toLowerCase():void 0)===t._getName().toLowerCase()}),t._getName().length>0&&!e?(t.savedFilter.get("name")!==t._getName()&&(t.savedFilter.set("name",t._getName()),t.savedFilter.save()),t.disableRename()):t._cancelRename()}}(this),100)},n.prototype._cancelRename=function(){return this.$el.removeClass("is-editing"),this.render()},n}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Filters.SavedFilters=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="filter__saved-filter-list",i.prototype.initialize=function(t){return i.__super__.initialize.apply(this,arguments),this.listenTo(this.collection,"sort",function(t){return function(){return t.render()}}(this))},i.prototype.activateFilter=function(t){return this.collectionViews[t.cid].activateFilter()},i.prototype.createItemView=function(t){var e;return e=new RG.Views.Filters.SavedFilter({savedFilter:t.model}),e.on("activate:filter",function(t){return function(i){return t.trigger("activate:filter",i),t.removeActiveState(),e.addActiveState()}}(this)),localStorage.lastActiveFilterId&&parseInt(localStorage.lastActiveFilterId,10)===t.model.id&&e.addActiveState(),e},i.prototype.removeActiveState=function(){return this.$(".is-active").removeClass("is-active")},i}(RG.Support.SortedCollectionView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Filters.SelectedOptions=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("filters/selected_options_summary"),i.prototype.selectedAllTemplate=templates.find("filters/selected_options_summary_all"),i.prototype.className="filter__category--selected-options",i.prototype.initialize=function(){return this.ast=[]},i.prototype.render=function(){return this._hasSelectedAll()?this.$el.html(this.selectedAllTemplate()):this.$el.html(this.template({collection:this._createViewModel()})),this},i.prototype.setSelectedOptions=function(t){return this.ast=t,this.render()},i.prototype._createViewModel=function(){return _.map(this.ast,function(t){return{name:t.optionGroup.get("name"),matchType:t.matchType,selectedOptions:_.map(t.selectedOptions,function(t){return t.escape("name")}).join("&nbsp;|&nbsp;")}})},i.prototype._hasSelectedAll=function(){return this.ast.length>0&&"all"===this.ast[0].matchType&&!this.ast[0].selectedOptions},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Resource.AvailableMinutes=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="time-available",i.prototype.initialize=function(t){return this.availableMinutes=t.availableMinutes},i.prototype.render=function(){var t;return t=RG.Utils.TimeFormatter.formatMinutes(this.availableMinutes),this.el.innerHTML=t+'<div class="time-available-linebreak"></div>free',this},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Resource.Avatar=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="span",i.prototype.className="booking-avatar",i.prototype.initialize=function(t){return this.resource=t.resource},i.prototype.render=function(){var t;return t=this._avatarTag(),t.attr("title",this.resource.get("name")),this.$el.append(t),this},i.prototype._avatarTag=function(){return this.resource.hasAvatar()?$(document.createElement("img")).attr("src",this.resource.get("imageUrl")):$(document.createElement("span")).addClass("resource-initials").text(this.resource.getInitials())},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Resource.Booking=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="booking",i.prototype.events={click:"showDetailsPopup",mousemove:"showAvailability",mouseenter:"applyHover",mouseleave:"removeHover"},i.prototype.initialize=function(t){this.availability=t.availability,this.unit=t.unit,this.waiting=t.waiting,this.bookingFormFactory=t.bookingFormFactory,this.currentUserId=this.bookingFormFactory.currentUserId,this.prevHoverDate=null,this._colorSource=t.colorSource,this._dateController=t.dateController},i.prototype._ensureElement=function(){var t;return this.el||(t=document.createElement("div"),t.className=this.className,this.el=t),this.$el=$(this.el),this.delegateEvents()},i.prototype.id=function(){return this.model.id?this.model.cid:this.model.getDraggingId()},i.prototype.applyHover=function(t){this.prevHoverDate=null,$("#calendar .booking[data-booking-id="+this.model.id+"]").addClass("hover"),window.requestAnimationFrame(function(t){return function(){return t.el.classList.add("hover")}}(this)),this._attachEvents()},i.prototype.hideAvailability=function(t){this.timeUnitUnderlayElement.removeClass("hover")},i.prototype.showAvailability=function(t){var e,i;if(e=this._getUnitDurationAtOffset(t.pageX-this.$el.offset().left),e&&this.prevHoverDate!==e.get("date")){if(this.prevHoverDate=e.get("date"),!this.model.collection||!this.model.collection.resource)return;i=document.querySelector("#"+RG.Utils.generateTimeUnitId(this.model.collection.resource.cid,e.attributes.date)),RG.setHoverElement(i)}},i.prototype.removeHover=function(){$("#calendar .booking[data-booking-id="+this.model.id+"]").removeClass("hover")},i.prototype.remove=function(){var t;null!=(t=this.durationBlocksView)&&t.remove(),i.__super__.remove.apply(this,arguments)},i.prototype.render=function(){return this._fillValues(),this},i.prototype.showDetailsPopup=function(t){var e,i,n,o;this.model.id&&!this.isInInteraction&&(RG.Popovers.clear(),n=new RG.Utils.BookingPopoverPlacer(t),e=n.createAnchor({className:"booking-detail-anchor"}),o=this._getDurationAtOffset(t.pageX-$(this.el).offset().left),i=new RG.Views.Dialogs.BookingPopoverFactory({bookingFormFactory:this.bookingFormFactory,popoverType:"details",booking:this.model.realBooking,duration:o,bookingAnchor:e}),RG.Popovers.set(i.popover()))},i.prototype._attachEvents=function(){this.hasAttachedEvents||(RG.Utils.Permissions.canManage(this.model)&&this._attachDragAndDrop(),!RG.Utils.Permissions.canManage(this.model)||this.waiting||this.model.get("saving")||this._attachResizable(),this.hasAttachedEvents=!0)},i.prototype._detachEvents=function(){var t,e;null!=(t=this.dragDrop)&&t.detach(),null!=(e=this.resize)&&e.detach(),this.dragDrop=null,this.resize=null},i.prototype._attachDragAndDrop=function(){this.dragDrop||(this.dragDrop=new RG.Interactions.DragDropBooking(this),this.dragDrop.attach())},i.prototype._attachResizable=function(){this.resize||(this.resize=new RG.Interactions.ResizeBooking(this),this.resize.attach())},i.prototype._getDurationAtOffset=function(t){var e;return e=this._getUnitDurationAtOffset(t),e?this.model.durations.find(function(t){return RG.Utils.DateComparator.equalsYMD(t.attributes.date,e.attributes.date)}):(t-=RG.getUnitWidth(),this._getDurationAtOffset(t))},i.prototype._getUnitDurationAtOffset=function(t){return this._unitDurations[Math.floor(t/RG.getUnitWidth())]},i.prototype._fillValues=function(){this._setOwnerFlag(),this._setDurations(),this._setCaptions(),this._setIdAttribute(),this.resizeWidth(),this._setStickyClass()},i.prototype._getLabelTopPosition=function(){var t;return t=Math.ceil(this.model.getFirstNonZeroDuration().getMinutes()/this.unit.getMinutesPerUtilisationLine()),6*t+2},i.prototype._isTransientInvalidated=function(){return this.model.transient&&this.model.getDateRange().startDate.valueOf()>this._dateController._startDate().valueOf()},i.prototype.rerenderIfOverExtends=function(){this._isTransientInvalidated()&&this.remove(),this.resizeWidth(),this._setDurations()},i.prototype.resizeWidth=function(){var t,e,i,n;t=this.model.transient?this.model.realBooking.getDateRange():this.model.getDateRange(),i=this._dateController._endDate(),t.endDate.getTime()>i.getTime()?(t.endDate=i,this.el.classList.add("no-end")):this.el.classList.remove("no-end"),this.model.transient&&(t.startDate=this._dateController._startDate(),this.el.classList.add("no-begin")),e=t.getNumberOfDays(),n=RG.getUnitWidth()*e/this.unit.getDaysPerUnit()+1+"px",this.el.style.width=n},i.prototype._getCaptionElements=function(){var t,e,i,n,o;return n="",o="",this.model.get("refreshable")&&(n='<img src="/assets/flag-detailed.png"></img>'),this.model.get("saving")&&(o=this._getSpinnerElement()),e=this._getLabelTopPosition()+"px",t=document.createElement("div"),t.className="label daily",t.style.top=e,t.innerHTML=[o,n,this.model.getCaption()].join(""),i=document.createElement("div"),i.className="label detailed",i.style.top=e,i.innerHTML=[o,n,this.model.getLongCaption()].join(""),[i,t]},i.prototype._getSpinnerElement=function(){return'<img src="/assets/calendar/ajax-loader.gif">'},i.prototype._getBookingResource=function(){return this.model.realBooking.collection.resource},i.prototype._removeOldCaptions=function(){var t,e,i,n,o;for(n=this.el.querySelectorAll(".label"),t=0,i=n.length;t<i;t++)e=n[t],null!=(o=e.parentElement)&&o.removeChild(e)},i.prototype._setColor=function(){var t;t=this._colorSource.getColorForBooking(this.model),this._unitDurations.forEach(function(e){return e.attributes.color=t}),this.$el.css("border-color",t.getBorderColor()),this.$el.css("background-color",t.getBackgroundColor()),this.$el.css("color",t.getTextColor())},i.prototype.resetColor=function(){return this._setColor(),this._renderDurations()},i.prototype._setCaptions=function(){var t,e,i,n;for(this._removeOldCaptions(),this.el.setAttribute("title",_.unescape(this.model.getTitleCaption())),n=this._getCaptionElements(),e=0,i=n.length;e<i;e++)t=n[e],this.el.appendChild(t)},i.prototype._setDurations=function(){var t,e,i,n,o;e=new RG.Utils.UnitDurationConverter(this.unit.constructor),i=this.model.durations.models,t=this.model.getDateRange(),n=t.startDate,o=_.min([this._dateController._endDate(),t.endDate],function(t){return t}),this.model.transient&&(n=this._dateController._startDate()),this._unitDurations=e.convertArray(i,n,o),this.resetColor()},i.prototype._renderDurations=function(){var t,e;null!=(e=this.durationBlocksView)&&e.remove(),t=document.createElement("div"),t.className="blocks",this.durationBlocksView=new RG.Views.Resource.UnitDurationBlocks({collection:this._unitDurations,unit:this.unit}),this.durationBlocksView.el=t,this.durationBlocksView.render(),t.parentNode!==this.el&&this.el.appendChild(t)},i.prototype._setIdAttribute=function(){this.el.setAttribute("data-booking-id",this.model.id)},i.prototype._setOwnerFlag=function(){var t;(null!=(t=this.model.get("booker"))?t.id:void 0)===this.currentUserId&&this.el.classList.add("mine")},i.prototype._setStickyClass=function(){this.model.getDateRange().getNumberOfDays()>1&&this.el.classList.add("sticky");
},i.prototype._stopPropagation=function(t){"function"==typeof t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Resource.TimeUnit=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="resources--cal-unit",i.prototype.events={mouseenter:"showAvailability"},i.prototype.baseUtilisationHeight=14,i.prototype.utilLineMultiplier=11,i.prototype._ensureElement=function(){var t;return this.el||(t=document.createElement("div"),t.className=this.className,this.el=t),this.$el=$(this.el),this.delegateEvents()},i.prototype.initialize=function(t){this._waitingListViews=[],this.resource=t.resource,this._bookingFormDialogFactory=t.bookingFormDialogFactory,this._downtimeFormDialogFactory=t.downtimeFormDialogFactory,this.colorSource=t.colorSource,this.dateController=t.dateController,this.currentDate=t.currentDate||new RG.Models.CurrentDate(RG.Utils.getTodayISO()),this.availabilityToggle=t.availabilityToggle,this.resourceLine=t.resourceLine,this.renderedBookings={}},i.prototype.resetColor=function(){return this._bookingsView&&this._bookingsView.resetColor(),this._waitingListViews.forEach(function(t){return t.resetColor()})},i.prototype.refreshInRange=function(t){if(t.overlapsWith(this.model.getDateRange()))return this.rerender()},i.prototype.bookingChanged=function(t){var e;if(t&&(this.model.getDateRange().overlapsWith(t.getSavedDateRange())||this.model.getDateRange().overlapsWith(new RG.Models.Booking(t.previousAttributes()).getSavedDateRange()))){if(e=this.renderedBookings[t.id],e&&e.deepEqual(t))return;return this.rerender()}},i.prototype.resizeTimeAllocationWidths=function(){return this._bookingsView&&this._bookingsView.resizeWidth(),this._waitingListViews.forEach(function(t){return t.resizeWidth()})},i.prototype.rerenderIfTimeAllocationsOverextend=function(){return this._bookingsView&&this._bookingsView.rerenderIfOverExtends(),this._waitingListViews.forEach(function(t){return t.rerenderIfOverExtends()})},i.prototype.remove=function(){return this.clearSubviews(),this.undelegateEvents(),this.stopListening(),i.__super__.remove.apply(this,arguments)},i.prototype.clearSubviews=function(){var t,e;null!=(t=this._availableMinutesView)&&t.remove(),null!=(e=this._utilisationView)&&e.remove(),this._removeExistingDowntimesView(),this._removeExistingBookingsView(),this._removeExistingWaitingListView()},i.prototype.render=function(){return RG.backburner.deferOnce("render",this,this._render),RG.backburner.debounce("renderCheck",RG.Utils.renderChecker,500),this},i.prototype.rerender=function(){return this.render(),this.rerenderIfTimeAllocationsOverextend()},i.prototype._getDate=function(){return RG.Utils.BookingDataParser.getDateFromStr(this.currentDate.date)},i.prototype._render=function(){return this.isRendered&&this.clearSubviews(),RG.Utils.DateComparator.equalsYMD(this.model.date,this._getDate())?this.el.className="resources--cal-unit current":this.el.className="resources--cal-unit",this.bookingsEl=document.createElement("div"),this.bookingsEl.className="bookings",this.utilisationEl=document.createElement("div"),this.utilisationEl.className="utilisation",this.availableMinutesEl=document.createElement("div"),this.availableMinutesEl.className="time-available",this._setId(),this._renderBookings(),this.renderUtilisationAndAvailableMinutes(),this._renderWaitingList(),this._setAvailability(),this._setDateAttribute(),this.appendChildElements(),RG.Utils.delayResizeCards(),this.isRendered=!0,this},i.prototype.appendChildElements=function(){this.availabilityToggle.shouldRenderUtilisation()?(this.el.appendChild(this.utilisationEl),this.bookingsEl.firstChild&&this.el.appendChild(this.bookingsEl)):(this.bookingsEl.firstChild&&this.el.appendChild(this.bookingsEl),this.el.appendChild(this.availableMinutesEl))},i.prototype.renderUtilisationAndAvailableMinutes=function(){this.availabilityToggle.shouldRenderUtilisation()?this.renderUtilisation():this.renderAvailableMinutes()},i.prototype._reRenderBookings=function(){this.model.containsDate(this.dateController._startDate())&&this.render()},i.prototype.showAvailability=function(t){RG.setHoverElement(this.el)},i.prototype._calcDurationsForUnit=function(){var t,e,i,n,o,r,s,a,l;for(e=this.resource.bookings.forDate(this.model.date),n=[],o=0,s=e.length;o<s;o++)for(t=e[o],l=t.durations.models,r=0,a=l.length;r<a;r++)i=l[r],this.model.containsDate(i.attributes.date)&&n.push(i);return n},i.prototype._getBookingDurationsForUnit=function(){return this._durationsForUnit?this._durationsForUnit:this._durationsForUnit=this._calcDurationsForUnit()},i.prototype._getEarlierStartedBookings=function(){var t,e,i,n,o,r,s,a;for(i=this.dateController,n=[],e=this.resource.bookings.overlapsDate(i._startDate()),r=0,s=e.length;r<s;r++)t=e[r],a=t.durations.betweenDates(i._startDate(),i._endDate()),a.length&&(o=t.clone(),o.layer=t.layer,o.realBooking=t,o.transient=!0,o.durations.reset(a),o.collection={resource:this.resource,remove:function(){}},n.push(o));return n},i.prototype._getBookingsForUnit=function(){var t,e;return e=[],this.model.containsDate(this.dateController._startDate())&&(e=this._getEarlierStartedBookings()),t=this.resource.bookings.startsOnDate(this.model.date),new RG.Collections.Bookings([].concat(e,t))},i.prototype._getDowntimeDurationsForUnit=function(){return this.resource.downtimes.durationsForDateInTimeZone(this.model.date,this.resource.get("timeZone"))},i.prototype._renderBookings=function(){var t,e,i,n,o,r,s;this._durationsForUnit=null,this._drawnBookings=n=this._getBookingsForUnit(),i=this._getBookingDurationsForUnit(),s=this._getDowntimeDurationsForUnit(),this._drawnDowntimes=o=this._getDowntimesForUnit(),t=[].concat(s,i),e=this._getBookingAnchorCount(t),r=[].concat(n.models,o.models),this.renderedBookings={},r.forEach(function(t){return function(e){return t.renderedBookings[e.id]=e.deepClone()}}(this)),(t.length||n.length)&&(this._bookingsView=new RG.Views.Resource.TimeAllocations({dateController:this.dateController,bookingFormDialogFactory:this._bookingFormDialogFactory,downtimeFormDialogFactory:this._downtimeFormDialogFactory,bookingAnchorCount:e,timeAllocations:r,unit:this.model,availability:this.resource.availability,colorSource:this.colorSource,el:this.bookingsEl}),this._bookingsView.render())},i.prototype._getBookingAnchorCount=function(t){var e,i,n,o,r,s,a,l,c,u,h;for(c=0,e=!1,i=!1,r=this._earlierStartedBookingCount(),s=0,l=t.length;s<l;s++)o=t[s],a=o.getLayer(),a>c&&(c=a),e||(e=o.isConfirmed()),i||(i=!(null!=(h=o.collection)?h.booking.isExclusivelyOnWaitingList():void 0));return u=i?c:r-1,c=c>u?c:u,n=this._drawnBookings.filter(function(t){return t.durations.length&&t.durations.models[0].isConfirmed()}),n.length||e||i?c+1:u},i.prototype._getEarlierStartedDowntimes=function(){var t,e;return t=this.dateController,e=this.resource.downtimes.overlapsDateInTimeZone(t._startDate(),this.resource.get("timeZone")),this._cloneDowntimes(e)},i.prototype._earlierStartedBookingCount=function(){var t;return t=this._getEarlierStartedBookings(),t.filter(function(t){return!t.isExclusivelyOnWaitingList()}).length},i.prototype._cloneDowntimes=function(t,e){var i,n,o,r,s;for(null==e&&(e=!0),n=[],r=0,s=t.length;r<s;r++)i=t[r],o=i.inTimeZone(this.resource.get("timeZone")),o.layer=i.layer,o.realBooking=i,o.transient=e,o.firstDate=this.dateController._startDate(),o.collection={resource:this.resource,remove:function(){}},n.push(o);return n},i.prototype._getDowntimesForUnit=function(){var t,e;return e=[],this.model.containsDate(this.dateController._startDate())&&(e=this._getEarlierStartedDowntimes()),t=this.resource.downtimes.startsOnDateInTimeZone(this.model.date,this.resource.get("timeZone")),this._downtimes=new RG.Collections.Downtimes,this._downtimes.models=e.concat(this._cloneDowntimes(t,!1)),this._downtimes.length=this._downtimes.models.length,this._downtimes.resource=this.resource,this._downtimes},i.prototype.resetUtilisationHeight=function(){return RG.backburner.deferOnce("render",this,this._resetUtilisationHeight)},i.prototype._resetUtilisationHeight=function(){var t,e;if(this._utilisationView)return e=this.resource.availability.getMaxMinutesInUnit(this._visibleDateRange()),t=this._calculateUtilisationHeight(e),this._utilisationView.resetUtilisationHeight(t)},i.prototype.renderAvailableMinutes=function(){var t,e;e=this._getUsedMinutes(),t=this.resource.availability.getMinutesAvailableForDate(this.model.date),this._availableMinutesView=new RG.Views.Resource.AvailableMinutes({availableMinutes:t-e,el:this.availableMinutesEl}),this._availableMinutesView.render()},i.prototype._calculateUtilisationHeight=function(t){return this.baseUtilisationHeight+this._getNumberOfUtilisationLines(t)*this.utilLineMultiplier},i.prototype._getNumberOfUtilisationLines=function(t){return Math.ceil(t/this.model.getMinutesPerUtilisationLine())},i.prototype.renderUtilisation=function(){var t,e,i,n,o;o=this._getUsedMinutes(),i=this.resource.availability.getMaxMinutesInUnit(this._visibleDateRange()),t=this.resource.availability.getMinutesAvailableForDate(this.model.date),n=this.resource.availability.getOvertimeMinutesInDateRange(this.model.getDateRange()),e=this._calculateUtilisationHeight(i),this._utilisationView=new RG.Views.Resource.UtilisationBlock({usedMinutes:o,availableMinutes:t,overtimeMinutes:n,minutesPerLine:this.model.getMinutesPerUtilisationLine(),height:e,el:this.utilisationEl}),this._utilisationView.render()},i.prototype._getUsedMinutes=function(){var t,e,i,n,o,r;for(i=[],r=this._getBookingDurationsForUnit(),n=0,o=r.length;n<o;n++)e=r[n],e.isConfirmed()&&i.push(e);return t=new RG.Utils.UnitDurationConverter(null,null),t.getDurationMinutesInUnit(i,this.model)},i.prototype._renderWaitingList=function(){var t,e,i,n,o,r,s,a,l,c,u,h,d;for(h=[],l=this._getBookingDurationsForUnit(),o=0,s=l.length;o<s;o++)i=l[o],i.isWaiting()&&h.push(i);if(h.length>0){for(n=document.createDocumentFragment(),d=document.createElement("div"),d.className="waitlist-anchor",d.innerHTML='<div class="waitlist" title="Waiting List"><div class="blocks"><div class="unit"></div></div></div>',n.appendChild(d),h.sort(function(t,e){return t.get("startTime")-e.get("startTime")}),r=0,a=h.length;r<a;r++)i=h[r],i.getMinutes()>0&&(t=document.createElement("div"),t.className="booking-anchor waitlist",e=i.collection.booking.clone(),e.realBooking=i.collection.booking,e.listenTo(e.realBooking,"change",function(){return e.set(e.realBooking.attributes)}),u=i.clone(),u.set({waiting:!1}),e.durations.reset([u]),e.collection={resource:this.resource,remove:function(){}},c=new RG.Views.Resource.Booking({dateController:this.dateController,bookingFormFactory:this._bookingFormDialogFactory,unit:this.model,colorSource:this.colorSource,model:e,waiting:!0}),t.appendChild(c.render().el),n.appendChild(t),this._waitingListViews.push(c));this.bookingsEl.appendChild(n)}},i.prototype._removeExistingBookingsView=function(){this._bookingsView&&this._bookingsView.remove()},i.prototype._removeExistingDowntimesView=function(){this._downtimesView&&this._downtimesView.remove()},i.prototype._removeExistingWaitingListView=function(){var t,e,i,n;if(this._waitingListViews.length){for(i=this._waitingListViews,t=0,e=i.length;t<e;t++)n=i[t],n.remove();this._waitingListViews.length=0}},i.prototype._setAvailability=function(){var t;t=this.model.date.getDay(),0!==t&&6!==t||this.el.classList.add("unavailable")},i.prototype._setDateAttribute=function(){this.el.setAttribute("data-date",RG.Utils.DateFormatter.getISODate(this.model.date))},i.prototype._setId=function(){this.el.setAttribute("id",RG.Utils.generateTimeUnitId(this.resource.cid,this.model.date))},i.prototype._setBookingsContents=function(t){this.el.insertBefore(t,this.bookingsEl),this.el.removeChild(this.bookingsEl),this.bookingsEl=t},i.prototype._visibleDateRange=function(){return new RG.Utils.DateRange(this.dateController._startDate(),this.dateController._endDate())},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Resource.Card=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("resource/card"),i.prototype.className="resource",i.prototype.initialize=function(){this.listenTo(this.model,"change",this._fillValues)},i.prototype.render=function(){return window.requestAnimationFrame(function(t){return function(){t.el.innerHTML=t.template(),t.el.setAttribute("data-resource-id",t.model.cid),t._fillValues()}}(this)),this},i.prototype._fillValues=function(){window.requestAnimationFrame(function(t){return function(){var e,i;t.el.querySelector("h3").innerHTML=t.model.escape("name"),t.el.querySelector("h4").innerHTML=t.model.escape("type"),i=window.currentUserTimeZone.replace(/&amp;/g,"&"),e=t.model.getTimeZone(),e.get("name")!==i&&(t.el.querySelector("p.timezone").innerHTML=e.toString()),t.el.querySelector("img").setAttribute("src",t.model.get("imageUrl"))}}(this))},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Resource.Cards=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="aside",i.prototype.itemView=RG.Views.Resource.Card,i.prototype.render=function(){return RG.backburner.deferOnce("render",this,this._render),this},i.prototype.createItemView=function(t){var e;return e=i.__super__.createItemView.apply(this,arguments),e.$el.toggleClass("hide",!t.model.visible),e},i}(RG.Support.CollectionView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Resource.Downtime=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="booking downtime",i.prototype.initialize=function(t){this.availability=t.availability,this.unit=t.unit,this.waiting=t.waiting,this.downtimeFormFactory=t.downtimeFormFactory,this.currentUserId=this.downtimeFormFactory.currentUserId,this.prevHoverDate=null,this._colorSource=t.colorSource,this._dateController=t.dateController},i.prototype.render=function(){return this._fillValues(),$(".sprite-spinner",this.el).each(function(){var t;return t={},t=0===$(this).closest(".detailed").length?new SpriteSpinner(this,{diameter:12,interval:50}):new SpriteSpinner(this,{diameter:18,interval:50}),t.start()}),this._ensureSpinnerStop(),this},i.prototype.resetColor=function(){},i.prototype._ensureSpinnerStop=function(){return Q.delay(1e3).then(function(t){return function(){var e;e=window.downtimes.findWhere({id:t.model.id}),t.model.get("saving")&&(e.get("saving")?t._ensureSpinnerStop():t.model.set({saving:!1}))}}(this))},i.prototype.showDetailsPopup=function(t){var e,i,n,o,r,s,a,l;this.model.id&&(i=this.model.realBooking,this._stopPropagation(t),RG.Popovers.clear(),s=new RG.Utils.BookingPopoverPlacer(t),n=s.createAnchor({className:"downtime-detail-anchor"}),a=this._getDurationAtOffset(t.pageX-$(this.el).offset().left),e=a.get("date"),l=i.getTimeRange(e),o=this.model.realBooking.getDurations().filter(function(t){return RG.Utils.DateComparator.equalsYMD(t.getDate(),e)})[0],r=new RG.Views.Dialogs.DowntimePopoverFactory({downtimeFormFactory:this.downtimeFormFactory,popoverType:"details",downtime:i,duration:o,downtimeAnchor:n}),RG.Popovers.set(r.popover()))},i.prototype._getDurationAtOffset=function(t){var e;return e=this._getUnitDurationAtOffset(t),e?this._unitDurations.find(function(t){return RG.Utils.DateComparator.equalsYMD(t.attributes.date,e.attributes.date)}):(t-=RG.getUnitWidth(),this._getDurationAtOffset(t))},i.prototype._setDurations=function(){var t,e,i,n;t=new RG.Utils.UnitDurationConverter(this.unit.constructor),e=this.model.getDurations(),i=this.model.getDateRange().startDate,n=_.sortBy([this._dateController._endDate(),this.model.getDateRange().endDate],function(t){return t})[0],this.model.transient&&(i=this._dateController._startDate()),this._unitDurations=t.convertArray(e,i,n)},i.prototype._setOwnerFlag=function(){this.model.attributes.creatorId===this.currentUserId&&this.el.classList.add("mine")},i.prototype._getCaptionElements=function(){var t,e,i,n,o,r,s;return r="",s="",n="",this.model.get("refreshable")&&(r='<img src="/assets/flag-detailed.png"></img>'),this.model.get("saving")&&(s=this._getSpinnerElement()),this.model.get("resourceIds").length>1&&(n="<span class='rg-icon--contacts'></span>"),e="",this.model.getType()&&(e=" | "),this.model.get("details")&&(e+=this.model.escape("details")+" | "),i=this._getLabelTopPosition()+"px",t=document.createElement("div"),t.className="label daily",t.style.top=i,t.innerHTML=[s,'<div class="booking-icons">',this._getTypeIcon(),r,n,"</div>",this.model.getType(),e,this.model.getDateTimeString()].join(""),o=document.createElement("div"),o.className="label detailed",o.style.top=i,o.innerHTML=['<div class="detailed-icons">',s,this._getTypeIcon(),r,n,"</div>",'<div class="detailed-info">',this.model.getDateTimeString(),"<br />",this.model.getType(),"<br />",this.model.escape("details"),"</div>"].join(""),[o,t]},i.prototype._getSpinnerElement=function(){return templates.find("calendar/light_spinner")()},i.prototype._getTypeIcon=function(){return"<span class='"+this.model.getTypeIcon()+"'></span>"},i.prototype._attachDragAndDrop=function(){this.dragDrop||(this.dragDrop=new RG.Interactions.DragDropDowntime(this),this.dragDrop.attach())},i.prototype._attachResizable=function(){this.resize||(this.resize=new RG.Interactions.ResizeDowntime(this),this.resize.attach())},i.prototype._getBookingResource=function(){return this.model.collection.resource},i.prototype._attachEvents=function(){this.model.id&&(RG.Utils.Permissions.canManageDowntime(this.model)&&this._attachDragAndDrop(),RG.Utils.Permissions.canManageDowntime(this.model)&&!this.waiting&&this._attachResizable())},i.prototype._isTransientInvalidated=function(){return this.model.transient&&!RG.Utils.DateComparator.equalsYMD(this.model.firstDate,this._dateController._startDate())},i}(RG.Views.Resource.Booking)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Resource.UnitDurationBlocks=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="blocks",i.prototype._ensureElement=function(){if(!this.el)return this.el=document.createElement("div"),this.el.className=this.className},i.prototype.initialize=function(t){this.unit=t.unit},i.prototype.createItemView=function(t){return new RG.Views.Resource.UnitDurationLine({model:t.model,minutesPerLine:this.unit.getMinutesPerUtilisationLine()})},i}(RG.Support.ArrayView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Resource.Line=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="resource-line",i.prototype.itemView=RG.Views.Resource.TimeUnit,i.prototype.initialize=function(t){this._bookingFormDialogFactory=t.bookingFormDialogFactory,this._downtimeFormDialogFactory=t.downtimeFormDialogFactory,this.dateController=t.dateController,this.currentDate=t.currentDate||new RG.Models.CurrentDate(RG.Utils.getTodayISO()),this.availabilityToggle=t.availabilityToggle,this._colorSource=t.colorSource,this.listenTo(this.currentDate,"change",this._rerenderUnit),this.listenTo(this.dateController,"append",this._appendFragment),this.listenTo(this.dateController,"prepend",this._prependFragment),this.listenTo(this._colorSource,"change:mode",this._resetColor),this.listenTo(this.model.availability,"refresh",this._refreshAvailability),this.listenTo(this.model.availability,"refreshUtilisation maxAvailabilityChanged",this._renderUtilisation),this.listenTo(this.model.bookings,"add change remove",this._notifyBookingChanged),this.listenTo(this.collection,"change",this._resizeTimeAllocationWidths)},i.prototype.createItemView=function(t){return new this.itemView({availabilityToggle:this.availabilityToggle,dateController:this.dateController,currentDate:this.currentDate,model:t.model,resource:this.model,colorSource:this._colorSource,bookingFormDialogFactory:this._bookingFormDialogFactory,downtimeFormDialogFactory:this._downtimeFormDialogFactory,resourceLine:this})},i.prototype.render=function(){return RG.backburner.deferOnce("render",this,this._render),this},i.prototype._render=function(){var t,e,i,n;for(this.close(),n=this.collection.models,t=0,e=n.length;t<e;t++)i=n[t],this.addItem(i);this.$el.attr("data-resource-id",this.model.cid),this._attachDragToCreateInteraction(),this._rendered=!0,this._fragment=document.createDocumentFragment()},i.prototype.remove=function(){this._detachInteractions(),i.__super__.remove.apply(this,arguments)},i.prototype._detachInteractions=function(){this.dragInteraction.detach(),this.dragCustomAvailabilityInteraction.detach()},i.prototype._attachDragToCreateInteraction=function(){this.dragInteraction=new RG.Interactions.DragToCreate(this),this.dragInteraction.attach(),this.dragCustomAvailabilityInteraction=new RG.Interactions.DragToCreateCustomAvailability(this),this.dragCustomAvailabilityInteraction.attach()},i.prototype._insertView=function(t,e){var n;return this._rendered?(n=t.render().el,void(e===this.collection.first()?this._fragment.insertBefore(n,this._fragment.firstChild):this._fragment.appendChild(n))):i.__super__._insertView.apply(this,arguments)},i.prototype._appendFragment=function(){var t,e,i,n;if(this._rendered){this.el.appendChild(this._fragment),this._isListeningToGroup=!1,this._fragment=document.createDocumentFragment(),e=this.collection.min(function(t){return t.date.valueOf()}),this.collectionViews[e.cid].rerender(),i=this.collectionViews;for(t in i)n=i[t],n.rerenderIfTimeAllocationsOverextend(),n.resetUtilisationHeight()}},i.prototype._prependFragment=function(){var t,e,i;if(this._rendered){this.el.insertBefore(this._fragment,this.el.firstChild),this._isListeningToGroup=!1,this._fragment=document.createDocumentFragment(),e=this.collectionViews;for(t in e)i=e[t],i.rerenderIfTimeAllocationsOverextend(),i.resetUtilisationHeight()}},i.prototype._resetColor=function(){return this.forEach(function(t){return t.resetColor()})},i.prototype._rerenderUnit=function(){return this.forEach(function(t){return t.render()})},i.prototype._refreshAvailability=function(t){return this.forEach(function(e){return e.refreshInRange(t)})},i.prototype._renderUtilisation=function(){return this.forEach(function(t){return t.renderUtilisationAndAvailableMinutes()})},i.prototype._notifyBookingChanged=function(t){return this.forEach(function(e){return e.bookingChanged(t)})},i.prototype._resizeTimeAllocationWidths=function(){return this.forEach(function(t){return t.resizeTimeAllocationWidths()})},i}(RG.Support.CollectionView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Resource.Lines=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.itemView=RG.Views.Resource.Line,i.prototype.id="resources",i.prototype.initialize=function(t){this.listenTo(this.collection,"change:visible",this._setVisibility),this.dateController=t.dateController,this.timeUnits=t.timeUnits,this._colorSource=t.colorSource,this._bookingFormDialogFactory=t.bookingFormDialogFactory,this._downtimeFormDialogFactory=t.downtimeFormDialogFactory,this._customAvailabilityDialogFactory=t.customAvailabilityDialogFactory,this.availabilityToggle=new RG.Utils.AvailabilityToggle(this,"true"===window.localStorage.availabilityToggle),this.currentDate=t.currentDate||new RG.Models.CurrentDate(RG.Utils.getTodayISO()),this.listenTo(this.timeUnits,"append prepend",this.clearInvisibleViews)},i.prototype.createItemView=function(t){var e;return e=new this.itemView({availabilityToggle:this.availabilityToggle,dateController:this.dateController,collection:this.timeUnits,model:t.model,currentDate:this.currentDate,colorSource:this._colorSource,bookingFormDialogFactory:this._bookingFormDialogFactory,downtimeFormDialogFactory:this._downtimeFormDialogFactory,customAvailabilityDialogFactory:this._customAvailabilityDialogFactory})},i.prototype._setVisibility=function(){var t,e;e=[],t=[],this.collection.models.forEach(function(i){return function(n){var o;o=i.collectionViews[n.cid],n.visible?e.push(o.el):t.push(o.el)}}(this)),t.forEach(function(t){return t.style.display="none"}),e.forEach(function(t){return t.style.display=""})},i}(RG.Support.CachedCollectionView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Resource.TimeAllocations=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.className="bookings",i.prototype.initialize=function(t){this.availability=t.availability,this.dateController=t.dateController,this.bookingAnchorCount=t.bookingAnchorCount,this.timeAllocations=t.timeAllocations,this.bookingAnchors=[],this.colorSource=t.colorSource,this.unit=t.unit,this._bookingFormDialogFactory=t.bookingFormDialogFactory,this._downtimeFormDialogFactory=t.downtimeFormDialogFactory,this.rendered=!1,this.collectionViews={}},i.prototype.addBooking=function(t){var e,i,n;if(i=this.bookingAnchors[t.layer]){for(n=this.createItemView(t);e=i.firstChild;)i.removeChild(e);i.appendChild(n.render().el),this.collectionViews[t.cid]=n}},i.prototype.createItemView=function(t){return t.constructor===RG.Models.Booking?new RG.Views.Resource.Booking({dateController:this.dateController,bookingFormFactory:this._bookingFormDialogFactory,model:t,unit:this.unit,availability:this.availability,colorSource:this.colorSource}):new RG.Views.Resource.Downtime({model:t,unit:this.unit,availability:this.availability,colorSource:this.colorSource,downtimeFormFactory:this._downtimeFormDialogFactory,dateController:this.dateController})},i.prototype.remove=function(){var t,e,n;i.__super__.remove.apply(this,arguments),e=this.collectionViews;for(t in e)n=e[t],n.remove()},i.prototype.render=function(){var t,e,i,n,o,r,s;this._fragment=document.createDocumentFragment(),this._setBookingAnchors(),o=this.collectionViews;for(t in o)s=o[t],s.remove();for(r=this.timeAllocations,e=0,i=r.length;e<i;e++)n=r[e],this.addBooking(n);return this.el.appendChild(this._fragment),this},i.prototype._setBookingAnchors=function(){var t,e,i,n,o;for(this.bookingAnchors=[];t=this.el.firstChild;)this.el.removeChild(t);if(this.bookingAnchorCount>0)for(i=n=1,o=this.bookingAnchorCount;1<=o?n<=o:n>=o;i=1<=o?++n:--n)e=document.createElement("div"),e.className="booking-anchor",this._fragment.appendChild(e),this.bookingAnchors.push(e)},i.prototype.resetColor=function(){var t,e,i;e=this.collectionViews;for(t in e)i=e[t],i.resetColor()},i.prototype.resizeWidth=function(){var t,e,i;e=this.collectionViews;for(t in e)i=e[t],i.resizeWidth()},i.prototype.rerenderIfOverExtends=function(){var t,e,i;e=this.collectionViews;for(t in e)i=e[t],i.rerenderIfOverExtends()},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Resource.UnitDurationLine=function(e){function i(t){i.__super__.constructor.apply(this,arguments),this.minutesPerLine=t.minutesPerLine,this.listenTo(this.model,"change",this.render)}return t(i,e),i.prototype.className="unit",i.prototype._ensureElement=function(){if(!this.el)return this.el=document.createElement("div"),this.el.className=this.className},i.prototype._removeElement=function(){if(this.el.parentNode)return this.el.parentNode.removeChild(this.el)},i.prototype.render=function(){var t,e,i;for(i=this.model.attributes.minutes,t=this.model.attributes.color,e=document.createDocumentFragment();i/this.minutesPerLine>1;)i-=this.minutesPerLine,e.appendChild(this._createFullLine(t.toString()));return i>0&&e.appendChild(this._createLine(i/this.minutesPerLine,t.toString())),this.model.get("waiting")&&this.el.classList.add("waiting-list"),this.el.appendChild(e),this},i.prototype._createFullLine=function(t){var e;return e=document.createElement("span"),e.style["background-color"]=t,e},i.prototype._createLine=function(t,e){var i;return i=document.createElement("span"),i.style["background-color"]=e,i.style.width=100*t+"%",i},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty,i=[].slice;RG.Views.Resource.UtilisationBlock=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.className="utilisation",n.prototype.initialize=function(t){this.usedMinutes=t.usedMinutes,this.availableMinutes=t.availableMinutes,this.overtimeMinutes=t.overtimeMinutes||0,this.minutesPerLine=t.minutesPerLine,this.height=t.height},n.prototype.resetUtilisationHeight=function(t){if(t!==this.height)return this.height=t,this._setHeight()},n.prototype.render=function(){var t,e,n,o,r,s,a,l,c,u,h,d,p,f,g,m,v,y,_;for(t=RG.Utils.TimeFormatter.formatMinutes(this.availableMinutes-this.usedMinutes),this.el.innerHTML='<div class="time-available">'+t+'<div class="time-available-linebreak"></div>free</div>',e=this.availableMinutes,m=this.usedMinutes,r=this.overtimeMinutes>this.availableMinutes?this.availableMinutes:this.overtimeMinutes,o=[],v=m>e-r?e-r:m,f=m<e-r?e-r-m:0,y=m>e-r?-(e-m-r):0,g=r-y;e>0;)_=e/this.minutesPerLine,_>1&&(_=1),n=e<this.minutesPerLine?e:this.minutesPerLine,o=[],l=n,l>0&&v>0&&(c=v>l?l:v,s=c/n,o.push({width:s,color:"#9F9F9F",className:"unit--used-normal"}),l-=c,e-=c,v-=c),l>0&&f>0&&(u=f>l?l:f,s=u/n,o.push({width:s,color:"#fff",className:"unit--unused-normal"}),l-=u,e-=u,f-=u),l>0&&y>0&&(d=y>l?l:y,s=d/n,o.push({width:s,color:"#B47972",className:"unit--used-overtime"}),l-=d,e-=d,y-=d),l>0&&g>0&&(h=g>l?l:g,s=h/n,o.push({width:s,color:"#F7BCB5",className:"unit--unused-overtime"}),l-=h,e-=h,g-=h),p=(a=RG.Views.Calendar.UtilisationBarFactory).create.apply(a,[_,"unit"].concat(i.call(o))),this.el.appendChild(p);return this._setHeight(),this},n.prototype._setHeight=function(){if(null!=this.height)return this.el.style.height=this.height.toString()+"px"},n}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Selectors.ClientProject=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return null==t&&(t={}),this.clients=t.clients||new RG.Collections.Clients,this.projects=t.projects||new RG.Collections.Projects,this.resource=t.resource||null,this.container=t.container,this._selectedValue=t.selectedValue,this._originalValue=t.selectedValue,
this.listenTo(this.clients,"add",this._fillValues),this.listenTo(this.clients,"remove",this._fillValues),this.listenTo(this.projects,"add",this._fillValues),this.listenTo(this.projects,"remove",this._fillValues),this.listenTo(this.clients,"add",this._setNewValue),this.listenTo(this.projects,"add",this._setNewValue)},i.prototype.getSelectedOption=function(){var t,e;return e=this.selectBox.trigger("change").val(),t=_.flatten([this.projects.models,this.clients.models]),_.find(t,function(t){return t.cid===e})},i.prototype.render=function(){var t;return null!=(t=this.selectBox)&&t.remove(),this.selectBoxEl=document.createElement("select"),this.selectBoxEl.style.width="288px",this.selectBoxEl.className="chzn-select",this.selectBox=$(this.selectBoxEl),this._addSelectBoxEvents(),this._fillValues(),this.el.appendChild(this.selectBoxEl),this.selectBox.chosen({allow_single_deselect:!0}),this},i.prototype.setSelectedValue=function(t){return this._selectedValue=t,this._selectedValue?this.selectBox.val(this._selectedValue).trigger("liszt:updated"):this.selectBox.val("").trigger("liszt:updated")},i.prototype._createClients=function(){var t,e,i,n,o,r,s,a,l,c,u;for(o=[],n=this.clients.models.filter(function(t){return function(e){return!e.get("archived")||e.cid===t._selectedValue}}(this)),t=this.projects.models.filter(function(t){return function(e){return!e.get("archived")||e.cid===t._selectedValue}}(this)),r=_.groupBy(t,function(t){var e;return null!=(e=t.get("client"))?e.id:void 0}),s=0,l=n.length;s<l;s++)for(e=n[s],o.push(this._createOption("client",e.cid,_.unescape(e.getName()))),i=r[e.id]||[],a=0,c=i.length;a<c;a++)u=i[a],o.push(this._createOption("project",u.cid,_.unescape(u.getName())));return o},i.prototype._createNewClientOption=function(){return this._createOption("new-client","new-client","New client...")},i.prototype._createNewProjectOption=function(){return this._createOption("new-project","new-project","New project...")},i.prototype._createNonClientProjects=function(){var t,e,i,n,o;for(t=[],o=this.projects.filter(function(t){return function(e){return!(e.get("client")||e.get("archived")&&e.cid!==t._selectedValue)}}(this)),o.length&&t.push(this._createOption("client separator","no-client","PROJECTS WITHOUT CLIENTS")),e=0,i=o.length;e<i;e++)n=o[e],t.push(this._createOption("project",n.cid,_.unescape(n.getName())));return t},i.prototype._addElementsToSelect=function(t){var e,i,n,o;for(i=document.createDocumentFragment(),n=0,o=t.length;n<o;n++)e=t[n],i.appendChild(e);this.selectBoxEl.appendChild(i)},i.prototype._fillValues=function(){var t;if(this.selectBox.html('<option selected="selected" value="">&nbsp;</option>'),t=[],RG.Utils.Permissions.canAddProject(this.resource)&&(t=t.concat(this._createNewProjectOption())),RG.Utils.Permissions.canAddClient(this.resource)&&(t=t.concat(this._createNewClientOption())),t=t.concat(this._createClients()),t=t.concat(this._createNonClientProjects()),this._addElementsToSelect(t),this.selectBox.hasClass("chzn-done"))return this.selectBox.trigger("liszt:updated")},i.prototype._createOption=function(t,e,i){var n;return n=document.createElement("option"),n.className=t,n.setAttribute("value",e),n.textContent=i,n},i.prototype._setNewValue=function(t){return this.setSelectedValue(t.cid)},i.prototype._addSelectBoxEvents=function(){var t;return null!=(t=this.modal)&&t.remove(),this.selectBox.on("change",function(t){return function(){return"new-client"===t.selectBox.val()?(t.modal=new RG.Views.Dialogs.NewClient,t.modal.on("cancelled",function(){return t.trigger("cancelled")},t),t.trigger("changeOverlay",t.modal,{className:"overlay client"})):"new-project"===t.selectBox.val()?(t.modal=new RG.Views.Dialogs.NewProject({clients:t.clients}),t._bindProjectEvents(t.modal),t.trigger("changeOverlay",t.modal,{className:"overlay project"})):"no-client"===t.selectBox.val()?t.selectBox.val("").trigger("liszt:updated"):t._originalValue=t.selectBox.val()}}(this))},i.prototype._bindProjectEvents=function(t){return t.on("cancelled",function(t){return function(){return t.trigger("cancelled")}}(this),this),t.on("changeOverlay",function(t){return function(e,i){return i.newClient||(t.modal=new RG.Views.Dialogs.NewProject({clients:t.clients,selectedClient:i.client}),t._bindProjectEvents(t.modal),e=t.modal),t.trigger("changeOverlay",e,i)}}(this))},i.prototype.remove=function(){var t,e,n;return null!=(t=this.modal)&&t.remove(),null!=(e=this.clients)&&e.remove(),null!=(n=this.projects)&&n.remove(),i.__super__.remove.apply(this,arguments)},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Selectors.ColorPicker=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("selectors/color_picker"),i.prototype.defaultColors=["d5ded9","bfbfbf","ece5ce","f1d4af","e8cb05","c68c00","e08e79","ffb400","ff9f80","ff6600","ef247f","ea1414","b70655","bb4b01","850505","80056d","d818bb","a675ff","683db8","16287f","0264b0","2654ea","59b2f6","18cfd6","09ca7a","b9d020","719004","0e6c6f","007f4b","9c8803"],i.prototype.events={"click .dropdown-toggle, .dropdown-menu a":"toggleColorbox","click ul.dropdown-menu.color-palette a":"colorPalette"},i.prototype.initialize=function(t){return null==t&&(t={}),this.colors=t.colors||this.defaultColors},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this},i.prototype.colorPalette=function(t){var e,i,n,o,r;return t.preventDefault(),t.stopPropagation(),i=$(t.currentTarget),e=i.attr("data-color"),n=i.closest(".color-picker"),o=n.parent().find(".color-picker-select"),r=n.find(".selected-color"),o.val(e),r.css("background-color","#"+e)},i.prototype.toggleColorbox=function(t){return t.preventDefault(),t.stopPropagation(),this.$(".color-picker").toggleClass("open")},i.prototype._fillValues=function(){var t,e,i,n,o,r,s;for(r=this.colors,s=[],i=0,n=r.length;i<n;i++)e=r[i],this.$(".js-select").append($(document.createElement("option")).attr("value",e).text(e)),o=$(document.createElement("li")),t=$(document.createElement("a")).css("background-color","#"+e).attr("data-color",e),s.push(this.$(".js-displayed-colors").append(o.append(t)));return s},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Selectors.Duration=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("selectors/duration"),i.prototype.className="hours-per-day",i.prototype.events={"change input":"triggerValidate","keyup input":"triggerValidate"},i.prototype.initialize=function(t){return this.duration=t.duration,this.storageTypeName=t.typeName,this.inlineHelpText=t.inlineHelpText||"Please fill in a booking duration."},i.prototype.getBookingDurationDTO=function(){return new RG.DTO.BookingDuration({duration:this.getDuration()})},i.prototype.getDuration=function(){var t,e;return t=parseInt(this._getHoursFieldEl().val(),10),e=parseInt(this._getMinutesFieldEl().val(),10),isNaN(t)&&(t=0),isNaN(e)&&(e=0),60*t+e},i.prototype.render=function(){return this.$el.html(this.template()),this._fillValues(),this},i.prototype.setDuration=function(t){return this.duration=t,this._fillValues()},i.prototype.toggleError=function(t){return this.$(".help-inline").toggle(t)},i.prototype.triggerValidate=function(){return 0!==this.getDuration()&&(window.localStorage["Duration:"+this.storageTypeName]=this.getDuration()),this.validate(!0),!0},i.prototype.validate=function(t){var e,i;return i=!1,e=this.getDuration(),e>0?e>1440?(i=!0,this.$(".help-inline.error").text("Must be less than 24 hours.")):i=!1:(i=!0,this.$(".help-inline.error").text("Please fill in a booking duration.")),this.toggleError(i),t&&this.trigger("validate"),!i},i.prototype._fillValues=function(){var t,e;return t=Math.floor(this.duration/60),e=this.duration%60,this.$(".help-inline").text(this.inlineHelpText),this._getHoursFieldEl().val(t),this._getMinutesFieldEl().val(e),this.validate()},i.prototype._getHoursFieldEl=function(){return this.$("#booking-hour-time")},i.prototype._getMinutesFieldEl=function(){return this.$("#booking-minute-time")},i}(RG.Views.BaseView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;RG.Views.Selectors.Resource=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=templates.find("selectors/resource"),i.prototype.events={"change .selector select":"_updateSelectedResource","click .alt-toggle a":"_showSelectBox"},i.prototype.initialize=function(t){return this.resources=t.resources,this.selected=t.selected},i.prototype.getSelectedResource=function(){return this.selected},i.prototype.render=function(){return this.$el.html(this.template()),this._populateSelectBox(),this.selected&&this._selectResourceByCid(this.selected.cid),this},i.prototype._populateSelectBox=function(){var t,e,i,n,o,r,s;for(t=[],s=this.el.querySelector(".selector select"),n=[],o=this.resources.models,e=0,i=o.length;e<i;e++)r=o[e],r.isBookable()&&n.push('<option value="'+r.cid+'">'+r.getName()+"</option>");return $(s).html(n.join(""))},i.prototype._selectResourceByCid=function(t){return this.$(".selector select").val(t).trigger("change")},i.prototype._showSelectBox=function(){return this.$(".current, .alt-toggle").hide(),this.$(".selector").show()},i.prototype._updateSelectedResource=function(){var t;return this.selected=this.resources.find(function(t){return function(e){return e.cid===t.$(".selector select").val()}}(this)),this.$(".current span.resource-name").html(this.selected.getName()),this.selected.hasAvatar()&&(t=new RG.Views.Resource.Avatar({resource:this.selected}),this.$(".current").prepend(t.render().el)),this.trigger("change",this.selected),!1},i}(RG.Views.BaseView)}.call(this),function(){window.RG.Popovers=new RG.Utils.PopoverManager,window.RG.renderer=new RG.Renderer.Renderer}.call(this),function(){$(function(){var t,e,i,n,o,r;return window.clients=new RG.Collections.Clients,window.deletedClients=new RG.Collections.Clients,window.projects=new RG.Collections.Projects,window.deletedProjects=new RG.Collections.Projects,null==window.resources&&(window.resources=new RG.Collections.ResourceInstances),window.resourceTypes=new RG.Collections.ResourceTypes,window.bookers=new RG.Collections.Bookers,window.deletedBookers=new RG.Collections.Bookers,window.savedFilters=new RG.Collections.SavedFilters,window.downtimeTypes=new RG.Collections.DowntimeTypes,window.downtimes=new RG.Collections.Downtimes,window.currentUserDate=new RG.Models.CurrentDate(RG.Utils.getTodayISO()),window.downtimes.on("change",function(t){var e,i,n,o,r,s,a,l,c,u;if(a=t.previousAttributes().resourceIds,s=t.get("resourceIds")||[],a&&!_.isEqual(a,s)){for(l=a.filter(function(t){return s.indexOf(t)===-1}),i=0,o=l.length;i<o;i++)u=l[i],window.downtimes.trigger("remove:resource_id:"+u,t);for(e=s.filter(function(t){return a.indexOf(t)===-1}),c=[],n=0,r=e.length;n<r;n++)u=e[n],c.push(window.downtimes.trigger("add:resource_id:"+u,t));return c}}),r=window.location.host.substr(0,window.location.host.indexOf(".")),RG.getApiRoot=function(){return"/v1/"+r},window.resources.reset([]),i=window.location.host.substr(0,window.location.host.indexOf(".")),setTimeout(function(){return RG.Utils.BookingDataParser.boot(i)},50),window.update=function(){return Q.promise(function(t){return setTimeout(function(){return RG.Utils.BookingDataParser.poll(),t()},0)})},setInterval(window.update,3e5),o=null,t=$(window),e=function(){var e,i,n;return n=t.width(),i=t.height(),e=[],RG.Variables.scrollingHorizontal=!0,window.requestAnimationFrame(function(){var e,o,r,s,a,l,c,u,h,d,p;for(p=$(".booking.sticky:visible"),o=0,l=p.length;o<l;o++)if(e=p[o],d=e.getBoundingClientRect(),d.left<n&&d.left<n&&d.right>250&&d.top<i&&d.top>110)for(u=250-d.left,u<0&&(u=0),h=u+"px",a=e.getElementsByClassName("label"),r=0,c=a.length;r<c;r++)s=a[r],s.style.paddingLeft!==h&&(s.style.paddingLeft=h);return t.scrollLeft()<50?($(".large-controls .previous-timeperiods").fadeIn(),$(".large-controls .next-timeperiods").fadeOut()):t.scrollLeft()>$(document).width()-t.width()-50?($(".large-controls .next-timeperiods").fadeIn(),$(".large-controls .previous-timeperiods").fadeOut()):($(".large-controls .previous-timeperiods").fadeOut(),$(".large-controls .next-timeperiods").fadeOut()),RG.Variables.scrollingHorizontal=!1})},$(window).scroll(e),$(window).on("touchmove",e),null!=(n=window.analytics)?n.track("Viewed Schedule"):void 0}),$(window).load(function(){var t;return t=$(window).scrollLeft(),$(window).scrollLeft(t),requestAnimationFrame(function(){return $(window).scrollLeft(t)})})}.call(this);